/*
 *
 * Wijmo Library 3.20141.34
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 */
var wijmo;(function(e){e.expando=".wijmo";var t=function(){function e(e){this.message=e,this.stack="Wijmo"+(new Error).stack,this.name="WijmoError"}return e}();e.WijmoError=t;var n=t;n.prototype=new Error,n.prototype.constructor=n})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=function(){function t(e){this.object=e}return t.getFrom=function(r,i){typeof i=="undefined"&&(i=!0);var s=e.expando,o;if(Object(r)!==r)return null;o=r[s],o&&o.object!==r&&(o=null);if(i&&!(o instanceof t&&Object.prototype.hasOwnProperty.call(r,s))){o=new t(r);try{Object.defineProperty(r,s,{value:o,configurable:!1,enumerable:!1,writable:!1})}catch(u){r[s]=o}}return o},t}();t.Expando=n})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(e){function t(e){return function(){var t=function(){return e.prototype._call.apply(t,arguments)};return $.extend(t,e.prototype),e.apply(t,arguments),t}}e.funcClass=t})(e.util||(e.util={}));var t=e.util})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){function i(e){return t.isFunction(e.subscribe)}function h(e){return typeof e=="undefined"&&(e=null),new f(e)}function p(e){return typeof e=="undefined"&&(e=0),new c(e)}function d(e){return typeof e=="undefined"&&(e=null),new f(e,!0)}function v(e){return t.isFunction(e)&&i(e)}var t=jQuery,n=function(){function e(e,t){this.handler=e,this.context=t}return e.prototype.trigger=function(e){return this.handler.apply(this.context,e)},e}();e.SubscriberEntry=n;var r=function(){function r(e){this.defaultContext=e,this._entries=[]}return r.prototype.subscribe=function(t,r){typeof r=="undefined"&&(r=this.defaultContext);var i=this,s=new n(t,r);return this._entries.push(s),{dispose:function(){return e.util.remove(i._entries,s)}}},r.prototype.trigger=function(){var t=[];for(var n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];e.util.each(this._entries,function(e,n){return n.trigger(t)})},r.makeSubscribable=function(n){var i=new r(n);return n.subscribe=t.proxy(i.subscribe,i),i},r}();e.Subscribable=r,e.isSubscriptable=i;var s=function(){function e(){}return e.prototype.subscribe=function(e,t){return this._subscribable=this._subscribable||new r(this),this._subscribable.subscribe(e,t)},e.prototype._trigger=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];this._subscribable&&this._subscribable.trigger.apply(this._subscribable,arguments)},e}();e.BaseObservable=s;var o=function(e){function t(t){e.call(this),this.mutable=t}return __extends(t,e),t.prototype._call=function(){return this.mutable.value},t}(s);e._ReadOnlyObservable=o;var u=e.util.funcClass(o),a=function(e){function t(t,n){typeof n=="undefined"&&(n=!1),e.call(this),this.value=t,this.checkNewValue=n}return __extends(t,e),t.prototype._call=function(e){return arguments.length>0&&(!this.checkNewValue||e!==this.value)&&(this.value=e,this._trigger(e),this._readOnly&&this._readOnly._trigger(e)),this.value},t.prototype.read=function(){return this._readOnly=this._readOnly||new u(this),this._readOnly},t}(s);e._MutableObservable=a;var f=e.util.funcClass(a),l=function(e){function t(t){e.call(this,t,!1),this.value=t}return __extends(t,e),t.prototype.change=function(e){return this._call(this._call()+e)},t.prototype.inc=function(){return this.change(1)},t.prototype.dec=function(){return this.change(-1)},t}(a);e._NumericMutableObservable=l;var c=e.util.funcClass(l);e.observable=h,e.numericObservable=p,e.observableWithNewValueCheck=d,e.isObservable=v})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){(function(n){function i(e,t){return typeof t=="undefined"&&(t=!1),r.isArray(e)?e=e.slice(0):r.isPlainObject(e)&&(e=r.extend(!!t,{},e)),e}function s(e){return typeof e=="string"||e instanceof String}function o(e){return typeof e=="number"}function u(t){return t===e.expando||t===r.expando}function a(e,t){var n=this;r.each(e,function(e,r){if(!u(e))return t.call(n,e,r)})}function f(t,n){var i=r.map(t,n);return delete i[e.expando],i}function l(e){var t;return e&&r.isFunction(e.toString)&&e.toString!==Object.prototype.toString?t=e.toString():t=JSON.stringify(e),t!=null&&t.length>2&&t[0]==='"'&&t[t.length-1]==='"'&&(t=t.substr(1,t.length-2)),t}function c(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];return e.replace(/{(\d+)}/g,function(e,n){return l(t[parseInt(n,10)])})}function h(e,t){var n=!0;return a(e,function(e,r){n=r,t&&(n=t.call(n,n,e));if(!n)return!1}),n}function p(e,t){var n=!1;return a(e,function(e,r){n=r,t&&(n=t.call(n,n,e));if(n)return!1}),n}function d(e,t){var n,i,o;if(e==null)return t==null?0:-1;if(t==null)return 1;if(r.isArray(e)&&r.isArray(t)){i=Math.min(e.length,t.length);for(n=0;n<i;n++){o=d(e[n],t[n]);if(o!==0)return o}return e.length-t.length}return s(e)&&s(t)?(e=e.toLowerCase(),t=t.toLowerCase(),e<t?-1:e>t?1:0):(o=e-t,isNaN(o)?0:o)}function v(e,t){return r.inArray(t,e)>=0}function m(e,t){var n=0,r;for(r=0;r<e.length;)e[r]!==t?r++:(e.splice(r,1),n++);return n}function g(e,t){return e==-1?-1:e==0?0:t?Math.ceil(e/t):1}function y(e,t){function i(){return e.apply(t,n)}var n=[];for(var r=0;r<arguments.length-2;r++)n[r]=arguments[r+2];if(typeof setTimeout==typeof undefined)return i();setTimeout(i,10)}function b(e){if(typeof console=="undefined")return;console.error?console.error(e):console.log&&console.log(e)}function w(e,n){var r=0,i=e,s;for(;;){var o=n.indexOf(".",r);o>=0?(s=n.substring(r,o),r=o+1):r>0?s=n.substring(r):s=n,i=i[s],t.isObservable(i)&&(i=i());if(o<0)break}return i}function E(e,n,r){var i=0,s;for(;;){var o=n.indexOf(".",i);o>=0?(s=n.substring(i,o),i=o+1):i>0?s=n.substring(i):s=n;var u=e[s];if(!(o>=0)){t.isObservable(u)?u(r):e[s]=r;break}t.isObservable(u)&&(u=u()),e=u}}function S(e){return typeof e=="object"&&!r.isArray(e)&&!r.isPlainObject(e)&&e.constructor!==Object.prototype.constructor}function x(e){t.util.each(e,function(e,n){if(!n||typeof n!="object")return;t.util.each(n,function(e,r){var i;if(!t.util.isString(r))return;i=/\/Date\((-?\d+)\)\//.exec(r);if(!i)return;n[e]=new Date(parseInt(i[1],10))})})}var r=jQuery;n.clone=i,n.isString=s,n.isNumeric=o,n.isInternalProperty=u,n.each=a,n.map=f,n.toStr=l,n.format=c,n.every=h,n.some=p,n.compare=d,n.contains=v,n.remove=m,n.pageCount=g,n.executeDelayed=y,n.logError=b,n.getProperty=w,n.setProperty=E,n.isClassInstance=S,n.convertDateProperties=x;var T=function(){function e(e){this.key=e}return e}();n.HashMapEntry=T;var N=function(){function e(){this.hash={}}return e.prototype.getEntry=function(e,t){typeof t=="undefined"&&(t=!1);if(e===null)return!this.nullEntry&&t&&(this.nullEntry=new T(e)),this.nullEntry;var n=String(e),r=this.hash[n],i;if(r==null){if(!t)return null;r=[],this.hash[n]=r}for(var s=0;s<r.length;s++)if(r[s].key===e)return r[s];return t&&(i=new T(e),r.push(i)),null},e.prototype.containsKey=function(e){return!!this.getEntry(e)},e.prototype.get=function(e,t){typeof t=="undefined"&&(t=null);var n=this.getEntry(e);return n?n.value:t},e.prototype.put=function(e,t){this.getEntry(e,!0).value=t},e}();n.HashMap=N})(t.util||(t.util={}));var n=t.util})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){t.errors={},t.errors._register=function(n){t.util.each(n,function(n,r){function i(){var n=[];for(var i=0;i<arguments.length-0;i++)n[i]=arguments[i+0];var s;return $.isFunction(r)?r=r.apply(this,arguments):arguments.length>0&&(n.unshift(r),r=t.util.format.apply(this,n)),r=$.trim(r),s=r[r.length-1],s!=="."&&s!=="!"&&s!=="?"&&(r+="."),new e.WijmoError(r)}t.errors[n]=function(){throw i.apply(this,arguments)},t.errors[n].create=i})},t.errors._register({indexOutOfBounds:"Index is outside the bounds of the array.",notImplemented:"The operation is not implemented",unsupportedOperation:"Unsupported operation",unsupportedFilterOperator:"Unsupported filter operator: {0}",unsupportedDataSource:"Unsupported data source",argument:function(e){var t="Unexpected argument value.";return e&&(t+="\nParameter name: "+e),t},argumentNull:"Argument '{0}' is null/undefined",noParser:"There is no parser for type '{0}'",noUrl:"Url is not specified",cantConvert:"Value can't be converted to type '{0}': '{1}'",noGlobalize:"Globalize is not defined. Make sure you include globalize.js",itemNotInView:"Item {0} is not in the data view",unsupportedFilterFormat:"The filter format is not supported",multiPropertyKeysNotSupported:"Entities with multiple properties in the primary key are not supported. Entity type: {0}",keyPropertyNotFound:"Key property not found in {0} entity type"})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){function r(n,r){typeof r=="undefined"&&(r=!1),n=n.toLowerCase();var i=t.ops[n];if(!i){var s=t.opMap[n];s&&(i=t.ops[s])}return!i&&r&&e.errors.unsupportedFilterOperator(n),i}function i(i){var s;if(!n.isPlainObject(i))return{operator:"==",op:t.ops.equals,value:i};var o=i.operator||t.ops.equals;if(e.util.isString(i.operator)){if(i.operator.toLowerCase()==="nofilter")return null;o=r(i.operator,!0)}else n.isFunction(o.apply)||e.errors.unsupportedFilterOperator(o);return{operator:i.operator,op:o,value:i.value}}function s(t){var r={isEmpty:!1,original:t,func:null,normalized:null};if(n.isFunction(t))r.func=t;else if(n.isArray(t))e.errors.unsupportedFilterFormat(t);else if(t){r.normalized={};var s=!1;e.util.each(t,function(t,o){n.isArray(o)&&e.errors.unsupportedFilterFormat(),o=i(o),o&&(r.normalized[t]=o,s=!0)}),s?r.func=function(t){return e.util.every(r.normalized,function(n,r){var i=e.util.getProperty(t,r);return n.op.apply(i,n.value)})}:r.normalized=null}return!r.normalized&&!r.func&&(r.isEmpty=!0,r.func=function(e){return!0}),r}var n=jQuery;t.opMap={"==":"equals",doesnotcontain:"notcontain","!=":"notequal",">":"greater","<":"less",">=":"greaterorequal","<=":"lessorequal",isnotempty:"notisempty",isnotnull:"notisnull"},t.normalizeCondition=i,t.compile=s,t.ops=function(){function r(e,n,r,i,s){return t[e.toLowerCase()]={name:e,displayName:n,arity:r,applicableTo:i,apply:s}}function i(t){return t instanceof Date&&(t=t.getTime()),e.util.isString(t)&&(t=t.toLowerCase()),t}function s(e,t,n,s){r(e,t,2,n,function(e,t){return s(i(e),i(t))})}function o(e,t,n,i){r(e,t,1,n,i)}function u(e,t,r){s(e,t,n.prim,r)}function a(e,t,r){s(e,t,n.str,r)}var t={},n={str:["string"],prim:["string","number","datetime","currency","boolean"]};return u("Equals","Equals",function(e,t){return e==t}),u("NotEqual","Not equal",function(e,t){return e!=t}),u("Greater","Greater than",function(e,t){return e>t}),u("Less","Less than",function(e,t){return e<t}),u("GreaterOrEqual","Greater or equal",function(e,t){return e>=t}),u("LessOrEqual","Less or equal",function(e,t){return e<=t}),a("Contains","Contains",function(e,t){return e==t||e&&e.indexOf&&e.indexOf(t)>=0}),a("NotContain","Does not contain",function(e,t){return e!=t&&(!e||!e.indexOf||e.indexOf(t)<0)}),a("BeginsWith","Begins with",function(e,t){return e==t||e&&e.indexOf&&e.indexOf(t)==0}),a("EndsWith","Ends with",function(t,n){var r;return!e.util.isString(t)||!e.util.isString(n)?!1:(r=t.lastIndexOf(n),r>=0&&t.length-r===n.length)}),o("IsEmpty","Is empty",n.str,function(e){return!e&&e!==0&&e!==!1}),o("NotIsEmpty","Is not empty",n.str,function(e){return!!e||e===0||e===!1}),o("IsNull","Is null",n.prim,function(e){return e==null}),o("NotIsNull","Is not null",n.prim,function(e){return e!=null}),t}()})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){function n(t){var n=[];return t=e.util.isString(t)?t.split(/,\s*/):$.isArray(t)?t.slice(0):[t],t=$.isArray(t)?t.slice(0):[t],e.util.each(t,function(t,r){var i=!0,s;if(r==null)return;if(!e.util.isString(r)){r.property!=null&&n.push(r);return}if(r[0]==="-")i=!1,r=r.substr(1);else{var o=/\s(asc|desc)\s*$/.exec(r);o&&(r=r.substr(0,o.index),i=o[1]!=="desc")}n.push({property:r,asc:i})}),n.length>0?n:null}function r(t,r){typeof r=="undefined"&&(r=e.util.compare);var i=n(t),s={isEmpty:!0,original:t,propertyCompareTo:r,compare:null,normalized:i};return i!=null&&(s.isEmpty=!1,s.compare=function(t,n){var s=0,o,u;for(s=0;s<i.length;s++){u=i[s],o=r(e.util.getProperty(t,u.property),e.util.getProperty(n,u.property));if(o!==0)return u.asc||(o=-o),o}return 0}),s}t.compile=r})(e.sorting||(e.sorting={}));var t=e.sorting})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(r){return t.isFunction(r)||e.errors.argument("factory"),n.push(r),{dispose:function(){e.util.remove(n,r)}}}function i(t){if(s(t))return t;var r=e.util.some(n,function(e){return e(t)});return r||e.errors.unsupportedDataSource()}function s(e){return e&&t.isFunction(e.count)&&t.isFunction(e.item)&&t.isFunction(e.getProperty)}var t=jQuery,n=[];e.registerDataViewFactory=r,r(function(e){return s(e)&&e}),r(function(n){return t.isArray(n)&&new e.ArrayDataView(n)}),e.asDataView=i,e.isDataView=s})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(){function n(n){function i(e){return function(){if(r)return;r=!0;try{e.apply(this,arguments)}finally{r=!1}}}this.array=n,this.currentItem=e.observableWithNewValueCheck(null),this.currentPosition=e.observableWithNewValueCheck(-1);var r=!1;this.currentItem.subscribe(i(function(e){this.currentPosition(e==null?-1:t.inArray(e,this.array))}),this),this.currentPosition.subscribe(i(function(t){e.util.isNumeric(t)||e.errors.argument("value"),(t<-1||t>=this.array.length)&&e.errors.indexOutOfBounds(),this.currentItem(t<0?null:this.array[t])}),this)}return n.prototype.update=function(){var e=this.currentItem(),n=this.currentPosition(),r=t.inArray(e,this.array);r<0&&e==null&&this._recentlyRemovedItem!=null&&(r=t.inArray(this._recentlyRemovedItem,this.array)),r>=0?(e&&(this._recentlyRemovedItem=e),this.currentPosition(r)):n>=0&&n<this.array.length?this.currentItem(this.array[n]):n>=this.array.length&&this.array.length>0?(n=this.array.length-1,this.currentPosition(n),this.currentItem(this.array[n])):(this.currentPosition(-1),this.currentItem(null))},n.prototype.updateDelayed=function(){e.util.executeDelayed(this.update,this)},n}();e.CurrencyManager=n})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(){function t(t){function n(){this.pageSize()>0&&this.pageIndex()>=0?(this._skip=this.pageSize()*this.pageIndex(),this._take=this.pageSize()):(this._skip=0,this._take=-1),t(!0)}this.onChanged=t,this.filter=e.observable(),this._compiledFilter=e.filtering.compile(null),this.sort=e.observable(),this._compiledSort=e.sorting.compile(null),this.pageIndex=e.observable(0),this.pageSize=e.observable(0),this._skip=0,this._take=-1,this.filter.subscribe(function(e){this.onFilterChanged(e),t()},this),this.sort.subscribe(function(){this._compiledSort=e.sorting.compile(this.sort()),t()},this),this.pageIndex.subscribe(n,this),this.pageSize.subscribe(n,this)}return t.prototype.onFilterChanged=function(t){this._compiledFilter=e.filtering.compile(t)},t.prototype.setFilter=function(e){this.filter(e)},t.prototype.update=function(e){"filter"in e&&this.setFilter(e.filter),"sort"in e&&this.sort(e.sort),"pageSize"in e&&this.pageSize(e.pageSize),"pageIndex"in e&&this.pageIndex(e.pageIndex)},t.prototype.apply=function(e,t,n){typeof t=="undefined"&&(t=!0),typeof n=="undefined"&&(n=null);var r;if(!this._compiledFilter.isEmpty){n?n.length=0:n=[];for(r=0;r<e.length;r++){var i=e[r];this._compiledFilter.func(i)&&n.push(i)}}else if(!n)n=e.slice(0);else{n.length=e.length;for(r=0;r<e.length;r++)n[r]=e[r]}this._compiledSort.isEmpty||this._stableSort(n,this._compiledSort.compare);var s=n.length;return t&&this._take>0&&(this._skip>0&&n.splice(0,Math.min(this._skip,n.length)),this._take<n.length&&(n.length=this._take)),{results:n,totalCount:s}},t.prototype._stableSort=function(e,t){var n=/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())&&/Google Inc/.test(navigator.vendor);t&&n?(e.forEach(function(t,n){e[n]={index:n,value:t}}),e.sort(function(e,n){var r=t(e.value,n.value);return r===0?e.index-n.index:r}),e.forEach(function(t,n){e[n]=t.value})):e.sort(t)},t.prototype.toObj=function(){return{filter:this._compiledFilter.normalized,sort:this._compiledSort.normalized,pageSize:this.pageSize(),pageIndex:this.pageIndex()}},t}();e.Shape=n;var r=function(){function r(t){this.isRemote=!1,this.localPaging=!0,this.local=[],this._updatingShape=!1,this._pageCount=e.observable(1),this._totalItemCount=e.numericObservable(0),this._isLoaded=e.observable(!1),this._isLoading=e.observable(!1),this._currentEditItem=e.observable(),this._isCurrentEditItemNew=!1,this._currentEditItemSnapshot=null,this.isLoading=this._isLoading.read(),this.isLoaded=this._isLoaded.read(),this._changed=new e.Subscribable(this),this.currentEditItem=this._currentEditItem.read(),this._initCurrency(),this._initShape(t)}return r.prototype.dispose=function(){},r.prototype.count=function(){return this.local.length},r.prototype.item=function(t){return(t<0||t>=this.local.length)&&e.errors.indexOutOfBounds(),this.local[t]},r.prototype.indexOf=function(e){return t.inArray(e,this.local)},r.prototype.getSource=function(){return this.sourceArray},r.prototype.toObservableArray=function(){return this._koArray||(this._koArray=ko.observableArray(this.local)),this._koArray},r._getProps=function(r){var i=[];return e.util.each(r,function(e,n){e=String(e);if(e.match(/^_/))return;if(t.isFunction(n)&&!n.subscribe)return;i.push({name:e})}),i},r.prototype.getProperties=function(){return this.count()?r._getProps(this.item(0)):[]},r.prototype._readProperty=function(t,n){return e.util.getProperty(t,n)},r.prototype.getProperty=function(e,t){var n=this._getItem(e);return this._readProperty(n,t)},r.prototype._writeProperty=function(t,n,r){e.util.setProperty(t,n,r)},r.prototype.setProperty=function(e,t,n){var r=this._getItem(e);return r===this.currentEditItem()&&this._currentEditItemSnapshot&&!(t in this._currentEditItemSnapshot)&&(this._currentEditItemSnapshot[t]=this.getProperty(e,t)),this._writeProperty(r,t,n),this},r.prototype.subscribe=function(e,t){return this._changed.subscribe(e,t)},r.prototype.trigger=function(){this._currencyManager.update(),this._changed.trigger(this.local),this._koArray&&this._koArray.notifySubscribers(this.local)},r.prototype.canFilter=function(){return!0},r.prototype.canSort=function(){return!0},r.prototype._updateShape=function(e){this._updatingShape=!0;try{this._shape.update(e)}finally{this._updatingShape=!1}},r.prototype.prevPage=function(){return this.pageIndex()<1?!1:(this.pageIndex(this.pageIndex()-1),!0)},r.prototype.nextPage=function(){return this.pageCount()>0&&this.pageIndex()+1>=this.pageCount()?!1:(this.pageIndex(this.pageIndex()+1),!0)},r.prototype._createShape=function(e){return new n(e)},r.prototype._initShape=function(e){var t=this,n=function(e){typeof e=="undefined"&&(e=!1),t._updatingShape||t.refresh(null,e&&t.localPaging)};this._shape=this._createShape(n),e&&this._updateShape(e),this.filter=this._shape.filter,this.sort=this._shape.sort,this.pageIndex=this._shape.pageIndex,this.pageSize=this._shape.pageSize,this.pageCount=this._pageCount.read(),this.totalItemCount=this._totalItemCount.read()},r.prototype._localRefresh=function(n){typeof n=="undefined"&&(n=this.localPaging);var r=this._shape.apply(this.sourceArray,n,this.local);return n&&this._totalItemCount(r.totalCount),this._pageCount(e.util.pageCount(this.totalItemCount(),this.pageSize())),this.trigger(),t.Deferred().resolve().promise()},r.prototype._remoteRefresh=function(){return this._localRefresh()},r.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1);var n=this;this.cancelRefresh(),e&&this._updateShape(e),this._isLoading(!0);var r=t?this._localRefresh():this._remoteRefresh();return r.then(function(){n._isLoaded(!0),n._isLoading(!1)})},r.prototype.cancelRefresh=function(){},r.prototype._initCurrency=function(){this._currencyManager=new e.CurrencyManager(this.local),this.currentItem=this._currencyManager.currentItem,this.currentPosition=this._currencyManager.currentPosition},r.prototype.isCurrentEditItemNew=function(){return this._isCurrentEditItemNew},r.prototype._beginEdit=function(e,t){this.commitEdit(),this._currentEditItemSnapshot={},this._isCurrentEditItemNew=t,this._currentEditItem(e)},r.prototype.canAdd=function(){return!0},r.prototype.add=function(t){t||e.errors.argument("item"),this.commitEdit(),this.local.push(t),this._beginEdit(t,!0),this.trigger()},r.prototype.canAddNew=function(){return!1},r.prototype.addNew=function(){return e.errors.unsupportedOperation()},r.prototype.editItem=function(e){typeof e=="undefined"&&(e=this.currentItem()),this.commitEdit(),e=this._getItem(e),e&&this._beginEdit(e,!1)},r.prototype.canRemove=function(){return!0},r.prototype._remove=function(t){this.local.splice(t.index,1),e.util.remove(this.sourceArray,t.item),this._totalItemCount.dec(),this.trigger()},r.prototype.remove=function(e){typeof e=="undefined"&&(e=this.currentItem()),this.commitEdit();var t=this._resolve(e);return t?(this._remove(t),!0):!1},r.prototype.canCancelEdit=function(){return!0},r.prototype.cancelEdit=function(){var n=this,r;if(!this.currentEditItem())return;var i=this.currentEditItem();this._currentEditItem(null),this._isCurrentEditItemNew?e.util.remove(this.local,this.item):this._currentEditItemSnapshot&&t.each(this._currentEditItemSnapshot,function(e,t){return n._writeProperty(i,e,t)}),this.trigger()},r.prototype.canCommitEdit=function(){return!0},r.prototype.commitEdit=function(){if(!this.currentEditItem())return;var t=this.currentEditItem();this._currentEditItem(null),this._isCurrentEditItemNew&&(this.sourceArray.push(t),this._totalItemCount.inc());var n=this._shape._compiledFilter;!n.isEmpty&&!n.func(t)&&e.util.remove(this.local,t),this.trigger()},r.prototype._getItem=function(t){var n;return e.util.isNumeric(t)?this.item(t):t},r.prototype._resolve=function(t,n){typeof n=="undefined"&&(n=!1);var r;return e.util.isNumeric(t)?{index:t,item:this.item(t)}:(r=this.indexOf(t),r<0?(n&&e.errors.itemNotInView(t),null):{index:r,item:t})},r}();e.ArrayDataViewBase=r;var i=function(e){function t(t,n){e.call(this,n),this.sourceArray=t,this.refresh()}return __extends(t,e),t}(r);e.ArrayDataView=i})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(e){function n(t){e.call(this),this.isRemote=!0,this.sourceArray=[],t&&this._construct(t)}return __extends(n,e),n.prototype._construct=function(e){this.options=e=t.extend({localPaging:!1},e),this.localPaging=e.localPaging,this._updateShape(e)},n}(e.ArrayDataViewBase);e.RemoteDataView=n})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=jQuery,n=function(){function e(e){this._originalReader=e}return e.prototype.read=function(e){e.items=null,this._originalReader&&t.isFunction(this._originalReader.read)&&this._originalReader.read(e),t.isArray(e.items)||(t.isArray(e.data)?e.items=e.data:e.data&&t.isArray(e.data.rows)?e.items=e.data.rows:e.items=[]);if(e.dynamic)if(!e.data||isNaN(e.data.totalRows))throw"totalRows value is missing"},e}(),r=function(r){function i(e){var i=this;r.call(this),this.dataSource=e,this.isRemote=!0,this.localPaging=!0,this._origLoaded=e.loaded,this._origReader=e.reader,e.loaded=function(e,n){i._loaded(),t.isFunction(i._origLoaded)&&i._origLoaded.apply(i,arguments)},e.reader=new n(e.reader);var s=e.items&&e.items.length>0;t.isArray(e.data)&&!s&&e.read(),e.items&&this._loaded()}return __extends(i,r),i.prototype.dispose=function(){this.dataSource.loaded=this._origLoaded,this.dataSource.reader=this._origReader,r.prototype.dispose.call(this)},i.prototype.getProperties=function(){return this.sourceArray&&this.sourceArray.length?e.ArrayDataViewBase._getProps(this.sourceArray[0]):[]},i.prototype._loaded=function(){this.sourceArray=this.dataSource.items,this.dataSource.data&&e.util.isNumeric(this.dataSource.data.totalRows)&&this._totalItemCount(this.dataSource.data.totalRows);var t=r.prototype._localRefresh.call(this,!this.dataSource.dynamic);this._currentDeferred&&t.then(this._currentDeferred.resolve)},i.prototype._remoteRefresh=function(){this._currentDeferred&&this._currentDeferred.state()==="pending"&&this._currentDeferred.fail(),this._currentDeferred=t.Deferred();var e={},n=!1;return this.dataSource.dynamic&&(n=!0,e.data=this._prepareRequest(),this.dataSource.proxy&&(this._origDataOption||(this._origDataOption=t.extend({},this.dataSource.proxy.options.data)),this.dataSource.proxy.options.data=t.extend({},this._origDataOption,e.data))),this.dataSource.load(e,n),this._currentDeferred},i.prototype._prepareRequest=function(){return{filtering:this._prepareFilterRequest(),paging:this._preparePageRequest(),sorting:this._prepareSortRequest()}},i.prototype._prepareFilterRequest=function(){var e=[];return!this._shape._compiledFilter.isEmpty&&this._shape._compiledFilter.normalized&&t.each(this._shape._compiledFilter.normalized,function(t,n){e.push({dataKey:t,filterOperator:n.op.Name,filterValue:n.value})}),e},i.prototype._preparePageRequest=function(){return{pageIndex:this._shape.pageIndex(),pageSize:this._shape.pageSize()}},i.prototype._prepareSortRequest=function(){return this._shape._compiledSort.isEmpty||!this._shape._compiledSort.normalized||this._shape._compiledSort.normalized.length==0?[]:t.map(this._shape._compiledSort.normalized,function(e){return{dataKey:e.property,sortDirection:e.asc?"ascending":"descending"}})},i}(e.ArrayDataViewBase);e.registerDataViewFactory(function(e){if(typeof wijdatasource=="function"&&e instanceof wijdatasource)return new r(e);return})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this.element.addClass(this.options.wijCSS.widget+" wijmo-wijpager "+this.options.wijCSS.helperClearFix),this.options.disabled&&this.disable(),this._refresh()},t.prototype._destroy=function(){this.element.removeClass(this.options.wijCSS.widget+" wijmo-wijpager "+this.options.wijCSS.helperClearFix),this.$ul.remove()},t.prototype._setOption=function(e,t){this._super(e,t),this._refresh()},t.prototype._refresh=function(){this._validate(),this.$ul&&this.$ul.remove(),this.element.append(this.$ul=n('<ul class="ui-list '+this.options.wijCSS.cornerAll+" "+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'" role="tablist"></ul>'));switch((this.options.mode||"").toLowerCase()){case"nextprevious":this._createNextPrev(!1);break;case"nextpreviousfirstlast":this._createNextPrev(!0);break;case"numeric":this._createNumeric(!1);break;case"numericfirstlast":this._createNumeric(!0)}},t.prototype._validate=function(){var e=this.options;if(isNaN(e.pageCount)||e.pageCount<1)e.pageCount=1;isNaN(e.pageIndex)||e.pageIndex<0?e.pageIndex=0:e.pageIndex>=e.pageCount&&(e.pageIndex=e.pageCount-1);if(isNaN(e.pageButtonCount)||e.pageButtonCount<1)e.pageButtonCount=1},t.prototype._createNextPrev=function(e){var t=this.options,n=t.firstPageClass?t.firstPageClass+" "+t.wijCSS.iconSeekFirst:"",r=t.previousPageClass?t.previousPageClass+" "+t.wijCSS.iconSeekPrev:"",i=t.nextPageClass?t.nextPageClass+" "+t.wijCSS.iconSeekNext:"",s=t.lastPageClass?t.lastPageClass+" "+t.wijCSS.iconSeekEnd:"";e&&t.pageIndex&&this.$ul.append(this._createPagerItem(!1,t.firstPageText,1,n)),t.pageIndex&&this.$ul.append(this._createPagerItem(!1,t.previousPageText,t.pageIndex,r)),t.pageIndex+1<t.pageCount&&this.$ul.append(this._createPagerItem(!1,t.nextPageText,t.pageIndex+2,i)),e&&t.pageIndex+1<t.pageCount&&this.$ul.append(this._createPagerItem(!1,t.lastPageText,t.pageCount,s))},t.prototype._createNumeric=function(e){var t=this.options,n=t.pageIndex+1,r=1,i=Math.min(t.pageCount,t.pageButtonCount),s,o=t.firstPageClass?t.firstPageClass+" "+t.wijCSS.iconSeekFirst:"",u=t.lastPageClass?t.lastPageClass+" "+t.wijCSS.iconSeekEnd:"";n>i&&(r=Math.floor(t.pageIndex/t.pageButtonCount)*t.pageButtonCount+1,i=r+t.pageButtonCount-1,i=Math.min(i,t.pageCount),i-r+1<t.pageButtonCount&&(r=Math.max(1,i-t.pageButtonCount+1))),r!==1&&(e&&this.$ul.append(this._createPagerItem(!1,t.firstPageText,1,o)),this.$ul.append(this._createPagerItem(!1,"...",r-1,"")));for(s=r;s<=i;s++)this.$ul.append(this._createPagerItem(s===n,s.toString(),s,""));t.pageCount>i&&(this.$ul.append(this._createPagerItem(!1,"...",i+1,"")),e&&this.$ul.append(this._createPagerItem(!1,t.lastPageText,t.pageCount,u)))},t.prototype._createPagerItem=function(e,t,r,i){var s,o=this.options.wijCSS,u=this,a=n("<li />").addClass(o.pagerButton+" "+o.cornerAll).attr({role:"tab","aria-label":t,title:t});return e?a.addClass(o.stateActive).attr("aria-selected","true"):a.addClass(o.stateDefault).hover(function(){u.options.disabled||n(this).addClass(o.stateHover)},function(){u.options.disabled||n(this).removeClass(o.stateHover)}).bind("click."+this.widgetName,{newPageIndex:r-1},n.proxy(this._onClick,this)),e?s=n("<span />"):s=i?n("<span />").addClass(o.icon+" "+i):n("<a/>").attr("href","#"),s.text(t),a.append(s),a},t.prototype._onClick=function(e){if(this.options.disabled)return!1;var t={newPageIndex:e.data.newPageIndex,handled:!1};if(this._trigger("pageIndexChanging",null,t)!==!1&&this.options.pageIndex!==t.newPageIndex){this.options.pageIndex=t.newPageIndex,t.handled||this._refresh();var n={newPageIndex:t.newPageIndex};this._trigger("pageIndexChanged",null,n)}return!1},t}(e.wijmoWidget);t.wijpager=r,r.prototype.widgetEventPrefix="wijpager";var i=function(){function e(){this.wijCSS={pagerButton:"wijmo-wijpager-button"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-c"},this.firstPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekFirst,this.firstPageText="First",this.lastPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekEnd,this.lastPageText="Last",this.mode="numeric",this.nextPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekNext,this.nextPageText="Next",this.pageButtonCount=10,this.previousPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekPrev,this.previousPageText="Previous",this.pageCount=1,this.pageIndex=0,this.pageIndexChanging=null,this.pageIndexChanged=null}return e}();r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("wijpager",r.prototype)})(e.pager||(e.pager={}));var t=e.pager})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n,r,i;n=function(e){var t=this;t.data={},t.reader=null,t.proxy=null,t.items=[],t.loading=null,t.loaded=null,t._constructor(e)},window.wijdatasource=n,t.extend(n.prototype,{_constructor:function(e){t.extend(this,e)},load:function(e,n){var r=this,i=r.proxy;if(t.isFunction(r.loading)&&r.loading(r,e)===!1)return;i?i.request(r,r.loaded,e):((r.items.length===0||n)&&this.read(),t.isFunction(r.loaded)&&r.loaded(r,e))},read:function(){var e=this,t=e.data;t&&e.reader?e.reader.read(e):e.items=e.data}}),r=function(e){t.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(e),t.isArray(e)&&(this.fields=e)},window.wijarrayreader=r,t.extend(r.prototype,{read:function(e){t.isArray(e.data)?e.items=this._map(e.data):e.items=[]},_map:function(e){var n=this,r=[];return n.fields===undefined||n.fields.length===0?(t.extend(!0,r,e),r):(t.each(e,function(e,i){var s={};t.each(n.fields,function(e,n){n.mapping&&typeof n.mapping&&window[n.mapping]&&(n.mapping=window[n.mapping]);if(t.isFunction(n.mapping))return s[n.name]=n.mapping(i),!0;var r=n.mapping!==undefined?n.mapping:n.name,o=i[r];o===undefined&&(n.defaultValue!==undefined?o=n.defaultValue:o=i),s[n.name]=o}),r.push(s)}),r)}}),i=function(e){this.options=e,t.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(e)},window.wijhttpproxy=i,t.extend(i.prototype,{request:function(e,n,r){var i=this,s,o;s=t.extend({},this.options),o=s.success,s.success=function(u){t.isFunction(o)&&o(u),i._complete(u,e,n,s,r)},t.ajax(s)},_complete:function(e,n,r,i,s){n.data=i.key!==undefined?e[i.key]:e,n.read(),t.isFunction(r)&&r(n,s)}})})(e.checkbox||(e.checkbox={}));var t=e.checkbox})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijcombobox",i=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var e=this,t;e.selectedItem=null,e.selectedItems=[],window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));try{t=document.activeElement}catch(r){}e._initInnerData(),e._createDOMElements(),e._bindInputEvents(),e._initDropDownList(),e.repaint(),e._checkSelectIndex(),e.options.text=e._input.val(),e._usingRemoteData()&&e.options.data&&(e.originalDataSourceLoaded=e.options.data.loaded),t===e._input[0]&&e.options.isEditable&&n(function(){e._input.focus()}),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.repaint(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcombobox")},r.prototype._initInnerData=function(){var e=this,t=e.options,n;t.dataSource!==null?(n=e._isBind(),n?e.innerData=e._getMappingItems():e.innerData=t.data):e.innerData=t.data,e.listHasCreated=!1},r.prototype._checkSelectIndex=function(){var e=this,t,r=e.options,i=e.innerData;r.selectedIndex===-1&&r.selectedValue&&n.each(i,function(e,t){if(i[e].value===r.selectedValue)return r.selectedIndex=e,r.selectionMode==="multiple"&&(r.selectedIndex=[r.selectedIndex]),!1}),t=r.selectedIndex,!e._usingRemoteData()&&(t>=0||n.isArray(t))&&e.search(null,"checkindex"),r.selectedIndex===-1&&r.text&&(!r.forceSelectionText||r.forceSelectionText&&e._checkTextInItems(r.text)!==-1)&&(e._input.val(r.text),r.selectedIndex=e._checkTextInItems(r.text),r.selectionMode==="multiple"&&(r.selectedIndex=[r.selectedIndex]),r.selectedIndex>-1&&e._checkSelectIndex())},r.prototype.repaint=function(){var e=this.options,t=this;if(t.element.is(":visible")||t._comboDiv||t._select!==undefined&&t._input.is(":visible")){t._showTrigger();if(e.disabledState){var n=e.disabled;t.disable(),e.disabled=n}return e.disabled&&t.disable(),!0}return!1},r.prototype._bindInputEvents=function(){var t=this,r=this.options.wijCSS,i,s,o,u,a;i=t._input,s=t.options,i.bind("keydown.wijcombobox",function(r){if(s.disabledState===!0||s.disabled)return;o=r.keyCode,u=e.getKeyCodeEnum();switch(o){case u.UP:t._move("previous",r),r.preventDefault();break;case u.DOWN:t._move("next",r),r.preventDefault();break;case u.ENTER:t.menu.active&&(r.preventDefault(),s.selectionMode==="multiple"&&t.menu&&t.menu.items&&t.menu.items.length===1&&n.each(t.selectedItems,function(e,n){n!==t.menu.items[0]&&(n.selected=!1)}),t.menu.select(r)),r.preventDefault();break;case u.TAB:i.trigger("wijcomboblur");if(!t.menu.active||s.selectionMode==="multiple"&&u.TAB===o)return;t.menu.select(r);var a=i.val().length;t._selectText(a,a,i);break;case u.ESCAPE:t.close(r,undefined);break;case u.LEFT:case u.RIGHT:case u.SHIFT:case 16:case 17:case u.CONTROL:case u.HOME:case u.END:case u.DELETE:case u.PAGE_UP:case u.PAGE_DOWN:break;case 18:i.trigger("wijcomboblur");break;default:window.clearTimeout(t.searching),s.isEditable===!1&&(t._cacheKey===undefined&&(t._cacheKey=""),t._cacheKey+=String.fromCharCode(o)),t.searching=window.setTimeout(function(){var e;s.isEditable===!1?(e=t._cacheKey,t._cacheKey=undefined):e=i.val(),t.search(e,r)},s.delay)}}).bind("wijcomboblur.wijcombobox",function(e){window.clearTimeout(t.searching),t._addInputFocus(!1,r.stateFocus),t.closing=window.setTimeout(function(){t.close(e,!0)},150)}).bind("focus.wijcombobox",function(){t._addInputFocus(!0,r.stateFocus)}).bind("blur.wijcombobox",function(){t.menu.element.is(":visible")||i.trigger("wijcomboblur"),t._inputBlurCausedByListItemClick||t._change()}),n.browser.msie&&parseInt(n.browser.version)>9&&i.bind("mouseup.wijcombobox",function(e){if(i.val()==="")return;setTimeout(function(){i.val()===""&&t.menu.deactivate()},5)})},r.prototype._addInputFocus=function(e,t){var n=this,r,i,s;r=n._input.parent(),i=e?"addClass":"removeClass",s=n._triggerArrow,r[i](t),s!==undefined&&s[i](t)},r.prototype._renderColumnsHeader=function(e){var t=this,r=n("<ul class='wijmo-wijcombobox-rowheader'></ul>");n.each(this.options.columns,function(e,i){var s=n("<li class='wijmo-wijcombobox-cell "+t.options.wijCSS.header+"'></li>");s.html(i.name),i.width!==undefined&&s.width(i.width),s.appendTo(r)}),e.append(r)},r.prototype._hasSameValueText=function(e,t){return e.label===t.label&&e.value===t.value},r.prototype._initDropDownList=function(){var e=this,t,r,i,s,o,u=this.options.wijCSS,a=parseInt(e._input.css("zIndex"),10),f;t=e.element[0].ownerDocument,isNaN(a)&&(a=0),e._comboDiv?r=e._oriList:r=n("<div class='"+u.comboboxListCss+"'></div>"),i=e.options,i.columns.length>0&&(r.addClass("wijmo-wijcombobox-multicolumn"),s=n("<div class='wijmo-wijsuperpanel-header "+u.stateDefault+"'></div>"),e._renderColumnsHeader(s),r.append(s)),o={keepHightlightOnMouseLeave:!0,selectionMode:i.selectionMode,addHoverItemClass:i.columns.length===0,focus:function(t,n){var r=n;i.selectOnItemFocus&&e.menu.select(null,{notCloseAfterSelected:!0}),i.columns.length>0&&r.element&&(r.element.prev().addClass("wijmo-wijcombobox-active-prev"),r.element.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").addClass(u.stateHover))},selected:function(t,r){window.clearTimeout(e.closing);var s=i.selectionMode,o,u,a=!1,f,l,c;o=r.item,u=n.inArray(o,e.items);if(u<0)return;if(e._trigger("select",t,o))if(s==="single"){if(!e._usingRemoteData())if(u!==i.selectedIndex){l=i.selectedIndex,c=e.selectedItem,a=e._triggerSelectedIndexChanging(c,o,l,u);if(a)return;e._setInputText(o.label),c&&(c.selected=!1),e.selectedItem=o,i.selectedIndex=u,i.selectedValue=e.selectedItem.value,i.inputTextInDropDownList=!0,c&&c.element&&c.element.removeClass("wijmo-wijcombobox-selecteditem"),e._trigger("changed",null,{oldItem:c,selectedItem:e.selectedItem,newIndex:i.selectedIndex,oldIndex:l}),e._triggerSelectedIndexChanged(c,e.selectedItem,l,i.selectedIndex)}else e.selectedItem&&e._input.val()!==e.selectedItem.label&&(r.data===undefined||!r.data.notCloseAfterSelected)&&e._input.val(o.label);else if(e.selectedItem===null||!e._hasSameValueText(o,e.selectedItem)){c=e.selectedItem,l=i.selectedIndex,a=e._triggerSelectedIndexChanging(c,o,l,r.selectedIndex);if(a)return;e._setInputText(o.label),e.selectedItem=o,u!==i.selectedIndex&&(i.selectedIndex=u,i.selectedValue=e.selectedItem.value),i.inputTextInDropDownList=!0,e._trigger("changed",null,{selectedItem:o}),e._triggerSelectedIndexChanged(c,o,l,i.selectedIndex)}}else if(!e._usingRemoteData()){a=e._triggerSelectedIndexChanging(null,o,l,r.selectedIndex);if(a)return;e.selectedItems=r.selectedItems,e._selectedItemsToInputVal(e.selectedItems),i.inputTextInDropDownList=!0,i.selectedIndex=r.selectedIndex,e._trigger("changed",null,{selectedItem:o,selectedItems:e.selectedItems}),e._triggerSelectedIndexChanged(null,o,null,i.selectedIndex)}(r.data===undefined||!r.data.notCloseAfterSelected)&&s==="single"&&(e.close(t),e._input.focus()),e._inputBlurCausedByListItemClick=!1},blur:function(e,t){var n=t.element;i.columns.length>0&&n&&(n.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").removeClass(u.stateHover),n.prev().removeClass("wijmo-wijcombobox-active-prev"))},mouseDown:function(t){e._inputBlurCausedByListItemClick=!0},itemRendering:function(e,t){var n=t,r="";n.isSeparator&&(r+=" wijmo-wijcombobox-separator"),n.selected&&(r+=" wijmo-wijcombobox-selecteditem"),r.length>0&&n.element.addClass(r)},itemRendered:function(e,t){var r=t,s,o;if(r.cells===undefined)return;s=r.element,s.empty(),o=n("<ul class='wijmo-wijcombobox-row'></ul>"),n.each(r.cells,function(e,t){var r=n("<li class='wijmo-wijcombobox-cell "+u.stateDefault+"'></li>");i.columns&&i.columns.length>e&&typeof i.columns[e].width!="undefined"&&r.width(i.columns[e].width),r.append(t),r.attr("title",t),o.append(r)}),s.append(o)},listRendered:function(t,r){var s=e.menu.selectedItem,o=e.menu.selectedItems,u,a;if(i.selectionMode==="single"&&s){u=n.inArray(s,e.items);if(u<0)return;e.selectedItem=e.items[u],e._setInputText(e.selectedItem.label,!0),u>=-1&&(i.selectedIndex=u)}else o&&o.length>0&&(u=[],a=[],n.each(o,function(t,r){var i=n.inArray(r,e.items);if(i<0)return!0;u.push(i),a.push(e.items[i])}),e._selectedItemsToInputVal(a),u.length>=0&&(i.selectedIndex=u))},superPanelOptions:{resized:function(t){var n=e.menu,r=n.element;i.dropdownWidth=r.outerWidth(),i.dropdownHeight=r.outerHeight(),e._positionList(),e.menu.refreshSuperPanel()}}},o=n.extend(!0,o,i.listOptions),f=i.ensureDropDownOnBody?n("body"):e._comboElement,e.menu=r.appendTo(f,t).wijlist(o).css({zIndex:a+1,top:0,left:0}).hide().data("wijmo-wijlist"),e._createDropDownList(),e._menuUL=e.menu.ul},r.prototype._setInputText=function(e,t){var n=this,r=n.options.text;n._input.val(e),n.options.text=e,r!==e&&!t&&n._trigger("textChanged",null,{oldText:r,newText:e})},r.prototype._triggerSelectedIndexChanged=function(e,t,r,i){var s=this.options,o;this._select!==undefined&&(this._select[0].selectedIndex=s.selectedIndex,this._select.trigger("change")),s.selectionMode==="single"?this._trigger("selectedIndexChanged",null,{oldItem:e,selectedItem:t,newIndex:i,oldIndex:r}):(o=n.inArray(t,this.items),this._trigger("selectedIndexChanged",null,{selectedItem:t,selectedIndex:o,selectedItems:this.selectedItems}))},r.prototype._triggerSelectedIndexChanging=function(e,t,r,i){var s=this.options,o,u,a=!0;return s.selectionMode==="single"?(u={oldItem:e,selectedItem:t,newIndex:i,oldIndex:r},a=this._trigger("selectedIndexChanging",null,u)):(o=n.inArray(t,this.items),u={selectedItem:t,selectedIndex:o,selectedItems:this.selectedItems},a=this._trigger("selectedIndexChanging",null,u)),a||(t.selected=!1,t.element&&t.element.removeClass("wijmo-wijcombobox-selecteditem")),!a},r.prototype._createDropDownList=function(e){var t=this,r,i=t.options,s=e;s||(s=t.innerData),s===null?r=null:r=n.isArray(s)?s:s.items,t._comboDiv?!t.listHasCreated&&r&&r.length>0&&(t.menu.setTemplateItems(i.data),n.isArray(t.innerData)?t.innerData=t.menu.items:t.innerData.items=t.menu.items,t.items=t.menu.items,t.menu.renderList(),t.listHasCreated=!0):!t.listHasCreated&&r&&r.length>0&&(t.menu.setItems(r),n.isArray(t.innerData)?t.innerData=t.menu.items:t.innerData.items=t.menu.items,t.items=t.menu.items,t.menu.renderList(),t.listHasCreated=!0)},r.prototype._getSelectedItemsText=function(e){var t="",r,i;return r=this,i=r.options.multipleSelectionSeparator,r.selectedItems=e,n.each(e,function(e,n){n&&(t+=n.label+i)}),t.length>0&&(t=t.substr(0,t.lastIndexOf(i))),t},r.prototype._selectedItemsToInputVal=function(e){var t=this;t._setInputText(t._getSelectedItemsText(e))},r.prototype._createDOMElements=function(){var e=this,t,r=this.options.wijCSS,i,s,o;o=n("<div class='"+r.comboboxWrapperCss+" "+r.stateDefault+" "+r.cornerAll+"'>"+"</div>"),i=e.element,i.is("select")?(t=n("<div role='combobox' class='"+r.comboboxCss+" "+r.widget+" "+r.helperClearFix+"'>"+"</div>"),t.append(o),e._comboElement=t,e._select=i,i.addClass(r.widget),s=e._input=n("<input role='textbox' aria-autocomplete='list' aria-haspopup='true' />").insertAfter(i),e.options.data||(e.options.data=e._convertSelectOptions(),e._initInnerData())):i.is("div")&&n(i.children()[0]).is("input[type='text']")&&n(i.children()[1]).is("div")?(e._comboElement=e._comboDiv=t=i,e._oriList=n(i.children()[1]),s=e._input=n(i.children()[0]),o.prependTo(t).append(s),i.addClass(r.comboboxCss+" "+r.widget+" "+r.helperClearFix),i.attr("role","combobox")):(t=n("<div role='combobox' class='"+r.comboboxCss+" "+r.widget+" "+r.helperClearFix+"'>"+"</div>"),t.append(o),e._comboElement=t,s=e._input=i),e._comboDiv||(t.insertBefore(s),e.element.is(":visible")&&s.width(s.width()),t.children("."+r.comboboxWrapperCss).append(s)),i.attr("title")&&e._comboElement.attr("title",i.attr("title")),s.attr({autocomplete:"off",role:"textbox","aria-wijcombobox":"list","aria-haspopup":"true"}).addClass(r.comoboboxInputCss),e._oldWidth=i.css("width"),e.options.isEditable===!1&&(s.attr("readonly","readonly"),o.bind("click",function(){if(e.options.disabledState===!0||e.options.disabled)return;e._triggerClick()}));if(e.options.disabledState===!0||e.options.disabled===!0)e._comboElement.addClass("wijmo-wijcombobox-disabled "+r.stateDisabled),s.attr("disabled","disabled");t.bind("mouseenter.wijcombobox",function(){if(e.options.disabledState===!0||e.options.disabled)return;e._addInputFocus(!0,r.stateHover)}).bind("mouseleave.wijcombobox",function(){e._addInputFocus(!1,r.stateHover)})},r.prototype._convertSelectOptions=function(){var e=[],t,r;return t=this,r=t._select.get(0).options,n.each(r,function(t,n){e.push({label:n.text,value:n.value})}),t.options.selectedIndex===-1&&t.options.selectedValue===null&&t.options.text===null&&(t.options.selectedIndex=t._select[0].selectedIndex),e},r.prototype.getComboElement=function(){return this._comboElement},r.prototype._showTrigger=function(){var e=this,t,r,i,s,o=this.options.wijCSS,u,a=0,f,l,c,h,p,d,v,m="<label class='wijmo-wijcombobox-label "+o.content+"'></label>",g="<div class='"+o.comboboxTriggerCss+" "+o.stateDefault+" "+o.cornerRight+"'>"+"<span class='"+o.icon+" "+o.iconArrowDown+"'></span>"+"</div>";t=e.options,r=e._input,i=r.parent(),s=e._comboElement,f=e._triggerArrow,l=e._label,e._select!==undefined&&(n.browser.msie?(u=e._select.clone(),e._select.after(u),a=u.width(),u.remove()):a=e._select.width(),s.css("width",""),r.width(a+(t.dropdownHeight<e.menu.element.height()?t.selectElementWidthFix:0)),e._select.hide()),r.css("margin-left",""),r.css("margin-right",""),s.width(i[0].offsetWidth),t.labelText!==null?(l=e._label=n(m),i.append(l.html(t.labelText))):l!==undefined&&(l.remove(),e._label=undefined),t.showTrigger?(r.removeClass(o.cornerAll),f===undefined&&(f=e._triggerArrow=n(g),s.append(f),f.bind("mouseover.triggerevent",e,function(e){if(t.disabledState===!0||t.disabled)return;var r=n(e.currentTarget);r.addClass(o.stateHover)}).bind("mousedown.triggerevent",e,function(e){if(t.disabledState===!0||t.disabled)return;var r=n(e.currentTarget);r.addClass(o.stateActive)}).bind("mouseup.triggerevent",e,function(e){var t=n(e.currentTarget);t.removeClass(o.stateActive)}).bind("click.triggerevent",e,function(){if(t.disabledState===!0||t.disabled)return;e._triggerClick()})),t.triggerPosition==="right"?(f.css({left:"",right:"0px"}),f.removeClass(o.cornerLeft),f.addClass(o.cornerRight)):(f.css({right:"",left:"0px"}),f.removeClass(o.cornerRight),f.addClass(o.cornerLeft)),f.setOutHeight(s.innerHeight()),c=f.find("span"),c.css("margin-left",(f.innerWidth()-c[0].offsetWidth)/2),c.css("margin-top",(f.innerHeight()-c[0].offsetHeight)/2)):(f!==undefined&&(f.unbind(".triggerevent"),f.remove(),e._triggerArrow=undefined),r.removeClass(o.cornerLeft),r.removeClass(o.cornerRight),r.addClass(o.cornerAll)),h=p=d=0,l!==undefined&&(p+=l.outerWidth(!0)),v=t.triggerPosition==="left"?i.leftBorderWidth():i.rightBorderWidth(),f!==undefined&&(d=f.outerWidth(!0)-v),h=p+d,r.setOutWidth(i.width()-h),h=h===0?"":h,t.triggerPosition==="right"?(r.css("margin-left",""),r.css("margin-right",h),l!==undefined&&(l.css("left",""),l.css("right",d))):(r.css("margin-right",""),r.css("margin-left",h),l!==undefined&&(l.css("right",""),l.css("left",d)))},r.prototype._triggerClick=function(e){var t=this,n="";window.clearTimeout(t.closing),t.menu.element.is(":visible")?t.close():(t._usingRemoteData()&&(n=t._input.val()),t.search(n,e))},r.prototype.destroy=function(){var e=this,t=this.options.wijCSS,r=e.element;e.options.isEditable===!1&&r.removeAttr("readonly"),e._input&&e._input.unbind(".wijcombobox"),e._comboElement&&e._comboElement.unbind(".wijcombobox"),e._triggerArrow&&e._triggerArrow.unbind(".triggerevent"),e._select!==undefined?(e._select.removeClass(t.widget),e._select.show(),e._input.remove()):e._comboDiv?(e._comboDiv.removeClass(t.comboboxCss+" "+t.widget+" "+t.helperClearFix),e._comboDiv.removeAttr("role"),e._input.insertBefore(e._comboDiv),e._comboDiv.children("."+t.comboboxWrapperCss).remove()):(r.css("width",e._oldWidth),r.removeClass(t.comoboboxInputCss),r.removeAttr("autocomplete").removeAttr("role").removeAttr("aria-wijcombobox").removeAttr("aria-haspopup"),r.insertBefore(e._comboElement),r.css("padding","")),e._comboElement.remove(),e.menu.destroy(),e.menu.element.remove(),n.wijmo.widget.prototype.destroy.call(e)},r.prototype._setOption=function(e,t){var r=this,i,s,o,u,a,f=this.options.wijCSS,l=r._label,c,h,p,d,v=null,m=0,g="<label class='wijmo-wijcombobox-label "+f.content+"'></label>",y=r.options;i=r._comboElement,s=r.element,u=s.parent(),h=y.selectedIndex,d=y.disabled,r._triggerArrow&&(m=r._triggerArrow.outerWidth()),n.wijmo.widget.prototype._setOption.apply(r,arguments);if(e==="disabled"){if(d===t)return;t?(i.addClass("wijmo-wijcombobox-disabled "+f.stateDisabled),r._input.attr("disabled","disabled"),r._comboDiv&&r._input.addClass("wijmo-wijcombobox-disabled "+f.stateDisabled).attr("disabled","disabled"),r._triggerArrow&&r._triggerArrow.unbind("click.triggerevent"),r.close()):(i.removeClass("wijmo-wijcombobox-disabled "+f.stateDisabled),r._input.removeAttr("disabled"),r._comboDiv&&r._input.removeClass("wijmo-wijcombobox-disabled "+f.stateDisabled).removeAttr("disabled"),r._triggerArrow&&r._triggerArrow.bind("click.triggerevent",r,function(){if(y.disabledState===!0)return;r._triggerClick()}))}else if(e==="labelText")y.labelText!==null?(l=r._label=n(g),r._input.parent().append(l.html(y.labelText)),r._triggerArrow!==undefined&&(c=r._triggerArrow[0].offsetWidth),y.triggerPosition==="right"?l!==undefined&&(l.css("left",""),l.css("right",c)):l!==undefined&&(l.css("right",""),l.css("left",c)),r.repaint()):l!==undefined&&(l.remove(),r._label=undefined);else if(e==="showTrigger")r._showTrigger(),!y.showTrigger&&r.element.is("select")&&s.width(s.width()+m);else if(e==="triggerPosition")s.width(s.width()+m),r._showTrigger();else if(e==="selectionMode")r.menu._setOption("selectionMode",t);else if(e==="isEditable")t?(r._input.removeAttr("readonly"),n("."+f.comboboxWrapperCss,r._comboElement[0]).bind("click",function(){r._triggerClick()})):(r._input.attr("readonly","readonly"),n("."+f.comboboxWrapperCss,r._comboElement[0]).unbind("click"));else if(e==="data"||e==="dataSource"){r._initInnerData(),r._setSelectedIndex(y.selectedIndex);if(n.isArray(r.innerData))r.listHasCreated=!1,r._createDropDownList();else try{r.innerData.loaded=function(e,t){e===null?r.items=null:r.items=n.isArray(e)?e:e.items,r.listHasCreated=!1,r._createDropDownList()},r.innerData.load(null)}catch(b){}y.selectedIndex!==-1&&(v=o?o[h]:null,o=r.innerData,r._trigger("changed",null,{oldItem:v,selectedItem:r.selectedItem,newIndex:y.selectedIndex,oldIndex:h}),r._triggerSelectedIndexChanged(v,r.selectedItem,h,y.selectedIndex)),r._keypress=!1}else if(e==="selectedIndex"){if(t===h)return;r.innerData===null?o=null:o=n.isArray(r.innerData)?r.innerData:r.innerData.items;if(y.selectionMode==="single"){v=o?o[h]:null;if(t>-1){o&&o[t]!==null&&(p=o[t]),a=r._triggerSelectedIndexChanging(v,p,h,t);if(a){y.selectedIndex=h;return}h!==null&&h!==-1&&h!==undefined&&v&&(v.selected=!1,this.menu.unselectItems(h),v.element&&v.element.removeClass("wijmo-wijcombobox-selecteditem")),o&&o[t]!==null&&(r.selectedItem=o[t],r.selectedItem&&(r.selectedItem.selected=!0,r._setInputText(r.selectedItem.label),y.selectedValue=r.selectedItem.value,y.inputTextInDropDownList=!0))}else if(t<=-1||!t){a=r._triggerSelectedIndexChanging(v,null,h,t);if(a){y.selectedIndex=h;return}y.inputTextInDropDownList=!1,r._clearSelection()}r._trigger("changed",null,{oldItem:v,selectedItem:r.selectedItem,newIndex:y.selectedIndex,oldIndex:h}),r._triggerSelectedIndexChanged(v,r.selectedItem,h,y.selectedIndex)}else n.isArray(h)||(h=[h]),n.each(h,function(e,t){r.menu.items&&r.menu.items[t]&&(r.menu.items[t].selected=!1)}),this.menu.unselectItems(h),r.selectedItems=[],r.selectedItem=null,n.isArray(t)||(t=[t],y[e]=t),r._setSelectedIndex(t),n.each(t,function(e,t){r.menu.items&&r.menu.items[t]&&(r.menu.items[t].selected=!0)}),r._trigger("changed",null,{oldItem:null,selectedItem:r.selectedItems,newIndex:y.selectedIndex,oldIndex:null})}else if(e==="selectedValue")o=r.items,o||(o=r.innerData),y.selectionMode==="single"?v=o?o[h]:null:h=null,t?(r.selectedItem&&r.selectedItem.selected!==undefined&&(r.selectedItem.selected=!1),o&&(this.options.selectedIndex>-1&&o.length>this.options.selectedIndex&&o[this.options.selectedIndex]&&(o[this.options.selectedIndex].selected=!1,this.menu.deactivate(),this.menu.unselectItems(this.options.selectedIndex),r.menu.items[this.options.selectedIndex].selected=!1),n.each(o,function(e,n){if(o[e].value===t)return r.selectedItem=o[e],r.selectedItem.selected=!0,r.menu.items[e].selected=!0,r._setInputText(r.selectedItem.label),y.selectionMode==="single"?y.selectedIndex=e:y.selectedIndex=[e],y.inputTextInDropDownList=!0,!1}))):y.selectionMode==="single"&&(y.inputTextInDropDownList=!1,r._clearSelection()),r._trigger("changed",null,{oldItem:v,selectedItem:y.selectionMode==="single"?r.selectedItem:r.selectedItems,newIndex:y.selectedIndex,oldIndex:h});else if(e==="text"){if(y.forceSelectionText&&r._checkTextInItems(t)===-1)return;r._setInputText(t)}else e==="selectElementWidthFix"&&r._showTrigger()},r.prototype._setSelectedIndex=function(e){var t=this,r=t.options,i=[],s=t.innerData;if(e===null||e===undefined)return;e===-1?(t.selectedItem=null,r.selectedIndex=-1,r.selectedValue=null,r.text?t._input.val(r.text):t._input.val("")):n.isArray(e)?(t.selectedItems=[],n.each(e,function(e,t){s&&s[t]!==null&&s[t]!==undefined&&(s[t].selected=!0,i.push(s[t]))}),t.selectedItems=i,t._selectedItemsToInputVal(i)):s&&s[e]!==null&&s[e]!==undefined?(s[e].selected=!0,t._input.val(s[e].label),t.selectedItem=s[e]):s&&n.isArray(s)&&e>s.length-1&&(r.selectedIndex=-1,t._input.val("")),r.text=t._input.val()},r.prototype.search=function(e,t){var r=this,i,s,o,u;i=r.options,s=r.innerData,window.clearTimeout(r.closing),o={value:e,e:t,self:r};if(s!==null||r._comboDiv){u=r._isBind();if(t!=="checkindex"&&r._trigger("search",t,{datasrc:s,term:o})===!1)return;if(n.isArray(s)||u||r._comboDiv||!r._usingRemoteData()&&s.items&&n.isArray(s.items)&&s.items.length>0)r._hideShowArrow(!1),r._onListLoaded(s,o);else{if(!u&&n.isArray(i.dataSource))return;if(r._usingRemoteData()&&t!==undefined&&e.length<i.minLength)return;r._hideShowArrow(!1),s.loaded=function(e,t){r.listHasCreated=!1,r._createDropDownList(e),r._onListLoaded(e,t),r.originalDataSourceLoaded&&r.originalDataSourceLoaded(e,t)},s.load(o)}}},r.prototype.getSelectedItems=function(){var e=this.options;return e.selectionMode==="single"?this.selectedItem:this.selectedItems},r.prototype._isBind=function(){var e=this.options,t=e.data;return t!==null&&t.label&&t.label.bind?!0:!1},r.prototype._getMappingItems=function(){var e=this.options,t=e.dataSource,r=e.data,i,s,o;return!t||!r?null:!r.label||!r.label.bind||!r.value||!r.value.bind?null:(s=r.label.bind,o=r.value.bind,t&&t.length!==0?(i=[],n.each(t,function(e,t){i.push({label:t[s],value:t[o]})}),i):null)},r.prototype._clearSelection=function(){var e=this,t=e.options;t.selectionMode==="single"?e.selectedItem!==null&&(e.selectedItem.selected=!1,e.selectedItem=null):e.selectedItems&&(n.each(e.selectedItems,function(e,t){t&&t.selected&&(t.selected=!1)}),e.selectedItem=null,e.selectedItems=[]),t.selectedValue=null,e._setInputText("")},r.prototype._usingRemoteData=function(){var e=this.options.data,t=!1;return!n.isArray(e)&&e!==null&&e.proxy&&(t=!0),t},r.prototype._hideShowArrow=function(e){var t=this,n,r;n=t.element,r=t._triggerArrow,r!==undefined&&r[e?"show":"hide"](),n[e?"removeClass":"addClass"]("wijmo-wijcombobox-loading")},r.prototype._onListLoaded=function(e,t){var r=t.self,i,s,o=this.options.wijCSS,u,a,f,l;i=r._input,s=r.options,u=t.value,e?a=n.isArray(e)?e:e.items:a=null,r.items=a;if(t.e==="checkindex"){f=s.selectedIndex,s.selectionMode==="multiple"&&n.isArray(f)?(r.selectedItems=[],n.each(f,function(e,t){var n=a[t];n.selected=!0,r.selectedItems.push(n)}),r._selectedItemsToInputVal(r.selectedItems)):(a[f].selected=!0,r.selectedItem=a[f],i.val(r.selectedItem.label)),r._hideShowArrow(!0);return}i.val()===""&&(!this.selectedItem||this.selectedItem.label!=="")&&r.menu.deactivate(),!r._usingRemoteData()&&a?l=a:(r._topHit=null,l=a),l&&l.length>0||r._comboDiv?r._openlist(l,t,u)&&r._addInputFocus(!0,o.stateFocus):r.close(null,!0),r._hideShowArrow(!0)},r.prototype.close=function(e,t){var r=this,i,s=this.options.wijCSS,o,u;i=r.menu,r._dropDownHeight=i.element.outerHeight(),r._dropDownWidth=i.element.outerWidth(),window.clearTimeout(r.closing),i.element.is(":visible")&&!i.element.is(":animated")&&!i.element.parent().is(":animated")&&(r._trigger("close",e),i.deactivate(),o=r.options.hidingAnimation,o&&(o.effect==="size"||o.animated==="size")&&(o.options=n.extend({to:{width:0,height:0}},o.options)),u=i.element.attr("style"),t!==!0&&o?i.element.hide(o.effect||o.animated,o.options,o.speed||o.duration,function(){i.element.removeAttr("style").attr("style",u).hide(),o.callback&&o.callback.apply(this,arguments)}):i.element.hide(),r._addInputFocus(!1,s.stateFocus),n(document).unbind("mouseup",r.closeOnClick),r._inputBlurCausedByListItemClick=!1)},r.prototype._change=function(){var e=this,t=e.options,r=t.forceSelectionText,i=t.selectionMode,s=e._input,o=s.val(),u=e.selectedItem,a=e.selectedItems,f,l=e.innerData,c=-1;f=t.selectedIndex||t.selectedIndex>-1?t.selectedIndex:-1;if(r)i==="single"&&(u!==null&&u!==undefined?u.label!==o&&e._setInputText(u.label):e._setInputText(""));else if(i==="single"){var h=!1;u!==null&&u!==undefined&&(h=u.label?u.label.toString()!==o:""!==o),!u&&o!==""||h?(e.selectedItem!==null&&(e.selectedItem.selected=!1,e.menu.unselectItems(t.selectedIndex)),c=e._checkTextInItems(o),c===-1?(e.selectedItem=null,t.selectedIndex=-1,t.selectedValue=null,t.inputTextInDropDownList=!1):l&&(l=n.isArray(l)?l:l.items,e.selectedItem=l[c],t.selectedIndex=c,t.selectedValue=e.selectedItem.value,t.inputTextInDropDownList=!0),e._setInputText(e._input.val()),e._trigger("changed",null,{oldItem:u,selectedItem:e.selectedItem,newIndex:t.selectedIndex,oldIndex:f}),f!==c&&e._triggerSelectedIndexChanged(u,e.selectedItem,f,t.selectedIndex)):e._setInputText(o)}if(i==="multiple"){if(!e.selectedItems||e.selectedItems.length===0)a=[u];e._selectedItemsToInputVal(a)}},r.prototype._checkTextInItems=function(e){var t=this.items,r=-1;return e&&!!t&&!!t.length&&n.each(t,function(t,n){if(n&&n.label&&n.label.toString()===e)return r=t,!1}),r},r.prototype._openlist=function(t,r,i){var s=r.self,o=r.e,u,a,f,l,c,h=2,p=0,d,v,m,g,y,b,w=n.trim(s._input.val()).length,E=e.getKeyCodeEnum(),S,x=!1,T;u=s._keypress=!!o,l=s.options,f=s.menu.element,n.ui?f.zIndex(s.element.zIndex()+100):(S=parseInt(s.element.css("zIndex"),10),isNaN(S)&&(S=0),f.css("zIndex",S+100)),s.listHasCreated||s._createDropDownList(),s.innerData&&(n.isArray(s.innerData)?T=s.innerData:T=s.innerData.items);if(!T||T.length===0)return!1;if(!s._usingRemoteData()&&i!==null&&i!==undefined){x=s._keypress&&l.isEditable&&l.columns.length===0&&l.highlightMatching&&w>0,o&&o.keyCode===E.DOWN&&i.length===0&&w>0?s._topHit=s.menu.filterItems(s._input.val(),!1,x):s._topHit=s.menu.filterItems(i,l.autoFilter,x);if(s._topHit===null&&s.innerData&&n("li[wijhidden]",s.menu.element).length===s.innerData.length)return s.close(null,!0),!1}return s.menu.element.show(),l.dropdownWidth==="auto"?a=s._comboElement.outerWidth():a=l.dropdownWidth,c=f.css("padding"),f.css("padding","0px"),f.setOutWidth(a),f.css("padding",c),d=l.dropdownHeight,f.children(".wijmo-wijsuperpanel-header")&&(p=f.children(".wijmo-wijsuperpanel-header").outerHeight()||0),m=Math.min(s._menuUL.outerHeight()+h+p,d),f.setOutHeight(m),s.menu.refreshSuperPanel(),s._positionList(),!u&&s.selectedItem!==undefined&&s.menu.activate(null,s.selectedItem,!0),u&&o.keyCode!==E.BACKSPACE?l.isEditable?s._runAutoComplete():s.menu.activate(null,s._topHit,!0):(g=s.options.showingAnimation,l.showingAnimation!==null&&(o===undefined||o.keyCode!==E.BACKSPACE)&&(s.menu.element.hide(),b={from:{width:0,height:0},to:{width:s._dropDownWidth||f.outerWidth(),height:s._dropDownHeight||f.outerHeight()}},g&&(g.effect==="size"||g.animated==="size")&&(g.options=n.extend(b,g.options)),y=f.attr("style"),f.show(g.effect||g.animated,g.options,g.speed||g.duration,function(){f.removeAttr("style").attr("style",y).show(),g.callback&&g.callback.apply(this,arguments),n.browser.msie&&f.css("filter","")}))),s.hasOwnProperty("closeOnClick")||(v=s.closeOnClick,s.closeOnClick=function(e){return v(e)}),s._trigger("open"),l.ensureDropDownOnBody&&s.menu.element.bind("mouseup.wijcombobox",s,function(e){s.closeOnClick(e),e.stopPropagation()}),n(document).bind("mouseup",s,s.closeOnClick),!0},r.prototype.closeOnClick=function(e){var t=e.data,r=t.options.wijCSS,i,s=e.target;!n.contains(t._comboElement[0],s)&&!n.contains(t.menu.element[0],s)&&(n.support.isTouchEnabled&&n.support.isTouchEnabled()?(i=t.menu.element.offset(),(e.pageX<i.left||e.pageX>i.left+t.menu.element.width()||e.pageY<i.top||e.pageY>i.top+t.menu.element.height())&&t.close()):t.close(),n("."+r.comboboxWrapperCss,t._comboElement[0]).removeClass(r.stateHover).removeClass(r.stateFocus),n("."+r.comboboxTriggerCss,t._comboElement[0]).removeClass(r.stateHover).removeClass(r.stateFocus)),t.options.ensureDropDownOnBody&&t.menu.element.unbind("mouseup.wijcombobox")},r.prototype._positionList=function(){var e=this,t,r;t=e.options.dropDownListPosition,r={my:"left top",at:"left bottom",of:e._comboElement,collision:"none"},r=n.extend(r,t),e.menu.element.position(r)},r.prototype._runAutoComplete=function(){var e=this,t,n,r,i,s,o;t=e._input,n=e._topHit;if(!e.options.autoComplete||n===null||n===undefined)return;e.menu.activate(null,n,!0),r=t.val(),i=n.label,t.val(i),s=r.length,o=i.length,e._selectText(s,o,t)},r.prototype._selectText=function(e,t,n){var r=n.val(),i=n.get(0),s;r.length>0&&(i.setSelectionRange!==undefined?i.setSelectionRange(e,t):i.createTextRange!==undefined&&(s=i.createTextRange(),s.moveStart("character",e),s.moveEnd("character",t-r.length),s.select()))},r.prototype._move=function(e,t){if(!this.menu.element.is(":visible")){this.search("",t);return}if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e))return;this.menu[e](t)},r.prototype._escapeRegex=function(e){return e===undefined?e:e.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},r.prototype._filter=function(e,t){var r=this._escapeRegex(t),i,s=null;return e?(i=new RegExp(r,"i"),n.each(e,function(e,t){if(r===undefined||r.length===0){t.match=!0;return}var n=i.exec(t.label);n===null?t.match=!1:(s===null&&n.index===0&&(s=t),t.match=n.index>=0)}),this._topHit=s,e):null},r}(e.wijmoWidget);t.wijcombobox=i;var s=function(){function e(){this.initSelector=":jqmData(role='wijcombobox')",this.wijCSS={comboboxCss:"wijmo-wijcombobox",comboboxWrapperCss:"wijmo-wijcombobox-wrapper",comoboboxInputCss:"wijmo-wijcombobox-input",comboboxListCss:"wijmo-wijcombobox-list",comboboxTriggerCss:"wijmo-wijcombobox-trigger"},this.dataSource=null,this.data=null,this.labelText=null,this.minLength=4,this.delay=300,this.showingAnimation=null,this.hidingAnimation=null,this.showTrigger=!0,this.triggerPosition="right",this.dropdownHeight=300,this.dropdownWidth="auto",this.selectOnItemFocus=!1,this.autoFilter=!0,this.autoComplete=!0,this.highlightMatching=!0,this.dropDownListPosition={},this.columns=[],this.selectionMode="single",this.multipleSelectionSeparator=",",this.forceSelectionText=!1,this.select=null,this.isEditable=!0,this.selectedIndex=-1,this.selectedValue=null,this.inputTextInDropDownList=!1,this.text=null,this.ensureDropDownOnBody=!0,this.open=null,this.close=null,this.selectElementWidthFix=6,this.search=null,this.changed=null,this.textChanged=null,this.selectedIndexChanged=null,this.selectedIndexChanging=null,this.listOptions=null}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijcombobox",i.prototype)})(e.combobox||(e.combobox={}));var t=e.combobox})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(e){var t=function(){function e(){this.OtherChar=0,this.Control=1,this.Numeric=2,this.MathSymbol=3,this.Symbol=4,this.Punctuation=5,this.Space=6,this.UpperCase=7,this.LowerCase=8,this.Katakana=9,this.Hiragana=10,this.FarEastPunctation=11,this.Hangul=12,this.FullWidth=32768}return e}();e.CharType=t;var n=function(){function e(){this.MinValue="\0",this.MaxValue="\uffff",this.ANSISTART=0,this.ANSIEND=255,this.BOTHWIDTHSTART=65280,this.BOTHWIDTHEND=65519,this.FULLALPHASTART=65281,this.FULLUPPERSTART=65313,this.FULLUPPEREND=65338,this.FULLALPHAEND=65374,this.CJKHALFSYMBOLSTART=65377,this.CJKHALFSYMBOLEND=65380,this.KANAHALFSTART=65381,this.KANAHALFEND=65439,this.HANGULHALFSTART=65440,this.HANGULHALFEND=65500,this.FULLSYMBOLSTART=65504,this.FULLSYMBOLEND=65510,this.HALFPUNCTSTART=65512,this.HALFPUNCTEND=65518,this.KATAKANA_VOICED="\uff9e",this.KATAKANA_SEMIVOICED="\uff9f",this.Tab="	",this.Space=" ",this._charstarts=["\0","\u0080","\u0100","\u0180","\u0250","\u02b0","\u0300","\u0370","\u0400","\u0530","\u0590","\u0600","\u0700","\u0780","\u0900","\u0980","\u0a00","\u0a80","\u0b00","\u0b80","\u0c00","\u0c80","\u0d00","\u0d80","\u0e00","\u0e80","\u0f00","\u1000","\u10a0","\u1100","\u1200","\u13a0","\u1400","\u1680","\u16a0","\u1780","\u1800","\u1e00","\u1f00","\u2000","\u2070","\u20a0","\u20d0","\u2100","\u2150","\u2190","\u2200","\u2300","\u2400","\u2440","\u2460","\u2500","\u2580","\u25a0","\u2600","\u2700","\u2800","\u2e80","\u2f00","\u2ff0","\u3000","\u3040","\u30a0","\u3100","\u3130","\u3190","\u31a0","\u3200","\u3300","\u3400","\u4e00","\ua000","\ua490","\uac00","\uf900","\ufb00","\ufb50","\ufe20","\ufe30","\ufe50","\ufe70","\uff00","\ufff0"],this.Blocks=["BASIC_LATIN","LATIN_1_SUPPLEMENT","LATIN_EXTENDED_A","LATIN_EXTENDED_B","IPA_EXTENSIONS","SPACING_MODIFIER_LETTERS","COMBINING_DIACRITICAL_MARKS","GREEK","CYRILLIC","ARMENIAN","HEBREW","ARABIC","SYRIAC","THAANA","DEVANAGARI","BENGALI","GURMUKHI","GUJARATI","ORIYA","TAMIL","TELUGU","KANNADA","MALAYALAM","SINHALA","THAI","LAO","TIBETAN","MYANMAR","GEORGIAN","HANGUL_JAMO","ETHIOPIC","CHEROKEE","UNIFIED_CANADIAN_ABORIGINAL_SYLLABIC","OGHAM","RUNIC","KUMER","MONGOLIAN","LATIN_EXTENDED_ADDITIONAL","GREEK_EXTENDED","GENERAL_PUNCTUATION","SUPERSCRIPTS_AND_SUBSCRIPTS","CURRENCY_SYMBOLS","COMBINING_MARKS_FOR_SYMBOLS","LETTERLIKE_SYMBOLS","NUMBER_FORMS","ARROWS","MATHEMATICAL_OPERATORS","MISCELLANEOUS_TECHNICAL","CONTROL_PICTURES","OPTICAL_CHARACTER_RECOGNITION","ENCLOSED_ALPHANUMERICS","BOX_DRAWING","BLOCK_ELEMENTS","GEOMETRIC_SHAPES","MISCELLANEOUS_SYMBOLS","DINGBATS","BRAILLE_PATTERNS","CJK_RADICALS_SUPPLEMENT","KANGXI_RADICALS","IDEOGRAPHIC_DESCRIPTION_CHARACTERS","CJK_SYMBOLS_AND_PUNCTUATION","HIRAGANA","KATAKANA","BOPOMOFO","HANGUL_COMPATIBILITY_JAMO","KANBUN","BOPOMOFO_EXTENDED","ENCLOSED_CJK_LETTERS_AND_MONTHS","CJK_COMPATIBILITY","CJK_UNIFIED_IDEOGRAPHS_EXTENSION","CJK_UNIFIED_IDEOGRAPHS","YI_SYLLABLES","YI_RADICALS","HANGUL_SYLLABLES","CJK_COMPATIBILITY_IDEOGRAPHS","ALPHABETIC_PRESENTATION_FORMS","ARABIC_PRESENTATION_FORMS_A","COMBINING_HALF_MARKS","CJK_COMPATIBILITY_FORMS","SMALL_FORM_VARIANTS","ARABIC_PRESENTATION_FORMS_B","HALFWIDTH_AND_FULLWIDTH_FORMS","SPECIALS"],this._fullhalfblocks=["\uff01","\uff10","\uff1a","\uff21","\uff3b","\uff41","\uff5b","\uff61","\uff65","\uffa0","\uffe0","\uffe8"],this._halfkana=["\u30fb","\u30f2","\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30fc","\u30a2","\u30a4","\u30a6","\u30a8","\u30aa","\u30ab","\u30ad","\u30af","\u30b1","\u30b3","\u30b5","\u30b7","\u30b9","\u30bb","\u30bd","\u30bf","\u30c1","\u30c4","\u30c6","\u30c8","\u30ca","\u30cb","\u30cc","\u30cd","\u30ce","\u30cf","\u30d2","\u30d5","\u30d8","\u30db","\u30de","\u30df","\u30e0","\u30e1","\u30e2","\u30e4","\u30e6","\u30e8","\u30e9","\u30ea","\u30eb","\u30ec","\u30ed","\u30ef","\u30f3","\u3099","\u309a"],this._fullkana=["\uff67","\uff71","\uff68","\uff72","\uff69","\uff73","\uff6a","\uff74","\uff6b","\uff75","\uff76","\uff76","\uff77","\uff77","\uff78","\uff78","\uff79","\uff79","\uff7a","\uff7a","\uff7b","\uff7b","\uff7c","\uff7c","\uff7d","\uff7d","\uff7e","\uff7e","\uff7f","\uff7f","\uff80","\uff80","\uff81","\uff81","\uff6f","\uff82","\uff82","\uff83","\uff83","\uff84","\uff84","\uff85","\uff86","\uff87","\uff88","\uff89","\uff8a","\uff8a","\uff8a","\uff8b","\uff8b","\uff8b","\uff8c","\uff8c","\uff8c","\uff8d","\uff8d","\uff8d","\uff8e","\uff8e","\uff8e","\uff8f","\uff90","\uff91","\uff92","\uff93","\uff6c","\uff94","\uff6d","\uff95","\uff6e","\uff96","\uff97","\uff98","\uff99","\uff9a","\uff9b","\uff9c","\uff9c","\uff68","\uff6a","\uff66","\uff9d","\uff73","\uff76","\uff79","\uff9c","\uff68","\uff6a","\uff66","\uff65","\uff70"],this._fullkanaSmall=["\uff67","\uff68","\uff69","\uff6a","\uff6b","\uff6c","\uff6d","\uff6e","\uff6f"],this._accentkana=[0,0,0,0,0,0,0,0,0,0,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,-1,1,0,-1,1,-1,1,-1,1,0,0,0,0,0,-3,1,2,-3,1,2,-3,1,2,-3,1,2,-3,1,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,1,1,1,0,0],this._feQuotes=["\u2018","\u2019","\u201c","\u201d"],this._jpnMixed=["\u30fc"],this._jpnSpecialFull=["\u3000","\u3001","\u3002","\u300c","\u300d","\u201c","\u201d","\u2018","\u2019","\u309b","\u309c","\uffe5"],this._jpnSpecialHalf=[" ","\uff64","\uff61","\uff62","\uff63",'"','"',"'","'","\uff9e","\uff9f","\u00a5"];var e=new t;this._mwtable=[e.Symbol|e.FullWidth,e.Numeric|e.FullWidth,e.Symbol|e.FullWidth,e.UpperCase|e.FullWidth,e.Symbol|e.FullWidth,e.LowerCase|e.FullWidth,e.Symbol|e.FullWidth,e.FarEastPunctation,e.Katakana,e.Hangul,e.Symbol|e.FullWidth,e.Symbol]}return e}();e.CharCategory=n;var r=function(){function e(){this.CharCategory=new n,this.Ctype=new t}return e.LowerKana="\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\uff67\uff68\uff69\uff6a\uff6b\uff6c\uff6d\uff6e\uff6f\u30f5\u30f6\u3095\u3096",e.UpperKana="\u3042\u3044\u3046\u3048\u304a\u3064\u3084\u3086\u3088\u308f\u30a2\u30a4\u30a6\u30a8\u30aa\u30c4\u30e4\u30e6\u30e8\u30ef\uff71\uff72\uff73\uff74\uff75\uff94\uff95\uff96\uff82\u30ab\u30b1\u304b\u3051",e.FullWidthSymbolArray=["\u3001","\u3002","\uff0c","\uff0e","\u30fb","\uff1a","\uff1b","\uff1f","\uff01","\u309b","\u309c","\u00b4","\uff40","\u00a8","\uff3e","\uffe3","\uff3f","\u30fd","\u30fe","\u309d","\u309e","\u3003","\u4edd","\u3005","\u3006","\u3007","\u30fc","\u2014","\u2010","\uff0f","\u301c","\u2016","\uff5c","\u2026","\u2025","\u2018","\u2019","\u201c","\u201d","\uff08","\uff09","\u3014","\u3015","\uff3b","\uff3d","\uff5b","\uff5d","\u3008","\u3009","\u300a","\u300b","\u300c","\u300d","\u300e","\u300f","\u3010","\u3011","\uff0b","\u2212","\u00b1","\u00d7","\u00f7","\uff1d","\u2260","\uff1c","\uff1e","\u2266","\u2267","\u221e","\u2234","\u2642","\u2640","\u00b0","\u2032","\u2033","\u2103","\uffe5","\uff04","\u00a2","\u00a3","\uff05","\uff03","\uff06","\uff0a","\uff20","\u00a7","\u2606","\u2605","\u25cb","\u25cf","\u25ce","\u25c7","\u25c6","\u25a1","\u25a0","\u25b3","\u25b2","\u25bd","\u25bc","\u203b","\u3012","\u2192","\u2190","\u2191","\u2193","\u3013","\uff07","\uff02","\uff0d","\u3033","\u3034","\u3035","\u303b","\u303c","\u30ff","\u309f","\u2208","\u220b","\u2286","\u2287","\u2282","\u2283","\u222a","\u2229","\u2284","\u2285","\u228a","\u228b","\u2209","\u2205","\u2305","\u2306","\u2227","\u2228","\u00ac","\u21d2","\u21d4","\u2200","\u2203","\u2295","\u2296","\u2297","\u2225","\u2226","\u2985","\u2986","\u3018","\u3019","\u3016","\u3017","\u2220","\u22a5","\u2312","\u2202","\u2207","\u2261","\u2252","\u226a","\u226b","\u221a","\u223d","\u221d","\u2235","\u222b","\u222c","\u2262","\u2243","\u2245","\u2248","\u2276","\u2277","\u2194","\u212b","\u2030","\u266f","\u266d","\u266a","\u2020","\u2021","\u00b6","\u266e","\u266b","\u266c","\u2669","\u25ef","\uff3c","\uff5e","\uffe0","\uffe1","\uffe2","\u2015"],e.HalfWidthSymbolArray=["\\","~","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","]","^","_","`","{","|","}","\uff61","\uff62","\uff63","\uff64","\uff65","\u00a1","\u00a4","\u00a5"],e.CharEx=new e,e.prototype.ToHalfKatakana=function(e){var t="";if(this.IsFullWidth(e)){if(this.IsKatakana(e)){var n=e,r=n.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(r<0||r>91)return n;n=this.CharCategory._fullkana[r];var i=this.CharCategory._accentkana[r];i>0&&(n+=String.fromCharCode(i==1?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0))),t=n}else if(this.IsHiragana(e)){var n=String.fromCharCode(e.charCodeAt(0)-this.CharCategory._charstarts[61].charCodeAt(0)+this.CharCategory._charstarts[62].charCodeAt(0)),r=n.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(r<0||r>91)return n;n=this.CharCategory._fullkana[r];var i=this.CharCategory._accentkana[r];i>0&&(n+=String.fromCharCode(i==1?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0))),t=n}}else this.IsKatakana(e)&&(t=e);return t},e.prototype.GetCharType=function(e){var t=this.Ctype.OtherChar,n=this.BelongTo(e);if(e==""||"\0"<=e&&e<=""||"\u0080"<=e&&e<="\u009f")return this.Ctype.Control;if("A"<=e&&e<="Z")return this.Ctype.UpperCase;if("a"<=e&&e<="z")return this.Ctype.LowerCase;if("0"<=e&&e<="9")return this.Ctype.Numeric;if(this.IsFullWidthSymbol(e)||this.IsHalfWidthSymbol(e))t=this.Ctype.Symbol;if(e.charCodeAt(0)==8216||e.charCodeAt(0)==8217||e.charCodeAt(0)==8220||e.charCodeAt(0)==8221)t=this.Ctype.Punctuation;e.charCodeAt(0)==12288&&(t=this.Ctype.Space);switch(this.CharCategory.Blocks[n]){case"HALFWIDTH_AND_FULLWIDTH_FORMS":return this.MultiWidthDetails(e);case"KATAKANA":return this.Ctype.Katakana|this.Ctype.FullWidth;case"HIRAGANA":return this.Ctype.Hiragana|this.Ctype.FullWidth}return this.IsFarEastBlock(n,e)&&(t|=this.Ctype.FullWidth),t},e.prototype.IsCharOfType=function(e,t){return this.GetCharType(e)==t},e.prototype.IsMultiWidth=function(e){var t=this.BelongTo(e),n=this.CharCategory.Blocks[t];return n=="KATAKANA"||n=="CJK_SYMBOLS_AND_PUNCTUATION"||n=="HALFWIDTH_AND_FULLWIDTH_FORMS"||n=="BASIC_LATIN"&&e>=" "},e.prototype.IsFullWidthSymbol=function(t){for(var n=0;n<e.FullWidthSymbolArray.length;n++)if(t===e.FullWidthSymbolArray[n])return!0;return!1},e.prototype.IsHalfWidthSymbol=function(t){for(var n=0;n<e.HalfWidthSymbolArray.length;n++)if(t===e.HalfWidthSymbolArray[n])return!0;return!1},e.prototype.IsFullWidth=function(e){if(this.IsFullWidthSymbol(e))return!0;if(this.IsHalfWidthSymbol(e))return!1;var t=this.BelongTo(e),n=this.IsFarEastBlock(t,e);return this.CharCategory.Blocks[t]=="HALFWIDTH_AND_FULLWIDTH_FORMS"&&(n=(this.MultiWidthDetails(e)&this.Ctype.FullWidth)==this.Ctype.FullWidth),n},e.prototype.IsSurrogatePair=function(e){return e.charCodeAt(0)>="\ud800".charCodeAt(0)&&e.charCodeAt(0)<="\udbff".charCodeAt(0)&&e.charCodeAt(1)>="\udc00".charCodeAt(0)&&e.charCodeAt(1)<="\udfff".charCodeAt(0)?!0:!1},e.prototype.IsSurrogate=function(e){return e!=null&&e.charCodeAt(0)>="\ud800".charCodeAt(0)&&e.charCodeAt(0)<="\udfff".charCodeAt(0)},e.prototype.IsOther=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.OtherChar},e.prototype.IsControl=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.Control},e.prototype.IsKatakana=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.Katakana},e.prototype.IsSmallHalfKatakana=function(e){var t=new Array("\u30a1","\u30a3","\u30a5","\u30a7","\u30a9","\u30e3","\u30e5","\u30e7","\u30c3","\u30ee"),n=e;e.charCodeAt(0)>this.CharCategory.KANAHALFSTART&&(n=this.CharCategory._halfkana[e.charCodeAt(0)-this.CharCategory.KANAHALFSTART]);for(var r=0;r<t.length;r++)if(n==t[r])return!0;return!1},e.prototype.IsHiragana=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.Hiragana||this.CharCategory._jpnMixed[0]==e},e.prototype.IsShiftJIS=function(e){return!1},e.prototype.IsJISX0208=function(e){return!1},e.prototype.IsDigit=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.Numeric},e.prototype.IsPunctuation=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.Punctuation},e.prototype.IsMathSymbol=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.MathSymbol},e.prototype.IsSymbol=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.Symbol},e.prototype.IsLower=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.LowerCase},e.prototype.IsUpper=function(e){return(this.GetCharType(e)&~this.Ctype.FullWidth)==this.Ctype.UpperCase},e.prototype.IsDigitOrSymbol=function(e){return this.IsDigit(e)||this.IsMathSymbol(e)},e.prototype.IsAlphabet=function(e){return this.IsUpper(e)||this.IsLower(e)},e.prototype.IsAlphaOrDigit=function(e){return this.IsUpper(e)||this.IsLower(e)||this.IsDigit(e)},e.prototype.IsUpperKana=function(e){return!this.IsLowerKana(e)},e.prototype.IsLowerKana=function(t){return e.LowerKana.search(t)!=-1},e.prototype.HasLowerKana=function(t){return e.UpperKana.search(t)!=-1||this.IsLowerKana(t)},e.prototype.ToUpperKana=function(t){var n=e.LowerKana.search(t);return n==-1?t:e.UpperKana.substr(n,1)},e.prototype.ToLowerKana=function(t){var n=e.UpperKana.search(t);return n>=e.UpperKana.length-4&&n<e.UpperKana.length?t:n==-1?t:e.LowerKana.substr(n,1)},e.prototype.ToLower=function(e){return this.IsUpper(e)?String.fromCharCode(e.charCodeAt(0)+32):e},e.prototype.ToUpper=function(e){return this.IsLower(e)?String.fromCharCode(e.charCodeAt(0)-32):e},e.prototype.IsSpace=function(e){return e==" "||e==="\u3000"},e.prototype.ToFullWidth=function(e){var t={text:"",processedAll:!1};t.text=e,t.processedAll=!1;if(e.length==0)return t;var n=e.substring(0,1);if(this.IsMultiWidth(n)){if(n<this.CharCategory._charstarts[1]){if(n==" ")return t.text="\u3000",t;var r="!";return t.text=String.fromCharCode(n.charCodeAt(0)-r.charCodeAt(0)+(this.CharCategory._charstarts[81].charCodeAt(0)+1)),t}if((this.MultiWidthDetails(n)&this.Ctype.Katakana)==this.Ctype.Katakana){if(n.charCodeAt(0)<this.CharCategory.KANAHALFSTART){var i=this.GetFullHalfWidthSpecialChar(n,!0);return t.text=i!==""?i:n,t}n=this.CharCategory._halfkana[n.charCodeAt(0)-this.CharCategory.KANAHALFSTART];if(e.length<2)return t.text=n,t;var s=e.charCodeAt(1)-(this.CharCategory.KATAKANA_VOICED.charCodeAt(0)-1);if(s==1||s==2){t.processedAll=!0;var o=this.CharCategory._accentkana[n.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1)];o!=0&&((Math.abs(o)&2)==s&&(n=String.fromCharCode(n.charCodeAt(0)+1)),n=String.fromCharCode(n.charCodeAt(0)+1))}s==1&&n=="\u30a6"&&(n="\u30f4")}}return t.text=n,t},e.prototype.ToHalfWidth=function(e){return this.ToHalfWidthEx(e)},e.prototype.ToHalfWidthEx=function(e){var t=this.GetCharType(e),n=this.IsMultiWidth(e);if((t&this.Ctype.FullWidth)==this.Ctype.FullWidth)switch(t&~this.Ctype.FullWidth){case this.Ctype.Punctuation:case this.Ctype.UpperCase:case this.Ctype.LowerCase:case this.Ctype.Symbol:case this.Ctype.Numeric:case this.Ctype.MathSymbol:var r=this.GetFullHalfWidthSpecialChar(e,!1);if(r!=="")e=r;else if(n){var i="!";e=String.fromCharCode(e.charCodeAt(0)-(this.CharCategory._charstarts[81].charCodeAt(0)+1)+i.charCodeAt(0))}break;case this.Ctype.Katakana:var s=e.charCodeAt(0)-(this.CharCategory._charstarts[62].charCodeAt(0)+1);if(s<0||s>91)return e;e=this.CharCategory._fullkana[s];var o=this.CharCategory._accentkana[s];if(o>0)return e+=String.fromCharCode(o==1?this.CharCategory.KATAKANA_VOICED.charCodeAt(0):this.CharCategory.KATAKANA_SEMIVOICED.charCodeAt(0)),e;break;case this.Ctype.Space:e=" ";break;case this.Ctype.Hangul:}return e},e.prototype.ToKatakana=function(e){if(!this.IsCharOfType(e,this.Ctype.Hiragana|this.Ctype.FullWidth))return e;var t=this.GetFullHalfWidthSpecialChar(e,!1);return t!==""?t:String.fromCharCode(e.charCodeAt(0)-this.CharCategory._charstarts[61].charCodeAt(0)+this.CharCategory._charstarts[62].charCodeAt(0))},e.prototype.ToHiragana=function(e){return this.IsKatakana(e)?(this.IsFullWidth(e)||(e=this.ToFullWidth(e).text),this.IsCharOfType(e,this.Ctype.Katakana|this.Ctype.FullWidth)?e>="\u30f7"&&e<="\u30ff"?e:e=="\u30f5"?"\u304b":e=="\u30f6"?"\u3051":String.fromCharCode(e.charCodeAt(0)+this.CharCategory._charstarts[61].charCodeAt(0)-this.CharCategory._charstarts[62].charCodeAt(0)):e):e},e.prototype.ToBigHalfKatakana=function(e){if(!this.IsSmallHalfKatakana(e))return e;var t=this.CharCategory._halfkana[e.charCodeAt(0)-this.CharCategory.KANAHALFSTART];return t=String.fromCharCode(t.charCodeAt(0)+1),t},e.prototype.BelongTo=function(e){var t=0,n=83,r=n>>1;while(n-t>1)e>=this.CharCategory._charstarts[r]?t=r:n=r,r=n+t>>1;return r},e.prototype.MultiWidthDetails=function(e){var t=0,n=this.CharCategory._fullhalfblocks.length,r=n>>1;while(n-t>1)e>=this.CharCategory._fullhalfblocks[r]?t=r:n=r,r=n+t>>1;return this.CharCategory._mwtable[r]},e.prototype.IsFarEastBlock=function(e,t){switch(this.CharCategory.Blocks[e]){case"CJK_COMPATIBILITY":case"CJK_COMPATIBILITY_FORMS":case"CJK_COMPATIBILITY_IDEOGRAPHS":case"CJK_RADICALS_SUPPLEMENT":case"CJK_SYMBOLS_AND_PUNCTUATION":case"CJK_UNIFIED_IDEOGRAPHS":case"CJK_UNIFIED_IDEOGRAPHS_EXTENSION":case"HALFWIDTH_AND_FULLWIDTH_FORMS":case"BOPOMOFO":case"BOPOMOFO_EXTENDED":case"HIRAGANA":case"KATAKANA":case"KANBUN":case"HANGUL_COMPATIBILITY_JAMO":case"HANGUL_JAMO":case"HANGUL_SYLLABLES":return!0;default:for(var n=0;n<this.CharCategory._feQuotes.length;n++)if(t==this.CharCategory._feQuotes[n])return!0;if(t.charCodeAt(0)>255)return!0;if(t.charCodeAt(0)==8216||t.charCodeAt(0)==8217||t.charCodeAt(0)==8220||t.charCodeAt(0)==8221)return!0}return!1},e.prototype.GetFullHalfWidthSpecialChar=function(e,t){if(t==1)var n=this.CharCategory._jpnSpecialHalf,r=this.CharCategory._jpnSpecialFull;else var n=this.CharCategory._jpnSpecialFull,r=this.CharCategory._jpnSpecialHalf;var i=-1,s=0;while(s<n.length){if(n[s]==e){i=s;break}s++}return i!=-1&&s<r.length?r[s]:""},e}();e.CharProcess=r})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(e){var t=function(){function e(){}return e.PADCHAR="=",e.ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e.Getbyte64=function(n,r){var i=e.ALPHA.indexOf(n.charAt(r));if(i==-1)throw"Cannot decode base64";return i},e.Decode=function(n){if(window.atob!==undefined)return window.atob(n);n=""+n;var r=e.Getbyte64,i,s,o,u=n.length;if(u==0)return n;if(u%4!=0)throw"Cannot decode base64";i=0,n.charAt(u-1)==e.PADCHAR&&(i=1,n.charAt(u-2)==e.PADCHAR&&(i=2),u-=4);var a=[];for(s=0;s<u;s+=4)o=r(n,s)<<18|r(n,s+1)<<12|r(n,s+2)<<6|r(n,s+3),a.push(String.fromCharCode(o>>16,o>>8&255,o&255));switch(i){case 1:o=r(n,s)<<18|r(n,s+1)<<12|r(n,s+2)<<6,a.push(String.fromCharCode(o>>16,o>>8&255));break;case 2:o=r(n,s)<<18|r(n,s+1)<<12,a.push(String.fromCharCode(o>>16))}return a.join("")},e.prototype.getbyte=function(e,t){var n=e.charCodeAt(t);if(n>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return n},e._charInfo=[],e._base64CharInfo="YwBoAGEAcgBpAG4AZgBvAC4AbgBsAHAAAAD+/wgAPAAAAGBLAAD0SwAAgHcAAIB4AAAAERARIBEwEUARUBFgEXARgBGQEaARsBHAEdAR4BHwEQASEBIgEjASQBJQEmAScBKAEpASoBKwEsAS0BLgEvASABMQEyATMBNAE1ATYBNwE4ATkBOgE7ATwBPQE+AT8BMAFBAUIBQwFFAS/v8ZAEAUUBL+/1EAUBRgFFAS/v8DAHAUUBKAFJAUoBSwFMAUgBFQEv7/KwDQFOAU/v8IAPAU/v8ZAFASABUQFSAVMBVAFVAVYBVwFYAVkBWgFYAR/v8DALAVwBXQFYAR/v8VAFAS/v8DAOAV8BWAEf7/qwAAFhAWIBYwFkAWUBZgFnAWgBH+/xgAgBaAEf7/DwBQEv7/pgCQFoAR/v9RAFAS/v8CAKAWgBH+/wULsBbAFoAR/v/+APAU/v//ANAW8BT+//8A0BbgFugW8Bb4FgAXCBcQFxgXIBcoFzAXOBdAF0gXUBdYF2AX/v8DAGgXcBdgF/7/AgB4F4AXiBeQF5gXoBeoF2AXsBdgF/7/AwC4F8AXUBf+/wQAyBdQF9AX2BfgF+gX8Bf4F/7/BwAAGAgYEBgYGFAXIBgoGGAXMBhAF/7/AwBQF/7/AwBgF/7/AgA4GGAX/v8DAEAYYBf+/wUASBhQGEAXWBhgGFAXaBhwGPgXeBiAGIgYkBiYGKAYqBiwGLgYwBjIGNAY2Bi4GP7/BQDgGOgY8Bj4GAAZuBj4FwgZuBj+/wUAEBkYGSAZiBgoGTAZOBn+/xAAQBlIGf7/AgBQGVgZYBloGXAZeBmAGYgZkBmYGaAZqBmwGbgZgBmIGcAZyBnQGdgZ4BnoGfAZiBn4GQAaCBqoGRAaeBmAGYgZGBogGigaqBkwGjgaQBpIGlAaWBpgGtgZaBpwGngaiBmAGogakBqoGZgaoBp4GogZqBqwGrgaqBnAGqAaeBqIGcga0BrYGqgZ4BroGvAaSBn4GgAbCBs4GRAbGBtIGf7/AgAgGygbMBs4Gf7/AgA4G0AbSBtQG1gbYBs4Gf7/AgBoG3AbeBuAG4gbSBmQG5gboBuoG/gXsBu4G8AbOBn+/wIASBn+/wIAyBvQG9gb4BvoG/Ab+BsAHEAX/v8CAAgcSBn+/wIAEBxIGf7/BQAYHEgZ/v8EACAcSBn+/wQAKBxIGf7/BAAwHDgcSBn+/wIAMBxIGf7/AgBAHEgcUBxIGf7/AwBIHEgZ/v8DAFgcYBxoHEgZcBxIGf7/BQB4HBgbSBn+/yUAgByIHJAcmBxIGf7/BACgHKgcsBy4HEgZwBxIGcgcsBzQHEgZ/v8DANgc4BzoHPAc+BwAHfAcSBn+/wIACB1IGf7/AgAQHUgZ/v8CABgdOBn+/wUASBmQGyAdKB0wHUgZOB14HEgZ/v8CACgcQB1IHVAdWB3+/wIASBlgHTgZ/v8OAGgdSBn+/wIAcB14HdgbgB2IHZAdSBmYHfAcOBn+/wQASBn+/wIAoB2oHbAduB1IGcAdOBn+/wgAUBf+/wIAyB3QHf7/AwDYHeAdUBfoHdAd/v8CAPgX/v8CAPAd+B1gF/7/CQAAHmAX/v8GAAgeEB4IHv7/AgAQHhgeCB4gHige/v8DADAeOB5AHkgeUB5YHmAeaB5wHngegB6IHpAemB6gHqgesB44GbgewB7IHtAe2B7gHuge8B74HgAf/v8CAAgfEB8YH1gdIB8oH1gdMB84H0AfOB/+/w4ASB9YHVAfWB9gH/7/AwBoH1gdcB84H3gfWB2AH4gfOBlYHf7/AgCQHzgZmB84GaAf/v8CAKgfsB9gH/7/BAC4H6AfWB3+/wsAwB/IH1gd/v8CANAfWB3+/wYA2B9YHf7/AgDgH+gf8B/4HzgZ/v8DAAAgWB0IIFgdECAYICAgKCCgHzAgWB04IEAgOB9IIDgfYB/+/xAAOB/+/wgAUCBYIDgf/v8DAGAgOB9oIDgf/v8QAFgd/v8DADgfcCB4IDgZ/v8KAEAX/v8CAIAgUBf+/wIAiCCQIJggYBf+/wYAoCCoIFAX/v8CALAgSBn+/wMAuCA4GUgZiBzAIP7/BAD4F/7/AgDIINAg2CDgIDgZ/v8EAFgd6CBYHf7/BQD4H1gd/v8NAPAgOBn4IAAhCCEQIRghGBtIGf7/BAAgISghSBn+/wQAMCE4IUgZOB0YG0gZ/v8EAEAhSCFIGRAdWB3+/wIA+B9IGWAfUCFYIWAfYCFoIWAfcCFYIWAf/v8CAHghgCFgH/7/AgCIIWAf/v8HAJAhYB/+/wUAmCFgH6AhSBn+/wsAqCFYHf7/BABIGf7/DACwITgZ/v8DAEgZuCFIGf7/FgCQG1gd/v8DAJAfOBn+/wMAwCFIGcghOBlgF/7/AgDQIdghYBfgITgZ/v8GAPAX6CHwIfghYBf+/wMAACIIIjgZ/v8GABAiGCJIGSAiOBlIGf7/AwAoIjAiSBn+/wIAOCJAIvAcOBn+/wIAuB1IGUgiSBlQIlgiOBn+/woASBn+/wIAYCJoInAieCI4Gf7/CgBIGf7/CgCwITgZ/v8FAIAi/v8QAIgi/v8QAEgZ/v8CADgdSBn+/wMAkCJIGf7/BgAoHDgZ/v8CAJgioCKoIrAiuCK4GP7/BgDAIjgZyCK4GP7/FQDQIjgZuBj+/wQA2CK4GP7/AgDgIjgZ/v8CAOgi+BfwIvAd+CIAIwgjECMYI7gY/v8HACAjKCP4FgAXCBcQFzAjOCNAI0gZSCNIGUAhUCNYI2AjaCNwI0gZUBx4Izgd/v8CADgZ/v8CAEgZ/v8HAJAigCOII/7/AgCQI5gj/v8DAKAjqCP4IDgZ/v8DAGAf/v8CALAjOBn+/wgASBmQG0gZ/v8DAAgaOBn+/wIASBlAIbgjSBnAIzgZ/v8DAEgZyCNIGf7/AgDQI9gjOBn+/wIAQBf+/wIA4CNQF/7/AgBIGf7/BAA4HfAcOBn+/wUA6COIGP7/AgDwIzgZ/v8MAIgY+COIGAAkOBn+/wwACCQQJIgYGCQgJCgkOBn+/woASBn+/wYAQCE4Gf7/CQAAH/7/BgAwJDgkOBn+/wgAYB/+/w8AQCRgH/7/AgBIJGAf/v8DAFAkWCRgJGAfaCRgH/7/AgBwJDgZ/v8CAFgd/v8EAHgkOBn+/wsAWB3+/wUAkB+II4AkOBn+/wgAQBeIJFAXkCSYJKAkCB5AF6gksCS4JMAkyCRAF4gkUBfQJNgkUBfgJOgk8CT4JEAXACVQF0AXiCRQF5AkmCRQFwgeQBeoJPgkQBcAJVAXQBeIJFAXCCVAFxAlGCUgJSglUBcwJUAXOCVAJUglUCVQF1glQBdgJVAXaCVwJf7/AwBYHf7/AgD4IFgd/v8GAPgfOBn+/wYASBn+/w0AiBw4Gf7/AgBIGTgdOBn+/w4AeCU4GYAl/v8GADgZ/v8IAPgX/v8PADgZiCL+/w8AiCUBAf7/BAABAgMCBAMBAf7/BwADAwMCBQYGBwgHBgYJCgYLDA0MDA4O/v8FAAwGDw8PBgYQEBD+/wwAEAkGChESERMTE/7/DAATCQ8KDwEBAf7/AgABAwEB/v8NABQGCAj+/wIAFRURFRMWDxcVERgZGhoRExUGERoTGxwcHAYQEP7/CwAQDxAQ/v8DABATExP+/wsAEw8TE/7/BAAQE/7/DAATEP7/CAATExAT/v8HABAQExD+/wIAExMTEBAT/v8CABAQExAQEBMTEBD+/wIAExAQExAQEBMTExAQExAQE/7/AwAQEBMQExMQExAQExAQEBMQ/v8CABATEx0QExMTHR3+/wIAEB4TEB4TEB4TEP7/CAATExATExAeExATEBAQE/7/BgATE/7/AwAQEBMQEBMTEP7/AgAQEBAT/v8FABMT/v8CAB0TExP+/wUAHx/+/wQAHyAgHx8f/v8DABER/v8CACAg/v8FAB8fERH+/wcAHx/+/wIAHxEREf7/AwAgER8RERH+/wgAISH+/wgAEBP+/wIAIBEQEwAAHxMTEwYAAAD+/wIAEREQBhAQEAD+/wIAEBATEBAQ/v8IAAAQEBD+/wQAExP+/wkAExATExAQEBMTExAT/v8EABMT/v8CABATDxATEBATExAQEBATIiEhIf7/AgAjIxAT/v8DABAQExD+/wYAExMQE/7/AgAAAP7/BgAAEBAQ/v8KABAAAB8kJP7/AwAAExMT/v8LAAAkJQAAAP7/AgAAISEh/v8OACYhJyEhJyEhJyEAAP7/BAAoKP7/DQAoAAAA/v8CACgoKCcnAAAA/v8FACkp/v8CAAAADw8qBwcrDCwVFSEh/v8FACEsAAAsLAAtLS3+/w8ALi0tLf7/BAAtISEh/v8JACEALy/+/wUABzAwLC0tIS0tLf7/CQAsLSEh/v8DACEpIyEhIf7/AgAhLi4hIRUhIf7/AgAtLQ4O/v8FAC0tLTExLSws/v8HAAAXLSEtLf7/BwAhIf7/BQAhAAAtLS3+/wQAISH+/wUAIS0AAP7/BwAyMv7/BQAoKP7/CAAoISEh/v8EADMzFQYGBjMAAAD+/woAACEhNB0d/v8TAAAAIR00NDQhISH+/wMAITQ0NDQhAAAdISEhIQAAAB0d/v8FACEhJCQ1Nf7/BQAkHx0AAAD+/wMAAB0dHf7/AgAAITQ0AB0dHf7/AwAdAAAdHQAAHR0d/v8KAB0AHR3+/wMAHQD+/wIAAAAdHf7/AgAAACEdNDQ0ISEhIQAANDQAADQ0IR0AAAD+/wMAADQAAP7/AgAdHQAdHR0hIQAANTX+/wUAHR0ICDY2/v8DACIAAAD+/wIAACEhNAAdHR3+/wIAHQAAAAAdHQAdHQAdHQAdHQAAIQA0NDQhIQAAAAAhIQAAISEhAAAAIQAA/v8DAAAdHR0dAP7/AgAAAP7/AwA1Nf7/BQAhIR0dHSEAAP7/BQAAISE0AB0dHf7/BAAAHR0dAB0dHf7/BgAdAB0dAB0dHf7/AgAAACEdNDQ0ISEh/v8CAAAhITQANDQhAAAdAAAA/v8HAAAIAAD+/wcAHQAdHQAdHR3+/wIAAAAhHTQh/v8CACEhIQAANDQAADQ0IQAA/v8EACE0AAD+/wIAHR0AHSIdAAD+/wgAIR0AHR0d/v8CAB0AAAAdHR0AHR3+/wIAAAAAHR0A/v8CAB0dAAAAHR0AAAAdHR0AAAAdHf7/BgAAAP7/AgA0NCE0NAAAADQ0NAA0NDQhAAAdAAAA/v8CAAA0AAD+/wQANjY2FRUV/v8CABUIFQAAAP7/AgAANDQ0AB0dHf7/AwAdAB0dHQAdHf7/CQAAHR0d/v8CAAAAAB0hISE0NDQ0ACEhIQAhIf7/AgAAAP7/AwAAISEAHR0AAP7/BwAcHP7/AwAcIgAANDQAHR0d/v8DAB0AHR3+/wMAAB0dHf7/AgAAACEdNDc0NP7/AgA0ADc0NAA0NCEhAAD+/wMAADQ0AAAA/v8DAB0AABUVAAAA/v8GAB0d/v8FAAAAAB00NDQhISEhADQ0NAA0NDQhAAD+/wQAADQAAP7/BAA2Nv7/AwAAAAAiHR3+/wMAAAA0NAAdHR3+/wgAHQAAAB0d/v8EAAAdHR3+/wQAAB0AAB0d/v8DAB0AAAAhAAAAADQ0NCEhIQD+/wIANDT+/wQAAAA0NCQAAAD+/wUAAB0dHf7/BwAdIR0dISH+/wMAIQAAAAAIHR3+/wMAHyEhIf7/AwAhJDU1/v8FACQkAAD+/wIAAB0dAP7/AgAAHR0A/v8CAAAdAAD+/wMAHR3+/wIAAB0dHf7/AwAAHR0dAB3+/wIAAAAdHQAdHR0dIR0dISH+/wMAACEhHQAAHR3+/wIAHQAfACEh/v8DAAAANTX+/wUAAAAdHQAAHSIiIiQk/v8HACQiIiL+/wIAISEiIv7/AwA1Nf7/BQA2Nv7/BQAiIf7/AwAJCv7/AgA0NB0d/v8EAAAdHR3+/wkAHQAAAAAhISH+/wYAITQhIf7/AgAhJCEhHR3+/wIAAAD+/wIAISH+/wQAACEhIf7/CQAhACIi/v8EACEiIiL+/wIAIgAiIiQk/v8CACQAAAD+/wUAHR3+/wUAHTQ0ISEhITQhIf7/AwA0ISE0NCEhHTU1/v8FACQk/v8DAB0d/v8DADQ0ISEdHf7/AgAhISEdNDQ0HR00NDT+/wMAHR0dISEhIR0dHf7/BgAhNDQhITQ0NP7/AgA0IR00NTX+/wUAAAD+/wIAIiIQEP7/AwAAAP7/BQAdHf7/BQAdJB8AAAAdHf7/BQAAAP7/AgAAHR0dHQAAAP7/AgAdHf7/CQAAAP7/AwAdHf7/BAAdAB0d/v8CAAAAHR3+/wMAHQD+/wIAHR3+/wIAAAAdAB0d/v8CAAAAHR3+/wMAHQD+/wIAHR3+/wIAAAAdHf7/BwAdAB0d/v8JAB0AAAAAISIkJCT+/wMAJDY2Nv7/CQA2AAAAFRX+/wUAAAD+/wMAHR3+/wIAHQAAAP7/BQAdHf7/BgAdJCQdHR3+/wMAHQAAAP7/BAAFHR0d/v8MAB0JCgAAAB0d/v8FAB0kJCQ4ODgAAAD+/wcAHR3+/wYAHQAdHf7/AgAhISEAAAD+/wUAHR0hISEkJAAAAP7/BAAdHSEhAAD+/wYAHQAhIQAA/v8GAB0d/v8CADk5NCEhIf7/AwA0NP7/BAAhNDQhISH+/wUAJCQkHyQkJAgdIQAANTX+/wUAAAD+/wMAHBz+/wUAAAD+/wMABgb+/wMAJQYGBgYhISEFAB0dHR8dHf7/CgAAAP7/BAAdHf7/BAAdIR0AAAD+/wIAISEhNDQ0NCEhNDQ0AAD+/wIANDQhNDQ0/v8CADQhISEAAP7/AgAVAAAABgY1Nf7/BQAdHf7/BwAAADQ0/v8IADQdHR3+/wMANDQAAP7/AwA1Nf7/BQAAAP7/AgAGBhUV/v8IAB0d/v8DAB0hITQ0NAAAJCQhIf7/AgA0HR0d/v8HACE0ISH+/wIAITT+/wIANDT+/wIAITQ0HR0d/v8DAAAA/v8CACQiIiL+/wQAIiEhIf7/BAAiIv7/BAAiAAAAISE0HR0d/v8GAB00ISH+/wIANDQhITQAAAAdHf7/AwA0NP7/BAAhIf7/BAA0NCEhAAAAJCQk/v8CADU1/v8FAAAAAB0dHTU1/v8FAB0d/v8HAB8f/v8DACQkExP+/wYAHx/+/wsAExP+/wsAHxMTE/7/CAATHx8f/v8CACEh/v8DACEAAAD+/wsAISEQE/7/AwATE/7/BAAQExMT/v8EABAQ/v8EABMT/v8DAAAAEBD+/wMAAAATE/7/BAAAEP7/BAATE/7/BwAAABMT/v8EAB4e/v8EABMT/v8CABMAExMQEP7/AgAeERMRERETExMAExMQEP7/AgAeERERExP+/wIAAAATExAQ/v8CAAARERETE/7/BAAQEP7/AgAQERERAAATExMAExMQEP7/AgAeEREABQX+/wUABRcXFzk6JSX+/wMABgYWGwkWFhsJFgYG/v8EADs8PT4/QEEUBwf+/wIABwYGBgYWGwYGBgYSEgYGBkIJCgYGBv7/BQAPBhIGBgb+/wQABgUXF/7/AgAXAAAA/v8CABcX/v8DABoTAAAaGv7/AwALCw8JChMaGv7/BQALCw8JCgAfH/7/AgAfAAAA/v8FAAgI/v8LAAAA/v8FACEh/v8GACEjIyMjISMjIyEhIf7/BQAhAAAA/v8HABUVEBUVFRUQFRUTEBAQExMQEBATFRAVFRUQEBD+/wIAFRX+/wMAEBX+/wMAEBD+/wIAGBMQEP7/AgATHR0dHRMVFRMTEBAPD/7/AgAPEBMT/v8CABUPFRUTIgAAABwcHP7/BgA4OP7/CQA4EBM4ODg4AAAA/v8DAA8P/v8CAA8VFRX+/wIADw8VFf7/AgAPFRUPFRUPFRUV/v8DAA8VFRX+/wcADw8VFQ8V/v8CABUV/v8HAA8P/v8PAAsZDw/+/wYAFRX+/wQADw/+/wIAFRX+/wIADw8VFf7/AwAVCQoVFRX+/wUAIiL+/xIAIhUPFRUV/v8DABUiFRX+/wIAFQ8PD/7/BAAVFf7/DAAPD/7/AwAVFf7/AwAAAP7/BAAVFf7/AwAVAAAA/v8EABUV/v8FABUAAAD+/wIAHBz+/wwAGhr+/woAIiL+/wcAHBz+/wMAFRX+/wMAFQ8VFf7/BAAVDxUV/v8LAA8P/v8EABUV/v8HABUPFRX+/wcAAAAVFf7/BgAiFRUV/v8HABUAAAAVFf7/AgAAAP7/BgAAFRUVFQAVFf7/AgAAABUV/v8GAAAVFRX+/wkAABX+/wIAFRUVAAAAFQAVFf7/AwAVAAAVFRX+/wMACQr+/wcAHBz+/wcAFQAAABUV/v8EAAAVFRX+/wYAFQAPD/7/AgAPCQoPDw8PAP7/AgAAAA8P/v8DAAkK/v8FAA8PDwkKCf7/CgAKDw8P/v8HAAkK/v8CAA8P/v8IAAkKDw/+/wMADxUVDw8P/v8CAA8AAAAVFf7/AgAVAAAA/v8FABAQ/v8HABAAExP+/wcAEwAQExAQEBMTEP7/BAAQEAATEBMTEBMT/v8DABMfAAAQE/7/AgATFRUV/v8CABUAAAD+/wYAAAYGBgYcBgYTE/7/AwAAAP7/BQAdHf7/AwAAAP7/BAAAHx0d/v8DAB0AHR3+/wMAHQAGBhYb/v8CAAYGBhYbBhYbBgb+/wQABiUGBiUGFhsGBhYbCQr+/wQABgb+/wIABiAGAAAA/v8HABUV/v8FAAAVFRX+/wUAAAD+/wUAFRX+/wYAAAD+/wIABQYGBhUfHTgJCv7/BQAVFQkK/v8EACUJCgoVODg4/v8EACEh/v8DACUfHx/+/wIAFRU4ODgfHQYVFR0d/v8DAB0AACEhEREfHx0lHR0d/v8MAB0GHx8fHQAA/v8CAAAdHR3+/wwAHQAiIjY2/v8CACIi/v8LACIVFQA2Nv7/BQAiIv7/BQAAAP7/BgAVHBwc/v8HACIi/v8GABUVFSIiHBwc/v8HACIi/v8GABUV/v8CACIi/v8HACIAIiL+/wMAIhUVFRUiIiL+/wkAFRUiIv7/BwAiFR0d/v8DAAAA/v8FAB0d/v8CAAAA/v8GAB0d/v8CAB0fHR3+/wsAHwYGBjU1/v8FAB0dAAD+/wMAEBP+/wYAHSEjIyMGAAD+/wQAISEGIBAT/v8EAAAA/v8EABER/v8DABEgICD+/wQAEREQE/7/BwATExAT/v8HAB8TExP+/wMAExD+/wMAEBP+/wUAIENDEBMAAAD+/wYAAB0dHf7/AwAhHR0dIR0dHR0hHR3+/wMAHTQ0ISE0FRX+/wIAAAD+/wIAHR3+/wIABgb+/wIAAAD+/wQANDQdHf7/CQA0NP7/CAAhAAAA/v8EACQkHR3+/wMAISH+/wQAJCQdHf7/AwAdISEh/v8FADQ0AAD+/wUAACQdHf7/BAAdISEh/v8CACE0NCEhNDQhIQAAAP7/BAAdHR0hHR3+/wQAITQAADU1/v8FAAAAJCT+/wIARET+/wgARUX+/wgAHR3+/wUAHQAAAP7/AgATE/7/AwATAAAA/v8FAAATExP+/wIAAAD+/wIAACghKCgo/v8EACgLKCj+/wYAKAAoKP7/AgAoAP7/AgAoKAAoKAAoKP7/BQAtLQAA/v8IAAAtLS3+/w0ACQoAAC0t/v8LAAAA/v8EAC0t/v8GACsVAAAGBv7/AwAGCQoGAAD+/wMABiUlEhIJCgn+/wcACgYGCQoGBgYGEhISDAYMAAYMBgYlCQoJ/v8CAAoHBgYLDQ8PDwAGCAcGAAD+/wIALS3+/wIALQAtLf7/CwAtAAAXAAYGBwgHBgYJCgYLDA0MDBMT/v8FABMJDwoPCQoGCQoGBh0d/v8FAB8dHR3+/w4AHx8AAB0d/v8DAAAAHR3+/wMAAAAdHf7/AwAAAB0dHQAAAAgIDxEVCAgAFQ8PDw8VFQAAAP7/BAAARkZGFRUAAB0d/v8GAAAdHR3+/wYAHQAdHQAdJAYiAAAAADY2Nv7/DgAAAAAiIiL+/wQAR0f+/woARxwcHBwVFRX+/wgAHAAAAP7/AgAiIv7/BgAiIQAANjb+/wIAAAD+/wYAHTgdHf7/BAA4AAAA/v8CAB0d/v8HAAAkHR3+/wIAAAD+/wIAHR3+/wQAJDg4OP7/AgAAAP7/BQAQEP7/BAATE/7/BAAoKP7/AwAAACgAKCj+/wYAACgoAAAAKAAAKCgo/v8DAEhI/v8CAAAA/v8CAAAGKCj+/wUAAAD+/wIAACcoISEhACEhAAAA/v8CACEh/v8CACgo/v8CAAAoKCgAKCgo/v8FAAAA/v8CACEhIQAAAAAhSEj+/wQAAAD+/wQAJyf+/wQAJwAAAP7/AwA4ODgAAAD+/wYAJCT+/wIAAAD+/wYAIiL+/wMAAAD+/wUAIiL+/wMAIgAAIiIi/v8FACI0NCEhISIiIjQ0NP7/AgA0FxcX/v8DABchISH+/wMAISIiISEh/v8DACIi/v8HACEh/v8CACIi/v8IAAAAFRUhISEVAAD+/wUANjYAAP7/BwAQEP7/BQATE/7/BQAQEP7/DQATE/7/AwATABMT/v8FABAQExP+/w0AEAAQEAAAEAAAEBAAABAQEBAAEBD+/wQAExP+/wIAABP+/wIAExP+/wMAABMTE/7/BwAQEAAQEBAQAAAQEBD+/wMAEAAQEP7/AwAQABMT/v8FABAQABAQEBAAEBD+/wIAEAD+/wIAAAAQEP7/AwAQABMT/v8NABAQ/v8FABMT/v8IAAAAEBD+/wQAEEkTE/7/DAATSRMT/v8DABAQ/v8MABBJExP+/wQAE0kTE/7/AwAQEP7/BAAQSRMT/v8MABNJExP+/wMAEBD+/wwAEEkTE/7/BAATSRMT/v8DABAQ/v8EABBJExP+/wQAE0kTE/7/AwAQEwAADg7+/wkAABcAAP7/BwAXF/7/CABFRf7/BwAAAO7u/v8CAB0ADg4OEA4PDhELERgSGAoaChQSFRIZCRgMEwkICBkSAAAbEhISAQALDBwSFhIPDhwKGQoKCBcSChIEAAIAAwADEgUNHAAHDRgAExITAxgDBAMPCxkEGgQYBAQEAwQICxgLHAQIAwMDBgAIAAoABQAJAA8ADwMMEQ0PDwEPBQ8HDwIPBhkMGwAQABEADxIJEgoDGQAAERAR/v8FACARMBEQEUARUBFgEXARgBGQEaARsBEQEf7/AgDAERAR/v8CANAR4BHwEQASEBEQEiASEBH+/wMAMBJAEhAR/v8CAFASEBH+/wIAYBIQEf7/BABwEhAR/v8DAIASkBKgEhAR/v9zALASEBHAEtAS4BIQEf7/TgDwEhAR/v8FAPAREBEAExAREBMgExAR/v8EADATQBMQEf7/GQBQExAR/v+uAGATEBH+/wMAcBMQEf7/IAGAExAR/v8HDpAT/v8DAJgTkBP+/wcAoBOQE/7/GgCYE5AT/v8IAJgTkBP+/wwAmBOQE/7/CQCoE5AT/v8HAKgTsBOQE/7/BgCoE5AT/v8HAKgTkBP+/wcAqBOQE/7/BwCoE7gTkBP+/wYAqBPAE5AT/v8GAKgTkBP+/wcAqBPIE5AT/v8NAJgTkBP+/wcAmBOQE/7/BADQE9gTkBP+/xAAmBOQE/7/BACYE5AT/v8MAOAT6BOQE/7/FgDwE/gTkBP+/w4AmBMAFJATmBOQE/7/EgCoE5AT/v8IAJgTkBP+/wcAmBOQE/7/BQCYE5AT/v8IAJgT/v8CAJAT/v8RAAgUEBSQE/7/DAAYFCAU/v8CACgUkBP+/w0AMBQ4FEAUSBSQE/7/BABQFFgUkBP+/wcAYBRoFHAUkBP+/xUAeBSAFJATiBSQFJAT/v8VAJgUkBP+/wgAoBSQE/7/AgCoFJAT/v8CAKAUkBP+/wIAsBSQE/7/BgCYE5AT/v8aAJgTkBP+/wIAmBOQE/7/FACYE5AT/v8QALgUwBSQE/7/AwDIFJAT0BSQE9gU4BToFPAU+BQAFQgVEBUYFSAVkBP+/wkAKBWQEzAVkBP+/wgAOBWQE/7/DACYE5AT/v8GAEAVkBP+/xIASBWQE/7/CwBQFVgVYBVoFXAVeBWAFZAT/v8PAIgVkBWQE/7/FACYFaAVqBWwFZAT/v8JALgVkBP+/wYAAAD+/wgAAQIDBAUGBwgJCgAA/v8EAAsMAAD+/wIAAA0AAA4PEAAAAP7/AwABAgMEBQYHCAkKAAD+/wIAERITFAAVAAD+/wMAFhcYAAAA/v8KABkREhMREhMAFhcYDg8QAAD+/wUAAQIDBAUGBwgJCg8aGxwdHh8gISIAAP7/CgAADQsMIyQlJicoFikqKywtLi8wFzEAAAD+/wgAMjM0AAAA/v8HABkREhMUNTY3ODkAAP7/AwA6AAAAIyQlJicoAAD+/wMAOg0LDCMkJSYnKAAA/v8EAAA7PD0+P0BBQkNERUYRERITFDU2Nzg5FkdILBdJGBhKMQAANixLTAAAAP7/AwANCwwjJCUmJygWR0hNTk8VMjM0KQ0LDCMkJSYnKBZHSE1OTxUyMzQpDQsMIyQlJicoFkdITU5PFTIzNCkAAP7/BwA6R0hNTk8VMjM0KQ0LDCMkJSYnKBY6AAD+/wMADQsMIyQlJicoFg0LDCMkJSYnKBYNCwwjJCUmJygWAAD+/wwAAA8AAP7/BAAAGQAA/v8EAAAREhMUNTY3ODkAAP7/BwAWKSoAAAD+/wMAERITFAAA/v8FABESExQ1Njc4ORYAAP7/AwAAUFFSU1RVVldYKllaW1xdAF5fYGErYmNkZWZnaGlqLAAA/v8FAAATAAD+/wMAABYAAP7/AgASAAAA/v8EABkAAAD+/wYAADb+/wIAAAD+/wwAABYAAP7/BAAAERITFDU2Nzg5FikqKywtLi8wF2tsbUlub3BxGHJzdEp1dnd4MXl6e0t8fX5/AAD+/wYADg8RNSxJSks1FiwXSRhKNRYsF0kYMUsWEREREhISEjUWFv7/AgAWKiws/v8CABdsSUn+/wIASRhKNSwPDzwQAAAA/v8IABkAAAD+/wIAETUWLAAA/v8GAAAwAAD+/wQAcQAAAP7/AgAAERIWKRcAAP7/CAARFikXAAD+/wMADQsMIxYpFxgAAP7/BAASExQ1Njc4ORMUNTY3ODkUNTY3ODkREhMUNTY3ODkREhMUNRITExQ1Njc4ORESExMUNQAAERITExQ1ExMUFP7/AgA2Nzc3ODg5Of7/AgASExQ1NhESExQUNTUAABESOzxCOzxDDkEOAAAA/v8GABESExQ1Njc4ORYpKissLS4vMAAA/v8OAAECAwQFBgcICQoBAgMEBQYHCAkKAQIDBAUGBwgJCgECAwQFBgcICQoBAgMEBQYHCAkKOQAAAP7/BwDu7v7/BgD//wAAAQECAgMDBAQFBQYGBwcICAkJ/wL/A/8B///+/xUA/wT/Bf8G/wf/CP8J///+/xEA/wD///7/RQAAAP7/AwDwvwAA/v8HAPA/AAD+/wMAAEAAAP7/AwAIQAAA/v8DABBAAAD+/wMAFEAAAP7/AwAYQAAA/v8DABxAAAD+/wMAIEAAAP7/AwAiQAAA/v8DAABAAAD+/wMACEAAAP7/AwDwPwAA/v8DANA/AAD+/wMA4D8AAP7/AwDoPwAA/v8DAPA/AAD+/wMAAEAAAP7/AwAIQAAA/v8DABBAAAD+/wMAMEAAAP7/AwAkQAAA/v8DAFlAAAD+/wIAAECPQAAA/v8HAPg/AAD+/wMABEAAAP7/AwAMQAAA/v8DABJAAAD+/wMAFkAAAP7/AwAaQAAA/v8DAB5AAAD+/wMAIUAAAP7/AwDgvwAA/v8DABBAAAD+/wMAFEAAAP7/AwAYQAAA/v8DABxAAAD+/wMAIEAAAP7/AwAiQAAA/v8DADRAAAD+/wMAPkAAAP7/AwBEQAAA/v8DAElAAAD+/wMATkAAAP7/AgAAgFFAAAD+/wMAVEAAAP7/AgAAgFZAAAD+/wIAAIjDQAAA/v8DADFAAAD+/wMAMkAAAP7/AwAzQAAA/v8DABRAAAD+/wMAGEAAAP7/AwAcQAAA/v8DACBAAAD+/wMAIkAAAP7/BABVVf7/AwDVP1VV/v8DAOU/mpmZmf7/AgDJP5qZmZn+/wIA2T8zM/7/AwDjP5qZmZn+/wIA6T9VVf7/AwDFP6uqqqr+/wIA6j8AAP7/AwDAPwAA/v8DANg/AAD+/wMA5D8AAP7/AwDsPwAA/v8DACZAAAD+/wMAKEAAAP7/AgAAQH9AAAD+/wIAAIizQAAA/v8CAABq6EAAAP7/AgAAavhAAAD+/wMAKkAAAP7/AwAsQAAA/v8DAC5AAAD+/wMANUAAAP7/AwA2QAAA/v8DADdAAAD+/wMAOEAAAP7/AwA5QAAA/v8DADpAAAD+/wMAO0AAAP7/AwA8QAAA/v8DAD1AAAD+/wMAP0AAAP7/AwBAQAAA/v8CAACAQEAAAP7/AwBBQAAA/v8CAACAQUAAAP7/AwBCQAAA/v8CAACAQkAAAP7/AwBDQAAA/v8CAACAQ0AAAP7/AgAAgERAAAD+/wMARUAAAP7/AgAAgEVAAAD+/wMARkAAAP7/AgAAgEZAAAD+/wMAR0AAAP7/AgAAgEdAAAD+/wMASEAAAP7/AgAAgEhAAAD+/wMAaUAAAP7/AgAAwHJAAAD+/wMAeUAAAP7/AgAAwIJAAAD+/wIAAOCFQAAA/v8DAIlAAAD+/wIAACCMQAAA/v8CAABAn0AAAP7/AgAAcKdAAAD+/wIAAECvQAAA/v8CAABwt0AAAP7/AgAAWLtAAAD+/wIAAEC/QAAA/v8CAACUwUAAAP7/AgAAiNNAAAD+/wIAAEzdQAAA/v8CAACI40AAAP7/AgAATO1AAAD+/wIAABfxQAAA/v8CAACI80AAAP7/AgAA+fVA",e.DecodeCharInfo=function(){var n=e.Decode(e._base64CharInfo),r=[],i=0;for(i=0;i<n.length;i+=2){var s=n.charCodeAt(i+1)*256+n.charCodeAt(i);r.push(s)}var o=[];for(i=0;i<r.length;i++)if(r[i]!=65534)o.push(r[i]);else{var u=r[i+1];for(var a=1;a<u;a++)o.push(r[i-1]);i++}for(i=0;i<o.length;i+=2){var f=o[i+1]*65536+o[i];e._charInfo.push(f)}},e.GetByte=function(n){e._charInfo.length===0&&e.DecodeCharInfo();var r=Math.floor(n/4),i=n%4,s=e._charInfo[r];switch(i){case 0:return s&255;case 1:return s>>8&255;case 2:return s>>16&255;case 3:return s>>24&255}},e.GetShortValue=function(n){var r=e.GetByte(n),i=e.GetByte(n+1);return i*256+r},e.GetIntValue=function(n){var r=e.GetByte(n),i=e.GetByte(n+1),s=e.GetByte(n+2),o=e.GetByte(n+3);return o*65535*256+s*65535+i*256+r},e}();e.CharInfo=t;var n=function(){function e(){}return e.InitTable=function(){e.globalizationResourceBytePtr=0,e.headerPtr=e.globalizationResourceBytePtr,e.s_pCategoryLevel1Index=t.GetIntValue(e.globalizationResourceBytePtr+40),e.s_pCategoriesValue=t.GetIntValue(e.globalizationResourceBytePtr+44),e.s_pNumericLevel1Index=t.GetIntValue(e.globalizationResourceBytePtr+48),e.s_pNumericValues=t.GetIntValue(e.globalizationResourceBytePtr+56),e.s_pDigitValues=t.GetIntValue(e.globalizationResourceBytePtr+52)},e.InternalConvertToUtf32=function(t,n,r){r.length=1;if(n<t.length-1){var i=t.charCodeAt(n)-55296;if(i>=0&&i<=1023){var s=t.charCodeAt(n+1)-56320;if(s>=0&&s<=1023)return r.length++,i*1024+s+65536}}return t.charCodeAt(n)},e.InternalGeteCategoryValue=function(r,i){if(i===undefined||i===null)i=0;var s=t.GetShortValue(e.s_pCategoryLevel1Index+2*(r>>8));s=t.GetShortValue(e.s_pCategoryLevel1Index+2*(s+(r>>4&15)));var o=e.s_pCategoryLevel1Index+2*s,u=t.GetByte(o+(r&15));return t.GetByte(e.s_pCategoriesValue+u*2+i)},e.InternalGetUnicodeCategory=function(n,r,i){var s=e.InternalConvertToUtf32(n,r,i);return e.InternalGeteCategoryValue(s,0)},e.IsCombiningCategory=function(t){return t!==r.NonSpacingMark&&t!==r.SpacingCombiningMark?t===r.EnclosingMark:!0},e}();e.CharUnicodeInfo=n,n.InitTable(),function(e){e._map=[],e.ClosePunctuation=21,e.ConnectorPunctuation=18,e.Control=14,e.CurrencySymbol=26,e.DashPunctuation=19,e.DecimalDigitNumber=8,e.EnclosingMark=7,e.FinalQuotePunctuation=23,e.Format=15,e.InitialQuotePunctuation=22,e.LetterNumber=9,e.LineSeparator=12,e.LowercaseLetter=1,e.MathSymbol=25,e.ModifierLetter=3,e.ModifierSymbol=27,e.NonSpacingMark=5,e.OpenPunctuation=20,e.OtherLetter=4,e.OtherNotAssigned=29,e.OtherNumber=10,e.OtherPunctuation=24,e.OtherSymbol=28,e.ParagraphSeparator=13,e.PrivateUse=17,e.SpaceSeparator=11,e.SpacingCombiningMark=6,e.Surrogate=16,e.TitlecaseLetter=2,e.UppercaseLetter=0}(e.UnicodeCategory||(e.UnicodeCategory={}));var r=e.UnicodeCategory,i=function(){function e(){}return e.GetNextTextElement=function(r,i,s){var o;if(r==null)throw"ArgumentNullException";var u=r.length;if(i<0||i>=u){if(i!=u)throw"ArgumentOutOfRangeException";return""}var a={},f=n.InternalGetUnicodeCategory(r,i,a);o=a.length;var l=e.GetCurrentTextElementLen(r,i,u,f,o,s);return s.length=l,r.substr(i,l)},e.GetCurrentTextElementLen=function(t,i,s,o,u,a){var f;if(i+u===s)return u;var l={},c=n.InternalGetUnicodeCategory(t,i+u,l);f=l.length;if(!n.IsCombiningCategory(c)||n.IsCombiningCategory(o)||o===r.Format||o===r.Control||o===r.OtherNotAssigned||o===r.Surrogate){var h=u;return a.ucCurrent=c,a.currentCharCount=f,h}var p=i;i+=u+f;while(i<s){var l={};c=n.InternalGetUnicodeCategory(t,i,l),f=l.length;if(!n.IsCombiningCategory(c)){a.ucCurrent=c,a.currentCharCount=f;break}i+=f}return i-p},e.GetTextElement=function(n){var r=[],i=0;while(i<n.length){var s={},o=e.GetNextTextElement(n,i,s);r.push(o),i+=s.length}return r},e}();e.StringInfo=i;var s=function(){function e(){}return e.TextElementCache={},e.TextElementCacheCount=0,e.AddElementCache=function(n,r){e.TextElementCacheCount>500&&(e.TextElementCache={},e.TextElementCacheCount=0),e.TextElementCache[n]=r,e.TextElementCacheCount++},e}();e.StringCache=s,String.prototype.GetStandardPosition=function(e,t){this.CreateSurrogateArray();var n=e;if(s.TextElementArray!==null&&e>0){var r=Math.min(e,s.TextElementArray.length),i=0;for(var o=0;o<r;o++)i+=s.TextElementArray[o].length;n=i}return n},String.prototype.CreateSurrogateArray=function(){if(s.TextElementArray===undefined||s._InnerValue.toString()!=this.toString()){s._InnerValue=this;var e=s.TextElementCache[this];e===undefined&&(e=i.GetTextElement(this),s.AddElementCache(this,e));if(e.length===this.length)s.TextElementArray=null;else{s.TextElementArray=e,s.MultiCharExit=!1;for(var t=0;t<e.length;t++)if(e[t].length>2){s.MultiCharExit=!0;break}}}},String.prototype.GetLength=function(){this.CreateSurrogateArray();var e=this.length;return s.TextElementArray!==null&&(e=s.TextElementArray.length),e},String.prototype.Substring=function(e,t){this.CreateSurrogateArray();if(e>=t)return"";var n=this.substring(e,t);if(s.TextElementArray!==null){e=Math.max(0,e),t=Math.min(s.TextElementArray.length,t);var r=[];for(var i=e;i<t;i++)r.push(s.TextElementArray[i]);n=r.join("")}return n},String.prototype.IndexOf=function(e,t){this.CreateSurrogateArray();var n=this.indexOf(e,t);if(s.TextElementArray!==null&&n>0){var r=0;for(var i=0;i<s.TextElementArray.length;i++){r+=s.TextElementArray[i].length;if(r==n){n=i+1;break}}}return s.TextElementArray!==null&&n>=0&&this.Substring(n,n+e.GetLength()).length!=e.length&&(n=-1),n},String.prototype.LastIndexOf=function(e){this.CreateSurrogateArray();var t=this.lastIndexOf(e);if(s.TextElementArray!==null&&t>0){var n=0;for(var r=0;r<s.TextElementArray.length;r++){n+=s.TextElementArray[r];if(n==t){t=r+1;break}}}return s.TextElementArray!==null&&t>=0&&this.Substring(t,t+e.GetLength()).length!=e.length&&(t=-1),t},String.prototype.CharAt=function(e){this.CreateSurrogateArray();var t=this.charAt(e);return s.TextElementArray!==null&&(e>=0&&e<s.TextElementArray.length?t=s.TextElementArray[e]:t=""),t},String.prototype.startWith=function(e){return e==null||e==""||this.length==0||e.length>this.length?!1:this.substr(0,e.length)==e?!0:!1},String.prototype.IsNulOrEmpty=function(e){return e==null||e==""}})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(wijmo){(function(input){"use strict";var $=jQuery,jqKeyCode=wijmo.getKeyCodeEnum(),wijinputcore=function(e){function t(){e.apply(this,arguments),this._boundMouseWheel=!1,this._wasPopupShowing=!1,this._blockNextTriggerClickedEvent=!1}return __extends(t,e),t.prototype._elemWithClasses=function(e,t){return typeof t=="undefined"&&(t=[]),$(e).addClass(t.join(" "))},t.prototype._divWithClasses=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];return this._elemWithClasses("<div/>",e)},t.prototype._spanWithClasses=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];return this._elemWithClasses("<span/>",e)},t.prototype._horizontalBorderWidth=function(e){return e.leftBorderWidth()+e.rightBorderWidth()},t.prototype._verticalBorderWidth=function(e){return e.topBorderWidth()+e.bottomBorderWidth()},t.prototype._create=function(){var e=this;try{var t=document.activeElement==this.element[0]}catch(n){}var r=this._horizontalBorderWidth(this.element),i=this._verticalBorderWidth(this.element);if(this.element[0].tagName.toLowerCase()!=="input"&&this.element[0].tagName.toLowerCase()!=="textarea")throw"Target element is not a INPUT";this._creationDate=new Date,window.wijmoApplyWijTouchUtilEvents&&($=window.wijmoApplyWijTouchUtilEvents($)),this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){e._destroy(),e._create(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijinput"),this.element.data("widgetName",this.widgetName),$.effects&&$.effects.save?$.effects.save(this.element,["width","height"]):$.save&&$.save(this.element,["width","height"]);var s=this.options.wijCSS;this.element.wrap("<div><span/></div"),this.wrapper=this.element.parent(),this.outerDiv=this.wrapper.parent(),this.outerDiv.addClass([s.wijinput,s.widget,s.helperClearFix,s.stateDefault,s.cornerAll].join(" ")),this.wrapper.addClass(s.wijinputWrapper),this.element.addClass(s.wijinputInput).addClass(s.cornerAll).attr("role","textbox");if(!(Utility.IsIE()&&parseFloat($.browser.version)<=7))try{this.element.attr("aria-multiline",!1)}catch(n){this.element[0].setAttribute("aria-multiline","false")}this.options.showTrigger!=undefined&&(this.options.showDropDownButton=this.options.showTrigger),this._createDropDownAndSpin(),this._initialize(),t&&$(function(){return e.element.focus().wijtextselection(0,e.element.val().length)});var o=this.element[0].style;o.width&&(this._isInPercents(o.width)?this.outerDiv.width(o.width):this.outerDiv.width(this.element.width()+r-this._horizontalBorderWidth(this.outerDiv)),this.element.width("")),o.height&&(this._isInPercents(o.height)?this.outerDiv.height(o.height):this.outerDiv.height(this.element.height()+i-this._verticalBorderWidth(this.outerDiv)),this.element.height(this.outerDiv.height()-(parseInt(this.wrapper.css("padding-top"))+parseInt(this.wrapper.css("padding-bottom")))),this.wrapper.height(o.height))},t.prototype._createDropDownAndSpin=function(){this._createDropDownAndSpinElement(),this._createDropDownAndSpinStyle(),this._createDropDownAndSpinLayout()},t.prototype._createDropDownAndSpinElement=function(){var e=this.options.wijCSS,t=this.options.spinnerAlign,n=t==="verticalLeft",r=this.options.dropDownButtonAlign==="left",i=this.options.showSpinner,s=this._isDropDownButtonShown();this.options.buttonAlign!=null&&(n=this.options.buttonAlign=="left",r=this.options.buttonAlign=="left",t=this.options.buttonAlign=="left"?"verticalLeft":"verticalRight"),this.triggerBtn=null,this.spinUpElement=null,this.spinDownElement=null,this.outerDiv.css("overflow","hidden");if(s){var o=r?e.cornerLeft:e.cornerRight;this.triggerBtn=this._divWithClasses(e.wijinputTrigger,e.stateDefault,o).append(this._spanWithClasses(e.icon,e.iconArrowDown)).attr("role","button"),this.element.attr({role:"combobox","aria-expanded":!1})}i&&(this.spinnerLeft=this._divWithClasses(e.wijinputSpinnerLeft,e.wijinputButton),this.spinnerRight=this._divWithClasses(e.wijinputSpinnerRight,e.wijinputButton),t==="verticalLeft"||t==="verticalRight"?(this.spinUpElement=this._divWithClasses(e.stateDefault,e.wijinputSpinUp).append(this._spanWithClasses(e.icon,e.iconArrowUp)).css({padding:"0px"}).attr("role","upbutton"),this.spinDownElement=this._divWithClasses(e.stateDefault,e.wijinputSpinDown).append(this._spanWithClasses(e.icon,e.iconArrowDown)).css({padding:"0px"}).attr("role","downbutton")):(this.spinUpElement=this._divWithClasses(e.stateDefault,e.wijinputSpin).append(this._spanWithClasses(e.icon,e.iconPlus,e.glyphIcon,e.glyphIconPlus)).css({padding:"0px"}).attr("role","upbutton"),this.spinDownElement=this._divWithClasses(e.stateDefault,e.wijinputSpin).append(this._spanWithClasses(e.icon,e.iconMinus,e.glyphIcon,e.glyphIconMinus)).css({padding:"0px"}).attr("role","downbutton")),this.element.attr("role","spinner"))},t.prototype._createDropDownAndSpinStyle=function(){var e=this.options.wijCSS,t=this.options.spinnerAlign,n=this.options.spinnerAlign==="verticalLeft",r=this.options.dropDownButtonAlign==="left",i=this.options.showSpinner,s=this._isDropDownButtonShown();this.options.buttonAlign!=null&&(n=this.options.buttonAlign=="left",r=this.options.buttonAlign=="left",t=this.options.buttonAlign=="left"?"verticalLeft":"verticalRight");if(s&&i)if(r)switch(t){case"verticalLeft":this.outerDiv.addClass(e.inputSpinnerTriggerLeft);break;case"verticalRight":this.outerDiv.addClass(e.inputTriggerLeft),this.outerDiv.addClass(e.inputSpinnerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(e.inputSpinnerTriggerLeft),this.outerDiv.addClass(e.inputSpinnerRight)}else switch(t){case"verticalLeft":this.outerDiv.addClass(e.inputTriggerRight),this.outerDiv.addClass(e.inputSpinnerLeft);break;case"verticalRight":this.outerDiv.addClass(e.inputSpinnerTriggerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(e.inputSpinnerTriggerRight),this.outerDiv.addClass(e.inputSpinnerLeft)}else if(s)r?this.outerDiv.addClass(e.inputTriggerLeft):this.outerDiv.addClass(e.inputTriggerRight);else if(i)switch(t){case"verticalLeft":this.outerDiv.addClass(e.inputSpinnerLeft);break;case"verticalRight":this.outerDiv.addClass(e.inputSpinnerRight);break;case"horizontalDownLeft":case"horizontalUpLeft":this.outerDiv.addClass(e.inputSpinnerLeft),this.outerDiv.addClass(e.inputSpinnerRight)}if(s&&i)if(r)switch(t){case"verticalRight":this.spinUpElement.addClass(e.cornerTR),this.spinDownElement.addClass(e.cornerBR);break;case"horizontalDownLeft":this.spinUpElement.addClass(e.cornerRight);break;case"horizontalUpLeft":this.spinDownElement.addClass(e.cornerRight)}else switch(t){case"verticalLeft":this.spinUpElement.addClass(e.cornerTL),this.spinDownElement.addClass(e.cornerBL);break;case"horizontalDownLeft":this.spinDownElement.addClass(e.cornerLeft);break;case"horizontalUpLeft":this.spinUpElement.addClass(e.cornerLeft)}else if(i)switch(t){case"verticalLeft":this.spinUpElement.addClass(e.cornerTL),this.spinDownElement.addClass(e.cornerBL);break;case"verticalRight":this.spinUpElement.addClass(e.cornerTR),this.spinDownElement.addClass(e.cornerBR);break;case"horizontalDownLeft":this.spinDownElement.addClass(e.cornerLeft),this.spinUpElement.addClass(e.cornerRight);break;case"horizontalUpLeft":this.spinUpElement.addClass(e.cornerLeft),this.spinDownElement.addClass(e.cornerRight)}},t.prototype._createDropDownAndSpinLayout=function(){var e=this.options.spinnerAlign,t=this.options.showSpinner,n=this._isDropDownButtonShown();this.options.buttonAlign!=null&&(e=this.options.buttonAlign=="left"?"verticalLeft":"verticalRight"),n&&this.triggerBtn.appendTo(this.outerDiv);if(t)switch(e){case"verticalLeft":this.spinnerLeft.append(this.spinUpElement).append(this.spinDownElement).appendTo(this.outerDiv);break;case"verticalRight":this.spinnerRight.append(this.spinUpElement).append(this.spinDownElement).appendTo(this.outerDiv);break;case"horizontalDownLeft":this.spinnerLeft.append(this.spinDownElement).appendTo(this.outerDiv),this.spinnerRight.append(this.spinUpElement).appendTo(this.outerDiv);break;case"horizontalUpLeft":this.spinnerLeft.append(this.spinUpElement).appendTo(this.outerDiv),this.spinnerRight.append(this.spinDownElement).appendTo(this.outerDiv)}},t.prototype._isDropDownButtonShown=function(){var e=this.options.showTrigger;return e===undefined&&(e=!1),e||this.options.showDropDownButton},t.prototype._isInPercents=function(e){return e.match(/%$/)},t.prototype._createTextProvider=function(){return undefined},t.prototype._beginUpdate=function(){},t.prototype._endUpdate=function(){var e=this;this.element.mousewheel&&!this._boundMouseWheel&&(this.element.mousewheel(function(t,n){e.isFocused()&&e._doSpin(n>0,!1)&&t.preventDefault()}),this._boundMouseWheel=!0)},t.prototype._isPopupShowing=function(){return!!this._comboDiv&&this._comboDiv.wijpopup("isVisible")},t.prototype._onTriggerMouseDown=function(e){this._wasPopupShowing&&(this._blockNextTriggerClickedEvent=!0)},t.prototype._onTriggerMouseUp=function(e){},t.prototype._onTriggerClicked=function(){if(this._blockNextTriggerClickedEvent){this._blockNextTriggerClickedEvent=!1;return}this._popupVisible()?this._hidePopup():this._showPopup()},t.prototype._showPopup=function(){return this._popupComboList()},t.prototype._hidePopup=function(){this._comboDiv.wijpopup("hide")},t.prototype._initialize=function(){var e=this;this.element.data("initializing",!0),this._trigger("initializing"),this.element.data("preText",this.element.val()),this.element.data("elementValue",this.element.val()),this.element.data("errorstate",!1),this.element.data("breakSpinner",!0),this.element.data("prevSelection",null),this.element.data("simulating",!1),this._createTextProvider(),this._beginUpdate();var t=this.options,n=function(e){return(e.which?e.which:e.button)===1},r=function(t){if(e.options.disabled)return;if(!n(t))return;if(e.options.disableUserInput)return;e._trySetFocus(),Utility.IsFireFox4OrLater()&&e._stopEvent(t),e.element.data("breakSpinner",!1),e._addState("active",$(e)),e._doSpin($(t.currentTarget).attr("role")=="upbutton",!0)},i=function(t){if(e.options.disabled)return;if(!n(t))return;if(e.options.disableUserInput)return;e._stopSpin(),e._removeState("active",$(e))};this.triggerBtn&&!t.disabledState&&this.triggerBtn.bind({mouseover:function(){if(e.options.disabled)return;e._addState("hover",$(e))},mouseout:function(){if(e.options.disabled)return;e._removeState("hover",$(e))},mousedown:function(t){if(e.options.disabled)return;if(!n(t))return;e._stopEvent(t),e._addState("active",$(e)),e._trigger("triggerMouseDown"),e._trigger("dropDownButtonMouseDown"),e._onTriggerMouseDown(t)},mouseup:function(t){e._onTriggerMouseUp(t)},click:function(t){if(e.options.disabled)return;e._stopEvent(t),e._stopSpin(),e._removeState("active",$(e)),e._trigger("triggerMouseUp"),e._trigger("dropDownButtonMouseUp"),e._onTriggerClicked(),e._trySetFocus()}}),this.spinUpElement&&!t.disabledState&&this.spinUpElement.bind({mouseover:function(){if(e.options.disabled)return;e._addState("hover",$(e))},mouseout:function(){if(e.options.disabled)return;e._removeState("hover",$(e)),e._removeState("active",$(e)),e._stopSpin()},mousedown:r,mouseup:i}),this.spinDownElement&&!t.disabledState&&this.spinDownElement.bind({mouseover:function(){if(e.options.disabled)return;e._addState("hover",$(e))},mouseout:function(){if(e.options.disabled)return;e._removeState("hover",$(e)),e._removeState("active",$(e)),e._stopSpin()},mousedown:r,mouseup:i}),this._attachInputEvent(),this.element.data("initializing",!1),this._resetData(),this._endUpdate(),this._updateText();if(this.options.disabledState){var s=t.disabled;this.disable(),t.disabled=s}this.options.disabled&&this.disable(),this.options.imeMode&&this.element.css("ime-mode",this.options.imeMode),this.element.data("initialized",!0),this._trigger("initialized")},t.prototype._attachInputEvent=function(){this.element.bind({"focus.wijinput":$.proxy(this._onFocus,this),"beforedeactivate.wijinput":$.proxy(this._onBeforeDeactivate,this),"blur.wijinput":$.proxy(this._onBlur,this),"mousedown.wijinput":$.proxy(this._onMouseDown,this),"mouseup.wijinput":$.proxy(this._onMouseUp,this),"keypress.wijinput":$.proxy(this._onKeyPress,this),"keydown.wijinput":$.proxy(this._onKeyDown,this),"keyup.wijinput":$.proxy(this._onKeyUp,this),"compositionstart.wijinput":$.proxy(this._onCompositionStart,this),"compositionend.wijinput":$.proxy(this._onCompositionEnd,this),"change.wijinput":$.proxy(this._onChange,this),"paste.wijinput":$.proxy(this._onPaste,this),"drop.wijinput":$.proxy(this._onDrop,this)}),this.element.bind("propertychange.wijinput input.wijinput",$.proxy(this._onInput,this))},t.prototype._detachInputEvent=function(){this.element.unbind(".wijinput")},t.prototype._init=function(){this.element.attr("readOnly")&&(this.options.readonly=!0),this.options.readonly===!0&&(this.options.disableUserInput=!0),(this.options.readonly===!0||this.options.disableUserInput===!0)&&this.element.attr("readOnly",!0),this.options.placeholder!=null&&(this.options.nullText=this.options.placeholder)},t.prototype._showNullText=function(){return!!this.options.nullText||this.options.nullText===""},t.prototype._setOption=function(e,t){switch(e){case"readonly":this._super(e,t),e="disableUserInput";break;case"placeholder":this._super(e,t),e="nullText";break;case"showTrigger":this.options.showTrigger=t,this.options.showDropDownButton=t}this._super(e,t);switch(e){case"spinnerAlign":case"dropDownButtonAlign":case"showDropDownButton":case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy(),this._create();break;case"showNullText":case"nullText":this._updateText();break;case"imeMode":this.element.css("ime-mode",this.options.imeMode);break;case"disabled":this.element.attr("disabled",t);var n=t?"addClass":"removeClass",r=this.options.wijCSS.stateDisabled;this.element[n](r),this.triggerBtn&&this.triggerBtn[n](r),this.spinUpElement&&this.spinUpElement[n](r),this.spinDownElement&&this.spinDownElement[n](r);break;case"disableUserInput":this.element.attr("readOnly",t);break;case"pickers":this._deleteComboDiv()}},t.prototype.destroy=function(){this._super(),this._comboDiv&&this._comboDiv.remove(),this._destroy()},t.prototype.drop=function(){this._onTriggerClicked()},t.prototype.isDestroyed=function(){return!this.outerDiv},t.prototype._destroy=function(){if(this.isDestroyed())return;this.wrapper=undefined,this.outerDiv=undefined,this._detachInputEvent(),this.element.removeData("errorstate").removeData("breakSpinner").removeData("prevSelection").removeData("simulating").removeData("isPassword").removeClass(this.options.wijCSS.wijinputInput).removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeAttr("aria-expanded"),this.element.parent().replaceWith(this.element),this.element.parent().replaceWith(this.element),$.effects&&$.effects.restore?$.effects.restore(this.element,["width","height"]):$.restore&&$.restore(this.element,["width","height"]),this.triggerBtn=undefined},t.prototype.widget=function(){return this.outerDiv||this._super()},t.prototype._getCulture=function(e){return typeof e=="undefined"&&(e=this.options.culture),Globalize.findClosestCulture(e||this.options.culture)},t.prototype._addState=function(e,t){t.is(":not(.ui-state-disabled)")&&t.addClass(this.options.wijCSS.getState(e))},t.prototype._removeState=function(e,t){t.removeClass(this.options.wijCSS.getState(e))},t.prototype._isInitialized=function(){return!this.element.data("initializing")},t.prototype._setData=function(e){this.setText(e)},t.prototype._resetData=function(){},t.prototype._validateData=function(){},t.prototype.getText=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!1):this.element.val()},t.prototype.setText=function(e){this._isInitialized()?(this._textProvider.setText(e),e!==""&&this.element.val()!==this.options.nullText&&this.element.data("isShowNullText",!1),this._updateText()):this.element.val(e)},t.prototype.getPostValue=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},t.prototype.selectText=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this.getText().length);var n=this;isNaN(e)&&(e=0),isNaN(t)&&(t=0),Utility.IsFireFox4OrLater()&&this.focus();if(this.element.is(":disabled"))return;this.isSelectingFromAPI=!0,this.element.wijtextselection(e,t),setTimeout(function(){return n.isSelectingFromAPI=!1},100)},t.prototype.focus=function(){if(this.element.is(":disabled"))return;this.element.get(0).focus()},t.prototype.isFocused=function(){return this.outerDiv?this.outerDiv.hasClass(this.options.wijCSS.stateFocus):!1},t.prototype.getSelectedText=function(){if(this.isFocused())return this.element.wijtextselection().text;if(this.element.data("prevSelection")){var e=this.element.data("prevSelection").start,t=this.element.data("prevSelection").end;return this.element.val().substring(e,t)}return""},t.prototype._raiseTextChanged=function(){var e=this.element.val(),t=this.element.data("preText");!!this.element.data("initialized")&&t!==e&&(this._trigger("textChanged",null,{text:e}),this.element.data("changed",!0)),this.element.data("preText",e)},t.prototype._raiseDataChanged=function(){},t.prototype._allowEdit=function(){return!this.element.is(":disabled")},t.prototype._updateText=function(e){typeof e=="undefined"&&(e=!1);if(!this._isInitialized())return;e=!!e;var t;this.element.data("selectionbeforeblur")!==undefined?(t=this.element.data("selectionbeforeblur"),this.element.removeData("selectionbeforeblur")):t=this.element.wijtextselection();var n=this.options;this.isDeleteAll&&this._showNullText()?(this.isDeleteAll=!1,n.date=null,this.element.val(n.nullText)):(this.element.val(this._textProvider.toString()),this.options.text=this._textProvider.toString(!0,!1,!1));if(this.element.is(":disabled"))return;e&&this.selectText(t.start,t.end),this.element.data("prevSelection",t),this._raiseTextChanged(),this._raiseDataChanged()},t.prototype._trySetFocus=function(){if(document.activeElement!==this.element[0])try{this.options.disableUserInput||this.element.focus()}catch(e){}},t.prototype._deleteSelText=function(e){typeof e=="undefined"&&(e=!1);if(!this._allowEdit())return;var t=this.element.wijtextselection();if(e){if(t.end<1)return;t.end===t.start&&t.start--}t.end--,t.end<t.start&&(t.end=t.start);var n=new input.wijInputResult;this._textProvider.removeAt(t.start,t.end,n),this._updateText(),this.selectText(n.testPosition,n.testPosition)},t.prototype._fireIvalidInputEvent=function(e){var t=this,n=this._trigger("invalidInput",null,{widget:this,"char":e});if($.isFunction(this.options.invalidInput)&&n===!0)return;if(!this.element.data("errorstate")){var r=this.options.invalidClass||this.options.wijCSS.stateError;this.element.data("errorstate",!0),window.setTimeout(function(){t.outerDiv&&t.outerDiv.removeClass(r),t.element.data("errorstate",!1)},200),this.outerDiv.addClass(r)}},t.prototype._onInput=function(e){if(!this._isSimulating()||!this.element.data("ime")||this.element.data("isComposingIME")){this.element.data("isComposingIME")&&this.element.data("simulationPending",!0);return}this._simulate()},t.prototype._keyDownPreview=function(e){var t=e.keyCode||e.which;return e.ctrlKey===!0&&t===88?!0:e.ctrlKey===!0&&t===90?!0:!1},t.prototype._onDoubleByteCharacter=function(){var e=this.element.data("lastDbsState"),t=this.element.wijtextselection(),n=this.element.val();this.element.data("isComposingIME")&&e&&e.selection.start===t.start&&e.Text===n?(this.element.removeData("lastDbsState"),this._onCompositionEnd()):(this.element.data("lastDbsState",{selection:t,text:n}),this._onCompositionStart())},t.prototype._onCompositionStart=function(){if(this.element.data("isComposingIME"))return;this.element.data("isComposingIME",!0),this._beforeSimulate(!0)},t.prototype._onCompositionEnd=function(){if(!this.element.data("isComposingIME"))return;this.element.data("isComposingIME",!1),this._isInitialized()&&(!this._textProvider||!this._textProvider.noMask)&&this._simulateIfPending()},t.prototype._simulateIfPending=function(){this.element.data("simulationPending")&&this.element.data("lastSelection")&&this._simulate()},t.prototype._beforeSimulate=function(e){typeof e=="undefined"&&(e=!1),this.element.data("lastSelection")||(this.element.data("lastSelection",this.element.wijtextselection()),this.element.data("lastValue",this.element.val())),this.element.data("ime",e),this.element.data("simulating",!0)},t.prototype._isSimulating=function(){return this.element.data("simulating")},t.prototype._simulate=function(e){var t=this,n=null;this.element.data("simulationPending",!1);if(typeof e=="string")n=e;else{var r=this.element.wijtextselection(),i=this.element.data("lastSelection").start,s=r.end;s>=i&&(n=this.element.val().substring(i,s))}n&&window.setTimeout(function(){if(t._isLastValueNull())return;t.element.val(t.element.data("lastValue"));var e=t.element.data("lastSelection");t.element.wijtextselection(e),t._batchKeyPress=!0,t.element.data("simulating",!1);var r=jQuery.Event("keypress");r.ctrlKey=r.altKey=!1;for(var i=0;i<n.length;i++){r.which=r.charCode=r.keyCode=n.charCodeAt(i),t._nextChar=i===n.length-1?"":n.charAt(i+1),t._onKeyPress(r),t._nextChar="";var s=t._appendChar;s&&s.length>0&&(t._appendChar="",r.which=r.charCode=r.keyCode=s.charCodeAt(i),t._onKeyPress(r)),t._skipNextChar&&(i++,t._skipNextChar=!1)}t._batchKeyPress=!1,t._endSimulate()},1)},t.prototype._isLastValueNull=function(){return!this.element.data("lastValue")},t.prototype._endSimulate=function(){this._simulateIfPending(),this.element.removeData("ime"),this.element.removeData("lastSelection"),this.element.removeData("lastValue")},t.prototype._processKeyForDropDownList=function(e){var t=this._getKeyCode(e);if(!(!e.altKey||t!==jqKeyCode.UP&&t!==jqKeyCode.DOWN))return this._onTriggerClicked(),this._stopEvent(e),!0;if(t===jqKeyCode.ESCAPE&&this._wasPopupShowing)return this._hidePopup(),this._stopEvent(e),!0;if(this._wasPopupShowing&&this._comboDiv!==undefined){if(t===jqKeyCode.DOWN){try{this._comboDiv.wijlist("next")}catch(n){}return this._stopEvent(e),!0}if(t===jqKeyCode.UP){try{this._comboDiv.wijlist("previous")}catch(n){}return this._stopEvent(e),!0}if(t===jqKeyCode.ENTER)return this._comboDiv.wijlist("select"),this._stopEvent(e),!0;if(t===jqKeyCode.PAGE_DOWN){try{this._comboDiv.wijlist("nextPage")}catch(n){}return this._stopEvent(e),!0}if(t===jqKeyCode.PAGE_UP){try{this._comboDiv.wijlist("previousPage")}catch(n){}return this._stopEvent(e),!0}}},t.prototype._processKeyOnNoMask=function(e){var t=this._getKeyCode(e);t===jqKeyCode.Enter&&this._onEnterDown(e);if(t===jqKeyCode.LEFT||t===jqKeyCode.RIGHT)if(this._processLeftRightKey(t===jqKeyCode.LEFT)){this._stopEvent(e);return}this._processKeyForDropDownList(e)},t.prototype._onKeyDown=function(e){this.element.data("prevSelection",null),this._deleteKeyDown=!1;if(!this._isInitialized())return;if(this._textProvider&&!!this._textProvider.noMask){this._processKeyOnNoMask(e);return}var t=this._getKeyCode(e);if(t===229){this._onDoubleByteCharacter();return}this._onCompositionEnd();if(this.options.disableUserInput){t===jqKeyCode.TAB?this._processTabKey(e)&&this._stopEvent(e):this._stopEvent(e);return}if(this._keyDownPreview(e)){this._stopEvent(e);return}if(this._processKeyForDropDownList(e))return;switch(t){case jqKeyCode.UP:this._doSpin(!0,!1),this._stopEvent(e);return;case jqKeyCode.DOWN:this._doSpin(!1,!1),this._stopEvent(e);return;case jqKeyCode.LEFT:case jqKeyCode.RIGHT:this._processLeftRightKey(t===jqKeyCode.LEFT)&&this._stopEvent(e);return;case jqKeyCode.TAB:this._processTabKey(e)&&this._stopEvent(e);return}if(e.ctrlKey)switch(t){case jqKeyCode.INSERT:case 67:return;default:}if(e.ctrlKey||e.altKey)return;switch(t){case 112:case 113:case 114:case 115:case 116:case 117:case jqKeyCode.TAB:case jqKeyCode.CAPSLOCK:case jqKeyCode.END:case jqKeyCode.HOME:case jqKeyCode.CTRL:case jqKeyCode.SHIFT:return;case jqKeyCode.BACKSPACE:this._deleteSelText(!0),this._stopEvent(e);return;case jqKeyCode.DELETE:this._deleteSelText(!1),this._stopEvent(e),this._deleteKeyDown=!0;return;case jqKeyCode.ENTER:this._onEnterDown(e);break;case jqKeyCode.ESCAPE:this._stopEvent(e),window.setTimeout($.proxy(this._resetData,this),1);return;case jqKeyCode.PAGE_UP:case jqKeyCode.PAGE_DOWN:case jqKeyCode.ALT:this._stopEvent(e);return}},t.prototype._onEnterDown=function(e){this.options.hideEnter&&this._stopEvent(e)},t.prototype._onKeyUp=function(e){if(this._textProvider&&!!this._textProvider.noMask)return;var t=this._getKeyCode(e);if(this._isSimulating()){t===jqKeyCode.ENTER&&this._onCompositionEnd();return}if(!this._isInitialized())return;if(t===jqKeyCode.ENTER||t===jqKeyCode.ESCAPE)return;if(this.options.disableUserInput){this._raiseTextChanged(),this._raiseDataChanged();return}this._stopEvent(e)},t.prototype._getKeyCode=function(e){var t=window.navigator.userAgent;return t.indexOf("iPod")===-1&&t.indexOf("iPhone")===-1||e.which!==127?e.keyCode||e.which:8},t.prototype._keyPressPreview=function(e){return!1},t.prototype._onKeyPress=function(e){if(this._isSimulating()||this._textProvider&&!!this._textProvider.noMask)return;this.element.data("prevSelection",null);if(this.options.disableUserInput)return;if(!this._allowEdit())return;if(e.ctrlKey&&e.keyCode===119){this._onPaste(e);return}var t=e.keyCode||e.which;if(Utility.IsFireFox4OrLater())switch(e.keyCode){case jqKeyCode.UP:case jqKeyCode.DOWN:case jqKeyCode.LEFT:case jqKeyCode.RIGHT:case jqKeyCode.HOME:case jqKeyCode.END:return}switch(t){case 0:case jqKeyCode.TAB:return;case jqKeyCode.BACKSPACE:this._stopEvent(e);return;case jqKeyCode.DELETE:if(this._deleteKeyDown){this._stopEvent(e);return}break;case jqKeyCode.ENTER:this.options.hideEnter&&this._stopEvent(e);return}if(e.ctrlKey||e.altKey)if(t!==jqKeyCode.SPACE)return;if(this._keyPressPreview(e))return;var n=String.fromCharCode(t),r=this._textProvider.replaceWith(this.element.wijtextselection(),n);r?(this._updateText(),this.selectText(r.testPosition+1,r.testPosition+1),this.element.data("prevSelection",{start:r.testPosition+1,end:r.testPosition+1})):this._fireIvalidInputEvent(n),this._batchKeyPress||this._stopEvent(e)},t.prototype._isNullText=function(e){return e=e||this.element.val(),this._showNullText()&&e===this.options.nullText},t.prototype._doFocus=function(){var e=this.element.wijtextselection(),t=e.start;this._updateText();var n=this.element.val();n.length===t&&(t=0),$.browser.safari||this.selectText(t,t)},t.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},t.prototype._onFocus=function(e){if(this.options.disableUserInput)return;this._addState("focus",this.outerDiv);if(!this.element.data("breakSpinner"))return;if(!this._isInitialized())return;if(!this._allowEdit())return;if(this.isSelectingFromAPI)return;this.element.data("focusNotCalledFirstTime")||this.element.data("focusNotCalledFirstTime",(new Date).getTime()),this._afterFocused()},t.prototype._onBeforeDeactivate=function(e){if(this.options.disableUserInput)return;if(!this.element.data("breakSpinner"))return;if(!this._isInitialized())return;if(!this._allowEdit())return;this.element.data("selectionbeforeblur",this.element.wijtextselection())},t.prototype._onBlur=function(e){if(this.options.disableUserInput)return;this._onCompositionEnd();if(this._isComboListVisible())return;var t=this.isFocused();this._removeState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){this.element.get(0).focus();if(this.element.data("prevSelection")){var n=this.element.data("prevSelection").start;n!==undefined&&n!==null&&this.selectText(n,n)}return}if(!this._isInitialized()||!t)return;this.element.data("value",this.element.val()),this._updateTextOnLostFocus()},t.prototype._updateTextOnLostFocus=function(){var e=this;window.setTimeout(function(){e._onChange(),e._updateText(),e._validateData(),e.element.data("changed")&&(e.element.data("changed",!1),e._popupVisible()||(e._trigger("change"),e.element.change()))},100)},t.prototype._popupVisible=function(){return this._wasPopupShowing},t.prototype._onMouseDown=function(e){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;if(Utility.IsMouseDownOnClearButton(e)){var t=!1;try{t=document.activeElement===e.target}catch(n){}this.element.data("focusedWhenMouseDown",t),this.element.data("mouseDownOnClearButton",!0);return}},t.prototype._onMouseUp=function(e){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;if(Utility.IsMouseDownOnClearButton(e)&&this.element.data("mouseDownOnClearButton")&&this.element.data("focusedWhenMouseDown")===!0){if(!this.options.disableUserInput){var t=this;setTimeout(function(){t._processClearButton()},0)}this.element.data("mouseDownOnClearButton",!1);return}this.element.data("mouseDownOnClearButton",!1),this.element.data("focusedWhenMouseDown",!1);var n=this.element.wijtextselection();this.element.data("prevSelection",n);if(this.element.val()=="")return;var t=this;setTimeout(function(){t.element.val()==""&&t.setText("")},5),this.element.data("isFocusSelecting")&&(this.element.data("isFocusSelecting",!1),e.preventDefault())},t.prototype._onChange=function(){if(!this.element)return;var e=this.element.val(),t=this.getText();t!==e&&this.setText(e)},t.prototype._onPaste=function(e){if(this._textProvider&&!!this._textProvider.noMask)return;this._beforeSimulate();var t=this;window.setTimeout(function(){t._simulate()},1)},t.prototype._onDrop=function(e){this._beforeSimulate();if(e.originalEvent&&e.originalEvent.dataTransfer){var t=e.originalEvent.dataTransfer.getData("Text");t&&this._simulate(t)}},t.prototype._stopEvent=function(e){e.stopPropagation(),e.preventDefault()},t.prototype._calcSpinInterval=function(){return this._repeatingCount++,this._repeatingCount>10?50:this._repeatingCount>4?100:this._repeatingCount>2?200:400},t.prototype._doSpin=function(e,t){return!1},t.prototype._stopSpin=function(){this.element.data("breakSpinner",!0),this._repeatingCount=0;var e=this.element.data("spintimer");e&&(clearTimeout(e),this.element.data("spintimer",undefined))},t.prototype._hasComboItems=function(){return!!this._getcomboItems()&&this._getcomboItems().length},t.prototype._getcomboItems=function(){return!!this.options.comboItems&&this.options.comboItems.length>0?this.options.comboItems:this.options.pickers.list},t.prototype._getcomboWidth=function(){return this.options.comboWidth||this.options.pickers.width},t.prototype._getcomboHeight=function(){return this.options.comboHeight||this.options.pickers.height},t.prototype._isComboListVisible=function(){return this._comboDiv?this._comboDiv.wijpopup("isVisible"):!1},t.prototype._deleteComboDiv=function(){if(this._comboDiv==undefined)return;this._comboDiv.wijlist("destroy"),this._comboDiv.remove(),delete this._comboDiv},t.prototype._createComboDiv=function(){var e=this;if(this._comboDiv!==undefined)return;this._comboDiv=$("<div></div>").appendTo(document.body).css("position","absolute");var t=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,selected:function(t,n){e.options.disableUserInput||e._setData(n.item.value),e._comboDiv.wijpopup("hide"),e._trySetFocus()}}),this._comboDiv.wijlist("setItems",t),this._comboDiv.wijlist("renderList")},t.prototype._popupComboList=function(){var e=this;if(!this._hasComboItems())return!1;if(!this._allowEdit())return!1;var t=this.outerDiv.width(),n=this._getcomboWidth(),r=this._getcomboHeight();return this._comboDiv!=undefined&&n&&parseInt(n)!==this._comboDiv.width()&&this._deleteComboDiv(),this._createComboDiv(),this._comboDiv.width(t),this._comboDiv.wijlist("option","autoSize",!r),r&&this._comboDiv.height(r),n&&this._comboDiv.width(n),this._comboDiv.wijlist("refreshSuperPanel"),this._comboDiv.wijpopup({autoHide:!0,hidden:function(){e._trigger("dropDownClose"),e._wasPopupShowing=!1,e._comboDiv.wijlist("unselectItems"),e._comboDiv.wijlist("deactivate")},shown:function(){e._trigger("dropDownOpen"),e._wasPopupShowing=!0}}),this.outerDiv.attr("aria-expanded",!0),this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4",hidden:function(){e.outerDiv.attr("aria-expanded",!1)}}),!0},t.prototype._normalize=function(e){return e.length&&e[0].label&&e[0].value?e:$.map(e,function(e){return typeof e=="string"?{label:e,value:e}:$.extend({label:e.label||e.value,value:e.value||e.label},e)})},t.prototype._processLeftRightKey=function(e){return!1},t.prototype._processTabKey=function(e){return!1},t.prototype._moveControl=function(e,t,n){var r=Utility.GetElements(),i=null,s={};if(r.length<2)return null;var o=Utility.GetNextFocusableControl(e,r,t),u=this;setTimeout(function(){Utility.SetElementFocus(o),u._trigger("keyExit")},0)},t.prototype._processClearButton=function(){},t}(wijmo.wijmoWidget);input.wijinputcore=wijinputcore;var wijinputClass="wijmo-wijinput",classPrefix=wijinputClass+"-",wijinputcore_options=function(){function e(){this.wijCSS={wijinput:wijinputClass,wijinputInput:classPrefix+"input",wijinputWrapper:classPrefix+"wrapper",wijinputWrapperSpinnerLeft:classPrefix+"wrapper-spinner-left",wijinputWrapperSpinnerRight:classPrefix+"wrapper-spinner-right",wijinputTrigger:classPrefix+"trigger",wijinputSpinnerLeft:classPrefix+"spinner-left",wijinputSpinnerRight:classPrefix+"spinner-right",wijinputButton:classPrefix+"button",wijinputSpin:classPrefix+"spin",wijinputSpinUp:classPrefix+"spinup",wijinputSpinDown:classPrefix+"spindown",glyphIcon:"glyphicon",glyphIconPlus:"glyphicon-plus",glyphIconMinus:"glyphicon-minus",iconPlus:"ui-icon-plus",iconMinus:"ui-icon-minus"},this.imeMode="",this.culture="",this.invalidClass=$.wijmo.wijCSS.stateError,this.nullText=undefined,this.placeholder=undefined,this.showNullText=!1,this.hideEnter=!1,this.disableUserInput=!1,this.readonly=!1,this.buttonAlign=null,this.dropDownButtonAlign="right",this.showDropDownButton=!1,this.showTrigger=undefined,this.showSpinner=!1,this.comboItems=undefined,this.comboWidth=undefined,this.comboHeight=undefined,this.blurOnLeftRightKey="none",this.spinnerAlign="verticalRight",this.allowSpinLoop=!1,this.pickers={list:undefined,width:undefined,height:undefined},this.dropDownOpen=null,this.dropDownClose=null,this.initializing=null,this.initialized=null,this.triggerMouseDown=null,this.triggerMouseUp=null,this.dropDownButtonMouseDown=null,this.dropDownButtonMouseUp=null,this.textChanged=null,this.invalidInput=null,this.keyExit=null}return e}();wijinputcore.prototype.options=$.extend(!0,{},wijmo.wijmoWidget.prototype.options,new wijinputcore_options);var Utility=function(){function Utility(){}return Utility.IdCounter=0,Utility.EditFieldSuffix="_EidtField",Utility.MaskValChar="\ufeff",Utility.Hold="g-C2",Utility.FireEvent=function(t,n,r,i){if(!n)return!1;try{n.call(window,t,r)}catch(s){return!1}return!0},Utility.FindIMControl=function(t){},Utility.ArrayIndexOf=function(t,n){if(t.indeOf)return t.indexOf(n);for(var r=0;r<t.length;r++)if(t[r]===n)return r;return-1},Utility.AttachEvent=function(t,n,r,i){t!==null&&t!==undefined&&(t.addEventListener?t.addEventListener(n,r,i):t.attachEvent&&t.attachEvent("on"+n,r))},Utility.AttachFocusEventOfDocument=function(){Utility.IsIE8OrBelow()?Utility.AttachEvent(document,"beforeactivate",function(e){Utility.FocusControlUpdate(e)},!0):Utility.AttachEvent(document,"focus",function(e){Utility.FocusControlUpdate(e)},!0)},Utility.FocusControlUpdate=function(t){Utility.PreviousFocusControl=Utility.FocusControl,Utility.FocusControl=t.target||t.srcElement},Utility.ToString=function(t,n,r,i){var s=t+"";if(r!=null){while(s.length<n)i?s+=r:s=r+s;return s}while(s.length<n)s+=t+"";return s},Utility.GetSelectionEndPosition=function(t){if(!Utility.IsIE()||Utility.IsIE11OrLater()){var n=0;n=t.selectionEnd;if(t.value){var r=t.value.substring(0,n);n=r.GetLength()}var i=0;i=t.selectionStart;if(t.value){var r=t.value.substring(0,i);i=r.GetLength()}return i>n&&(n=i),n}return Utility.GetSelectionStartPosition(t)+document.selection.createRange().text.GetLength()},Utility.GetSelectionStartPosition=function(t){if(t.selectionStart!=null){var n=0;n=t.selectionStart;if(t.value){var r=t.value.substring(0,n);n=r.GetLength()}var i=0;i=t.selectionEnd;if(t.value){var r=t.value.substring(0,i);i=r.GetLength()}return i<n&&(n=i),n}try{var s=t.createTextRange(),o=document.selection.createRange(),u=t.value.GetLength(),a=0,f=u,l=0;while(a<f){l=Math.floor((a+f)/2),s=t.createTextRange();var c=l,r=t.value.Substring(0,l);for(;;){var h=r.IndexOf("\r\n");if(h==-1)break;c--,r=r.Substring(h+2,r.GetLength())}var p=l-c;c=l-p,s.moveStart("character",c);if(s.offsetTop>o.offsetTop)f=l;else if(s.offsetTop<o.offsetTop){if(a==l)return f;a=l}else if(s.offsetLeft>o.offsetLeft)f=l;else{if(!(s.offsetLeft<o.offsetLeft))return t.value.Substring(l-1,l)=="\r"&&l++,l;if(a==l)return f;a=l}}return u}catch(d){return 0}},Utility.GetCursorPosition=function(t,n){if(t==null)return-1;if(!Utility.IsIE()||Utility.IsIE11OrLater()){var r=0;r=t.selectionStart;if(t.value){var i=t.value.substring(0,r);r=i.GetLength()}return r}var s=0;if(document.selection){t.focus();var o=document.selection.createRange();o.moveStart("character",-t.value.length),s=o.text.length}return s},Utility.GetPasteData=function(t){return Utility.GetDataFromClipboard(t)},Utility.GetDataFromClipboard=function(t){return t==0?Utility.SavedText:window.clipboardData?window.clipboardData.getData("Text"):Utility.CutCopyPasteEventObject!==null&&Utility.CutCopyPasteEventObject.clipboardData!==undefined?Utility.CutCopyPasteEventObject.clipboardData.getData("text"):null},Utility.ClearSelection=function(t){Utility.IsIE()&&!Utility.IsIE11OrLater()?document.selection.createRange().text!=""&&document.selection.empty():Utility.GetSelectionText(t)!=""&&(t.selectionStart=t.value.length,t.selectionEnd=t.selectionStart)},Utility.GetSelectionText=function(t){if(t.selectionStart!=null)return t.value.substring(t.selectionStart,t.selectionEnd);if(document.selection!=null)return document.selection.createRange().text;if(document.activeElement!==null){var t=document.activeElement,n=t.selectionStart,r=t.selectionEnd;return t.value.substring(n,r)}return""},Utility.GetNextFocusableControl=function(t,n,r){typeof t=="string"&&(t=document.getElementById(t));var i=0;for(var s=0;s<n.length;s++)if(t===n[s]){r?i=(s+1)%n.length:i=(s-1+n.length)%n.length;break}return n[i]},Utility.FireSystemEvent=function(t,n){if(Utility.IsIE())t.fireEvent(n);else{var r=document.createEvent("HTMLEvents");r.initEvent(n.substring(2,n.length),!0,!0),t.dispatchEvent(r)}},Utility.GetTextBoxScrollWidth=function(t,n){return Utility.MeasureText(t.value,t).Width},Utility.MoveFocus=function(t,n){var r=Utility.GetElements(),i=Utility.GetNextFocusableControl(t,r,n);return Utility.SetElementFocus(i),i},Utility.SetElementFocus=function(t){t.focus()},Utility.GetAllElements=function(){return document.body.querySelectorAll?document.body.querySelectorAll("button, input, object, select, textarea"):document.body.all?document.body.all:document.body.getElementsByTagName("*")},Utility.GetElements=function(){var t=[],n=Utility.GetAllElements(),r=0,i=/^(?:button|input|object|select|textarea)$/i;for(var s=0;s<n.length;s++){if((!document.body.querySelectorAll||Utility.IsIE())&&!i.test(n[s].tagName.toLowerCase()))continue;var o=!n[s].disabled,u=n[s].style.visibility!=="hidden",a=n[s].type!="hidden"&&n[s].tabIndex!=-1,f=n[s].tagName.toLowerCase()=="textarea"&&n[s].tabIndex!=-1,l=a||f;o&&u&&l&&(t[r++]=n[s])}for(var s=0;s<t.length-1;s++)for(var c=s+1;c<t.length;c++)if(t[c].tabIndex<t[s].tabIndex){var h=t[s];t[s]=t[c],t[c]=h}return t},Utility.CheckInt=function(t,n,r){var i=parseInt(t);if(isNaN(i))throw"value is invalid";if(i<n||i>r)throw t+" is out of range, should between "+n+" and "+r;return i},Utility.CheckFloat=function(t,n,r){var i=parseFloat(t);if(isNaN(i))throw"value is invalid";if(t<n||t>r)throw t+" is out of range, should between "+n+" and "+r;return i},Utility.CheckDate=function(t,n,r){if(!(t instanceof Date))throw"Type is invalid";if(isNaN(t))throw"Date is a invalid date";if(r!=undefined)if(t<n||t>r)throw t+" is out of range, should between "+n+" and "+r},Utility.CheckBool=function(t){return typeof t=="string"&&t.toLowerCase()==="true"?!0:t==1},Utility.CheckFunction=function CheckFunction(fun){if(fun===undefined||fun===null)return null;if(typeof fun=="string"){fun=Utility.Trim(fun);if(fun.length==0)return null;try{eval("fun ="+fun)}catch(e){}}if(typeof fun=="function")return fun;throw"The value is not a valid function"},Utility.GetCheckElement=function(){if(Utility.CheckElement==null){var t=document.createElement("div");Utility.CheckElement=t,t.style.display="none"}return Utility.CheckElement},Utility.CheckString=function(t){if(t!==undefined&&(typeof t=="string"||t instanceof String))return t==null&&(t=""),t.toString();throw t+" type is not a string."},Utility.GetCSSLength=function(t){var n=parseInt(t);return isNaN(n)?0:n},Utility.CheckCSSLength=function(t){return t=Utility.CheckInt(t,0,Math.pow(2,31)),parseInt(t)==t&&(t+="px"),Utility.GetCheckElement().style.width="",Utility.GetCheckElement().style.width=t,Utility.GetCheckElement().style.width},Utility.CheckFontSizeValue=function(t){return parseInt(t)==t&&(t+="px"),Utility.GetCheckElement().style.fontSize="",Utility.GetCheckElement().style.fontSize=t,Utility.GetCheckElement().style.fontSize},Utility.CheckColor=function(t){return Utility.GetCheckElement().style.backgroundColor="",Utility.GetCheckElement().style.backgroundColor=t,Utility.GetCheckElement().style.backgroundColor},Utility.CheckImageUrl=function(t){return Utility.CheckString(t)},Utility.GetCssImageUrl=function(t){return t.startWith('url("')?t=t.substring(5,t.length-2):t.startWith("url(")&&(t=t.substring(4,t.length-1)),t},Utility.CheckCssImageUrl=function(t){return t.length>0&&!t.startWith("url(")&&(t="url("+t+")"),Utility.GetCheckElement().style.backgroundImage="",Utility.GetCheckElement().style.backgroundImage=t,Utility.GetCheckElement().style.backgroundImage},Utility.CheckEnum=function(t,n){for(var r in t)if(t[r]==n||t[r]==n.toLowerCase())return t[r];throw"Enum value is invalid"},Utility.CheckChar=function(t){t=Utility.CheckString(t);if(t.length!==1)throw"Invalid value";return t},Utility.GetMultipleStringEnum=function(t){var n=t.split(" ");return n.sort(),n.join(",")},Utility.CheckMultipleStringEnum=function(t,n){var r=n.split(","),i=[];for(var s=0;s<r.length;s++)i.push(Utility.CheckEnum(t,Utility.Trim(r[s])));return i.join(" ")},Utility.EncodingToHTML=function(t){if(t.IndexOf("&")!=-1){var n=t,r="";while(n.IndexOf("&")!=-1){var i=n.IndexOf("&");n=n.replace("&","&amp;"),r+=n.Substring(0,i+5),n=n.Substring(i+5,n.GetLength())}n.IndexOf("&")==-1&&n!=""&&(r+=n),t=r}while(t.IndexOf(" ")!=-1)t=t.replace(" ","&nbsp;");while(t.IndexOf("<")!=-1)t=t.replace("<","&lt;");while(t.IndexOf(">")!=-1)t=t.replace(">","&gt;");return t},Utility.DecodingFromHTML=function(t){while(t.IndexOf("&nbsp;")!=-1)t=t.replace("&nbsp;"," ");while(t.IndexOf("&lt;")!=-1)t=t.replace("&lt;","<");while(t.IndexOf("&gt;")!=-1)t=t.replace("&gt;",">");if(t.IndexOf("&amp;")!=-1){var n=t,r="";while(n.IndexOf("&amp;")!=-1){var i=n.IndexOf("&amp;");n=n.replace("&amp;","&"),r+=n.Substring(0,i+1),n=n.Substring(i+1,n.GetLength())}n.IndexOf("&amp;")==-1&&n!=""&&(r+=n),t=r}return t},Utility.IsStandCompliantModeOn=function(){return Utility.IsIE()?document.compatMode=="CSS1Compat":document.compatMode=="CSS1Compat"||document.compatMode=="BackCompat"},Utility.GetPageZoomRate=function(){if(Utility.IsIE()&&Utility.engine===8)return screen.deviceXDPI/screen.logicalXDPI;var t=document.getElementById("gcsh_standard_control_for_get_normal_position");if(typeof t!="undefined"&&t!=null)return document.getElementById("gcsh_standard_control_for_get_normal_position").offsetLeft/100;var n=document.createElement("div");return document.body.appendChild(n),n.id="gcsh_standard_control_for_get_normal_position",n.style.visibility="hidden",n.style.left="100px",n.style.top="1px",n.style.width="1px",n.style.height="1px",n.style.position="absolute",document.getElementById("gcsh_standard_control_for_get_normal_position").offsetLeft/100},Utility.GetElementPosition=function(t){if(Utility.IsIE()||Utility.chrome||Utility.safari){if(Utility.engine>=8){var n=Utility.GetElementPositionForIE8(t);if(n.Left==0&&n.Top==0){var r=Utility.GetElementPositionForFireFox(t);return r}return n}var i=Utility.GetElementPositionForIE(t);return{Left:i.Left,Top:i.Top}}return Utility.GetElementPositionForFireFox(t)},Utility.GetElementPositionForIE8=function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var r=0,i=0;if(n==null||n.self||n.nodeType===9)return{Left:i,Top:r};var s=n.getBoundingClientRect();if(!s)return{Left:i,Top:r};var o=n.ownerDocument.documentElement,i=s.left+o.scrollLeft,r=s.top+o.scrollTop;try{var u=n.ownerDocument.parentWindow.frameElement||null;if(u){var a=u.frameBorder==="0"||u.frameBorder==="no"?2:0;i+=a,r+=a}}catch(f){}return{Left:i,Top:r}},Utility.GetElementPositionForIE=function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var r=0,i=0;if(n==null)return{Left:i,Top:r};if(n.offsetParent)while(n.offsetParent!=null){var s=n.offsetParent,o=s.tagName.toLowerCase();o!="table"&&o!="body"&&o!="html"&&s.clientTop&&s.clientLeft&&(i+=s.clientLeft,r+=s.clientTop);if(Utility.engine==7&&s.style.position.toLowerCase()=="relative"){i+=n.offsetLeft-n.scrollLeft,r+=n.offsetTop;var u=Utility.GetPageZoomRate();if(u==1){var a=n.offsetTop;for(var f=0;f<s.children.length;f++){var l=s.children[f];if(l==n)break;if(l.offsetTop){a=l.offsetTop;break}}r-=a}}else if(!Utility.IsStandCompliantModeOn()||Utility.engine!=7||n.style.position.toLowerCase()!="absolute"&&n.style.position.toLowerCase()!="relative")n.tagName.toLowerCase()=="input"&&n.type.toLowerCase()=="text"||n.tagName.toLowerCase()=="textarea"?(r+=n.offsetTop,i+=n.offsetLeft):(r+=n.offsetTop-n.scrollTop,i+=n.offsetLeft-n.scrollLeft);else{var u=Utility.GetPageZoomRate();r+=(n.offsetTop-n.scrollTop)/u,i+=(n.offsetLeft-n.scrollLeft)/u}n=s}else n.left&&n.top?(i+=n.left,r+=n.top):(n.x&&(i+=n.x),n.y&&(r+=n.y));if(n.style.position.toLowerCase()!="relative"&&n.style.position.toLowerCase()!="absolute"&&n.tagName.toLowerCase()=="body"&&Utility.IsStandCompliantModeOn())if(Utility.engine!=7)r+=n.offsetTop,i+=n.offsetLeft;else{var c=parseInt(n.currentStyle.marginTop),h=parseInt(n.currentStyle.marginLeft);isNaN(c)&&(c=0),isNaN(h)&&(h=0),r+=c,i+=h}return{Left:i,Top:r}},Utility.GetElementPositionForFireFox=function(t){var n=t;typeof t=="string"&&(n=document.getElementById(t));var r=0,i=0,s=0,o=0;if(n==null)return{Left:i,Top:r};if(n.offsetParent)while(n.offsetParent!=null){var u=n.offsetParent.tagName.toLowerCase();u!="table"&&u!="body"&&u!="html"&&u!="div"&&n.offsetParent.clientTop&&n.offsetParent.clientLeft&&(i+=n.offsetParent.clientLeft,r+=n.offsetParent.clientTop),r+=n.offsetTop,i+=n.offsetLeft,n=n.offsetParent}else n.left&&n.top?(i+=n.left,r+=n.top):(n.x&&(i+=n.x),n.y&&(r+=n.y));n=t,typeof t=="string"&&(n=document.getElementById(t));if(n.parentElement)while(n.parentElement!=null&&n.tagName.toLowerCase()!="html")o+=n.scrollTop,s+=n.scrollLeft,n=n.parentElement;return r-=o,i-=s,n.style.position.toLowerCase()!="relative"&&n.style.position.toLowerCase()!="absolute"&&n.tagName.toLowerCase()=="body"&&Utility.IsStandCompliantModeOn()&&(r+=n.offsetTop,i+=n.offsetLeft),{Left:i,Top:r}},Utility.MeasureText=function(t,n){if(Utility.MeasureElement===undefined){var r=document.createElement("div");r.style.position="absolute",r.style.border="solid 0px",r.style.left="-100000px",r.style.top="-100000px";var i=window.document.createTextNode("");r.appendChild(i),document.body.appendChild(r),Utility.MeasureElement=r,Utility.MeasureTextElement=i}var r=Utility.MeasureElement,i=Utility.MeasureTextElement;if(document!=null){var s=document.body.contains(n);s||document.body.appendChild(n);var o=n.currentStyle||window.getComputedStyle(n,null);r.style.fontFamily=o.fontFamily,r.style.fontSize=o.fontSize,r.style.fontStyle=o.fontStyle,r.style.fontWeight=o.fontWeight,s||document.body.removeChild(n)}var u=null;if(typeof t=="string")i.nodeValue=t,u={Width:r.clientWidth,Height:r.clientHeight};else{u=[];for(var a=0;a<t.length;a++)i.nodeValue=t[a],u.push({Width:r.clientWidth,Height:r.clientHeight})}return u},Utility.GetOSDefaultFontFamily=function(){switch(Utility.GetClientOS().toLowerCase()){case"winxp":return"MS UI Gothic";case"vista":return"\u00a5\u00e1\u00a5\u00a4\u00a5\u00ea\u00a5\u00aa";case"win7":return"\u00a5\u00e1\u00a5\u00a4\u00a5\u00ea\u00a5\u00aa";case"win8":return"Meiryo UI";case"win2003":return"MS UI Gothic";case"win2000":return"MS UI Gothic"}return"MS UI Gothic"},Utility.IsTouchSupport=function(){return window.navigator.userAgent.toLowerCase().indexOf("touch")!=-1},Utility.DisabledHoldVisual=function(t){t!==null&&t!==undefined&&Utility.IsTouchSupport()&&Utility.IsIE10OrLater()&&(t.addEventListener("MSHoldVisual",function(e){e.preventDefault()},!1),t.addEventListener("MSGestureHold",function(e){e.preventDefault()},!1),t.addEventListener("contextmenu",function(e){e.preventDefault()},!1))},Utility.IsMouseDownOnClearButton=function(t){if(!Utility.IsIE10OrLater())return!1;for(var n=0;n<document.styleSheets.length;n++){var r=document.styleSheets[n];for(var i=0;i<r.cssRules.length;i++)if(r.cssRules[i].selectorText=="::-ms-clear"&&r.cssRules[i].style.display=="none")return!1}var s=t.offsetX,o=t.offsetY,u=t.srcElement||t.target,a=u.clientWidth,f=u.clientHeight,l=parseInt(u.currentStyle.paddingLeft),c=parseInt(u.currentStyle.paddingRight);if(u.readOnly||t.button!=MouseButton.Left)return!1;if(a-f+l+c<Utility.GetClearButtonShowThreshold(u))return!1;var h=a-f;return s>h&&s<=a&&o>=0&&o<f?!0:!1},Utility.GetClearButtonShowThreshold=function(t){var n=Utility.MeasureText("ABCDQ",t).Height,r=4.3604432*n-.76207324;return r=Math.round(r),r},Utility.IsFocusFromIMControl=function(t,n){try{var r=n.fromElement;while(r!=null){if(r.id==t||r.id==t+this.Hold+"_DropDownObj"||r.id==t+"_DropDown_Container"||r.id==t+"_ContextMenu"||r.id==t+"_HistoryList"||r.id==t+"_EditField"||r.id==t+"_BorderContainer"||r.id==t+"_DropDown_EditField")return!0;r=r.parentNode}return!1}catch(i){return!1}},Utility.IsFocusToIMControl=function(t,n){try{var r=n.toElement;while(r!=null){if(r.id==t||r.id==t+this.Hold+"_DropDownObj"||r.id==t+"_DropDown_Container"||r.id==t+"_ContextMenu"||r.id==t+"_HistoryList"||r.id==t+this.Hold+"_DropDownObj_PopupMonth"||r.id==t+"_EditField"||r.id==t+"_BorderContainer"||r.id==t+"_DropDown_EditField")return!0;r=r.parentNode}return!1}catch(i){return!1}},Utility.Trim=function(t){if(t=="")return"";var n=0,r=0;for(var i=0;i<t.length;i++)if(t.CharAt(i)!=" "&&t.CharAt(i)!="\u00a1\u00a1"){n=i;break}for(var i=t.length-1;i>=0;i--)if(t.CharAt(i)!=" "&&t.CharAt(i)!="\u00a1\u00a1"){r=i+1;break}try{var s=t.Substring(n,r);return s}catch(o){return t}},Utility.GetBrowserType=function(){var t=navigator.userAgent.toLowerCase();if(t.indexOf("msie")!=-1)Utility.ie=t.match(/msie ([\d.]+)/)[1];else if(t.indexOf("chrome")!=-1)Utility.chrome=t.match(/chrome\/([\d.]+)/)[1];else if(t.indexOf("safari")!=-1){var n=t.match(/version\/([\d.]+)/);n&&(Utility.safari=n[1])}else t.indexOf("firefox")!=-1?Utility.firefox=t.match(/firefox\/([\d.]+)/)[1]:t.indexOf("opera")!=-1&&(Utility.opera=t.match(/opera.([\d.]+)/)[1]);t.indexOf("ipad")!=-1&&(Utility.IPad=!0),Utility.engine=null,window.navigator.appName=="Microsoft Internet Explorer"&&(document.documentMode?Utility.engine=document.documentMode:(Utility.engine=5,document.compatMode&&document.compatMode=="CSS1Compat"&&(Utility.engine=7),Utility.ie&&Utility.ie.indexOf("6")==0&&(Utility.engine=6))),t.indexOf("rv:")!==-1&&t.indexOf("firefox")===-1&&(Utility.ie=Utility.engine=t.match(/rv:([\d.]+)/)[1])},Utility.GetTouchPath=function(t,n){return t===-1||n===-1?"Error":t>n?t-n>20?"ToTop":"NotMove":t<n?n-t>20?"ToBottom":"NotMove":"NotMove"},Utility.IsPad=function(){var t=Utility.IPad||Utility.GetClientOS().toLowerCase()=="android";return t},Utility.IsJapan=function(){return navigator.userLanguage?navigator.userLanguage.indexOf("ja")!=-1:navigator.language?navigator["language"].indexOf("ja")!=-1:!1},Utility.IsFireFox4OrLater=function(){return Utility.firefox!=null&&parseFloat(Utility.firefox)>=4},Utility.IsIE11OrLater=function(){return Utility.IsIE()&&Utility.engine>=11},Utility.IsIE10OrLater=function(){return Utility.IsIE()&&Utility.engine>=10},Utility.IsIE9OrLater=function(){return Utility.IsIE()&&Utility.engine>=9},Utility.IsIE8OrLater=function(){return Utility.IsIE()&&Utility.engine>=8},Utility.IsIE8OrBelow=function(){return Utility.IsIE()&&Utility.engine<=8},Utility.IsIE8=function(){return Utility.IsIE()&&Utility.engine==8},Utility.IsIE7=function(){return Utility.IsIE()&&Utility.engine==7},Utility.IsIE7OrLater=function(){return Utility.IsIE()&&Utility.engine>=7},Utility.IsIE=function(){return Utility.ie!==undefined},Utility.IsIE9=function(){return Utility.IsIE()&&Utility.engine==9},Utility.GetClientOS=function(){var t;if(!Utility.IsIE()){var n=navigator.userAgent,r=n.indexOf("("),i=n.indexOf(")");t=n.substring(r+1,i)}else t=navigator.appVersion;return t.indexOf("NT 6.0")!=-1?"vista":t.indexOf("NT 5.2")!=-1?"win2003":t.indexOf("NT 5.1")!=-1?"winxp":t.indexOf("NT 5.0")!=-1?"win2000":t.indexOf("NT 6.1")!=-1?"Win7":t.indexOf("NT 6.2")!=-1?"Win8":t.indexOf("NT 6.3")!=-1?"Win8":t.indexOf("Android")!=-1?"Android":"unknow"},Utility.CreateStyleElement=function(t){var n=document.createElement("style");return n.id=t,n.type="text/css",n},Utility.CreateClassStyle=function(t){return Utility.CreateSelectorStyle("."+t)},Utility.CreateSelectorStyle=function(t){var n=document.getElementById("tableStyle");n==null&&(n=this.CreateStyleElement("tableStyle"),document.body.appendChild(n));var r=n.sheet||n.styleSheet,i=r.cssRules||r.rules;return r.insertRule?r.insertRule(t+"{ }",i.length):r.addRule(t,"{ }",i.length),i.item(i.length-1)},Utility.SetSelection=function(t,n,r,i){$(t).wijtextselection(Math.min(n,r),Math.max(n,r))},Utility.PreventDefault=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},Utility.CancelBubble=function(t){t.cancelBubble!==undefined?t.cancelBubble=!0:t.stopPropagation()},Utility.DragDrop=function(t){try{t.dragDrop(!0)}catch(n){}},Utility.GetMouseButton=function(t){var n=MouseButton.Default,r=Utility.IsIE8OrBelow()?1:0;return t.button==r?n=MouseButton.Left:t.button==1?n=MouseButton.Middle:t.button==2&&(n=MouseButton.Right),n},Utility.GetMouseWheelValue=function(t,n){return Utility.IsFireFox4OrLater()?-n.detail/3:(n.wheelDelta>=120?t++:n.wheelDelta<=-120&&t--,t)},Utility.SetCopy=function(t,n){var r;try{if(t==null||t==""){document.selection&&(r=document.selection.createRange().text);if(r=="")return}}catch(i){}t!=null&&(r=t),Utility.CopyDataToClipBoard(r,n)},Utility.CopyDataToClipBoard=function(t,n){if(n==0){Utility.SavedText=t;return}window.clipboardData?setTimeout(function(){try{window.clipboardData.setData("Text",t)}catch(e){}},0):Utility.CutCopyPasteEventObject!==null&&Utility.CutCopyPasteEventObject.clipboardData!==undefined&&Utility.CutCopyPasteEventObject.clipboardData.setData("text",t)},Utility.SetZoomStyle=function(t,n,r){if(t===undefined||t===null)return;var i="top left";r===DropDownAlign.Right&&(i="top right"),Utility.firefox?(t.style.MozTransformOrigin=n===""?"":i,t.style.MozTransform=n===""?"":"scale("+n+")",t.setAttribute("ZoomValue",n)):Utility.chrome||Utility.safari?n!==""?(t.style.MozTransform="scale("+n+")",t.style.WebkitTransform="scale("+n+")",t.style.webkitTransformOrigin=i):(t.style.MozTransform="",t.style.WebkitTransform="",t.style.WebkitTransformOrigin=""):Utility.IsIE9OrLater()?n!==""?(t.style.msTransform="scale("+n+")",t.style.msTransformOrigin=i):(t.style.msTransform="",t.style.msTransformOrigin=""):t.style.zoom=n},Utility.FilterText=function(t,n){if(n.GetLength()==0)return"";var r="",i=0,s=0;for(i=0;i<n.GetLength();i++){var o=!1;for(s=0;s<t.GetLength();s++)n.Substring(i,i+1)==t.Substring(s,s+1)&&(o=!0);o==1&&(r+=n.Substring(i,i+1))}return r},Utility.IndexOfAny=function(t,n,r){if(r>=t.length)return-1;for(var i=r;i<t.length;i++)for(var s=0;s<n.length;s++)if(t.charAt(i)==n[s])return i;return-1},Utility}();input.Utility=Utility,Utility.GetBrowserType(),function(e){e._map=[],e.None=0,e.Click=1,e.ContextMenu=2,e.ClientEvent=3,e.KeyExit=4,e.Default=5,e.SpinButton=6,e.DropDown=7,e.ImeInput=8,e.Left=9,e.Right=10,e.DragDrop=11}(input.FocusType||(input.FocusType={}));var FocusType=input.FocusType;(function(e){e._map=[],e.Default=0,e.Era=1,e.Year=2,e.Month=3,e.Day=4,e.AMPM=5,e.Hour=6,e.Minute=7,e.Second=8})(input.DateCursorPosition||(input.DateCursorPosition={}));var DateCursorPosition=input.DateCursorPosition;(function(e){e._map=[],e.NoControl=0,e.Filter=1,e.Cut=2})(input.CrLfMode||(input.CrLfMode={}));var CrLfMode=input.CrLfMode;(function(e){e._map=[],e.IncludeLiterals=0,e.ExcludeLiterals=1})(input.ClipContent||(input.ClipContent={}));var ClipContent=input.ClipContent;(function(e){e._map=[],e.Insert=0,e.Overwrite=1,e.FixedInsert=2,e.FixedOverwrite=3})(input.EditMode||(input.EditMode={}));var EditMode=input.EditMode;(function(e){e._map=[],e.Always=1,e.PostDisplay=2,e.PreDisplay=3})(input.ShowLiterals||(input.ShowLiterals={}));var ShowLiterals=input.ShowLiterals;(function(e){e._map=[],e.None=0,e.Left=1,e.Right=2,e.Both=3})(input.ExitOnLeftRightKey||(input.ExitOnLeftRightKey={}));var ExitOnLeftRightKey=input.ExitOnLeftRightKey;(function(e){e._map=[],e.None=0,e.Field=1,e.All=2})(input.HighlightText||(input.HighlightText={}));var HighlightText=input.HighlightText;(function(e){e._map=[],e.Default=-1,e.Left=0,e.Middle=1,e.Right=2})(input.MouseButton||(input.MouseButton={}));var MouseButton=input.MouseButton;(function(e){e._map=[],e.Left=1,e.Right=2})(input.DropDownAlign||(input.DropDownAlign={}));var DropDownAlign=input.DropDownAlign;(function(e){e._map=[],e._map[0]="Automatic",e.Automatic=0,e._map[1]="Fixed",e.Fixed=1})(input.ScrollBarMode||(input.ScrollBarMode={}));var ScrollBarMode=input.ScrollBarMode;(function(e){e._map=[],e._map[0]="None",e.None=0,e._map[1]="Horizontal",e.Horizontal=1,e._map[2]="Vertical",e.Vertical=2,e._map[3]="Both",e.Both=3})(input.ScrollBars||(input.ScrollBars={}));var ScrollBars=input.ScrollBars;(function(e){e._map=[],e.Normal=0,e.Hover=1,e.Pressed=2,e.Focused=4,e.Disabled=8})(input.ControlStatus||(input.ControlStatus={}));var ControlStatus=input.ControlStatus;(function(e){e._map=[],e.Tab=1,e.ShiftTab=2,e.NextControl=3,e.PreviousControl=4,e.Right=5,e.Left=6,e.CtrlRight=7,e.CtrlLeft=8,e.CharInput=9})(input.ExitKeys||(input.ExitKeys={}));var ExitKeys=input.ExitKeys;(function(e){e._map=[],e.Control=0,e.Field=1})(input.TabAction||(input.TabAction={}));var TabAction=input.TabAction;(function(e){e._map=[],e.BackSpace=8,e.Tab=9,e.Clear=12,e.Enter=13,e.Shift=16,e.Control=17,e.Alt=18,e.Pause=19,e.Caps_Lock=20,e.Escape=27,e.Space=32,e.PageUp=33,e.PageDown=34,e.End=35,e.Home=36,e.Left=37,e.Up=38,e.Right=39,e.Down=40,e.Select=41,e.Print=42,e.Execute=43,e.Insert=45,e.Delete=46,e.Help=47,e.equalbraceright=48,e.exclamonesuperior=49,e.quotedbltwosuperior=50,e.sectionthreesuperior=51,e.dollar=52,e.percent=53,e.ampersand=54,e.slashbraceleft=55,e.parenleftbracketleft=56,e.parenrightbracketright=57,e.A=65,e.B=66,e.C=67,e.D=68,e.E=69,e.F=70,e.G=71,e.H=72,e.I=73,e.J=74,e.K=75,e.L=76,e.M=77,e.N=78,e.O=79,e.P=80,e.Q=81,e.R=82,e.S=83,e.T=84,e.U=85,e.V=86,e.W=87,e.X=88,e.Y=89,e.Z=90,e.KP_0=96,e.KP_1=97,e.KP_2=98,e.KP_3=99,e.KP_4=100,e.KP_5=101,e.KP_6=102,e.KP_7=103,e.KP_8=104,e.KP_9=105,e.KP_Multiply=106,e.KP_Add=107,e.KP_Separator=108,e.KP_Subtract=109,e.KP_Decimal=110,e.KP_Divide=111,e.F1=112,e.F2=113,e.F3=114,e.F4=115,e.F5=116,e.F6=117,e.F7=118,e.F8=119,e.F9=120,e.F10=121,e.F11=122,e.F12=123,e.F13=124,e.F14=125,e.F15=126,e.F16=127,e.F17=128,e.F18=129,e.F19=130,e.F20=131,e.F21=132,e.F22=133,e.F23=134,e.F24=135,e.Num_Lock=136,e.Scroll_Lock=137})(input.Key||(input.Key={}));var Key=input.Key,BaseUIProcess=function(){function e(){this.isMulSelected=!1,this.isDblClick=!1,this.isTriClick=!1,this.isOverWrite=!1,this.moveFocusExitOnLastChar=!1}return e.prototype.GetInputElement=function(){return this.Owner.GetInputElement()},e.prototype.GetElementId=function(){return this.Owner.GetInputElement().id},e.prototype.GetShowLiterals=function(){return this.Owner.GetShowLiterals!==undefined?this.Owner.GetShowLiterals():ShowLiterals.Always},e.prototype.SetCursorPositionAndSelection=function(e,t,n,r){var i={};if(e==1||e==HighlightText.All)i.SelectionStart=0,i.SelectionEnd=t.GetLength();return i},e.prototype.Clear=function(){return null},e.prototype.Focus=function(e){var t=e.Text,n=e.DisplayText,r=e.FocusType,i=e.Element,s=e.HighlightText,o=e.CursorPosition,u={};this.isMulSelected=!1,r==FocusType.Click&&(u.SelectionStart=Utility.GetCursorPosition(i),u.SelectionEnd=u.SelectionStart),u.Text=t,u.SelectionStart==-1?(u.SelectionStart=0,u.SelectionEnd=0):u.SelectionStart>u.Text.GetLength()?(u.SelectionStart=u.Text.GetLength(),u.SelectionEnd=u.Text.GetLength()):u.SelectionStart==n.GetLength()&&(u.SelectionStart=u.Text.GetLength(),u.SelectionEnd=u.Text.GetLength()),r==FocusType.Left&&o==DateCursorPosition.Default?(u.SelectionStart=0,u.SelectionEnd=0):r==FocusType.Right&&o==DateCursorPosition.Default&&(u.SelectionStart=u.Text.GetLength(),u.SelectionEnd=u.Text.GetLength());if(s==HighlightText.None&&o==DateCursorPosition.Default)return u;if(r==FocusType.ContextMenu)return u;var a=u.SelectionStart==null?e.SelectionStart:u.SelectionStart,f=this.SetCursorPositionAndSelection(s,u.Text,o,a);return f!=null&&(u.SelectionStart=f.SelectionStart,u.SelectionEnd=f.SelectionEnd,u.IsSelectionDeterminedByHighlightText=!0),u},e.prototype.LoseFocus=function(e){},e.prototype.MouseDown=function(e){var t={};return this.isTriClick=!1,this.isDblClick&&!Utility.GrapeCityTimeout&&e==MouseButton.Left&&(this.isTriClick=!0,t=this.SelectAll()),this.isDblClick=!1,t},e.prototype.MouseUp=function(e,t,n,r,i){var s={};return this.isTriClick?(Utility.SetSelection(e,t,n),null):i?(s=this.SelectAll(),Utility.SetSelection(e,s.SelectionStart,s.SelectionEnd),s):(s.SelectionStart=t,s.SelectionEnd=n,r==MouseButton.Left&&(s.SelectionStart=Utility.GetSelectionStartPosition(e),s.SelectionEnd=Utility.GetSelectionEndPosition(e)),s.SelectionStart!=s.SelectionEnd?this.isMulSelected=!0:this.isMulSelected=!1,s)},e.prototype.ProcessShortcutKey=function(e,t,n,r){var i={};switch(e){case"Clear":if(t)return i.System=!1,i;return this.Clear();case"NextControl":var s=this.MoveControl(this.GetInputElement(),!0,!1,"NextControl");return s!=null&&(i.EventInfo=s.EventInfo,i.FocusType=s.FocusType,i.FocusExit=!0),i.System=!1,i;case"PreviousControl":var s=this.MoveControl(this.GetInputElement(),!1,!1,"PreviousControl");return s!=null&&(i.EventInfo=s.EventInfo,i.FocusType=s.FocusType,i.FocusExit=!0),i.System=!1,i;case"NextField":return i=this.MoveField(n,!0),i;case"PreviousField":return i=this.MoveField(n,!1),i;case"NextField/NextControl":var i=this.MoveFieldAndControl(n,!0);return i;case"PreviousField/PreviousControl":var i=this.MoveFieldAndControl(n,!1);return i}},e.prototype.ProcessCharKeyInput=function(e,t,n,r,i){return null},e.prototype.ProcessNavigatorKeyInput=function(e,t,n,r,i,s,o,u){var a={};switch(e){case 45:return t==EditMode.FixedInsert?this.isOverWrite=!1:t==EditMode.FixedOverwrite?this.isOverWrite=!0:this.isOverWrite=!this.isOverWrite,a.Overwrite=this.isOverWrite,a.System=!1,this.Format.Fields.fieldCount==0&&(a.System=!0),a;case 8:a=this.ProcessBackSpace(i,s,r),a.System=!1;break;case 46:a=this.ProcessDelete(i,s,r),a.System=!1;break;case 196643:case 196644:case 196645:case 196647:case 65569:case 196641:case 65570:case 196642:if(e==65569||e==196641)e=196644;else if(e==65570||e==196642)e=196643;a.SelectionEnd=this.GetCaretPosition(s,e),this.isMulSelected=!0,a.System=!1;break;case 65582:case 65544:if(this.isMulSelected){if(!this.Owner._isSupportClipBoard()){a.System=!0;break}a=this.Cut(n,i,s)}else a=this.ProcessBackSpace(i,s);a.System=!1;break;case 65581:case 131158:if(this.Owner._isSupportClipBoard()){var f=Utility.GetPasteData(this.Owner?this.Owner.GetUseClipboard():!0);a=this.Paste(i,s,f,u),a.System=!1}else a.System=!0;break;case 65571:case 65572:case 65573:case 65575:case 65574:case 65576:this.isMulSelected=!0,a.SelectionEnd=this.GetCaretPosition(s,e),a.System=!1;break;case 131139:case 131117:this.Owner._isSupportClipBoard()?(this.Copy(n,i,s),a.System=!1):a.System=!0;break;case 131118:this.isMulSelected||(s=this.GetCaretPosition(s,e)),a=this.ProcessDelete(i,s),a.System=!1;break;case 131080:case 196616:this.isMulSelected||(s=this.GetCaretPosition(s,e)),a=this.ProcessBackSpace(i,s),a.System=!1;break;case 131137:a=this.SelectAll(),a.System=!1;break;case 131160:this.Owner._isSupportClipBoard()?(a=this.Cut(n,i,s),a.System=!1):a.System=!0;break;case 131162:a=this.Undo(),a.System=!1;break;case 131109:case 37:if(i==0&&(o==ExitOnLeftRightKey.Both||o==ExitOnLeftRightKey.Left)){var l=e==37?"Left":"CtrlLeft",c=this.MoveControl(this.GetInputElement(),!1,!0,l);return c!=null&&(a.EventInfo=c.EventInfo,a.FocusType=c.FocusType,a.FocusExit=!0),a};case 131108:case 131110:case 36:case 33:case 131105:if(e==33||e==131105)e=131108;a=this.ProcessLeftDirection(i,s,e),a.System=!1;break;case 131111:case 39:if(i==r.GetLength()&&(o==ExitOnLeftRightKey.Both||o==ExitOnLeftRightKey.Right)){var l=e==39?"Right":"CtrlRight",c=this.MoveControl(this.GetInputElement(),!0,!0,l);return c!=null&&(a.EventInfo=c.EventInfo,a.FocusType=c.FocusType,a.FocusExit=!0),a};case 131107:case 131112:case 35:case 34:case 131106:if(e==34||e==131106)e=131107;a=this.ProcessRightDirection(i,s,e),a.System=!1;break;default:a=null}return a},e.prototype.ProcessLeftDirection=function(e,t,n){},e.prototype.ProcessRightDirection=function(e,t,n){},e.prototype.KeyDown=function(e){var t=e.KeyCode,n=e.SelectionStart,r=e.SelectionEnd,i=e.Text,s=e.EditMode,o=e.KeyAction,u=e.ReadOnly,a=e.ClipContent,f=e.ExitOnLastChar,l=e.ExitOnLeftRightKey,c=e.TabAction,h={};switch(s){case EditMode.Insert:this.isOverWrite=!1;break;case EditMode.Overwrite:this.isOverWrite=!0;break;case EditMode.FixedInsert:this.isOverWrite=!1;break;case EditMode.FixedOverwrite:this.isOverWrite=!0}n!=r?this.isMulSelected=!0:this.isMulSelected=!1;switch(t){case 9:return h=this.ProcessTabKey(r,!0,c),h;case 65545:return h=this.ProcessTabKey(r,!1,c),h}if(o!=null)return this.ProcessShortcutKey(o,u,r,n);if(u){if(t==27||t==262182||t==262184||t==38||t==40)return null;if(t!=131117&&t!=131139&&t!=9&&t!=65545&&t!=131081&&t!=196617&&t!=131137&&t!=37&&t!=39&&t!=38&&t!=40)return h}if(this.Format.Fields.fieldCount==0){switch(t){case 45:return s==EditMode.FixedInsert?this.isOverWrite=!1:s==EditMode.FixedOverwrite?this.isOverWrite=!0:this.isOverWrite=!this.isOverWrite,h.Overwrite=this.isOverWrite,this.Format.Fields.fieldCount==0&&(h.System=!0),h;case 37:case 131109:if(n==0&&(l==ExitOnLeftRightKey.Both||l==ExitOnLeftRightKey.Left)){var p=t==37?"Left":"CtrlLeft",d=this.MoveControl(this.GetInputElement(),!1,!0,p);return d!=null&&(h.EventInfo=d.EventInfo,h.FocusType=d.FocusType,h.FocusExit=!0),h}break;case 39:case 131111:if(n==i.GetLength()&&(l==ExitOnLeftRightKey.Both||l==ExitOnLeftRightKey.Right)){var p=t==39?"Right":"CtrlRight",d=this.MoveControl(this.GetInputElement(),!0,!0,p);return d!=null&&(h.EventInfo=d.EventInfo,h.FocusType=d.FocusType,h.FocusExit=!0),h}}return null}var v=this.ProcessCharKeyInput(t,n,r,f,i);return v!=null?v:(h=this.ProcessNavigatorKeyInput(t,s,a,i,n,r,l,f),h)},e.prototype.KeyPress=function(e){},e.prototype.KeyUp=function(e){},e.prototype.ShowContextMenu=function(e,t){var n={};return t==""&&(n.SelectionStart=Utility.GetCursorPosition(e),n.SelectionEnd=n.SelectionStart),n},e.prototype.SelectStart=function(e,t,n){var r={};return t==""&&!this.isTriClick&&!this.isDblClick&&n!=MouseButton.Default&&(r.SelectionStart=Utility.GetCursorPosition(e),r.SetFalse=!0),r},e.prototype.DoubleClick=function(e){var t={},n=this.Format.Fields.GetFieldIndexByPos(e),r=this.Format.Fields.GetFieldRange(n.index);return t.SelectionStart=r.start,t.SelectionEnd=r.length+r.start,Utility.GrapeCityTimeout=!1,this.isDblClick=!0,this.isMulSelect=!0,setTimeout(function(){Utility.GrapeCityTimeout=!0},300),t},e.prototype.Undo=function(){},e.prototype.Cut=function(e,t,n){var r={};return t==n?r:(this.FireClientEvent("OnBeforeCut"),this.Copy(e,t,n),r=this.ProcessDelete(t,n),this.FireClientEvent("OnCut"),r)},e.prototype.Copy=function(t,n,r){var i=null,s=!0;if(t==ClipContent.ExcludeLiterals){var o=Math.abs(n-r),n=Math.min(n,r);if(o==0)return;i=this.Format.Fields.GetNonLiteralsText(n,o)}else!Utility.IsIE()||Utility.IsIE11OrLater()?i=Utility.GetSelectionText(this.Owner.GetInputElement()):i=document.selection.createRange().text;this.Owner&&(i=e.UpdateCrLfString(i,this.Owner.GetAcceptsCrlf()),s=this.Owner.GetUseClipboard()),Utility.IsIE()?setTimeout(function(){Utility.SetCopy(i,s)}):Utility.SetCopy(i,s)},e.prototype.Paste=function(e,t,n,r){},e.prototype.SelectAll=function(){var e={SelectionStart:0,SelectionEnd:0};e.SelectionStart=0;var t;return this.ID&&(t=this.GetShowLiterals()),t=="PostDisplay"||t=="PreDisplay"?e.SelectionEnd=Utility.FindIMControl(this.ID).GetText().GetLength():e.SelectionEnd=this.Format.Fields.GetLength(),this.isMulSelected=!0,e},e.prototype.FireEvent=function(e,t,n,r){if(Utility.FireEvent(e,t,n,r))return FocusType.ClientEvent},e.prototype.ProcessCharKey=function(e,t,n,r){var i={},s=Math.min(e,t),o=Math.abs(t-e),u={};i.start=s,i.success=!1;if(this.Format.Fields.GetFieldIndex(s).index==-1){var a={};return a.Name=this.Owner.InvalidInputEvent,a.Args=null,a.Type="invalidInput",i.EventInfo=a,i}var f=n.toString();if(o==0&&!this.isOverWrite)u=this.Format.Fields.Insert(s,f,!1);else if(o==0)if(s==this.Format.Fields.GetLength())u=this.Format.Fields.Insert(s,f,!1);else{var l=!1,c=this.Format.Fields.GetFieldIndexByPos(s),h=c.index,p=c.offset,d=this.Format.Fields.GetFieldRange(h);this.Format.Fields.GetFieldByIndex(h).fieldLabel=="PromptField"?s-p+d.length==this.Format.Fields.GetLength()?l=!1:(l=!0,o=d.length-p+1):(l=!0,o=n.GetLength());if(this.Format.Fields.GetFieldIndexByPos(s+o).index==-1){var a={};return a.Name=this.Owner.InvalidInputEvent,a.Args=null,a.Type="invalidInput",i.EventInfo=a,i}l?u=this.Format.Fields.Replace(s,o,f,!1):u=this.Format.Fields.Insert(s,f,!1)}else u=this.Format.Fields.Replace(s,o,f,!1);s=u.cursorPos;if(u.text!=""){var a={};return a.Name=this.Owner.InvalidInputEvent,a.Args=null,a.Type="invalidInput",i.EventInfo=a,i.start=s,i.success=!1,i}if(r==1)if(s==this.Format.Fields.GetLength())this.moveFocusExitOnLastChar=!0;else{var c=this.Format.Fields.GetFieldIndexByPos(s),h=c.index,p=c.offset;h==this.Format.Fields.fieldCount-1&&p==0&&this.Format.Fields.GetFieldByIndex(h).fieldLabel=="PromptField"&&(this.moveFocusExitOnLastChar=!0)}return i.start=s,i.success=!0,i},e.prototype.ProcessDeleteKey=function(e,t){var n=Math.min(e,t),r=Math.abs(e-t),i={};if(n==this.Format.Fields.GetLength()&&r==0)return i;var s,o=this.Format.Fields.GetFieldIndexByPos(n);s=o.index;if(s==-1)return i;if(r==0){if(this.Format.Fields.GetFieldByIndex(s).fieldLabel=="PromptField")return i;n=this.Format.Fields.Delete(n,1).cursorPos,i.SelectionStart=n,i.SelectionEnd=i.SelectionStart}else{var u,a;o=this.Format.Fields.GetFieldIndexByPos(n+r),u=o.offset,a=o.index;if(a==-1)return i;u==0&&a--;if(s==a&&this.Format.Fields.GetFieldByIndex(s).fieldLabel=="PromptField")return i;var f=this.Format.Fields.Delete(n,r);if(!f.isSucceed)return i;i.SelectionStart=f.cursorPos,i.SelectionStart==0&&this.Format.Fields.GetFieldByIndex(0).fieldLabel=="PromptField"&&(i.SelectionStart=this.Format.Fields.GetFieldByIndex(0).GetLength()),i.SelectionEnd=i.SelectionStart;var l,c,h=this.Format.Fields.GetFieldIndexByPos(i.SelectionStart);c=h.index,l=h.offset,l!=0&&this.Format.Fields.GetFieldByIndex(c).fieldLabel=="PromptField"&&(i.SelectionStart=i.SelectionStart-l+this.Format.Fields.GetFieldByIndex(c).GetLength(),i.SelectionEnd=i.SelectionStart)}return i},e.prototype.ProcessBackSpace=function(e,t,n){},e.prototype.ProcessDelete=function(e,t,n){},e.prototype.GetCaretPosition=function(e,t,n,r,i){var s=this.Format.Fields,o=s.GetFieldIndexByPos(e),u=o.index,a=o.offset,f,n,r,l=0;switch(t){case 36:case 65572:case 65574:return e<=n?0:n;case 35:case 65571:case 65576:return e>=r?s.GetLength():r;case 37:if(e==0)return 0;s.GetFieldByIndex(u).fieldLabel==i?a>0?e-=a:e--:a==0&&s.GetFieldByIndex(u-1).fieldLabel==i?e-=s.GetFieldRange(u-1).length:e--;break;case 39:if(e==s.GetLength())return e;if(s.GetFieldByIndex(u).fieldLabel==i){f=s.GetFieldRange(u),n=f.start,r=n+f.length;if(e<r)return r}else e++;break;case 131109:if(e==0||u==0)return 0;if(s.GetFieldByIndex(u).fieldLabel==i)f=s.GetFieldRange(u-1),e=f.start;else{if(a==0){for(l=u-1;l>=0;l--)if(s.GetFieldByIndex(l).fieldLabel!=i)return f=s.GetFieldRange(l),f.start;return 0}e-=a}break;case 196645:if(e==0||u==0)return 0;a==0?(f=s.GetFieldRange(u-1),e=f.start):e-=a;break;case 131111:if(e==s.GetLength()||u==s.fieldCount-1)return s.GetLength();if(s.GetFieldByIndex(u).fieldLabel!=i){for(l=u+1;l<s.fieldCount;l++)if(s.GetFieldByIndex(l).fieldLabel!=i)return f=s.GetFieldRange(l),f.start;return s.GetLength()}f=s.GetFieldRange(u+1),e=f.start;break;case 196647:if(e==s.GetLength()||u==s.fieldCount-1)return s.GetLength();f=s.GetFieldRange(u+1),e=f.start;break;case 131118:return e==s.GetLength()||s.GetFieldByIndex(u).fieldLabel==i?e:(f=s.GetFieldRange(u),f.start+f.length);case 131080:case 196616:if(e==0||s.GetFieldByIndex(u).fieldLabel==i&&u==0)return e;if(s.GetFieldByIndex(u).fieldLabel==i)return s.GetFieldRange(u-1).start;if(a==0){for(l=u-1;l>=0;l--)if(s.GetFieldByIndex(l).fieldLabel!=i)return f=s.GetFieldRange(l),f.start;return e}e-=a;break;case 196643:case 131107:case 131112:return s.GetLength();case 196644:case 131108:case 131110:return 0;case 65573:return e==0?0:--e;case 65575:return e==s.GetLength()?e:++e}return e},e.prototype.CompareShortcut=function(e,t){if(t.toString().IndexOf("|")==-1)return t==e?!0:!1;var n=null;while(n!=-1){n=t.toString().IndexOf("|");var r=t.toString().GetLength();if(t.Substring(0,n==-1?r:n)==e)return!0;t=t.Substring(n+1,r)}return!1},e.prototype.MoveControl=function(e,t,n,r){var i=Utility.GetElements(),s=null,o={};if(i.length<2)return null;var u=Utility.GetNextFocusableControl(e,i,t);r=="CharInput"||!Utility.IsIE()?(Utility.NextID=u,setTimeout(function(){Utility.SetElementFocus(u)},0)):Utility.SetElementFocus(u);if(n){var a=document.getElementById(u);if(a!=null&&(a.tagName.toLowerCase()=="textarea"||a.type=="text")&&Utility.IsIE()){var f=a.createTextRange();if(r=="Left"||r=="CtrlLeft")f.moveStart("character",a.value.length),f.select()}}var l={Key:ExitKeys.CharInput};switch(r){case"NextControl":l.Key=ExitKeys.NextControl;break;case"PreviousControl":l.Key=ExitKeys.PreviousControl;break;case"Right":l.Key=ExitKeys.Right;break;case"Left":l.Key=ExitKeys.Left;break;case"CtrlRight":l.Key=ExitKeys.CtrlRight;break;case"CtrlLeft":l.Key=ExitKeys.CtrlLeft;break;case"CharInput":l.Key=ExitKeys.CharInput}return s={},s.Name=this.Owner.KeyExitEvent,s.Args=l,s.Type="KeyExit",s!=null&&(o.EventInfo=s),o},e.prototype.MoveField=function(e,t){var n=this.Format.Fields.MoveField(e,t),r={};return n==-1?(r.NextPos=n,r):(r.SelectionStart=n,r.SelectionEnd=n,r)},e.prototype.ProcessTabKey=function(e,t,n){var r={Key:ExitKeys.Tab},i={};t?r.Key=ExitKeys.Tab:r.Key=ExitKeys.ShiftTab;var s={};return s.Name=this.Owner.KeyExitEvent,s.Args=r,s.Type="KeyExit",i.EventInfo=s,i.FocusType=FocusType.KeyExit,i.System=!0,i},e.prototype.MoveFieldAndControl=function(e,t){var n=this.MoveField(e,t);if(n.NextPos!=-1)return n;var r=t?"NextControl":"PreviousControl",i=this.MoveControl(this.GetInputElement(),t,!1,r);return i!=null&&(n.EventInfo=i.EventInfo,n.FocusType=i.FocusType,n.FocusExit=!0),n},e.prototype.DragStart=function(){},e.prototype.DragEnd=function(){},e.prototype.Drop=function(){},e.prototype.DragOver=function(){},e.prototype.GetKeyActionName=function(e,t){if(t==null)return null;var n=t,r=new Array,i=n.IndexOf(","),s=0;if(t!=""){while(i!=-1)r[s++]=n.Substring(0,i),n=n.Substring(i+1,n.GetLength()),i=n.IndexOf(",");r[s++]=n;for(var o=0;o<s;o+=2)if(this.IsKeyCodeContained(e,r[o+1]))return r[o]}return null},e.prototype.IsKeyCodeContained=function(e,t){var n=t,r=n.IndexOf("|");while(r!=-1){if(n.Substring(0,r)==e)return!0;n=n.Substring(r+1,n.GetLength()),r=n.IndexOf("|")}return n==e?!0:!1},e.prototype.FireClientEvent=function(e){},e.prototype.PerformSpin=function(e,t,n){},e.UpdateCrLfString=function(t,n){var r=t;if(t)if(n==CrLfMode.Filter)r=t.replace(new RegExp("[\r\n]","g"),"");else if(n==CrLfMode.Cut){var i=t.split(new RegExp("[\r\n]","g"));i.length>0?r=i[0]:r=""}return r},e.FilterReturnChar=function(t){return t!=null&&(t=t.replace(new RegExp("[\r]","g"),"")),t},e}();input.BaseUIProcess=BaseUIProcess;var InputUIUpdate=function(){function e(e){this.Owner=e}return e.prototype.SetLastClientValues=function(e){},e.prototype.GetText=function(){if(this.Owner.GetInputElement()!=null)return this.Owner.GetInputElement().value},e.prototype.SetText=function(e){if(this.GetText()==null)return;if(this.GetText().replace(/\r\n/g,"\n")==e.replace(/\r\n/g,"\n"))return;this.Owner.GetInputElement()!=null&&(this.Owner.GetInputElement().value=e)},e.prototype.SetFocus=function(){try{this.Owner.GetInputElement()!=null&&this.Owner.GetInputElement().focus()}catch(e){}},e.prototype.GetTextHAlign=function(){return this.Owner.GetInputElement()!==null?this.Owner.GetInputElement().style.textAlign:""},e.prototype.SetTextHAlign=function(e){if(this.Owner.GetInputElement()!==null){this.Owner.GetInputElement().style.textAlign=e;if(Utility.IsIE()){var t=this.Owner.GetInputElement().style.width,n=parseInt(t);isNaN(n)&&(n=120),this.Owner.GetInputElement().style.width=n+1+"px";var r=this;setTimeout(function(){r.InputElement.style.width=t},0)}}},e.prototype.SetForeColor=function(e){this.Owner.GetInputElement()!=null&&(this.Owner.GetInputElement().style.color=e)},e.prototype.WriteCssStyle=function(e){try{var t=document.getElementById("gcsh_InputManWeb_Style_Container");if(Utility.IsIE())t.styleSheet.cssText=e;else{var n=t.sheet;for(var r=n.cssRules.length-1;r>=0;r--)n.deleteRule(r);var i=e.split("}");for(var s=0;s<i.length;s++){var o=i[s],u=o.indexOf("{");if(u==-1)continue;var e=o.substring(u+1);if(e.length!=0){var a=o.substring(0,u);n.insertRule(a+"{"+e+"}",n.cssRules.length)}}}}catch(f){}},e.prototype.ClearCssStyle=function(){},e}();input.InputUIUpdate=InputUIUpdate;var GlobalEventHandler=function(){function e(){}return e.OnKeyDown=function(t,n,r){if(t.ImeMode===!0&&!Utility.IsIE8OrBelow())return;var i=n.keyCode;r&&(i|=524288);var s={};s.Shift=!1,s.Ctrl=!1,s.Alt=!1,n.shiftKey&&(s.Shift=!0),n.ctrlKey&&(s.Ctrl=!0),n.altKey&&(s.Alt=!0);var o=null;Utility.FuncKeysPressed=s;try{o=t.KeyDown(n)}catch(u){}if(o!=null&&o.KeyCode!=null){Utility.IsIE()&&(n.keyCode=o.KeyCode),Utility.IsIE()||(Utility.ShouldInvokeKeyPress=!1);return}o?Utility.IsIE()?n!=null&&(n.returnValue=!0):Utility.ShouldInvokeKeyPress=!0:(Utility.PreventDefault(n),Utility.IsIE()||(Utility.ShouldInvokeKeyPress=!1))},e.OnKeyPress=function(t,n){if(!(n.charCode!==118&&n.charCode!==120&&n.charCode!==99||!n.ctrlKey))return;if(Utility.IPad&&n.charCode>256)return;if(n.keyCode==46&&n.shiftKey)return;if(t.ImeMode===!0)return;var r=t;if(!Utility.IsIE()&&(n.charCode==0||!Utility.ShouldInvokeKeyPress)){if(!Utility.ShouldInvokeKeyPress||(n.keyCode==38||n.keyCode==40)&&r.Type!="Edit"){Utility.ShouldInvokeKeyPress=!0,Utility.PreventDefault(n),r!=null&&r.Type=="Edit"&&r.DropDownObj!=null&&r.DropDownObj.IsKeyFromDropDown&&(r.DropDownObj.IsKeyFromDropDown=!1);return}if(n.keyCode!=13||r.Type!="Edit")return}var i=n.keyCode||n.charCode;if(i!=13||r.Type=="Edit"){var s=String.fromCharCode(i);try{if(input.CharProcess.CharEx.IsSurrogate(s.charAt(0))){r.IsSurrogateKeyPressing=!0;return}}catch(o){}if(s!=null){var u=null;try{u=t.KeyPress(s,n)}catch(o){}}if(!u){Utility.PreventDefault(n);return}}},e.OnKeyUp=function(t,n){if(t.ImeMode===!0&&!Utility.IsIE8OrBelow())return;try{var r=t;if(r.IsSurrogateKeyPressing)try{if(r.InputElement!=null){var i=r.InputElement.value,s=r.InputElement.selectionStart,o=i.substr(s-2,s);r.KeyPress(o,n)}}finally{r.IsSurrogateKeyPressing=!1}Utility.FuncKeysPressed={Shift:n.shiftKey,Ctrl:n.ctrlKey,Alt:n.altKey},r.KeyUp(n)}catch(u){}},e.OnCompositionStart=function(t,n){try{t.CompositionStart(n)}catch(r){}},e.OnCompositionUpdate=function(t,n){try{t.CompositionUpdate(n)}catch(r){}},e.OnCompositionEnd=function(t,n){try{t.CompositionEnd(n)}catch(r){}},e.OnWebkitEditableContentChanged=function(t,n){try{t.WebkitEditableContentChanged(n)}catch(r){}},e.OnMouseOver=function(t,n){try{t.MouseOver&&t.MouseOver()}catch(r){}},e.OnMouseOut=function(t,n){try{t.MouseOut()}catch(r){}},e.OnMouseMove=function(t,n){try{t.MouseMove&&t.MouseMove(n)}catch(r){}},e.OnMouseDown=function(t,n){if(t.ImeMode&&t.ImeMode===!0&&!Utility.IsIE8OrBelow())return;try{t.MouseDown(n),Utility.IsIE()||(Utility.DragStartElementID=t)}catch(r){}},e.OnMouseUp=function(t,n){if(t.ImeMode&&t.ImeMode===!0&&!Utility.IsIE8OrBelow())return;try{if(t.MouseUpPointerType!=null&&t.MouseUpPointerType!==4&&t.MouseUpPointerType!=="mouse"){var r={};for(var i in n)r[i]=n[i];setTimeout(function(e){t.MouseUp(r)},300)}else t.MouseUp(n);Utility.IsIE()||(Utility.DragStartElementID="")}catch(s){}},e.OnSelectStart=function(t,n){Utility.InnerSelect===!0&&Utility.ShouldFireOnSelectStart==0&&Utility.CancelBubble(n);var r=Utility.GetSelectionText(t.GetInputElement());if(typeof r=="undefined"||r==null)r="";var i=null;try{i=t.SelectStart(r)}catch(s){}i==0&&Utility.PreventDefault(n)},e.OnDblClick=function(t,n){var r=null;try{r=t.DoubleClick()}catch(i){}r||Utility.PreventDefault(n)},e.OnHTML5BeforeCopy=function(t,n){try{Utility.CutCopyPasteEventObject=n?n.originalEvent:n,t.Copy(n)}catch(r){}finally{Utility.CutCopyPasteEventObject=null}},e.OnHTML5Cut=function(t,n){try{var r=t.GetInputElement(),i=r.value,s=r.selectionStart,o=r.selectionEnd;setTimeout(function(){r.value=i,r.selectionStart=s,r.selectionEnd=o,t.Cut(n)},0)}catch(u){}},e.OnHTML5Paste=function(t,n){try{if(Utility.chrome&&Utility.GetClientOS().toLowerCase()!=="android")Utility.CutCopyPasteEventObject=n?n.originalEvent:n,t.Paste(Utility.GetDataFromClipboard(!0)),Utility.PreventDefault(n);else{var r=t.SelectionStart,i=t.SelectionEnd;setTimeout(function(){Utility.GetClientOS().toLowerCase()==="android"&&(t.SelectionStart=r,t.SelectionEnd=i),t.isPasting=!0,t.ImeInput("DirectInput")},0)}}catch(s){}finally{Utility.CutCopyPasteEventObject=null}},e.OnMouseWheel=function(t,n){try{t.MouseWheel(n),t.ShouldCancelMouseWheelDefaultBehavior()&&Utility.PreventDefault(n)}catch(r){}},e.OnDragStart=function(t,n){try{t.DragStart()}catch(r){}},e.OnDragEnd=function(t,n){try{t.DragEnd(n)}catch(r){}},e.OnDrop=function(t,n){try{var r=n.originalEvent.dataTransfer.getData("Text");t.DragDrop(r,n)}catch(i){}},e.OnTouchStart=function(t,n){Utility.TouchStartTime=new Date,Utility.TouchStartEvt=n},e.OnTouchEnd=function(t,n){if(Utility.TouchStartTime!==undefined){Utility.TouchEndTime=new Date;var r=Utility.TouchEndTime.valueOf()-Utility.TouchStartTime.valueOf();if(r>1e3){var i="";try{i=Utility.GetSelectionText(t.GetInputElement())}catch(s){}t.ShowContextMenu(i,Utility.TouchStartEvt),t.GetEnabled()&&Utility.PreventDefault(n)}Utility.TouchStartTime=undefined,Utility.TouchEndTime=undefined}},e.OnDragEnter=function(t,n){try{t.DragEnter()}catch(r){}},e.OnDragLeave=function(t,n){try{t.DragLeave()}catch(r){}},e.OnSelect=function(t,n){try{t&&t.Focused&&t.Select()}catch(r){}},e.OnPropertyChanged=function(t,n){try{t.PropertyChange(n)}catch(r){}},e.OnMSPointerUp=function(t,n){t.MSPointerUp(n)},e.OnMSPointerDown=function(t,n){try{t.MSPointerDown(n)}catch(r){}},e.OnMSGestureTap=function(t,n){try{t.MSGestureTap(n)}catch(r){}},e.OnEditFieldFocus=function(t,n){if(Utility.IsFocusFromIMControl(t._id,n))if(Utility.IsIE()||Utility.HasGetFocus)return;Utility.IsOnFocus=!0,Utility.IsIE()||(Utility.HasGetFocus=!0),this.OnFocus(t,n)},e.OnEditFieldLoseFocus=function(n,r){try{var i=n;if(i!=null&&i.Type=="Edit"&&i.IsFocusToDropDownEdit){i.IsFocusToDropDownEdit=!1;return}if(Utility.IsFocusToIMControl(n._id,r))return;if(Utility.firefox){if(Utility.IsOnFocus&&Utility.IsIE()&&Utility.IsOnActivate&&Utility.IsOnActivateControlID==n._id){Utility.FocusToBorder!=null&&Utility.FocusToBorder==1&&(Utility.FocusToBorder=!1,i.SetInnerFocus());return}Utility.FocusToBorder=!1,Utility.IsIE()?Utility.IsOnFocus=!1:Utility.HasGetFocus=!1}e.OnLostFocus(n,r),Utility.FuncKeysPressed={Shift:!1,Ctrl:!1,Alt:!1}}catch(s){}},e.OnFocusOut=function(t,n){Utility.FocusToBorder=!1;if(Utility.IsIE()&&n.toElement){var r=n.toElement.id;r==t._id+"_Inside_Div_Container"&&(Utility.FocusToBorder=!0)}if(Utility.IsFocusToIMControl(t._id,n)){Utility.IsIE()&&Utility.engine>=9&&(Utility.IsOnActivate=!0,Utility.IsOnActivateControlID=t._id,Utility.IsOnFocus=!0);return}Utility.IsIE()&&Utility.IsOnActivate&&(Utility.IsOnActivate=!1,Utility.IsOnActivateControlID=""),Utility.IsOnFocus&&(Utility.IsOnFocus=!1)},e.OnActivate=function(t,n){Utility.IsOnActivate=!0,Utility.IsOnActivateControlID=t._id;if(Utility.IsFocusFromIMControl(t._id,n))return;Utility.IsOnActivate=!0,Utility.IsOnActivateControlID=t._id},e.OnDeActivate=function(t,n){if(Utility.IsFocusToIMControl(t._id,n))return;Utility.IsOnActivate=!1,Utility.IsOnActivateControlID="",Utility.IsOnFocus=!1},e.OnFocus=function(t,n){try{var r=function(){t.Focus(),t.Focused=!0,Utility.IsPad()&&(t.IPadSelectionRefreshTimer=setInterval(function(){t.Select()},400))};Utility.IsIE()?r.call(this):setTimeout(r,0)}catch(i){}},e.OnLostFocus=function(t,n){try{t.LoseFocus(n),t.Focused=!1,Utility.IsPad()&&clearInterval(t.IPadSelectionRefreshTimer)}catch(r){}},e}();input.GlobalEventHandler=GlobalEventHandler})(wijmo.input||(wijmo.input={}));var input=wijmo.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";function t(e,t){typeof t=="undefined"&&(t=2);var n=""+e+"";if(n.length>t)n=n.substr(n.length-t);else while(n.length<t)n="0"+n;return n}function J(e,t,n){if(e instanceof Date){t||(t="d"),n||(typeof t=="string"?n={}:n=t),typeof t=="string"&&(n.format=t),n.date=e;var r=new $(n),i=new V(r,n.format,!0);return i.toString()}return""}function Q(e,t,n){Globalize.findClosestCulture(t)&&(n=t,t=undefined);var r=Globalize.findClosestCulture(n).calendars.standard,i=r.patterns.d;t?t.length<=1?i=Z(t,r.patterns):i=t:i=r.patterns.d;var s=new $({}),o=new V(s,i,!0);return G(o.descriptors)?Y(e,o,r):Globalize.parseDate(e,i,n)}function G(e){for(var t=0;t<e.length;t++)if(e[t].type===n.EraYear||e[t].type===n.TwoEraYear||e[t].type===n.EraName||e[t].type===n.TwoEraName||e[t].type===n.ThreeEraName||e[t].type===n.EraYearBig)return!0;return!1}function Y(e,t,r){var i="",s="",o=0,u=0,a=1,f=1,l=1,c=0,h=0,p=0,d=function(){return o<e.length&&v+1<t.descriptors.length&&t.descriptors[v+1].type===n.liternal&&e.charAt(o)!==t.descriptors[v+1].liternal||v===t.descriptors.length-1&&o+1<=e.length};for(var v=0;v<t.descriptors.length;v++){var m=!1;for(;o<e.length;){i=e.charAt(o++),s+=i;for(var g=0;g<X.GetEraCount();g++){var y=s.toLocaleLowerCase()===X.GetEraShortNames()[g].toLowerCase()&&t.descriptors[v].type===n.EraName,b=s.toLocaleLowerCase()===X.GetEraAbbreviations()[g].toLowerCase()&&t.descriptors[v].type===n.TwoEraName,w=s.toLocaleLowerCase()===X.GetEraNames()[g].toLowerCase()&&t.descriptors[v].type===n.ThreeEraName;if(y||b||w){u=g,s="",m=!0;break}}if(m)break;if(t.descriptors[v].type===n.liternal&&t.descriptors[v].liternal===s){s="";break}switch(t.descriptors[v].type){case n.EraYear:case n.TwoEraYear:if(d())break;a=parseInt(s,10),isNaN(a)&&(a=1),s="",m=!0;break;case n.EraYearBig:if(d())break;s==="\u5143"?a=1:(a=parseInt(s,10),isNaN(a)&&(a=1)),s="",m=!0;break;case n.TwoDigitMonth:case n.Month:if(d())break;f=parseInt(s,10),isNaN(f)&&(f=1),s="",m=!0;break;case n.AbbreviatedMonthNames:if(d())break;for(var E=0;E<r.months.namesAbbr.length;E++)if(s.toLocaleLowerCase()===r.months.namesAbbr[E]){f=E+1,s="";break}m=!0;break;case n.MonthNames:if(d())break;for(var S=0;S<r.months.names.length;S++)if(s.toLocaleLowerCase()===r.months.names[S]){f=S+1,s="";break}m=!0;break;case n.TwoDigityDayOfMonth:case n.DayOfMonth:if(d())break;l=parseInt(s,10),isNaN(l)&&(l=1),s="",m=!0;break;case n.h:case n.hh:case n.H:case n.HH:if(d())break;c=parseInt(s,10),isNaN(c)&&(c=1),s="",m=!0;break;case n.m:case n.mm:if(d())break;h=parseInt(s,10),isNaN(h)&&(h=1),s="",m=!0;break;case n.s:case n.ss:if(d())break;p=parseInt(s,10),isNaN(p)&&(p=1),s="",m=!0;break;case n.ShortAmPm:case n.AmPm:if(d())break;for(var x=0;x<r.PM.length;x++)if(s.toLocaleLowerCase()===r.PM[x]){c+=12;break}s="",m=!0;break;case n.OneDigitYear:case n.TwoDigitYear:case n.FourDigitYear:case n.AbbreviatedDayNames:case n.DayNames:case n.AD:if(d())break;s="",m=!0;break;default:}if(m)break}}return X.ConvertToGregorianDate(u,a,f,l,c,h,p,!1)}function Z(e,t){var n=e;if(e&&e.length<=1)switch(e){case"":case"d":n=t.patterns.d;break;case"D":n=t.patterns.D;break;case"f":n=t.patterns.D+" "+t.patterns.t;break;case"F":n=t.patterns.D+" "+t.patterns.T;break;case"g":n=t.patterns.d+" "+t.patterns.t;break;case"G":n=t.patterns.d+" "+t.patterns.T;break;case"m":n=t.patterns.M;break;case"M":n=t.patterns.M;break;case"s":n=t.patterns.S;break;case"t":n=t.patterns.t;break;case"T":n=t.patterns.T;break;case"u":n=t.patterns.S;break;case"U":n=t.patterns.D+" "+t.patterns.T;break;case"y":n=t.patterns.Y;break;case"Y":n=t.patterns.Y;break;case"r":case"R":n="ddd, dd MMM yyyy HH:mm:ss G\\M\\T"}return n}function et(e,t,n,r,i){var s=Q(e,r,i);return s>=t&&s<=n}e.paddingZero=t,function(e){e._map=[],e.liternal=-1,e.OneDigitYear=1,e.TwoDigitYear=2,e.FourDigitYear=10,e.TwoDigitMonth=20,e.Month=25,e.AbbreviatedMonthNames=26,e.MonthNames=27,e.EraYear=70,e.TwoEraYear=71,e.EraName=72,e.TwoEraName=73,e.ThreeEraName=74,e.EraYearBig=75,e.AD=80,e.TwoDigityDayOfMonth=30,e.DayOfMonth=31,e.AbbreviatedDayNames=100,e.DayNames=101,e.h=45,e.hh=46,e.H=47,e.HH=48,e.ShortAmPm=250,e.AmPm=251,e.mm=50,e.m=51,e.ss=60,e.s=61}(e.DescriptorType||(e.DescriptorType={}));var n=e.DescriptorType,r=function(){function e(e,t){this.id=t,this.startIndex=0,this.name=null,this.type=n.liternal,this.maxLen=2,this.formatString="",this._txtProvider=e,this.startIndex=0}return e.prototype.getText=function(){return null},e.prototype.getRealText=function(e){return this._txtProvider.inputWidget.options.date==null?this.formatString:e},e.prototype.setText=function(e,t,n,r){return!1},e.prototype.inc=function(){},e.prototype.dec=function(){},e.prototype.needAdjustInsertPos=function(){return!0},e.prototype.reachMaxLen=function(){var e=this.getText();do{if(e.charAt(0)!=="0")break;e=e.slice(1)}while(e.length>0);return e.length>=this.maxLen},e}();e._iDateDescriptor=r;var i=function(e){function t(t,n){e.call(this,t,n),this.liternal="",this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){return this.liternal},t}(r),s=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getDate(),t=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();if(X.Equal(e,n))this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(t.valueOf()));else{var r=this._txtProvider.inputWidget._getInnerIncrement();this._txtProvider.setYear(this._txtProvider.getYear()+r,null,!0),this._txtProvider.getDate()>n&&this._txtProvider.setDate(new Date(n.valueOf()))}},t.prototype.dec=function(){var e=this._txtProvider.getDate(),t=this._txtProvider.inputWidget._getRealEraMinDate(),n=this._txtProvider.inputWidget._getRealEraMaxDate();if(X.Equal(e,t))this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(n.valueOf()));else{var r=this._txtProvider.inputWidget._getInnerIncrement();this._txtProvider.setYear(this._txtProvider.getYear()-r,null,!0),this._txtProvider.getDate()<t&&this._txtProvider.setDate(new Date(t.valueOf()))}},t}(r),o=function(e){function t(t,r){e.call(this,t,r),this.name="Era Year",this.formatString="e",this.type=n.EraYear}return __extends(t,e),t.prototype.getText=function(){var e=X.GetEraDate(this._txtProvider.getDate());return e.eraYear===-1?"":(e.eraYear=e.eraYear>99?99:e.eraYear,this.getRealText(String(e.eraYear)))},t.prototype.setText=function(e,t,n){if(isNaN(parseInt(e)))return!1;var r=this._txtProvider.getDate(),i=X.GetEraDate(r);if(i.eraYear!==-1){var s=parseInt(e);s>=X.GetEraYears()[i.era]&&(s=X.GetEraYears()[i.era]);var o=this._txtProvider.inputWidget.options.date==null;o&&(s=parseInt(e));var u=X.ConvertToGregorianDate(i.era,s,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!1);if(i.era<X.GetEraCount()-1){var a=X.GetEraDates()[i.era+1];u>a&&(s=X.GetEraYears()[i.era]-1,u=X.ConvertToGregorianDate(i.era,s,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!1))}return this._txtProvider.setDate(u),!0}return!1},t}(s),u=function(e){function r(t,r){e.call(this,t,r),this.name="Two Era Year",this.formatString="ee",this.type=n.TwoEraYear}return __extends(r,e),r.prototype.getText=function(){var e=X.GetEraDate(this._txtProvider.getDate());return e.eraYear===-1?"":(e.eraYear=e.eraYear>99?99:e.eraYear,this.getRealText(t(e.eraYear,2)))},r.prototype.setText=function(e,t,n){if(isNaN(parseInt(e)))return!1;var r=this._txtProvider.getDate(),i=X.GetEraDate(r);if(i.eraYear!==-1){var s=String(i.eraYear)+e,o=parseInt(s.substring(s.length-2,s.length));o>X.GetEraYears()[i.era]&&(o=X.GetEraYears()[i.era]);var u=this._txtProvider.inputWidget.options.date==null;u&&(o=parseInt(e));var a=X.ConvertToGregorianDate(i.era,o,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!1);if(i.era<X.GetEraCount()-1){var f=X.GetEraDates()[i.era+1];a>f&&(o=X.GetEraYears()[i.era]-1,a=X.ConvertToGregorianDate(i.era,o,r.getMonth()+1,r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),!1))}return this._txtProvider.setDate(a),!0}return!1},r}(s),a=function(e){function t(t,r){e.call(this,t,r),this.name="Era Year Big",this.formatString="E",this.type=n.EraYearBig}return __extends(t,e),t.prototype.getText=function(){var t=e.prototype.getText.call(this);return t==1?"\u5143":t},t}(o),f=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getDate(),t=X.GetEraDate(e);if(t.era===-1)return;var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();if(X.Equal(e,r))this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(n.valueOf()));else if(t.era>=X.GetEraCount()-1)this._txtProvider.setDate(new Date(r.valueOf()));else{var i=t.era+this._txtProvider.inputWidget._getInnerIncrement();i=i>X.GetEraCount()-1?X.GetEraCount()-1:i;var s=t.eraYear>X.GetEraYears()[i]?X.GetEraYears()[i]:t.eraYear,o=X.ConvertToGregorianDate(i,s,e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),!0);o=o==null?X.GetEraDates()[i]:o,o>r?this._txtProvider.setDate(new Date(r.valueOf())):this._txtProvider.setDate(o)}},t.prototype.dec=function(){var e=this._txtProvider.getDate(),t=X.GetEraDate(e);if(t.era===-1)return;var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();if(X.Equal(e,n))this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(new Date(r.valueOf()));else if(t.era==0)this._txtProvider.setDate(new Date(n.valueOf()));else{var i=t.era-this._txtProvider.inputWidget._getInnerIncrement();i=i<0?0:i;var s=t.eraYear>X.GetEraYears()[i]?X.GetEraYears()[i]:t.eraYear,o=X.ConvertToGregorianDate(i,s,e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),!0);o==null&&(o=new Date(X.GetEraDates()[i+1]),o.setDate(o.getDate()-1)),o>r?this._txtProvider.setDate(new Date(n.valueOf())):this._txtProvider.setDate(o)}},t}(r),l=function(e){function t(t,r){e.call(this,t,r),this.name="Era Name",this.formatString="g",this.type=n.EraName}return __extends(t,e),t.prototype.getText=function(){var e=X.GetEraDate(this._txtProvider.getDate());return e.era===-1?"":this.getRealText(X.GetEraSymbols()[e.era])},t.prototype.setText=function(e,t,n){var r=e.substr(e.length-1,1),i=0;for(i=0;i<X.GetEraCount();i++)if(r.toLowerCase()===X.GetEraShortcuts()[i].toLowerCase()||e.toLowerCase()===X.GetEraShortNames()[i].toLowerCase())break;if(i==X.GetEraCount())return!0;var s=this._txtProvider.getDate(),o=X.GetEraDate(s);if(o.era===-1)return!0;var u=o.eraYear>X.GetEraYears()[i]?X.GetEraYears()[i]:o.eraYear,a=X.ConvertToGregorianDate(i,u,s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),!0);a=a==null?X.GetEraDates()[i]:a;if(i<X.GetEraCount()-1){var f=X.GetEraDates()[i+1];a=a>f?f:a}return this._txtProvider.setDate(a),!0},t}(f),c=function(e){function t(t,r){e.call(this,t,r),this.name="Two Era Name",this.formatString="gg",this.type=n.TwoEraName}return __extends(t,e),t.prototype.getText=function(){var e=X.GetEraDate(this._txtProvider.getDate());return e.era===-1?"":this.getRealText(X.GetEraAbbreviations()[e.era])},t.prototype.setText=function(e,t,n){var r=e.substr(e.length-1,1),i=0;for(i=0;i<X.GetEraCount();i++)if(r.toLowerCase()===X.GetEraShortcuts()[i].toLowerCase()||e.toLowerCase()===X.GetEraShortNames()[i].toLowerCase()||e.toLowerCase()===X.GetEraAbbreviations()[i].toLowerCase())break;if(i==X.GetEraCount())return!0;var s=this._txtProvider.getDate(),o=X.GetEraDate(s);if(o.era===-1)return!0;var u=o.eraYear>X.GetEraYears()[i]?X.GetEraYears()[i]:o.eraYear,a=X.ConvertToGregorianDate(i,u,s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),!0);a=a==null?X.GetEraDates()[i]:a;if(i<X.GetEraCount()-1){var f=X.GetEraDates()[i+1];a=a>f?f:a}return this._txtProvider.setDate(a),!0},t}(f),h=function(e){function t(t,r){e.call(this,t,r),this.name="Three Era Name",this.formatString="ggg",this.type=n.ThreeEraName}return __extends(t,e),t.prototype.getText=function(){var e=X.GetEraDate(this._txtProvider.getDate());return e.era===-1?"":this.getRealText(X.GetEraNames()[e.era])},t.prototype.setText=function(e,t,n){var r=e.substr(e.length-1,1),i=0;for(i=0;i<X.GetEraCount();i++)if(r.toLowerCase()===X.GetEraShortcuts()[i].toLowerCase()||e.toLowerCase()===X.GetEraShortNames()[i].toLowerCase()||e.toLowerCase()===X.GetEraAbbreviations()[i].toLowerCase()||e.toLowerCase()===X.GetEraNames()[i].toLowerCase())break;if(i==X.GetEraCount())return!1;var s=this._txtProvider.getDate(),o=X.GetEraDate(s);if(o.era===-1)return!0;var u=o.eraYear>X.GetEraYears()[i]?X.GetEraYears()[i]:o.eraYear,a=X.ConvertToGregorianDate(i,u,s.getMonth()+1,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),!0);a=a==null?X.GetEraDates()[i]:a;if(i<X.GetEraCount()-1){var f=X.GetEraDates()[i+1];a=a>f?f:a}return this._txtProvider.setDate(a),!0},t}(f),p=function(e){function t(t,r){e.call(this,t,r),this.name="AD",this.formatString="A",this.type=n.AD}return __extends(t,e),t.prototype.getText=function(){return"A.D."},t}(r),d=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){e.prototype.inc.call(this);var t=this._txtProvider.getDate(),n=t.getFullYear(),r=t.getMonth(),i=t.getDate(),s=t.getHours(),o=t.getMinutes(),u=t.getSeconds(),a=r+this._txtProvider.inputWidget._getInnerIncrement(),f=X.DaysInMonth(n,a+1);i>f&&(i=f);var l=new Date(n,a,i,s,o,u);if(this._txtProvider._isEraFormatExist()){var c=this._txtProvider.inputWidget._getRealEraMinDate(),h=this._txtProvider.inputWidget._getRealEraMaxDate();l>=h?X.Equal(this._txtProvider.getDate(),h)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(c):this._txtProvider.setDate(h):this._txtProvider.setDate(l)}else{var c=this._txtProvider.inputWidget._getRealMinDate(),h=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(l,!0)?this._txtProvider.setDate(l):X.Equal(this._txtProvider.getDate(),h)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(c):this._txtProvider.setDate(h)}},t.prototype.dec=function(){e.prototype.inc.call(this);var t=this._txtProvider.getDate(),n=t.getFullYear(),r=t.getMonth(),i=t.getDate(),s=t.getHours(),o=t.getMinutes(),u=t.getSeconds(),a=r-this._txtProvider.inputWidget._getInnerIncrement(),f=X.DaysInMonth(n,a+1);i>f&&(i=f);var l=new Date(n,a,i,s,o,u);n==1&&(l.setFullYear(1),a<0&&l.setMonth(a));if(this._txtProvider._isEraFormatExist()){var c=this._txtProvider.inputWidget._getRealEraMinDate(),h=this._txtProvider.inputWidget._getRealEraMaxDate();l<c?X.Equal(this._txtProvider.getDate(),c)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(h):this._txtProvider.setDate(c):this._txtProvider.setDate(l)}else{var c=this._txtProvider.inputWidget._getRealMinDate(),h=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(l,!0)?this._txtProvider.setDate(l):X.Equal(this._txtProvider.getDate(),c)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(h):this._txtProvider.setDate(c)}},t.prototype.setText=function(e,t,n){parseInt(e)>12&&(e=e.substr(e.length-1,1));var r=this._txtProvider.setMonth(e,t,n);if(r&&this._txtProvider._isEraFormatExist()){var i=this._txtProvider.inputWidget._getRealEraMinDate(),s=this._txtProvider.inputWidget._getRealEraMaxDate(),o=this._txtProvider.getDate();o>s?this._txtProvider.setDate(s):o<i&&this._txtProvider.setDate(i)}return r},t}(r),v=function(e){function t(t,r){e.call(this,t,r),this.name="Two-digit month",this.formatString="MM",this.type=n.TwoDigitMonth}return __extends(t,e),t.prototype.getText=function(){var e=""+this._txtProvider.getMonth()+"";return this.getRealText(e.length===1?"0"+e:e)},t.prototype.setText=function(t,n,r){return t==="0"?!0:e.prototype.setText.call(this,t,n,r)},t}(d),m=function(e){function t(t,r){e.call(this,t,r),this.name="month",this.formatString="M",this.type=n.Month}return __extends(t,e),t.prototype.getText=function(){var e=""+this._txtProvider.getMonth()+"";return this.getRealText(e)},t}(d),g=function(e){function t(t,r){e.call(this,t,r),this.name="AbbreviatedMonthNames",this.formatString="MMM",this.type=n.AbbreviatedMonthNames,this.maxLen=n.AbbreviatedMonthNames}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getMonth(),t=this._txtProvider._getCulture();return this.getRealText(t.calendars.standard.months.namesAbbr[e-1])},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider.inputWidget._getCulture().calendars.standard;return r=this._txtProvider.findAlikeArrayItemIndex(i.months.namesAbbr,e),r===-1?!1:this._txtProvider.setMonth(r+1,t,n)},t}(d),y=function(e){function t(t,r){e.call(this,t,r),this.name="MonthNames",this.formatString="MMMM",this.type=n.MonthNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getMonth(),t=this._txtProvider._getCulture();return this.getRealText(t.calendars.standard.months.names[e-1])},t.prototype.setText=function(e,t,n){var r=-1,i;if(n&&n.isfullreset)r=1;else{i=this._txtProvider._getCulture(),r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.months.names,e);if(r===-1)return!1}return this._txtProvider.setMonth(r+1,t,n)},t}(d),b=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getDayOfMonth()+this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setDate(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t>r?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},t.prototype.dec=function(){var e=this._txtProvider.getDayOfMonth()-this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setDate(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t<n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r)}},t.prototype.setText=function(e,t,n){var r=this._txtProvider.getDate(),i=X.DaysInMonth(r.getFullYear(),r.getMonth()+1);parseInt(e)>i&&(e=i+"");var s=this._txtProvider.setDayOfMonth(e,t,n);if(s&&this._txtProvider._isEraFormatExist()){var o=this._txtProvider.inputWidget._getRealEraMinDate(),u=this._txtProvider.inputWidget._getRealEraMaxDate(),r=this._txtProvider.getDate();r>u?this._txtProvider.setDate(u):r<o&&this._txtProvider.setDate(o)}return s},t}(r),w=function(e){function r(t,r){e.call(this,t,r),this.name="Two-digit day of month",this.formatString="dd",this.type=n.TwoDigityDayOfMonth}return __extends(r,e),r.prototype.getText=function(){return this.getRealText(t(this._txtProvider.getDayOfMonth()))},r.prototype.setText=function(t,n,r){return t==="0"?!0:e.prototype.setText.call(this,t,n,r)},r}(b),E=function(e){function t(t,r){e.call(this,t,r),this.name="Day of month",this.formatString="d",this.type=n.DayOfMonth}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfMonth();return this.getRealText(""+e+"")},t}(b),S=function(e){function t(t,r){e.call(this,t,r),this.name="AbbreviatedDayNames",this.formatString="ddd",this.type=n.AbbreviatedDayNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfWeek(),t=this._txtProvider._getCulture();return this.getRealText(t.calendars.standard.days.namesAbbr[e-1])},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider._getCulture();return r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.days.namesShort,e),r===-1?!1:this._txtProvider.setDayOfWeek(r+1)},t.prototype.needAdjustInsertPos=function(){return!1},t}(b),x=function(e){function t(t,r){e.call(this,t,r),this.name="DayNames",this.formatString="dddd",this.type=n.DayNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfWeek(),t=this._txtProvider._getCulture();return this.getRealText(t.calendars.standard.days.names[e-1])},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider._getCulture();return r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.days.names,e),r===-1?!1:this._txtProvider.setDayOfWeek(r+1)},t.prototype.needAdjustInsertPos=function(){return!1},t}(b),T=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getYear()+this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setFullYear(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t>r?X.Equal(this._txtProvider.getDate(),r)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(r):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):X.Equal(this._txtProvider.getDate(),r)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(r)}},t.prototype.dec=function(){var e=this._txtProvider.getYear()- +this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setFullYear(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t<n?X.Equal(this._txtProvider.getDate(),n)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r):this._txtProvider.setDate(n):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):X.Equal(this._txtProvider.getDate(),n)?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r):this._txtProvider.setDate(n)}},t}(r),N=function(e){function n(t,n){e.call(this,t,n)}return __extends(n,e),n.prototype.setText=function(e,n,r){e=t(e);var i=t(this._txtProvider.getYear(),4),s,o,u,a,f;return e==="00"&&(s=this._txtProvider.getMonth(),o=this._txtProvider.getDayOfMonth(),u=this._txtProvider.getHours(),a=this._txtProvider.getMinutes(),f=this._txtProvider.getSeconds(),s===1&&o===1&&!u&&!a&&!f&&(i="0001",e="01")),i.length>=2&&(i=i.substr(0,2)+e.substr(0,2)),this._txtProvider.setYear(parseInt(i),r,!1)},n}(T),C=function(e){function r(t,r){e.call(this,t,r),this.name="Four-digit year",this.formatString="yyyy",this.type=n.FourDigitYear,this.maxLen=4}return __extends(r,e),r.prototype.getText=function(){return this.getRealText(t(this._txtProvider.getYear(),4))},r.prototype.setText=function(e,t,n,r){if(r&&n){e*=1,e%=100;var i=2e3;this._txtProvider.inputWidget.options.startYear&&(i=this._txtProvider.inputWidget.options.startYear);var s=i%100,o=i-s;e>=s?e=o+e:e=o+e+100}return this._txtProvider.setYear(e,n,!1)},r}(T),k=function(e){function r(t,r){e.call(this,t,r),this.name="One-digit year",this.formatString="y",this.type=n.OneDigitYear}return __extends(r,e),r.prototype.getText=function(){var e=t(this._txtProvider.getYear());return e[0]==="0"&&(e=e[1]),this.getRealText(e)},r}(N),L=function(e){function r(t,r){e.call(this,t,r),this.name="Two-digit year",this.formatString="yy",this.type=n.TwoDigitYear}return __extends(r,e),r.prototype.getText=function(){return this._txtProvider.inputWidget.isFocused()&&this._txtProvider.inputWidget.options.date==null?"yy":this.getRealText(t(this._txtProvider.getYear(),2))},r}(N),A=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getHours()+this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setHours(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t>r?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},t.prototype.dec=function(){var e=this._txtProvider.getHours()-this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setHours(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t<n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r)}},t}(r),O=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){var r=this._txtProvider.getHours();return r>12&&(e=e*1+12),this._txtProvider.setHours(e,t)},t}(A),M=function(e){function t(t,r){e.call(this,t,r),this.name="h",this.formatString="h",this.type=n.h}return __extends(t,e),t.prototype.getText=function(){if(this._txtProvider.inputWidget.isFocused()&&this._txtProvider.inputWidget.options.date==null)return"h";var e=this._txtProvider.getHours();return e>12?e-=12:e===0&&(e=12),e==12&&this._txtProvider.inputWidget.options.hour12As0&&(e=0),this.getRealText(""+e+"")},t}(O),_=function(e){function r(t,r){e.call(this,t,r),this.name="hh",this.formatString="hh",this.type=n.hh}return __extends(r,e),r.prototype.getText=function(){var e=this._txtProvider.getHours();return e>12?e-=12:e===0&&(e=12),e==12&&this._txtProvider.inputWidget.options.hour12As0&&(e=0),this.getRealText(t(e,2))},r}(O),D=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){return this._txtProvider.setHours(e,t)},t}(A),P=function(e){function t(t,r){e.call(this,t,r),this.name="H",this.formatString="H",this.type=n.H}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();return e==0&&!this._txtProvider.inputWidget.options.midnightAs0&&(e=24),this.getRealText(""+e+"")},t}(D),H=function(e){function r(t,r){e.call(this,t,r),this.name="HH",this.formatString="HH",this.type=n.HH}return __extends(r,e),r.prototype.getText=function(){var e=this._txtProvider.getHours();return e==0&&!this._txtProvider.inputWidget.options.midnightAs0&&(e=24),this.getRealText(t(e,2))},r}(D),B=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(e,!0)},t.prototype.dec=function(){var e=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(e,!0)},t.prototype.setText=function(e,t,n){var r;return e.toLowerCase().indexOf("a")>=0?(r=this._txtProvider.getHours()%12,this._txtProvider.setHours(r,!0)):e.toLowerCase().indexOf("p")>=0&&(r=this._txtProvider.getHours()%12+12,this._txtProvider.setHours(r,!0)),!0},t}(r),j=function(e){function t(t,r){e.call(this,t,r),this.name="t",this.formatString="t",this.type=n.ShortAmPm}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours(),t=this._txtProvider._getCulture(),n=this._txtProvider.inputWidget._getInnerAmDesignator(),r=this._txtProvider.inputWidget._getInnerPmDesignator(),i=e<12?n:r;return this.getRealText(i.charAt(0)||" ")},t}(B),F=function(e){function t(t,r){e.call(this,t,r),this.name="tt",this.formatString="tt",this.type=n.AmPm}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours(),t=this._txtProvider._getCulture(),n=this._txtProvider.inputWidget._getInnerAmDesignator(),r=this._txtProvider.inputWidget._getInnerPmDesignator(),i=e<12?n:r;return i.length<=0&&(i=" "),this.getRealText(i)},t}(B),I=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getMinutes()+this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setMinutes(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t>r?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},t.prototype.dec=function(){var e=this._txtProvider.getMinutes()-this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setMinutes(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t<n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r)}},t.prototype.setText=function(e,t,n){return n&&n.isfullreset&&(e="0"),this._txtProvider.setMinutes(e,t)},t}(r),q=function(e){function r(t,r){e.call(this,t,r),this.name="mm",this.formatString="mm",this.type=n.mm}return __extends(r,e),r.prototype.getText=function(){return this.getRealText(t(this._txtProvider.getMinutes()))},r}(I),R=function(e){function t(t,r){e.call(this,t,r),this.name="m",this.formatString="m",this.type=n.m,this.delta=12}return __extends(t,e),t.prototype.getText=function(){return this.getRealText(this._txtProvider.getMinutes().toString())},t}(I),U=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=this._txtProvider.getSeconds()+this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setSeconds(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t>r?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(n)}},t.prototype.dec=function(){var e=this._txtProvider.getSeconds()-this._txtProvider.inputWidget._getInnerIncrement(),t=new Date(this._txtProvider.getDate().valueOf());t.setSeconds(e);if(this._txtProvider._isEraFormatExist()){var n=this._txtProvider.inputWidget._getRealEraMinDate(),r=this._txtProvider.inputWidget._getRealEraMaxDate();t<n?this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r):this._txtProvider.setDate(t)}else{var n=this._txtProvider.inputWidget._getRealMinDate(),r=this._txtProvider.inputWidget._getRealMaxDate();this._txtProvider.inputWidget._isValidDate(t,!0)?this._txtProvider.setDate(t):this._txtProvider.inputWidget._getAllowSpinLoop()&&this._txtProvider.setDate(r)}},t.prototype.setText=function(e,t,n){return n&&n.isfullreset&&(e="0"),this._txtProvider.setSeconds(e,t)},t}(r),z=function(e){function r(t,r){e.call(this,t,r),this.name="ss",this.formatString="ss",this.type=n.ss}return __extends(r,e),r.prototype.getText=function(){return this.getRealText(t(this._txtProvider.getSeconds()))},r}(U),W=function(e){function t(t,r){e.call(this,t,r),this.name="s",this.formatString="s",this.type=n.s}return __extends(t,e),t.prototype.getText=function(){return this.getRealText(this._txtProvider.getSeconds().toString())},t}(U),X=function(){function e(){}return e.EraDates=new Array(new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)),e.EraCount=4,e.EraYears=new Array(45,15,64,99),e.EraMax=new Date(2087,11,31,23,59,59),e.EraMin=new Date(1868,8,8),e.EraKeys=new Array("1","2","3","4","m","t","s","h"),e.EraIndices=new Array(0,1,2,3,0,1,2,3),e.DateLongFormat="yyyyMMddHHmmss",e.EraNames=new Array("M","T","S","H","\u660e","\u5927","\u662d","\u5e73","\u660e\u6cbb","\u5927\u6b63","\u662d\u548c","\u5e73\u6210"),e.WeekDays=new Array("\u65e5\u66dc\u65e5","\u6708\u66dc\u65e5","\u706b\u66dc\u65e5","\u6c34\u66dc\u65e5","\u6728\u66dc\u65e5","\u91d1\u66dc\u65e5","\u571f\u66dc\u65e5"),e.MonthNames=new Array("1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"),e.ShortWeekDays=new Array("\u65e5","\u6708","\u706b","\u6c34","\u6728","\u91d1","\u571f"),e.ShortMonthNames=new Array("1","2","3","4","5","6","7","8","9","10","11","12"),e.RokuyouTextArray=new Array("\u5148\u52dd","\u53cb\u5f15","\u5148\u8ca0","\u4ecf\u6ec5","\u5927\u5b89","\u8d64\u53e3"),e.RokuyouTextArrayEn=new Array("Senshou","Tomobiki","Senbu","Butsumetsu","Taian","Shakkou"),e.DefaultTwoDigitYear=2029,e.Digits=2,e.EraYearMax=99,e.RokuyouMin=new Date(1960,0,28),e.RokuyouMax=new Date(2050,0,22),e.LunarInfo=new Array(44710,43856,19808,43748,42352,21104,29283,55632,27479,22176,39632,19925,19168,42208,54484,53840,54680,46400,54944,103846,38320,18864,43444,42160,45690,27216,27968,46934,11104,38320,19317,18800,25776,29859,59984,28056,21968,11104,38629,37600,51552,59732,54432,55888,30034,22208,43959,9680,37584,51893,43344,46240,111779,46416,21977,19360,42416,21877,21168,43344,47444,27296,44368,27474,19296,42726,42352,21104,27237,55600,23200,46755,38608,19415,19168,42192,118998,53840,54560,56645,46752,38608,21938,18864,42359,42160,45648,111189,27968,44448),e.IsValidEraDate=function(t){return t<this.GetEraMin()||t>this.GetEraMax()?!1:!0},e.ConvertToGregorianYear=function(t,n,r){return t<0||t>=this.GetEraCount()||n<1||r&&n>this.GetEraYears()[t]?-1:this.GetEraDates()[t].getFullYear()+n-1},e.GetEraDates=function(){if(window.eras!=undefined){var t=new Array;for(var n=0;n<window.eras.length;n++){var r=new Date(window.eras[n].startDate.replace(/-/g,"/"));t[n]=r}return t}return this.EraDates},e.GetEraNames=function(){var t=new Array;if(window.eras!=undefined){for(var n=0;n<window.eras.length;n++)t[n]=window.eras[n].name;return t}for(var n=0;n<this.EraCount;n++)t[n]=this.EraNames[n+2*this.EraCount];return t},e.GetEraSymbols=function(){var t=new Array;if(window.eras!=undefined){for(var n=0;n<window.eras.length;n++)t[n]=window.eras[n].symbol;return t}for(var n=0;n<this.EraCount;n++)t[n]=this.EraNames[n];return t},e.GetEraAbbreviations=function(){var t=new Array;if(window.eras!=undefined){for(var n=0;n<window.eras.length;n++)t[n]=window.eras[n].abbreviation;return t}for(var n=0;n<this.EraCount;n++)t[n]=this.EraNames[n+this.EraCount];return t},e.GetEraShortNames=function(){var t=new Array;if(window.eras!=undefined){for(var n=0;n<window.eras.length;n++)t[n]=window.eras[n].shortcuts.split(",")[1];return t}for(var n=0;n<this.EraCount;n++)t[n]=this.EraNames[n];return t},e.GetEraShortcuts=function(){var t=new Array;if(window.eras!=undefined){for(var n=0;n<window.eras.length;n++)t[n]=window.eras[n].shortcuts.split(",")[0];return t}for(var n=0;n<this.EraCount;n++)t[n]=this.EraKeys[n];return t},e.GetEraMax=function(){if(window.eras!=undefined&&window.eras.length>0){var t=new Date(window.eras[window.eras.length-1].startDate.replace(/-/g,"/"));return t.setFullYear(t.getFullYear()+99),t}return this.EraMax},e.GetEraMin=function(){if(window.eras!=undefined&&window.eras.length>0){var t=new Date(window.eras[0].startDate.replace(/-/g,"/"));return t}return this.EraMin},e.GetEraCount=function(){return window.eras!=undefined?window.eras.length:this.EraCount},e.GetEraYears=function(){if(window.eras!=undefined){var t=new Array;for(var n=1;n<window.eras.length;n++){var r=new Date(window.eras[n-1].startDate.replace(/-/g,"/")),i=new Date(window.eras[n].startDate.replace(/-/g,"/"));t[n-1]=i.getFullYear()-r.getFullYear()+1}return t[n-1]=99,t}return this.EraYears},e.ConvertToGregorianDate=function(t,n,r,i,s,o,u,a){var f=this.ConvertToGregorianYear(t,n,a);if(f<1||f>9999)return null;if(r<1||r>12)return null;var l=this.DaysInMonth(f,r);if(i<1||i>l)return null;if(s<0||s>23)return null;if(o<0||o>59)return null;if(u<0||u>59)return null;var c=new Date(f,r-1,i,s,o,u);if(a){var h=this.GetEraDates()[t],p=t+1!=this.GetEraCount()?this.AddMilliseconds(this.GetEraDates()[t+1],-1):this.GetEraMax();if(c<h||c>p)return null}return c},e.String2Date=function(t){if(t==null||t.Length==0)return null;var n=new Date(Date.parse(t));return n},e.ToString=function(t,n,r,i){var s=t+"";if(r!=null){while(s.length<n)i?s+=r:s=r+s;return s}while(s.length<n)s+=t+"";return s},e.Date2String=function(n,r,i,s){var o="";try{r==1?i==1?o=n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate():s==1?o=n.getHours()+":"+e.ToString(n.getMinutes(),2,"0")+":"+e.ToString(n.getSeconds(),2,"0"):o=n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+n.getHours()+":"+e.ToString(n.getMinutes(),2,"0")+":"+e.ToString(n.getSeconds(),2,"0"):i==1?o=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear():s==1?o=n.getHours()+":"+e.ToString(n.getMinutes(),2,"0")+":"+e.ToString(n.getSeconds(),2,"0"):o=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()+" "+n.getHours()+":"+e.ToString(n.getMinutes(),2,"0")+":"+e.ToString(n.getSeconds(),2,"0")}catch(u){o=""}return o},e.Date2Long=function(t){try{return(t.getFullYear()*100+t.getMonth()+1)*100+t.getDate()}catch(n){return 0}},e.Date2Number=function(t){return t==null?0:((((t.getFullYear()*100+t.getMonth()+1)*100+t.getDate())*100+t.getHours())*100+t.getMinutes())*100+t.getSeconds()},e.Long2Date=function(t){return new Date(Math.floor(t/1e4),Math.floor(t%1e4/100)-1,t%100)},e.GetEraDate=function(t){var n=new Object;n.era=-1,n.eraYear=-1;if(!this.IsValidEraDate(t))return n;for(var r=0;r<this.GetEraCount();r++){var i=r+1!=this.GetEraCount()?this.GetEraDates()[r+1]:this.AddMilliseconds(this.GetEraMax(),1);if(t<i){n.era=r,n.eraYear=t.getFullYear()-this.GetEraDates()[r].getFullYear()+1;break}}return n},e.MakeDate=function(t,n,r,i){var s=new Date;return s=this.ConvertToGregorianDate(t,n,r,i,0,0,0,!0),s==null?-1:s},e.GetValidMonthRange=function(t,n){var r={};return r.min=1,r.max=12,t==-1||n==-1?r:(n==1?r.min=this.GetEraDates()[t].getMonth()+1:n==this.EraYears[t]&&t<this.EraCount-1&&(r.max=this.AddMilliseconds(this.GetEraDates()[t+1],-1).getMonth()+1),r)},e.GetValidDayRange=function(t,n,r){var i=new Object;i.min=1,i.max=this.DaysInMonth(this.ConvertToGregorianYear(t,n,!0),r);var s=this.GetEraDates()[t],o=t<this.GetEraCount()-1?this.AddMilliseconds(this.GetEraDates()[t+1],-1):this.GetEraMax();return t==-1||n==-1?i:(n==1&&r==s.getMonth()+1?i.min=s.getDate():n==this.EraYears[t]&&r==o.getMonth()+1&&(i.max=o.getDate()),i)},e.IsLeapYear=function(t){return t%400==0||t%4==0&&t%100!=0?!0:!1},e.DayOfYear=function(t,n,r){var i=0;for(var s=1;s<n;s++)i+=this.DaysInMonth(t,s);return i+=r,i},e.DaysInMonth=function(t,n){if(n>12)t+=Math.floor(n/12),n%=12;else if(n<0){var r=n*-1;t-=Math.ceil(r/12),n=12-r%12}switch(n){case 2:return this.IsLeapYear(t)?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},e.Equal=function(t,n,r){if(t==null&&n==null)return!0;if(t==null)return!1;if(n==null)return!1;try{return r?t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()&&t.getDate()==n.getDate()&&t.getHours()==n.getHours()&&t.getMinutes()==n.getMinutes()&&t.getSeconds()==n.getSeconds()?!0:!1:t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()&&t.getDate()==n.getDate()?!0:!1}catch(i){return!1}},e.YearMonthEqual=function(t,n){if(t==null&&n==null)return!0;if(t==null)return!1;if(n==null)return!1;try{return t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()?!0:!1}catch(r){return!1}},e.SetDate=function(t,n,r){var i=new Date,s=12e4;if(t*12+n>s)i=new Date(9999,11,31);else if(t*12+n<100)i=new Date(100,0,1);else{var o=this.DaysInMonth(t,n);r>o&&(r=o),i=new Date(t,n-1,r)}return i},e.SetFullDate=function(t,n,r){var i=new Date;i.setDate(1);var s=12e4,o=this.DaysInMonth(t,n);return n>0&&n<12&&r>o&&(r=o),i.setFullYear(t),i.setMonth(n-1),i.setDate(r),i},e.SetFullDateByDate=function(t){var n=new Date;return n.setDate(1),n.setFullYear(t.getFullYear()),n.setMonth(t.getMonth()),n.setDate(t.getDate()),n.setHours(0,0,0,0),n},e.LYearDays=function(t){var n,r=348;for(n=32768;n>8;n>>=1)r+=this.LunarInfo[t-1960]&n?1:0;return r+this.leapDays(t)},e.leapDays=function(t){return this.LeapMonth(t)?this.LunarInfo[t-1960]&65536?30:29:0},e.LeapDays=function(t){return this.LeapMonth(t)?this.LunarInfo[t-1960]&65536?30:29:0},e.LeapMonth=function(t){return this.LunarInfo[t-1960]&15},e.MonthDays=function(t,n){return this.LunarInfo[t-1960]&65536>>n?30:29},e.GetRokuyou=function(t){if(t-this.RokuyouMin<0||t-this.RokuyouMax>0)return;var n,r=0,i=0,s=new Date(1960,0,28),o=Math.round((t-s)/864e5);for(n=1960;n<2050&&o>0;n++)i=this.LYearDays(n),o-=i;o<0&&(o+=i,n--),this.year=n,r=this.LeapMonth(n),this.isLeap=!1;for(n=1;n<13&&o>0;n++)r>0&&n==r+1&&this.isLeap==0?(--n,this.isLeap=!0,i=this.LeapDays(this.year)):i=this.MonthDays(this.year,n),this.isLeap==1&&n==r+1&&(this.isLeap=!1),o-=i;o==0&&r>0&&n==r+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--n)),o<0&&(o+=i,--n),this.month=n,this.day=o+1;var u=(this.month+this.day-2)%6,a=new Date(1996,6,15),f=new Date(1996,7,13);this.IsDateInRange(t,a,f)&&(u=(6+u-1)%6);var l=new Date(1996,8,12),c=new Date(1996,9,11);this.IsDateInRange(t,l,c)&&(u=(6+u-1)%6);var h=new Date(2033,7,25),p=new Date(2033,11,21);this.IsDateInRange(t,h,p)&&(u=(u+1)%6),this.Equal(t,a)&&(u=(6+u-1)%6),this.Equal(t,l)&&(u=(6+u-1)%6);var d;return d},e.IsDateInRange=function(t,n,r){var i=t.getYear(),s=n.getYear(),o=r.getYear(),u=t.getMonth(),a=n.getMonth(),f=r.getMonth(),l=t.getDate(),c=n.getDate(),h=r.getDate(),p=i*1e4+u*100+l,d=s*1e4+a*100+c,v=o*1e4+f*100+h;return p>=d&&p<=v},e.GetRokuyouText=function(t){var n=new Array;n=this.RokuyouTextArray.slice(0);switch(t){default:return""}},e.DaysInSpecialWeek=function(t,n,r){var i=new Array,s=this.DaysInMonth(t,n+1),o=new Date(t,n,1),u;for(var a=1;a<=s;a++){o.setDate(a);if(o.getDay()==r){var f=new Date(t,n,a);i.push(f),u=a;break}}u+=7;while(u<=s){o.setDate(u);var l=new Date(t,n,u);i.push(l),u+=7}return i},e.GetDaysByFirstWeekday=function(t){var n=new Array;n.push(t);var r=new Date(t);while(r.getDate()+7<=this.DaysInMonth(t.getFullYear(),t.getMonth()+1))r=new Date(r.getFullYear(),r.getMonth(),r.getDate()+7),n.push(r);return n},e.AddMilliseconds=function(t,n){var r=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return r.setMilliseconds(r.getMilliseconds()+n),new Date(r.valueOf())},e.GetWeekIndexByDate=function(t){return Math.floor(t.getDate()/7)},e}();e.DateTimeInfo=X;var V=function(){function e(e,t,n){this.inputWidget=e,this.maskPartsCount=0,this.isDisplayFormat=!0,this.pattern="M/d/yyyy",this.descriptors=new Array(0),this.desPostions=new Array(0),this.fields=new Array(0),this.isDisplayFormat=n,this._setFormat(t)}return e.prototype._parseFormat=function(e){var t=[],n="",r="",i=!1,s=!1,o,u;for(o=0;o<e.length;o++){u=e.charAt(o);if(s){t.push(this.createDescriptor(-1,u)),n="",s=!1;continue}if(u==="\\"){s=!0,n.length>0&&(this.handlePattern(n,t)||t.push(this.createDescriptor(-1,r)),n="");continue}if(u==="'"){i?(i=!1,n=""):(i=!0,n.length>0&&(this.handlePattern(n,t)||t.push(this.createDescriptor(-1,r)),n=""));continue}if(i){t.push(this.createDescriptor(-1,u)),n="";continue}o||(r=u),r!==u&&n.length>0&&(this.handlePattern(n,t)||t.push(this.createDescriptor(-1,r)),n=""),n+=u,r=u}return n.length>0&&(this.handlePattern(n,t)||t.push(this.createDescriptor(-1,r))),t},e.prototype._parseFormatToPattern=function(e){var t=this.inputWidget._getCulture().calendars.standard,n=t.patterns.d;if(e.length<=1)switch(e){case"":case"d":n=t.patterns.d;break;case"D":n=t.patterns.D;break;case"f":n=t.patterns.D+" "+t.patterns.t;break;case"F":n=t.patterns.D+" "+t.patterns.T;break;case"g":n=t.patterns.d+" "+t.patterns.t;break;case"G":n=t.patterns.d+" "+t.patterns.T;break;case"m":n=t.patterns.M;break;case"M":n=t.patterns.M;break;case"s":n=t.patterns.S;break;case"t":n=t.patterns.t;break;case"T":n=t.patterns.T;break;case"u":n=t.patterns.S;break;case"U":n=t.patterns.D+" "+t.patterns.T;break;case"y":n=t.patterns.Y;break;case"Y":n=t.patterns.Y;break;case"r":case"R":n="ddd, dd MMM yyyy HH:mm:ss G\\M\\T"}else n=e;return n},e.prototype.createDescriptor=function(e,t){var n=null,r=this.maskPartsCount++;switch(e){case-1:n=new i(this,r),n.liternal=t;break;case 20:n=new v(this,r);break;case 25:n=new m(this,r);break;case 26:n=new g(this,r);break;case 27:n=new y(this,r);break;case 30:n=new w(this,r);break;case 31:n=new E(this,r);break;case 100:n=new S(this,r);break;case 101:n=new x(this,r);break;case 10:n=new C(this,r);break;case 1:n=new k(this,r);break;case 2:n=new L(this,r);break;case 45:n=new M(this,r);break;case 46:n=new _(this,r);break;case 47:n=new P(this,r);break;case 48:n=new H(this,r);break;case 250:n=new j(this,r);break;case 251:n=new F(this,r);break;case 50:n=new q(this,r);break;case 51:n=new R(this,r);break;case 60:n=new z(this,r);break;case 61:n=new W(this,r);break;case 70:n=new o(this,r);break;case 71:n=new u(this,r);break;case 72:n=new l(this,r);break;case 73:n=new c(this,r);break;case 74:n=new h(this,r);break;case 75:n=new a(this,r);break;case 80:n=new p(this,r);break;default:}return n},e.prototype.handlePattern=function(e,t){var n=new RegExp("y{3,4}"),r=n.test(e);if(r)return t.push(this.createDescriptor(10)),!0;n=new RegExp("y{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(2)),!0;n=new RegExp("y{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(1)),!0;n=new RegExp("d{4,4}"),r=n.test(e);if(r)return t.push(this.createDescriptor(101)),!0;n=new RegExp("d{3,3}"),r=n.test(e);if(r)return t.push(this.createDescriptor(100)),!0;n=new RegExp("d{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(30)),!0;n=new RegExp("d{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(31)),!0;n=new RegExp("M{4,4}"),r=n.test(e);if(r)return t.push(this.createDescriptor(27)),!0;n=new RegExp("M{3,3}"),r=n.test(e);if(r)return t.push(this.createDescriptor(26)),!0;n=new RegExp("M{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(20)),!0;n=new RegExp("M{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(25)),!0;n=new RegExp("h{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(46)),!0;n=new RegExp("h{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(45)),!0;n=new RegExp("H{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(48)),!0;n=new RegExp("H{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(47)),!0;n=new RegExp("m{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(50)),!0;n=new RegExp("m{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(51)),!0;n=new RegExp("s{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(60)),!0;n=new RegExp("s{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(61)),!0;n=new RegExp("t{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(251)),!0;n=new RegExp("t{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(250)),!0;n=new RegExp("e{2,10}"),r=n.test(e);if(r)return t.push(this.createDescriptor(71)),!0;n=new RegExp("e{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(70)),!0;n=new RegExp("g{3,10}"),r=n.test(e);if(r)return t.push(this.createDescriptor(74)),!0;n=new RegExp("g{2,2}"),r=n.test(e);if(r)return t.push(this.createDescriptor(73)),!0;n=new RegExp("g{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(72)),!0;if(this.isDisplayFormat){n=new RegExp("E{1,10}"),r=n.test(e);if(r)return t.push(this.createDescriptor(75)),!0;n=new RegExp("A{1,1}"),r=n.test(e);if(r)return t.push(this.createDescriptor(80)),!0}return!1},e.prototype.daysInMonth=function(e,t){e-=1;var n=(new Date(t,++e,1,-1)).getDate();return n},e.prototype._isDigitString=function(e){e=K.trim(e);if(e.length===0)return!0;var t=e.charAt(0),n,r;if(t==="+"||t==="-")e=e.substr(1),e=K.trim(e);if(e.length===0)return!0;try{return n=parseFloat(e),r=n.toString(),r===e}catch(i){return!1}},e.prototype._internalSetDate=function(e){this.inputWidget&&this.inputWidget._internalSetDate(e)},e.prototype._isValidDate=function(e){return this.inputWidget._isValidDate(e)},e.prototype._setFormat=function(e){var t=this.inputWidget._getCulture();if(t==null)return;this.pattern=this._parseFormatToPattern(e),this.descriptors=this._parseFormat(this.pattern),this.fields=K.grep(this.descriptors,function(e){return e.type!==-1})},e.prototype._isEraFormatExist=function(){for(var e=0;e<this.descriptors.length;e++)if(this.descriptors[e].type>=70&&this.descriptors[e].type<=75)return!0;return!1},e.prototype.getDate=function(){return this.inputWidget?new Date(this.inputWidget._safeGetDate(!0).getTime()):undefined},e.prototype.setDate=function(e){this.inputWidget&&this.inputWidget._setData(e)},e.prototype.getYear=function(){return this.getDate().getFullYear()},e.prototype.setYear=function(e,t,n){try{t&&t.isfullreset&&(t.offset=1,e="1970");if(typeof e=="string"&&!this._isDigitString(e))return!1;e*=1;var r=this.inputWidget.options,i=1,s=9999,o,u,a;n&&(r.minDate&&(i=Math.max(i,r.minDate.getFullYear())),r.maxDate&&(s=Math.min(s,r.maxDate.getFullYear()))),t&&t.isreset&&(e=i),e<i&&(e=i),e>s&&(e=s),o=this.getDate(),u=new Date(o.getTime()),u.setFullYear(e);if(this._isValidDate(u))return a=this.daysInMonth(this.getMonth(),this.getYear()),a===o.getDate()?(u=new Date(o.getTime()),u.setDate(1),u.setFullYear(e),u.setDate(a),this._isValidDate(u)?(this._internalSetDate(u),!0):!1):(o.setFullYear(e),this._internalSetDate(o),!0);return t&&t.isreset?(o.setFullYear(1),this._internalSetDate(o),!0):!1}catch(f){return!1}},e.prototype.getMonth=function(){return this.getDate().getMonth()+1},e.prototype.setMonth=function(e,t,n){try{n&&n.isfullreset&&(e="1"),e*=1;var r=this.getDate(),i,s;if(typeof t!="undefined"&&!t)if(e>12||e<1){if(!n||!n.isreset)return!1;e=1}return i=this.daysInMonth(this.getMonth(),this.getYear()),i===this.getDate().getDate()?(s=new Date(r.getTime()),s.setDate(1),s.setMonth(e-1),i=this.daysInMonth(s.getMonth()+1,s.getFullYear()),s.setDate(i),this._isValidDate(s)?(this._internalSetDate(s),!0):!1):(s=new Date(r.getTime()),s.setMonth(e-1),this._isValidDate(s)?(this._internalSetDate(s),!0):!1)}catch(o){return!1}},e.prototype.getHours=function(){return this.getDate().getHours()},e.prototype.setHours=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>24)return!1;var n=new Date(this.getDate().getTime());return n.setHours(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},e.prototype.getMinutes=function(){return this.getDate().getMinutes()},e.prototype.setMinutes=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>60)return!1;var n=new Date(this.getDate().getTime());return n.setMinutes(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},e.prototype.getSeconds=function(){return this.getDate().getSeconds()},e.prototype.setSeconds=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>60)return!1;var n=new Date(this.getDate().getTime());return n.setSeconds(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},e.prototype.getDayOfMonth=function(){return this.getDate().getDate()},e.prototype.setDayOfMonth=function(e,t,n){try{if(n&&n.isfullreset)return this.setDayOfMonth(1,t);var r=this.getDate(),i,s;e*=1;if(typeof t!="undefined"&&!t){i=this.daysInMonth(this.getMonth(),this.getYear());if(e>i||e<1)return n&&n.isreset?this.setDayOfMonth(1,t,n):!1}return s=new Date(r.getTime()),s.setDate(e),this._isValidDate(s)?(this._internalSetDate(s),!0):!1}catch(o){return!1}},e.prototype.getDayOfWeek=function(){return this.getDate().getDay()+1},e.prototype.setDayOfWeek=function(e){try{e*=1;var t=e-this.getDayOfWeek();return this.setDayOfMonth(this.getDayOfMonth()+t,!0)}catch(n){return!1}},e.prototype._getCulture=function(){return this.inputWidget._getCulture()},e.prototype.findAlikeArrayItemIndex=function(e,t){var n=-1,r=99999,i,s;for(i=0;i<e.length;i++)s=e[i].toLowerCase().indexOf(t.toLowerCase()),s!==-1&&s<r&&(r=s,n=i);return n},e.prototype.toString=function(){if(this._isEraFormatExist()&&this.inputWidget.options.date!=null){var e=this.inputWidget._getRealEraMinDate(),t=this.inputWidget._getRealEraMaxDate();if(this.inputWidget.options.date<e||this.inputWidget.options.date>t)return""}var n="",r=0,i,s,o;this.desPostions=new Array(0);for(i=0;i<this.descriptors.length;i++){this.descriptors[i].startIndex=n.length,s=this.descriptors[i].getText(),n+=s;for(o=0;o<s.length;o++){this.desPostions.push({desc:this.descriptors[i],pos:o,text:s,length:s.length}),r++;if(this.desPostions.length!==r)throw"Fatal Error !!!!!!!!!!!!!!!"}}return n},e}();e.wijDateTextFormatter=V;var $=function(){function e(e){this.options=e,e.format=e.format||"M/d/yyyy",e.amDesignator=e.amDesignator||"",e.pmDesignator=e.pmDesignator||"",e.hour12As0===undefined&&(e.hour12As0=!1),e.midnightAs0===undefined&&(e.midnightAs0=!0)}return e.prototype._getInnerIncrement=function(){return 1},e.prototype._getCulture=function(){return Globalize.findClosestCulture(this.options.culture)},e.prototype._getRealEraMaxDate=function(){return this.options.maxDate?X.GetEraMax()<this.options.maxDate?X.GetEraMax():this.options.maxDate:X.GetEraMax()},e.prototype._getRealEraMinDate=function(){return this.options.minDate?X.GetEraMin()>this.options.minDate?X.GetEraMin():this.options.minDate:X.GetEraMin()},e.prototype._safeGetDate=function(e){var t=this.options.date;return t==null&&(t=new Date),e||(t=this._checkRange(t)),t},e.prototype._safeSetDate=function(e,t){var n=e;return t||(e=this._checkRange(e)),isNaN(e)&&(e=n),this.options.date=e,!0},e.prototype._getAllowSpinLoop=function(){return!1},e.prototype._getRealMinDate=function(){if(this.options.minDate)return this.options.minDate;var e=new Date(1,0,1,0,0,0);return e.setFullYear(1),e},e.prototype._getRealMaxDate=function(){return this.options.maxDate?this.options.maxDate:new Date(9999,11,31,23,59,59)},e.prototype._setData=function(e){this.options.date=e},e.prototype._isValidDate=function(e,t){if(e===undefined)return!1;if(isNaN(e))return!1;if(e.getFullYear()<1||e.getFullYear()>9999)return!1;if(t){if(this.options.minDate&&e<this.options.minDate)return!1;if(this.options.maxDate&&e>this.options.maxDate)return!1}return!0},e.prototype._getInnerAmDesignator=function(){return this.options.amDesignator==""?this._getStandardAMPM("AM"):this.options.amDesignator},e.prototype._getInnerPmDesignator=function(){return this.options.pmDesignator==""?this._getStandardAMPM("PM"):this.options.pmDesignator},e.prototype.isFocused=function(){return!1},e.prototype._internalSetDate=function(e){},e.prototype._checkRange=function(e){return e&&(this.options.minDate&&e<this.options.minDate&&(e=new Date(Math.max(this.options.minDate.valueOf(),e.valueOf()))),this.options.maxDate&&e>this.options.maxDate&&(e=new Date(Math.min(this.options.maxDate.valueOf(),e.valueOf())))),e},e.prototype._getStandardAMPM=function(e){var t=this._getCulture();if(t&&t.calendar){var n=t.calendars.standard[e];if(n)return n[0]}return e},e}();e.wijInputDateImpl=$;var K=jQuery;K.wijinputcore=K.wijinputcore||{},K.wijinputcore.formatdate=K.wijinputcore.formatdate||J,K.wijinputcore.parseDate=K.wijinputcore.parseDate||Q,K.wijinputcore.validateDate=K.wijinputcore.validateDate||et})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=e.getKeyCodeEnum(),i=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype._create=function(){t.Utility.chrome&&this.element.attr("type","text"),e.prototype._create.call(this)},i.prototype._createTextProvider=function(){this._textProvider=new o(this,this.options.dateFormat,this.options.displayFormat)},i.prototype._strToDate=function(e){return this._textProvider.parseDate(e)},i.prototype._beginUpdate=function(){var t,n=null;e.prototype._beginUpdate.call(this),this.options.minDate&&typeof this.options.minDate=="string"&&(this.options.minDate=this._strToDate(this.options.minDate)),this.options.maxDate&&typeof this.options.maxDate=="string"&&(this.options.maxDate=this._strToDate(this.options.maxDate)),this.options.date===undefined?!this.element.data("elementValue")||(t=this.element.data("elementValue")):typeof this.options.date=="string"?t=this.options.date:n=this.options.date,this.options.date===undefined&&(this.options.date=new Date),t&&(n=this._strToDate(t),n===null&&(n=new Date)),n==null&&(n=this.options.date),this._safeSetDate(n);var r=this._getCulture();r!=null&&(this.options.amDesignator==""&&(this.options.amDesignator=this._getStandardAMPM("AM")),this.options.pmDesignator==""&&(this.options.pmDesignator=this._getStandardAMPM("PM"))),this.element.data({defaultDate:n===null?n:new Date(n.getTime()),preDate:n===null?n:new Date(n.getTime())}),this._resetTimeStamp(),this._initPicker(),this.element.addClass(this.options.wijCSS.wijinputdate).attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":this.options.date})},i.prototype._endUpdate=function(){var n=this;e.prototype._endUpdate.call(this),this.element.bind("click.wijinput",function(){if(!n._allowEdit())return;var e=n.options.activeField,r=n.element.wijtextselection();n._updateText(),n.element.wijtextselection(r),n.element.data("ignoreHighLight")!=1&&n._highLightCursor(),t.Utility.chrome&&n.element.data("needResoteActiveField")==1&&n._setOption("activeField",e),n.element.data("ignoreHighLight",!1)})},i.prototype._getInnerNullText=function(){return this.options.placeholder!=null?this.options.placeholder:this.options.showNullText?this.options.nullText:null},i.prototype._getInnerAmDesignator=function(){return this.options.amDesignator==""?this._getStandardAMPM("AM"):this.options.amDesignator},i.prototype._getInnerPmDesignator=function(){return this.options.pmDesignator==""?this._getStandardAMPM("PM"):this.options.pmDesignator},i.prototype._getInnerIncrement=function(){var e=Number(this.options.increment);return isNaN(e)&&(e=1),e},i.prototype._getAllowSpinLoop=function(){return!!this.options.allowSpinLoop},i.prototype._getRealMaxDate=function(){return this.options.maxDate?this.options.maxDate:new Date(9999,11,31,23,59,59)},i.prototype._getRealMinDate=function(){if(this.options.minDate)return this.options.minDate;var e=new Date(1,0,1,0,0,0);return e.setFullYear(1),e},i.prototype._getRealEraMaxDate=function(){return this.options.maxDate?t.DateTimeInfo.GetEraMax()<this.options.maxDate?t.DateTimeInfo.GetEraMax():this.options.maxDate:t.DateTimeInfo.GetEraMax()},i.prototype._getRealEraMinDate=function(){return this.options.minDate?t.DateTimeInfo.GetEraMin()>this.options.minDate?t.DateTimeInfo.GetEraMin():this.options.minDate:t.DateTimeInfo.GetEraMin()},i.prototype._isEraFormatExist=function(){return this._textProvider._isEraFormatExist()},i.prototype._checkDate=function(){var e=this.options.date,n=this._checkRange(this.options.date);t.DateTimeInfo.Equal(e,n)||(this._setOption("date",n),this._trigger("valueBoundsExceeded",null))},i.prototype._checkRange=function(e){return e&&(this.options.minDate&&e<this.options.minDate&&(e=new Date(Math.max(this.options.minDate,e))),this.options.maxDate&&e>this.options.maxDate&&(e=new Date(Math.min(this.options.maxDate,e)))),e},i.prototype._safeSetDate=function(e,t){var n=e;return t||(e=this._checkRange(e)),isNaN(e)&&(e=n),this.options.date=e,!0},i.prototype._safeGetDate=function(e){var t=this.options.date;return t==null&&(t=new Date),e||(t=this._checkRange(t)),t},i.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"pickers":this._reInitPicker();break;case"minDate":case"maxDate":typeof this.options[t]=="string"&&(this.options[t]=this._strToDate(n));var r=this.options.date;r===null&&(r=new Date);var i=this._getRealMinDate(),s=this._getRealMaxDate();(r<i||r>s)&&this._safeSetDate(r),this._updateText(),this._highLightField();break;case"date":!n||(typeof n=="string"?n=this._strToDate(n):typeof n=="object"?n=new Date(n.getTime()):n=new Date(n),isNaN(n)&&(n=new Date)),this._safeSetDate(n),this._updateText(),this._highLightField();break;case"midnightAs0":case"hour12As0":case"amDesignator":case"pmDesignator":this._updateText(),this._highLightField();break;case"culture":this._textProvider._setFormat(this.options.dateFormat);var o=this.options.displayFormat==""?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(o),this.options.amDesignator=this._getStandardAMPM("AM"),this.options.pmDesignator=this._getStandardAMPM("PM"),this._updateText();var u=this.element.data("calendar");u&&u.wijcalendar("option",t,n),this._reInitPicker();break;case"dateFormat":this._textProvider._setFormat(this.options.dateFormat),this.options.displayFormat==""&&this._textProvider._setDisplayFormat(this.options.dateFormat);if(this._isEraFormatExist()&&this.options.date!=null){var a=this._getRealEraMinDate(),f=this._getRealEraMaxDate();this.options.date<a?this._setOption("date",a):this.options.date>f&&this._setOption("date",f)}this._updateText();var u=this.element.data("calendar");u&&u.wijcalendar("option",t,n),this._reInitPicker();break;case"displayFormat":var o=this.options.displayFormat==""?this.options.dateFormat:this.options.displayFormat;this._textProvider._setDisplayFormat(o),this._updateText();break;case"activeField":n=Math.min(n,this._textProvider.getFieldCount()-1),n=Math.max(n,0),this.options.activeField=n,this._checkDate(),this.element.data("ignoreHighLight")!=1&&this._highLightField(),this._resetTimeStamp();break;case"nextTooltip":case"prevTooltip":case"titleFormat":case"toolTipFormat":var u=this.element.data("calendar",u);u&&u.wijcalendar("option",t,n);break;case"comboItems":this._reInitPicker()}},i.prototype._setData=function(e){this.option("date",e)},i.prototype._resetData=function(){var e=this.element.data("defaultDate");e===undefined||e===null?(e=this.element.data("elementValue"),e!==undefined&&e!==null&&e!==""?this.setText(e):this._setData(null)):this._setData(e)},i.prototype._resetTimeStamp=function(){this.element.data("cursorPos",0),this.element.data("timeStamp",new Date("1900/1/1")),this.element.data("lastInputChar","")},i.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(e.prototype._showNullText.call(this)&&this.isDateNull())return"";var t=this._textProvider.toString();return t===this.options.nullText?"":t},i.prototype._highLightAllField=function(){if(this.isFocused()){var e=this._textProvider.getAllRange();if(e)try{this.element.wijtextselection(e)}catch(t){}}},i.prototype._highLightField=function(e){typeof e=="undefined"&&(e=this.options.activeField);if(this.isFocused()){var t=this._textProvider.getFieldRange(e);if(t)try{this.element.wijtextselection(t)}catch(n){}}},i.prototype._highLightCursor=function(e){if(this._isNullText())return;e===undefined&&(e=Math.max(0,this.element.wijtextselection().start));var t=this._textProvider.getCursorField(e);if(t<0)return;this._setOption("activeField",t)},i.prototype._toNextField=function(){this._setOption("activeField",this.options.activeField+1)},i.prototype._toPrevField=function(){this._setOption("activeField",this.options.activeField-1)},i.prototype._toFirstField=function(){this._setOption("activeField",0)},i.prototype._toLastField=function(){this._setOption("activeField",this._textProvider.getFieldCount())},i.prototype._clearField=function(e){typeof e=="undefined"&&(e=this.options.activeField);var n=this._textProvider.getFieldRange(e),r,i=this;n&&(r=new t.wijInputResult,this._textProvider.removeAt(n.start,n.end,r),this._updateText(),window.setTimeout(function(){i._highLightField()},1))},i.prototype.spinUp=function(){this._doSpin(!0,!1)},i.prototype.spinDown=function(){this._doSpin(!1,!1)},i.prototype.drop=function(){e.prototype._onTriggerClicked.call(this)},i.prototype.focus=function(){e.prototype.focus.call(this),this._addState("focus",this.outerDiv),this._updateText(),this.options.highlightText=="all"?this._highLightAllField():this._highLightField()},i.prototype.isDateNull=function(){return this.options.date===null||this.options.date===undefined},i.prototype._min=function(e,t){return t==undefined?e:e<t?e:t},i.prototype._max=function(e,t){return t==undefined?e:e>t?e:t},i.prototype._allowEdit=function(){return!this.option("disableUserInput")},i.prototype._onFocus=function(n){e.prototype._onFocus.call(this,n);if(!this._allowEdit())return;this._updateText();if(this.element.data("IsInSelectTextMethod")==1)return;if(t.Utility.chrome){var r=this;r.element.data("needResoteActiveField",!0),window.setTimeout(function(){r.element.data("needResoteActiveField",!1),r.options.highlightText=="all"?r._highLightAllField():r._highLightField()},200)}else this.options.highlightText=="all"?(this._highLightAllField(),this.element.data("ignoreHighLight",!0)):this._highLightField()},i.prototype._simulate=function(n){var r=null;if(typeof n=="string")r=n;else{var i=this.element.wijtextselection(),s=this.element.data("lastSelection").start,o=i.end;o>=s&&(r=this.element.val().substring(s,o))}for(var u=0;u<t.DateTimeInfo.GetEraCount();u++)if(r.toLowerCase()===t.DateTimeInfo.GetEraShortNames()[u].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraAbbreviations()[u].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraSymbols()[u].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraNames()[u].toLowerCase()){r=t.DateTimeInfo.GetEraShortNames()[u].toLowerCase();break}e.prototype._simulate.call(this,r)},i.prototype._doSpin=function(e,t){var n=this;if(!this._allowEdit())return!1;if(t&&this.element.data("breakSpinner"))return!1;e?this._trigger("spinUp",null):this._trigger("spinDown",null);if(this.options.date==null){this._setDefaultDate(e);return}var r=!1;e?r=this._textProvider.incEnumPart():r=this._textProvider.decEnumPart(),r&&(this._updateText(),this._highLightField());if(t&&!this.element.data("breakSpinner")){var i=window.setTimeout(function(){return n._doSpin(e,!0)},this._calcSpinInterval());this.element.data("spintimer",i)}return!0},i.prototype._setDefaultDate=function(e){e?this.options.date=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate():this.options.date=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),this._updateText(),this._highLightField()},i.prototype._onChange=function(){},i.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},i.prototype._onBlur=function(t){e.prototype._onBlur.call(this,t),this._checkDate(),this._removeState("focus",this.outerDiv),this._updateText()},i.prototype._keyDownPreview=function(n){if(e.prototype._keyDownPreview.call(this,n))return!0;var i=n.keyCode||n.which,s;switch(i){case r.UP:case r.DOWN:if(n.altKey)return this._onTriggerClicked(),!0;if(this.element.data("pickerCurrentTab")!="List")return this._doSpin(i==r.UP,!1),this._stopEvent(n),!0;break;case r.LEFT:return this.options.activeField!=0||this.options.blurOnLeftRightKey.toLowerCase()!="left"&&this.options.blurOnLeftRightKey.toLowerCase()!="both"?this._toPrevField():(t.Utility.MoveFocus(this.element.get(0),!1),this._trigger("keyExit")),!0;case r.RIGHT:return this.options.activeField!=this._textProvider.getFieldCount()-1||this.options.blurOnLeftRightKey.toLowerCase()!="right"&&this.options.blurOnLeftRightKey.toLowerCase()!="both"?this._toNextField():(t.Utility.MoveFocus(this.element.get(0),!0),this._trigger("keyExit")),!0;case r.ENTER:if(this._wasPopupShowing)return this.element.data("pickerCurrentTab")=="Calendar"?this.options.date==null&&this._setOption("date",new Date):this.element.data("pickerCurrentTab")=="List"?this._processKeyForDropDownList(n):this._okButtonMouseDown(null,null),this._hidePopup(),!0;this.options.hideEnter&&e.prototype._stopEvent.call(this,n);break;case r.TAB:if(this.options.tabAction!=="field"||this.options.highlightText!=="field"){this._trigger("keyExit");break}s=this.element.wijtextselection();if(s&&s.end-s.start!==this.element.val().length)if(n.shiftKey){if(!(this.options.activeField>0)){this._trigger("keyExit");break}this._toPrevField()}else{if(!(this.options.activeField<this._textProvider.getFieldCount()-1)){this._trigger("keyExit");break}this._toNextField()}return!0;case r.SPACE:case 188:case 190:case 110:case 191:if(n.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0;break;case r.HOME:return n.ctrlKey?this._setOption("date",new Date):this._toFirstField(),!0;case r.END:return n.ctrlKey?this._processClearButton():this._toLastField(),!0;case r.BACKSPACE:case r.DELETE:if(this._allowEdit())return this._processDeleteKey(),!0}return!1},i.prototype._processDeleteKey=function(){if(this.options.date==null)return;var e=this.element.wijtextselection();if(e.end-e.start===this.element.val().length){var t=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate();if(this.options.date>t){this._setOption("date",t);return}}else{var n=this.options.activeField,r=this._textProvider.getFiledText(n);this._clearField();var i=this._textProvider.getFiledText(n);if(r!=i)return}this._processClearButton()},i.prototype._autoMoveToNextField=function(e,t){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,e,t)&&this._toNextField()},i.prototype._processClearButton=function(){this._allowEdit()?this._setOption("date",null):this._updateText()},i.prototype._autoMoveToNextControl=function(e,n,r){if(!this.options.blurOnLastChar||r!==this._textProvider.getFieldCount()-1)return;this._textProvider.needToMove(r,e,n)&&(t.Utility.MoveFocus(this.element.get(0),!0),this._trigger("keyExit"))},i.prototype._keyPressPreview=function(e){var t=e.keyCode||e.which,n,i,s,o,u,a,f,l,c,h,p;if(t===r.ENTER)return this.isDateNull()&&this._setOption("date",new Date),!1;n=this._textProvider.getFieldRange(this.options.activeField);if(n){if(t===r.TAB)return!0;if(t===r.SPACE)return this._stopEvent(e),!0;i=String.fromCharCode(t),s=this._textProvider.isFieldSep(i,this.options.activeField);if(s)return this._toNextField(),this._stopEvent(e),!0;o=this.element.data("cursorPos"),u=new Date,f=this.element.data("timeStamp"),p=this.element.data("lastInput"),a=u.getTime()-f.getTime()>this.options.keyDelay;var h=i;a?o=0:p&&(h=p+h),this.element.data({timeStamp:u,lastInput:h}),l=n.start+o,this.element.data("cursorPos",++o);var d=this.options.date==null;c=this._textProvider.addToField(h,this.options.activeField,l);var v=this.options.activeField;return c?(this._updateText(),this._autoMoveToNextField(o,i),this._highLightField(),this._autoMoveToNextControl(o,i,v)):(d&&this._setOption("date",null),this._resetTimeStamp(),this._fireIvalidInputEvent()),v!=this.options.activeField?this.element.data("lastInputChar",""):this.element.data("lastInputChar",i),this._stopEvent(e),!0}return!1},i.prototype._raiseDataChanged=function(){var e=this.options.date,t=this.element.data("preDate");this.element.data("preDate",e?new Date(e.getTime()):null);if(!t&&e||t&&!e||t&&e&&t.getTime()!==e.getTime())this._popupVisible()&&this._syncCalendar(),this.element.attr("aria-valuenow",e),this._trigger("dateChanged",null,{date:e})},i.prototype._isMinDate=function(e){return e.getFullYear()===1&&e.getMonth()===0&&e.getDate()===1},i.prototype._reInitPicker=function(){this._destroyPicker(),this._initPicker()},i.prototype._destroy=function(){e.prototype._destroy.call(this),this._destroyPicker()},i.prototype._destroyPicker=function(){var e=this.element.data("pickers");e!=undefined&&(e.remove(),this.element.data("pickers",null),this.element.data("calendar",null),this.element.data("datePicker",null),this.element.data("timePicker",null),this._comboDiv=undefined)},i.prototype._initPicker=function(){var e=this,r=this.element.data("pickers");if(r!=undefined)return;var i=this;this._initPickerData();var s=this._getPickerCount(),o=this.element.data("pickerWidth"),u=this.element.data("pickerHeight"),a=this.element.data("pickerAreaHeight");s>1&&(u+=8,a+=8);var f=s>1?u:a;r=n("<table/>").appendTo(document.body).attr({"class":"ui-widget-content ui-corner-all",borderWidth:"0px",cellspacing:"0px",cellpadding:"0px",cursor:"default"}).css({"font-size":"12px"});var l=n("<tr/>").appendTo(r),c=n("<tr/>").appendTo(r),h=n("<td/>").appendTo(l).css({width:"100%",height:"100%"}),p=n("<td/>").appendTo(c).attr("align","center").css({width:"100%",height:"30px",display:"none"}),d=n("<input type='button'/>").appendTo(p).attr({"class":"ui-state-active ui-widget",value:"OK"}).css({width:"80px",height:"26px",margin:"1px","text-align":"center",cursor:"pointer",visibility:"hidden"}).mousedown(function(e,t){i._okButtonMouseDown(e,t)}),v=n("<div/>").appendTo(h).css({width:"100%",height:"100%",padding:"0px",margin:"0px",borderWidth:"0px",overflow:"hidden"}),m=n("<ul/>").css({"line-height":"1px","font-size":"12px"});s>1&&m.appendTo(v);var g="";if(this._isCalendarPickerShown()){s>1?this._addPickerTab(m,"Calendar","#calendarDiv"):t.Utility.IsIE9()&&(h.css({width:""}),v.css({width:""})),this._initCalendarPicker();var y=this.element.data("calendar");this._addPickerEditor(v,y,"calendarDiv"),g="Calendar"}this._isListPickerShown()&&(s>1&&this._addPickerTab(m,"List","#listDiv"),this._initListPicker(),this._addPickerEditor(v,this._comboDiv,"listDiv"),g=g==""?"List":g);if(this._isDatePickerShown()){s>1&&this._addPickerTab(m,"Date","#dateDiv"),this._initDatePicker();var b=this.element.data("datePicker");this._addPickerEditor(v,b,"dateDiv"),g=g==""?"Date":g}if(this._isTimePickerShown()){s>1&&this._addPickerTab(m,"Time","#timeDiv"),this._initTimePicker();var w=this.element.data("timePicker");this._addPickerEditor(v,w,"timeDiv"),g=g==""?"Time":g}if(g=="Calendar")r.css({width:o+"px",height:"","font-size":""});else if(g=="Date"||g=="Time")p.css({display:""}),r.css({width:o+"px",height:u+"px","font-size":"12px"}),v.css({height:f+"px"});this.element.data("pickerCurrentTab",g);var i=this;v.wijtabs({select:function(e,t){var n=t.tab.outerText||t.tab.text;p.css({display:"none"}),i.element.data("pickerCurrentTab",n);if(n=="Calendar")i.focus(),r.css({width:o+"px",height:"","font-size":""}),v.css({height:"100%"});else if(n=="List"){var s=i._getListPickerWidth();i._comboDiv.wijlist("option","width",s),r.css({width:s,height:"","font-size":""}),v.css({height:"100%"}),i._comboDiv.wijlist("renderList"),i._comboDiv.focus()}else{i.focus();if(n=="Time"||n=="Date")p.css({display:""}),r.css({width:o+"px",height:u+"px","font-size":"12px"}),v.css({height:f+"px"})}}}),r.wijpopup({autoHide:!0,hidden:function(){e._trigger("dropDownClose"),e._wasPopupShowing=!1},shown:function(){e._trigger("dropDownOpen"),e._wasPopupShowing=!0}}),this.element.data("pickers",r),this.element.data("divPickers",v),this.element.data("divOK",d)},i.prototype._initPickerData=function(){var e=70,t=32,n=26,r=30,i=150,s=100,o=235,u=242,a=220,f=220,l=this._getPickerCount(),c=l*e,h=s;c=c<i?i:c,this._isCalendarPickerShown()&&(c=c<o?o:c,h=h<u?u:h);if(this._isListPickerShown()){var p=this._getcomboItems();if(p!=undefined){var d=p.length*n;h=h<d?d:h}}if(this._isDatePickerShown()){c=c<a?a:c,h=h<a?a:h;var v=this._getDatePickerMinYear(),m=this._getDatePickerMaxYear(),g=this._getDefaultDatePickerFormat(),y=this.options.pickers.datePicker.format!=undefined?this.options.pickers.datePicker.format:g,b=y.split(",");b.length!=3&&(b=g.split(","),this.options.pickers.datePicker.format=g);var w=this._getRollFormat(b,"y"),E=this._getRollFormat(b,"M"),S=this._getRollFormat(b,"d");if(!this._isValidatePickerFormat(w)||!this._isValidatePickerFormat(E)||!this._isValidatePickerFormat(S))b=g.split(","),w=this._getRollFormat(b,"y"),E=this._getRollFormat(b,"M"),S=this._getRollFormat(b,"d"),this.options.pickers.datePicker.format=g;this.element.data("pickerDateYearFormat",w),this.element.data("pickerDateMonthFormat",E),this.element.data("pickerDateDayFormat",S),this.element.data("pickerMinYear",v),this.element.data("pickerMaxYear",m),this.element.data("pickerDateFormat",b)}if(this._isTimePickerShown()){c=c<a?a:c,h=h<a?a:h;var x=this._getDefaultTimePickerFormat(),T=this.options.pickers.timePicker.format!=undefined?this.options.pickers.timePicker.format:x,N=T.split(",");N.length!=3&&(N=x.split(","),this.options.pickers.timePicker.format=x);var C=this._getRollFormat(N,"h"),k=this._getRollFormat(N,"m"),L=this._getRollFormat(N,"t");if(!this._isValidatePickerFormat(C)||!this._isValidatePickerFormat(k)||!this._isValidatePickerFormat(L))N=x.split(","),C=this._getRollFormat(N,"h"),k=this._getRollFormat(N,"m"),L=this._getRollFormat(N,"t"),this.options.pickers.timePicker.format=x;this.element.data("pickerTimeHourFormat",C),this.element.data("pickerTimeMinuteFormat",k),this.element.data("pickerTimeAMFormat",L),this.element.data("pickerTimeFormat",N)}var A=this.options.pickers.width!=undefined?this.options.pickers.width:0,O=this.options.pickers.height!=undefined?this.options.pickers.height:0;A=A<c?c:A,O=O<h?h:O,O-=l>1?t:0;var M=O-r,_=Math.floor(M/5)+1,D=_*2,P=_*5+6,H=_*4-3,B=_*2+2,j=_;this.element.data("itemHeight",_),this.element.data("indicatorHeight",D),this.element.data("pickerWidth",A),this.element.data("pickerHeight",O),this.element.data("pickerAreaHeight",M),this.element.data("indicatorTranslateTop",P),this.element.data("indicatorTranslateDown",H),this.element.data("indicatorTranslateSelector",B),this.element.data("indicatorTranslateContent",j)},i.prototype._initListPicker=function(){var e=this;if(this._comboDiv!==undefined)return;this._comboDiv=n("<div/>").css({overflow:"hidden",display:"block",left:"",top:"",position:""});var r=this._normalize(this._getcomboItems());this._comboDiv.wijlist({maxItemsCount:5,autoSize:!0,selected:function(t,n){e.options.disableUserInput||e._setData(n.item.value);var r=e.element.data("pickers");r!=undefined&&r.wijpopup("hide"),e._trySetFocus()}}),this._comboDiv.wijlist("setItems",r),this._comboDiv.wijlist("renderList"),t.Utility.IsIE7()&&this._comboDiv.attr("align","left")},i.prototype._initCalendarPicker=function(){var t=this,r=this.element.data("calendar");if(r!=undefined)return;var i=this.options.calendar;if(i===undefined||i===null)return;if(typeof i=="boolean"||i==="default")i=n("<div/>");r=n(i);if(r.length!==1)return;this.element.data("calendar",r),this.options.localization&&(this.options.nextTooltip=this.options.localization.nextTooltip,this.options.prevTooltip=this.options.localization.prevTooltip,this.options.titleFormat=this.options.localization.titleFormat,this.options.toolTipFormat=this.options.localization.toolTipFormat),r.wijcalendar({popupMode:!0,culture:this.options.culture,nextTooltip:this.options.nextTooltip||"Next",prevTooltip:this.options.prevTooltip||"Previous",titleFormat:this.options.titleFormat||"MMMM yyyy",toolTipFormat:this.options.toolTipFormat||"dddd, MMMM dd, yyyy",selectedDatesChanged:function(){var n=r.wijcalendar("getSelectedDate"),i=t.option("date");e.prototype._wasPopupShowing=!1;var s=t.element.data("pickers");s!=undefined&&s.wijpopup("hide"),n&&(i&&(n.setHours(i.getHours()),n.setMinutes(i.getMinutes()),n.setSeconds(i.getSeconds()),n.setMilliseconds(i.getMilliseconds())),t._allowEdit()&&(t.option("date",n),t.selectText())),t._trySetFocus()}}),r.css({display:"block",left:"",top:"",position:"","margin-bottom":"0px"}),this._syncCalendar(),this._updateCalendarPicker()},i.prototype._initTimePicker=function(){var e=this.element.data("timePicker");if(e!=undefined)return;var r=this,i=this.element.data("itemHeight")*5,s=this.element.data("pickerWidth"),o=this.element.data("itemHeight")+"px",u=this.element.data("indicatorHeight")+"px",a=this.element.data("indicatorTranslateTop"),f=this.element.data("indicatorTranslateDown"),l=this.element.data("indicatorTranslateSelector"),c=this.element.data("indicatorTranslateContent"),h=this._createDivElement(document.body,s+"px"),p=this._createDivIndicatiorElement(h,o,"",l),d=this._createTableElement(h,i+"px","-",c),v=n("<tr/>").appendTo(d),m=n("<td/>").css({width:"33%"}),g=this._createPickerDivElement(m,i),y=this._createMaskElement(g,i),b={};for(var w=1;w<=12;w++){var E=this._getRollText(w,this.element.data("pickerTimeHourFormat")),S=this._createItemElement(w,y,o,E);b[w-1]=S}var x=n("<td/>").css({width:"33%"}),T=this._createPickerDivElement(x,i),N=this._createMaskElement(T,i),C={};for(var w=0;w<60;w++){var E=this._getRollText(w,this.element.data("pickerTimeMinuteFormat")),S=this._createItemElement(w,N,o,E);C[w]=S}var k=n("<td/>").css({width:"34%"}),L=this._createPickerDivElement(k,i),A=this._createMaskElement(L,i),O={};for(var w=0;w<2;w++){var E=this._getRollText(w,this.element.data("pickerTimeAMFormat")),S=this._createItemElement(w,A,o,E);O[w]=S}var M=this.element.data("pickerTimeFormat"),_=!1,D=!1,P=!1;for(var w=0;w<M.length;w++)(M[w]=="h"||M[w]=="hh")&&!_&&(m.appendTo(v),_=!0),(M[w]=="m"||M[w]=="mm")&&!D&&(x.appendTo(v),D=!0),(M[w]=="t"||M[w]=="tt")&&!P&&(k.appendTo(v),P=!0);this.element.data("timePicker",h),this.element.data("divHour",g),this.element.data("divMinute",T),this.element.data("divAM",L),this.element.data("divHourMask",y),this.element.data("divMinuteMask",N),this.element.data("divAMMask",A),this.element.data("pickerHourArray",b),this.element.data("pickerMinuteArray",C),this.element.data("pickerAMArray",O);if(!t.Utility.IsIE8OrBelow()){var H=this._createIndicatiorElement(g,u,"-",a),B=this._createIndicatiorElement(g,u,"-",f),j=this._createIndicatiorElement(T,u,"-",a),F=this._createIndicatiorElement(T,u,"-",f),I=this._createIndicatiorElement(L,u,"-",a),q=this._createIndicatiorElement(L,u,"-",f);this.element.data("divHourIndicatorTop",H),this.element.data("divMinuteIndicatorTop",j),this.element.data("divAMIndicatorTop",I),this.element.data("divHourIndicatorDown",B),this.element.data("divMinuteIndicatorDown",F),this.element.data("divAMIndicatorDown",q)}this._initTimePickerEvent(),this._initTouchPickerEvent("Hour"),this._initTouchPickerEvent("Minute"),this._initTouchPickerEvent("AM")},i.prototype._initTimePickerEvent=function(){var e=this,t=this.element.data("divHour"),n=this.element.data("divMinute"),r=this.element.data("divAM");t.mousewheel(function(t,n){e._hourMouseWheel(t,n)}),n.mousewheel(function(t,n){e._minuteMouseWheel(t,n)}),r.mousewheel(function(t,n){e._amMouseWheel(t,n)})},i.prototype._initDatePicker=function(){var e=this.element.data("datePicker");if(e!=undefined)return;var r=this,i=this.element.data("pickerMinYear"),s=this.element.data("pickerMaxYear"),o=this.element.data("itemHeight")*5,u=this.element.data("pickerWidth"),a=this.element.data("itemHeight")+"px",f=this.element.data("indicatorHeight")+"px",l=this.element.data("indicatorTranslateTop"),c=this.element.data("indicatorTranslateDown"),h=this.element.data("indicatorTranslateSelector"),p=this.element.data("indicatorTranslateContent"),d=this._createDivElement(document.body,u+"px"),v=this._createDivIndicatiorElement(d,a,"",h),m=this._createTableElement(d,o+"px","-",p),g=n("<tr/>").appendTo(m),y="33%",b="33%",w="33%";this.element.data("pickerDateMonthFormat")=="MMMM"&&(y="30%",b="45%",w="25%");var E=n("<td/>").css({width:y}),S=this._createPickerDivElement(E,o),x=this._createMaskElement(S,o),T=new Array;for(var N=i;N<=s;N++){var C=this._getRollText(N,this.element.data("pickerDateYearFormat")),k=this._createItemElement(N,x,a,C);T[N-i]=k}var L=n("<td/>").css({width:b}),A=this._createPickerDivElement(L,o),O=this._createMaskElement(A,o),M={};for(var N=1;N<=12;N++){var C=this._getRollText(N,this.element.data("pickerDateMonthFormat")),k=this._createItemElement(N-1,O,a,C);M[N-1]=k}var _=n("<td/>").css({width:w}),D=this._createPickerDivElement(_,o),P=this._createMaskElement(D,o),H={};for(var N=1;N<=31;N++){var C=this._getRollText(N,this.element.data("pickerDateDayFormat")),k=this._createItemElement(N,P,a,C);H[N-1]=k}var B=this.element.data("pickerDateFormat"),j=!1,F=!1,I=!1;for(var N=0;N<B.length;N++)B[N]=="yyyy"&&!j&&(E.appendTo(g),j=!0),(B[N]=="M"||B[N]=="MM"||B[N]=="MMM"||B[N]=="MMMM")&&!F&&(L.appendTo(g),F=!0),(B[N]=="d"||B[N]=="dd")&&!I&&(_.appendTo(g),I=!0);this.element.data("datePicker",d),this.element.data("divYear",S),this.element.data("divMonth",A),this.element.data("divDay",D),this.element.data("divYearMask",x),this.element.data("divMonthMask",O),this.element.data("divDayMask",P),this.element.data("pickerYearArray",T),this.element.data("pickerMonthArray",M),this.element.data("pickerDayArray",H);if(!t.Utility.IsIE8OrBelow()){var q=this._createIndicatiorElement(S,f,"-",l),R=this._createIndicatiorElement(S,f,"-",c),U=this._createIndicatiorElement(A,f,"-",l),z=this._createIndicatiorElement(A,f,"-",c),W=this._createIndicatiorElement(D,f,"-",l),X=this._createIndicatiorElement(D,f,"-",c);this.element.data("divYearIndicatorTop",q),this.element.data("divMonthIndicatorTop",U),this.element.data("divDayIndicatorTop",W),this.element.data("divYearIndicatorDown",R),this.element.data("divMonthIndicatorDown",z),this.element.data("divDayIndicatorDown",X)}this._initDatePickerEvent(),this._initTouchPickerEvent("Year"),this._initTouchPickerEvent("Month"),this._initTouchPickerEvent("Day")},i.prototype._initDatePickerEvent=function(){var e=this,t=this.element.data("divYear"),n=this.element.data("divMonth"),r=this.element.data("divDay");t.mousewheel(function(t,n){e._yearMouseWheel(t,n)}),n.mousewheel(function(t,n){e._monthMouseWheel(t,n)}),r.mousewheel(function(t,n){e._dayMouseWheel(t,n)})},i.prototype._initTouchPickerEvent=function(e){var n=this.element.data("div"+e),r=this.element.data("div"+e+"Mask");this._addPickerTouchEvent(r,e);if(!t.Utility.IsIE8OrBelow()){var i=this.element.data("div"+e+"IndicatorTop"),s=this.element.data("div"+e+"IndicatorDown");this._addPickerTouchEvent(i,e),this._addPickerTouchEvent(s,e)}},i.prototype._addPickerTouchEvent=function(e,t){var n=this;e.bind("touchstart",function(e){n._touchStart(e,t),e.preventDefault()}).bind("touchmove",function(e){n._touchMove(e,t),e.preventDefault()}).bind("touchend",function(e){n._touchEnd(e,t),e.preventDefault()})},i.prototype._touchStart=function(e,t){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=n.clientY;this.element.data("touch"+t+"StartY",r),this.element.data("touch"+t+"BaseY",this.element.data("picker"+t+"ScrollCurrent")),this.element.data("touch"+t+"Started",!0),this.element.data("touchStartTime",new Date);var i=this.element.data("picker"+t+"ScrollCurrent");this.element.data("picker"+t+"ScrollTo",i)},i.prototype._touchMove=function(e,t){if(!this._allowEdit())return;if(this.element.data("touch"+t+"Started")!=1)return;var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=n.clientY,i=this.element.data("touch"+t+"StartY"),s=this.element.data("touch"+t+"BaseY"),o=s+r-i;this._scrollTheViewByTouch(t,o)},i.prototype._touchEnd=function(e,t){var n=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0],r=this.element.data("touch"+t+"StartY"),i=this.element.data("touch"+t+"BaseY"),s=n.clientY-r,o=i+s;if(Math.abs(s)<10){var u=this.element.data("picker"+t+"ScrollCurrent");this.element.data("picker"+t+"ScrollTo",u),this._adjustTouchPosition(t,u);return}this.element.data("touch"+t+"StartY",-1),this.element.data("touch"+t+"BaseY",-1),this.element.data("touch"+t+"Started",!1);var a=new Date,f=a-this.element.data("touchStartTime");if(f<200){var l=this.element.data("itemHeight")*5,c=s<0?-1:1;s*=4,s=Math.abs(s)<l?c*l:s,o+=s,this.element.data("touchQuickScroll",!0),this.element.data("picker"+t+"ScrollRate",3)}this._adjustTouchPosition(t,o)},i.prototype._hourMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerHour"),r=this.element.data("pickerHour"),i=r;r-=t,r=r<1?1:r,r=r>12?12:r;var s=this.element.data("pickerAM");r==12?s==0&&(s=1,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,0,!1),this.element.data("pickerAM",s)):i==12&&s==1&&(s=0,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,1,!1),this.element.data("pickerAM",s)),this._updateItemTransform("Hour",r-1),this._scrollTheView("Hour",r-1,n-1,!1),this.element.data("pickerHour",r),e.preventDefault&&e.preventDefault()},i.prototype._minuteMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerMinute"),r=this.element.data("pickerMinute");r-=t,r=r<0?0:r,r=r>59?59:r,this._updateItemTransform("Minute",r),this._scrollTheView("Minute",r,n,!1),this.element.data("pickerMinute",r),e.preventDefault&&e.preventDefault()},i.prototype._amMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var r=n(e.currentTarget).data("pickerAM"),i=this.element.data("pickerAM");i-=t,i=i<0?0:i,i=i>1?1:i,this._updateItemTransform("AM",i),this._scrollTheView("AM",i,r,!1),this.element.data("pickerAM",i),e.preventDefault&&e.preventDefault()},i.prototype._yearMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerMinYear"),r=this.element.data("pickerMaxYear"),i=this.element.data("pickerYear"),s=this.element.data("pickerYear");i-=t,i=i<n?n:i,i=i>r?r:i,this._updateItemTransform("Year",i-n),this._scrollTheView("Year",i-n,s-n,!1),this.element.data("pickerYear",i),this._updateDayPickerMaxCount(),e.preventDefault&&e.preventDefault()},i.prototype._monthMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerMonth"),r=this.element.data("pickerMonth");n-=t,n=n<1?1:n,n=n>12?12:n,this._updateItemTransform("Month",n-1),this._scrollTheView("Month",n-1,r,!1),this.element.data("pickerMonth",n),this._updateDayPickerMaxCount(),e.preventDefault&&e.preventDefault()},i.prototype._dayMouseWheel=function(e,t){if(!this._allowEdit())return;if(isNaN(t))return;var n=this.element.data("pickerDayMaxCount"),r=this.element.data("pickerDay"),i=this.element.data("pickerDay");i-=t,i=i<1?1:i,i=i>n?n:i,this._updateItemTransform("Day",i-1),this._scrollTheView("Day",i-1,r-1,!1),this.element.data("pickerDay",i),e.preventDefault&&e.preventDefault()},i.prototype._hourMouseDown=function(e,t){var r=this.element.data("pickerHour"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Hour",i,r,!1),this.element.data("pickerHour",i)},i.prototype._minuteMouseDown=function(e,t){var r=this.element.data("pickerMinute"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Minute",i,r,!1),this.element.data("pickerMinute",i)},i.prototype._amMouseDown=function(e,t){var r=n(e.currentTarget).data("pickerAM"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("AM",i,r,!1),this.element.data("pickerAM",i)},i.prototype._yearMouseDown=function(e,t){var r=this.element.data("pickerMinYear"),i=n(e.currentTarget).data("rollValue"),s=this.element.data("pickerYear");this._scrollTheView("Year",i-r,s-r,!1),this.element.data("pickerYear",i),this._updateDayPickerMaxCount()},i.prototype._monthMouseDown=function(e,t){var r=this.element.data("pickerMonth"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Month",i,r,!1),this.element.data("pickerMonth",i),this._updateDayPickerMaxCount()},i.prototype._dayMouseDown=function(e,t){var r=this.element.data("pickerDay"),i=n(e.currentTarget).data("rollValue");this._scrollTheView("Day",i-1,r-1,!1),this.element.data("pickerDay",i)},i.prototype._updateCalendarPicker=function(){var e=this.element.data("calendar"),t=this.options.pickers;if(e==undefined||t==undefined)return;if(t.calendar==undefined)return;t.calendar.allowQuickPick!=undefined&&e.wijcalendar("option","allowQuickPick",t.calendar.allowQuickPick),t.calendar.navButtons!=undefined&&e.wijcalendar("option","navButtons",t.calendar.navButtons),t.calendar.nextTooltip!=undefined&&e.wijcalendar("option","nextTooltip",t.calendar.nextTooltip),t.calendar.prevTooltip!=undefined&&e.wijcalendar("option","prevTooltip",t.calendar.prevTooltip),t.calendar.showDayPadding!=undefined&&e.wijcalendar("option","showDayPadding",t.calendar.showDayPadding),t.calendar.showOtherMonthDays!=undefined&&e.wijcalendar("option","showOtherMonthDays",t.calendar.showOtherMonthDays),t.calendar.showTitle!=undefined&&e.wijcalendar("option","showTitle",t.calendar.showTitle),t.calendar.showWeekDays!=undefined&&e.wijcalendar("option","showWeekDays",t.calendar.showWeekDays),t.calendar.showWeekNumbers!=undefined&&e.wijcalendar("option","showWeekNumbers",t.calendar.showWeekNumbers),t.calendar.titleFormat!=undefined&&e.wijcalendar("option","titleFormat",t.calendar.titleFormat),t.calendar.toolTipFormat!=undefined&&e.wijcalendar("option","toolTipFormat",t.calendar.toolTipFormat),t.calendar.weekDayFormat!=undefined&&e.wijcalendar("option","weekDayFormat",t.calendar.weekDayFormat)},i.prototype._updateTimePicker=function(){var e=this.element.data("pickerHour")-1,t=this.element.data("pickerMinute"),n=this.element.data("pickerAM"),r=this.element.data("divHourMask"),i=this.element.data("divMinuteMask"),s=this.element.data("divAMMask");this._updateItemTransform("Hour",e),this._updateItemTransform("Minute",t),this._updateItemTransform("AM",n),this._scrollTheView("Hour",e,e,!0),this._scrollTheView("Minute",t,t,!0),this._scrollTheView("AM",n,n,!0),this.element.data("pickerHourScrollDelay",5),this.element.data("pickerMinuteScrollDelay",5),this.element.data("pickerAMScrollDelay",5),this.element.data("pickerHourScrollRate",1),this.element.data("pickerMinuteScrollRate",1),this.element.data("pickerAMScrollRate",1)},i.prototype._updateDatePicker=function(){var e=this.element.data("pickerMinYear"),n=this.element.data("pickerYear"),r=this.element.data("pickerMonth"),i=this.element.data("pickerDay"),s=t.DateTimeInfo.DaysInMonth(n,r);this._updateItemTransform("Year",n-e),this._updateItemTransform("Month",r-1),this._updateItemTransform("Day",i-1),this._scrollTheView("Year",n-e,n-e,!0),this._scrollTheView("Month",r-1,r-1,!0),this._scrollTheView("Day",i-1,i-1,!0),this.element.data("pickerYearScrollDelay",5),this.element.data("pickerMonthScrollDelay",5),this.element.data("pickerDayScrollDelay",5),this.element.data("pickerYearScrollRate",1),this.element.data("pickerMonthScrollRate",1),this.element.data("pickerDayScrollRate",1),this._updateDayPickerMaxCount()},i.prototype._updateDayPickerMaxCount=function(){var e=this.element.data("pickerYear"),n=this.element.data("pickerMonth"),r=this.element.data("pickerDay"),i=t.DateTimeInfo.DaysInMonth(e,n);this.element.data("pickerDayMaxCount",i);var s=this.element.data("pickerDayArray");for(var o=29;o<=31;o++){var u=o>i?"none":"";s[o-1].css("display",u)}if(r>i){var a=this.element.data("divDayMask");r=i,this._updateItemTransform("Day",r-1),this._scrollTheView("Day",r-1,null,!1),this.element.data("pickerDay",r)}},i.prototype._updateItemTransform=function(e,n){if(t.Utility.IsIE8OrBelow())return;if(n<0)return;var r=this.element.data("picker"+e+"Array"),i=this._getItemLength(e),s="skew(0deg) scale(1.2, 1.2) translate(0px, 0px)",o="skew(-5deg) scale(0.9, 0.9) translate(0px, 0px)",u="skew(-10deg) scale(0.7, 0.7) translate(0px, 0px)",a="skew(-15deg) scale(0.5, 0.5) translate(0px, 0px)";for(var f=0;f<i;f++)f==n-3?this._setCssTransform(r[f],"",a,!0):f==n-2?this._setCssTransform(r[f],"",u,!0):f==n-1?this._setCssTransform(r[f],"",o,!0):f==n?this._setCssTransform(r[f],"",s,!0):f==n+1?this._setCssTransform(r[f],"",o,!0):f==n+2?this._setCssTransform(r[f],"",u,!0):f==n+3?this._setCssTransform(r[f],"",a,!0):this._setCssTransform(r[f],"","",!0)},i.prototype._createDivElement=function(e,t){var e=n("<div/>").appendTo(e).css({width:t+"px",display:"block",left:"",top:"",position:""}).bind("touchstart",function(e){e.preventDefault()}).bind("touchmove",function(e){e.preventDefault()});return e},i.prototype._createTableElement=function(e,t,r,i){var s=n("<table/>").appendTo(e).css({width:"100%",height:t+"px"}).attr({cellspacing:"0px",cellpadding:"0px"});return this._setCssTransform(s,r,i,!1),s},i.prototype._createItemElement=function(e,t,r,i){var s=n("<div/>").appendTo(t).css({height:r,lineHeight:r,cursor:"default"}).html(i).data("rollValue",e);return s},i.prototype._createPickerDivElement=function(e,t){var r=n("<div/>").appendTo(e).css({height:t,border:"0px","text-align":"center",overflow:"hidden",background:"transparent"});return r},i.prototype._createMaskElement=function(e,t){var r=n("<div/>").appendTo(e).css({height:t});return r},i.prototype._createDivIndicatiorElement=function(e,t,r,i){var s=n("<div/>").appendTo(e).css({height:t,opacity:"0.5",lineHeight:t,margin:"0px",cursor:"default"}).attr("class","ui-state-active");return this._setCssTransform(s,r,i,!1),s},i.prototype._createIndicatiorElement=function(e,t,r,i){var s=n("<div/>").appendTo(e).css({height:t,opacity:"0.5",lineHeight:t,"border-width":"0px",cursor:"default"}).attr("class","ui-widget-content");return this._setCssTransform(s,r,i,!1),s},i.prototype._hideItemInIE7=function(e,n){if(!t.Utility.IsIE7())return;var r=this.element.data("picker"+e+"LastItemIndex"),i=this._getItemIndexByPosition(e,n);if(i==r)return;var s=i-2,o=i+2,u=this.element.data("picker"+e+"Array"),a=this._getItemLength(e);for(var f=0;f<a;f++)f>=s&&f<=o?u[f].css("visibility",""):u[f].css("visibility","hidden");this.element.data("picker"+e+"LastItemIndex",i)},i.prototype._okButtonMouseDown=function(t,n){var r=this.element.data("pickerYear"),i=this.element.data("pickerMonth")-1,s=this.element.data("pickerDay"),o=this.element.data("pickerHour"),u=this.element.data("pickerMinute"),a=this.element.data("pickerAM");o==12&&(o=0),a==1&&(o+=12);var f=this._getPickerValue();f.setFullYear(r),f.setMonth(i),f.setDate(s),f.setHours(o),f.setMinutes(u),e.prototype._wasPopupShowing=!1;var l=this.element.data("pickers");l!=undefined&&l.wijpopup("hide"),this._allowEdit()&&(this.option("date",f),this.selectText()),this._trySetFocus()},i.prototype._getCorrentPickerFormat=function(e){for(var t=0;t<e.length-1;t++)for(var n=t+1;n<e.length;n++)if(e[n].index<e[t].index){var r=e[t];e[t]=e[n],e[n]=r}var i="";for(var t=0;t<e.length;t++)i+=e[t].value,t<e.length-1&&(i+=",");return i},i.prototype._getDefaultDatePickerFormat=function(){var e=this._getCulture();if(e==null)return"yyyy,M,d";var t=e.calendars.standard,n=t.patterns.d,r={index:n.indexOf("y"),value:"yyyy"},i={index:n.indexOf("M"),value:"MM"},s={index:n.indexOf("d"),value:"dd"};if(r.index==-1||i.index==-1||s.index==-1)return"yyyy,M,d";var o=new Array;return o[0]=r,o[1]=i,o[2]=s,this._getCorrentPickerFormat(o)},i.prototype._getDefaultTimePickerFormat=function(){if(this.options.culture.length>=2){var e=this.options.culture.substr(0,2);if(e=="ja"||e=="zh")return"tt,hh,mm"}return"hh,mm,tt"},i.prototype._getListPickerWidth=function(){var e=this._getcomboWidth(),t=this.element.data("pickerWidth"),n=e!=undefined?e:this.outerDiv.width();return t>n?t+"px":n+"px"},i.prototype._getDatePickerMinYear=function(){var e=this._isEraFormatExist()?this._getRealEraMinDate():this._getRealMinDate(),t=e.getFullYear(),n=this._getPickerValue(),r=this._max(n.getFullYear()-50,t);return r},i.prototype._getDatePickerMaxYear=function(){var e=this._isEraFormatExist()?this._getRealEraMaxDate():this._getRealMaxDate(),t=e.getFullYear(),n=this._getPickerValue(),r=this._min(n.getFullYear()+50,t);return r},i.prototype._getPickerValue=function(){var e=this.options.date;return e=e==null?new Date:e,e},i.prototype._getRollFormat=function(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)!=-1)return e[n];return""},i.prototype._getRollText=function(e,t){var n=this._getCulture(),r="";switch(t){case"M":case"h":r=e.toString();break;case"MM":case"hh":r=e<10?"0"+e.toString():e.toString();break;case"m":case"d":case"yyyy":r=e.toString();break;case"mm":case"dd":r=e<10?"0"+e.toString():e.toString();break;case"t":r=e==0?this._getStandardAMPM("AM"):this._getStandardAMPM("PM"),r=r.substr(0,1);break;case"tt":r=e==0?this._getStandardAMPM("AM"):this._getStandardAMPM("PM");break;case"MMM":r=n.calendars.standard.months.namesAbbr[e-1];break;case"MMMM":r=n.calendars.standard.months.names[e-1];break;default:}return r},i.prototype._getStandardAMPM=function(e){var t=this._getCulture();if(t&&t.calendar){var n=t.calendars.standard[e];if(n)return n[0]}return e},i.prototype._getItemIndexByPosition=function(e,t){var n=this._getTouchPositionArray(e),r=this._getItemLength(e);e=="Day"&&r>this.element.data("pickerDayMaxCount")&&(r=this.element.data("pickerDayMaxCount"));var i=-1;for(var s=0;s<r;s++){if(s==0){if(t>n[s]){i=0;break}}else if(t<=n[s-1]&&t>=n[s]){var o=n[s-1]-t,u=t-n[s];i=o>u?s:s-1;break}if(s==r-1&&t<n[s]){i=s;break}}return i},i.prototype._getItemLength=function(e){switch(e){case"Hour":case"Month":return 12;case"Year":var t=this.element.data("pickerMinYear"),n=this.element.data("pickerMaxYear");return n-t+1;case"Day":return 31;case"Minute":return 60;case"AM":return 2}return-1},i.prototype._getTouchPositionArray=function(e){var t={},n=this.element.data("itemHeight"),r=this._getItemLength(e);for(var i=0;i<r;i++)t[i]=(2-i)*n;return t},i.prototype._adjustTouchPosition=function(e,t){var n=this._getTouchPositionArray(e),r=this._getItemIndexByPosition(e,t),i=this._itemIndexToValue(e,r);this.element.data("picker"+e,i),this._scrollTheViewByTouch(e,n[r])},i.prototype._itemIndexToValue=function(e,t){switch(e){case"Minute":case"AM":return t;case"Hour":case"Month":case"Day":return t+1;case"Year":var n=this.element.data("pickerMinYear");return n+t}return-1},i.prototype._scrollTheView=function(e,t,n,r){var i=this.element.data("itemHeight"),s=(2-t)*i;this.element.data("picker"+e+"ScrollTo",s);if(r==1){var o=this.element.data("div"+e+"Mask"),u=s;this._setCssTransform(o,"",u,!1),this._hideItemInIE7(e,u),this.element.data("picker"+e+"ScrollCurrent",u)}else this._scrollPicker(e)},i.prototype._scrollPicker=function(e){var t=this.element.data("div"+e+"Mask"),n=this.element.data("picker"+e+"ScrollTo"),r=this.element.data("picker"+e+"ScrollCurrent"),i=this.element.data("picker"+e+"ScrollDelay");r==undefined&&(r=n,this._setCssTransform(t,"",r,!1),this.element.data("picker"+e+"ScrollCurrent",r));if(n==r||r==undefined)return!1;r+=n>r?1:-1;var s="translate(0,"+r+"px) ";this._setCssTransform(t,"",r,!1),this._hideItemInIE7(e,r),this.element.data("picker"+e+"ScrollCurrent",r);var o=this;return setTimeout(function(){o._scrollPicker(e)},i),!0},i.prototype._scrollTheViewByTouch=function(e,t){var n=this.element.data("itemHeight"),r=this.element.data("picker"+e+"ScrollCurrent"),i=this.element.data("picker"+e+"ScrollTo");this.element.data("picker"+e+"ScrollTo",t),this._scrollPickerByTouch(e)},i.prototype._setCssTransform=function(e,n,r,i){var s=r;i||(s="translate(0, "+n+r+"px)"),e.css("position",""),e.css("top",""),t.Utility.IsIE8OrBelow()?(e.css("position","relative"),e.css("top",n+r+"px")):t.Utility.IsIE9()?e.css("-ms-transform",s):e.css("transform",s)},i.prototype._scrollPickerByTouch=function(e){var t=this.element.data("div"+e+"Mask"),n=this.element.data("picker"+e+"ScrollTo"),r=this.element.data("picker"+e+"ScrollCurrent");r==undefined&&(r=n,this._setCssTransform(t,"",r,!1),this.element.data("picker"+e+"ScrollCurrent",r));if(n==r){this.element.data("picker"+e+"ScrollRate",1),this.element.data("picker"+e+"ScrollDelay",5),this.element.data("touchQuickScroll",!1);if(e=="Month"||e=="Year")this._updateDayPickerMaxCount();else if(e=="Hour"){var i=this._getItemIndexByPosition(e,r),s=this.element.data("pickerAM");i==11?s==0&&(s=1,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,0,!1),this.element.data("pickerAM",s)):s==1&&(s=0,this._updateItemTransform("AM",s),this._scrollTheView("AM",s,1,!1),this.element.data("pickerAM",s))}return!1}var o=this.element.data("itemHeight"),u=this.element.data("picker"+e+"ScrollDelay"),a=this.element.data("picker"+e+"ScrollRate"),f=Math.abs(n-r),l=f>a?a:f;this.element.data("touchQuickScroll")==1&&(f<o?u=80:f<o*2?u=50:f<o*5?u=30:f<o*8?u=20:f<o*10&&(u=10),this.element.data("picker"+e+"ScrollDelay",u)),r+=n>r?l:-1*l,this._setCssTransform(t,"",r,!1),this.element.data("picker"+e+"ScrollCurrent",r);var i=this._getItemIndexByPosition(e,r),c=this.element.data("picker"+e+"LastItemIndex");i!=c&&this._updateItemTransform(e,i),this.element.data("picker"+e+"LastItemIndex",c);var h=this;return setTimeout(function(){h._scrollPickerByTouch(e)},u),!0},i.prototype._syncCalendar=function(){var e=this.element.data("calendar");if(!e)return;var t=this._safeGetDate();if(t==null||this._isMinDate(t))t=new Date;e.wijcalendar("option","displayDate",t),this.options.minDate&&e.wijcalendar("option","minDate",this.options.minDate),this.options.maxDate&&e.wijcalendar("option","maxDate",this.options.maxDate),e.wijcalendar("unSelectAll"),e.wijcalendar("selectDate",t),e.wijcalendar("refresh")},i.prototype._showPopup=function(){this._isDatePickerNeedReInit()&&this._reInitPicker();var e=this.element.data("pickers");if(e==undefined)return!1;e.wijpopup("show",n.extend({},this.options.popupPosition,{of:this.outerDiv}));var t=this._getPickerValue(),r=t.getHours();r>12?r-=12:r==0&&(r=12),this.element.data("pickerValue",t),this.element.data("pickerYear",t.getFullYear()),this.element.data("pickerMonth",t.getMonth()+1),this.element.data("pickerDay",t.getDate()),this.element.data("pickerHour",r),this.element.data("pickerMinute",t.getMinutes()),this.element.data("pickerAM",t.getHours()<12?0:1),this.element.data("divOK").css("visibility",""),this._isTimePickerShown()&&(this._updateTimePicker(),e.attr({"class":"ui-widget-content ui-corner-all"})),this._isDatePickerShown()&&(this._updateDatePicker(),e.css({"font-size":"12px"}).attr({"class":"ui-widget-content ui-corner-all"}));if(this._isListPickerShown()){this._getPickerCount()==1&&(e.attr({"class":""}),this._comboDiv.focus());if(this.element.data("pickerCurrentTab")=="List"){var i=this._getListPickerWidth();e.css({width:i,height:""}),e.css({"font-size":""});var s=this._comboDiv[0].parentElement;this._comboDiv.wijlist("destroy"),this._comboDiv.remove(),delete this._comboDiv,this._initListPicker(),this._comboDiv.appendTo(s),this._comboDiv.focus()}}return this._isCalendarPickerShown()&&(this._syncCalendar(),this.element.data("pickerCurrentTab")=="Calendar"&&(this._getPickerCount()<=1&&e.css({width:""}),e.css({"font-size":""}))),!0},i.prototype._hidePopup=function(){var e=this.element.data("pickers");e!=undefined&&e.wijpopup("hide"),this.element.data("divOK").css("visibility","hidden")},i.prototype._popupVisible=function(){var e=this.element.data("pickers");return e!=undefined?e.wijpopup("isVisible"):!1},i.prototype._isComboListVisible=function(){return this._popupVisible()},i.prototype._isValidDate=function(e,t){if(e===undefined)return!1;if(isNaN(e))return!1;if(e.getFullYear()<1||e.getFullYear()>9999)return!1;if(t){if(this.options.minDate&&e<this.options.minDate)return!1;if(this.options.maxDate&&e>this.options.maxDate)return!1}return!0},i.prototype._isValidatePickerFormat=function(e){switch(e){case"yyyy":case"M":case"MM":case"MMM":case"MMMM":case"d":case"dd":case"h":case"hh":case"m":case"mm":case"t":case"tt":return!0}return!1},i.prototype._isDatePickerNeedReInit=function(){if(!this._isDatePickerShown())return!1;var e=this.element.data("pickerMinYear"),t=this.element.data("pickerMaxYear"),n=this._getPickerValue().getFullYear();if(n<e||n>t)return!0;var r=this._isEraFormatExist()?this._getRealEraMinDate().getFullYear():this._getRealMinDate().getFullYear(),i=this._isEraFormatExist()?this._getRealEraMaxDate().getFullYear():this._getRealMaxDate().getFullYear();return e<r||t>i?!0:!1},i.prototype._isDropDownButtonShown=function(){return this.options.showDropDownButton},i.prototype._isCalendarPickerShown=function(){return this.options.pickers.calendar!=undefined&&this.options.pickers.calendar.visible!==!1||this._getPickerCount()==0},i.prototype._isListPickerShown=function(){var e=this._getcomboItems();return e!=undefined&&e.length!=undefined?e.length>0:!1},i.prototype._isTimePickerShown=function(){return this.options.pickers.timePicker!=undefined&&this.options.pickers.timePicker.visible!==!1},i.prototype._isDatePickerShown=function(){return this.options.pickers.datePicker!=undefined&&this.options.pickers.datePicker.visible!==!1},i.prototype._getPickerCount=function(){var e=0,t=this.options.pickers.calendar!=undefined&&this.options.pickers.calendar.visible!==!1;return e+=t?1:0,e+=this._isListPickerShown()?1:0,e+=this._isTimePickerShown()?1:0,e+=this._isDatePickerShown()?1:0,e},i.prototype._addPickerEditor=function(e,t,r){var i=n("<div/>").attr({id:r,align:"center"}).css({padding:"0px"}).append(t).appendTo(e)},i.prototype._addPickerTab=function(e,t,r){var i=n("<li/>").appendTo(e).css("line-height","1px"),s=n("<a/>").attr("href",r).html(t).appendTo(i)},i.prototype._internalSetDate=function(e){var t=this,n=this.options,r=this.element,i=!!r.data("typing"),s;i?(n.date=e,s=function(){var e=new Date,i=r.data("timeStamp");i&&(e.getTime()-i.getTime()>n.keyDelay?(t._safeSetDate(n.date,!0),t._updateText(),t._highLightField()):window.setTimeout(s,n.keyDelay))},window.setTimeout(s,n.keyDelay)):this._safeSetDate(e)},i.prototype.selectText=function(t,n){typeof t=="undefined"&&(t=0),typeof n=="undefined"&&(n=this.getText().length);if(this.isFocused())e.prototype.selectText.call(this,t,n);else{this.element.data("IsInSelectTextMethod",!0),this.focus();var r=this;setTimeout(function(){try{r.selectText(t,n)}catch(e){}},0),this.element.data("IsInSelectTextMethod",!1)}},i}(t.wijinputcore);t.wijinputdate=i;var s=function(){function e(){this.wijCSS={wijinputdate:t.wijinputcore.prototype.options.wijCSS.wijinput+"-date"},this.date=undefined,this.minDate=null,this.maxDate=null,this.dateFormat="d",this.displayFormat="",this.amDesignator="",this.pmDesignator="",this.midnightAs0=!0,this.hour12As0=!1,this.blurOnLastChar=!1,this.blurOnLeftRightKey="none",this.tabAction="field",this.startYear=1950,this.smartInputMode=!1,this.activeField=0,this.keyDelay=800,this.autoNextField=!0,this.calendar="default",this.popupPosition={offset:"0 4"},this.highlightText="field",this.increment=1,this.imeMode="auto",this.showDropDownButton=!0,this.showTrigger=undefined,this.pickers={list:undefined,width:undefined,height:undefined,calendar:undefined,datePicker:undefined,timePicker:undefined},this.dateChanged=null,this.spinUp=null,this.spinDown=null,this.valueBoundsExceeded=null}return e}();i.prototype.options=n.extend(!0,{},t.wijinputcore.prototype.options,new s),n.wijmo.registerWidget("wijinputdate",i.prototype);var o=function(){function e(e,n,r){this.inputWidget=e,this._disableSmartInputMode=!1,this.paddingZero=t.paddingZero,this.formatter=new t.wijDateTextFormatter(e,n,!1),r=r==""?n:r,this.displayFormatter=new t.wijDateTextFormatter(e,r,!0)}return e.prototype.initialize=function(){},e.prototype.getFiledText=function(e){var t=this.formatter.fields[e];return t.getText()},e.prototype.getFieldCount=function(){return this.formatter.fields.length},e.prototype.getFieldRange=function(e){e>=this.formatter.fields.length&&(e=this.formatter.fields.length-1);var t=this.formatter.fields[e];return{start:t.startIndex,end:t.startIndex+t.getText().length}},e.prototype.getAllRange=function(){return{start:0,end:this.formatter.toString().length}},e.prototype.getCursorField=function(e){if(this.formatter.desPostions.length==0)return 0;e=Math.min(e,this.formatter.desPostions.length-1),e=Math.max(e,0);var t=this.formatter.desPostions[e].desc,r;if(t.type===-1){r=n.inArray(t,this.formatter.descriptors);if(!(r>0&&this.formatter.descriptors[r-1].type!==-1))return-1;t=this.formatter.descriptors[r-1]}return n.inArray(t,this.formatter.fields)},e.prototype.needToMove=function(e,n,r){if(!this.inputWidget._isValidDate(this.inputWidget._safeGetDate(),!0))return!1;var i=this.formatter.fields[e];switch(i.type){case 72:case 73:case 74:for(var s=0;s<t.DateTimeInfo.GetEraCount();s++)if(r.toLowerCase()===t.DateTimeInfo.GetEraShortcuts()[s].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraShortNames()[s].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraAbbreviations()[s].toLowerCase()||r.toLowerCase()===t.DateTimeInfo.GetEraNames()[s].toLowerCase())return!0;return!1}var o=parseInt(r,10);if(n===i.maxLen)return!0;if(isNaN(o))return!1;var u=this.inputWidget.element.data("lastInputChar");switch(i.type){case 10:return this._isSmartInputMode()&&n===2;case 20:case 25:case 45:case 46:return u=="0"&&o==1?!0:o>1;case 47:case 48:return u=="0"&&o<=2?!0:o>2;case 30:case 31:return u=="0"&&o<=3?!0:o>3;case 50:case 51:case 60:case 61:return u=="0"&&o<=6?!0:o>6;case 70:case 71:return!1}return!1},e.prototype._isEraFormatExist=function(){return this.formatter._isEraFormatExist()},e.prototype._getCulture=function(){return this.inputWidget._getCulture()},e.prototype._isDigitString=function(e){e=n.trim(e);if(e.length===0)return!0;var t=e.charAt(0),r,i;if(t==="+"||t==="-")e=e.substr(1),e=n.trim(e);if(e.length===0)return!0;try{return r=parseFloat(e),i=r.toString(),i===e}catch(s){return!1}},e.prototype._setFormat=function(e){return this.formatter._setFormat(e)},e.prototype._setDisplayFormat=function(e){return this.displayFormatter._setFormat(e)},e.prototype._internalSetDate=function(e){this.inputWidget&&this.inputWidget._internalSetDate(e)},e.prototype.toString=function(){if(this.inputWidget._isEraFormatExist()&&this.inputWidget.options.date!=null){var e=this.inputWidget._getRealEraMinDate(),t=this.inputWidget._getRealEraMaxDate();if(this.inputWidget.options.date<e||this.inputWidget.options.date>t)return""}return this.inputWidget.isFocused()?this.formatter.toString():this.inputWidget.isDateNull()&&this.inputWidget._getInnerNullText()!=null?this.inputWidget._getInnerNullText():this.displayFormatter.toString()},e.prototype.parseDate=function(e){var t;return t=n.wijinputcore.parseDate(e,this.formatter.pattern,this._getCulture()),t},e.prototype.setText=function(e){var t=this.parseDate(e);return t==null?this._internalSetDate(null):this._internalSetDate(new Date(t)),!0},e.prototype.haveEnumParts=function(){return!1},e.prototype.removeLiterals=function(e){return e=""+e+"",e=e.replace(new RegExp("[+]","g"),""),e=e.replace(new RegExp("[.]","g"),""),e=e.replace(new RegExp("[:]","g"),""),e=e.replace(new RegExp("[-]","g"),""),e=e.replace(new RegExp("[()=]","g"),""),e},e.prototype.getFirstDelimiterPos=function(e,t){var n=0,r=0,i,s;while(n<t.length&&r<e.length){i=t.charAt(n),s=e.charAt(r);if(i!==s)return r-1;r++,n++}return e.length-1},e.prototype.isFieldSep=function(e,t){var n=t++,r;return n<this.formatter.descriptors.length?(r=this.formatter.descriptors[n],r.type!==-1?!1:e===r.text):!1},e.prototype.getPositionType=function(e){var t=this.formatter.desPostions[e];return t.desc.type},e.prototype.addToField=function(e,t,n){var r=this.formatter.fields[t],i,s,o;return i=e,s={val:e,pos:0,offset:0,isreset:!1},this.inputWidget.element.data("typing",!0),o=r.setText(i,e.length===1?!1:!0,s,this._isSmartInputMode()),this.inputWidget.element.data("typing",!1),o},e.prototype.insertAt=function(e,n,r){typeof r=="undefined"&&(r=new t.wijInputResult),r.testPosition=-1;var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;if(e.length===1){i=this.formatter.desPostions[n];if(i&&i.desc.type===-1&&i.text===e)return r.testPosition=n,r.hint=r.characterEscaped,!0}s=e,o=n,e=this.removeLiterals(e),u=e,a=!1,l=!1,o>0&&u.length===1&&(o--,n=o,i=this.formatter.desPostions[o],a=!0,i&&(i.desc.type===-1||i.desc.getText().length!==1)&&(n++,o++,a=!1)),f=!1;while(u.length>0&&o<this.formatter.desPostions.length){i=this.formatter.desPostions[o];if(i.desc.type===-1){o+=i.length;continue}if(i.desc.needAdjustInsertPos()){c=u.substr(0,i.length-i.pos),c=i.text.slice(0,i.pos)+c+i.text.slice(i.pos+c.length,i.length),a&&(c=i.text+c),l&&(c+=i.text),p=i.desc.getText().length,v="";try{e.length===1&&(i.pos?i.pos>0&&(v=c.substring(0,i.pos+1)):v=e)}catch(E){}p===1&&c.length>1&&e.length===1&&(i.desc.type===31||i.desc.type===25)&&(this._disableSmartInputMode=!0),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),this._disableSmartInputMode=!1,!f&&typeof v!="undefined"&&v.length>0&&(i.desc.type===26||i.desc.type===27||i.desc.type===100||i.desc.type===101||i.desc.type===250||i.desc.type===251)&&(f=i.desc.setText(v,e.length===1?!1:!0,h));if(f)r.hint=r.success,r.testPosition=o+h.offset,e.length===1&&(m=i.desc.getText().length,d=i.pos,i.pos>m-1&&(d=m),g=m-p,g>0&&i.pos===p-1&&(d=m-1),y=this.toString(),r.testPosition=i.desc.startIndex+d+h.offset),u=u.slice(i.length-i.pos,u.length);else{r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n);if(i.desc.type!==-1&&e.length===1)return!1}o+=i.length}else b=this.getFirstDelimiterPos(u,s),b<0&&(b=0),c=u.substring(0,b+1),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),f?(r.hint=r.success,r.testPosition=o+h.offset,u=u.slice(b+1,u.length)):(r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n)),b<0&&(b=0),w=b+1,o+=w}return f},e.prototype.removeAt=function(e,t,n,r){try{var i=this.formatter.desPostions[e],s,o,u,a,f=this.inputWidget,l=f.element,c=l.val().length;return c===t+1&&e===0&&(f.isDeleteAll=!0),i.desc.needAdjustInsertPos()&&(s="0",o=e,i.text=i.desc.getText(),s=i.text.slice(0,i.pos)+s+i.text.slice(i.pos+s.length,i.length),i.desc.name==="tt"?s="AM":i.desc.name==="t"?s="A":i.desc.formatString==="ee"?s="01":i.desc.formatString==="e"&&(s="1"),u={val:s,pos:i.pos,offset:0,isreset:!0,isfullreset:!1},t-e+1>=i.length&&(u.isfullreset=!0,e+=i.length,o=e),a=i.desc.setText(s,!1,u,this._isSmartInputMode()),a?(n.hint=n.success,n.testPosition=o):(n.hint=n.invalidInput,n.testPosition===-1&&(n.testPosition=e))),e<t&&this.removeAt(e+1,t,n),!0}catch(h){return!1}},e.prototype.incEnumPart=function(){var e=this.formatter.fields[this.inputWidget.options.activeField];return e&&e.inc(),!0},e.prototype.decEnumPart=function(){var e=this.formatter.fields[this.inputWidget.options.activeField];return e&&e.dec(),!0},e.prototype._isSmartInputMode=function(){return this._disableSmartInputMode?!1:this.inputWidget?this.inputWidget.options.smartInputMode:!0},e.prototype._getInt=function(e,t,r,i){var s,o;for(s=i;s>=r;s--){o=e.substring(t,t+s);if(o.length<r)return null;if(n.wij.charValidator.isDigit(o))return o}return null},e.prototype._tryParseDate=function(e,t){var n=this._getCulture().calendars,r,i,s,o;return t=t||n.standard.patterns.d,t&&(t.indexOf("MMM")===-1&&t.indexOf("MMMM")===-1&&(t=t.replace("MM","M")),t=t.replace("dd","d"),t=t.replace("tt","a")),r=t.replace("yyyy","yy"),i=n.standard["/"],s=[t,r,t.replace(new RegExp(i,"g"),"-"),r.replace(new RegExp(i,"g"),"-"),t.replace(new RegExp(i,"g"),"."),r.replace(new RegExp(i,"g"),".")],o=Globalize.parseDate(e,s,this._getCulture()),o?o:(o=new Date(e),o.toString()!=="Invalid Date"&&e&&e!==""?o:0)},e.prototype._formatDate=function(e,n,r){var i=this;if(!e.valueOf())return"&nbsp;";var s=this.inputWidget._getCulture().calendars.standard,o=n.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(n){var o;switch(n){case"yyyy":return t.paddingZero(e.getFullYear(),4);case"MMMM":return r.dateTimeFormat.monthNames[e.getMonth()];case"MMM":return r.dateTimeFormat.abbreviatedMonthNames[e.getMonth()];case"MM":return i.paddingZero(e.getMonth()+1,2);case"M":return i.paddingZero(e.getMonth()+1,1);case"mm":return i.paddingZero(e.getMinutes(),2);case"m":return i.paddingZero(e.getMinutes(),1);case"dddd":return r.dateTimeFormat.dayNames[e.getDay()];case"ddd":return r.dateTimeFormat.abbreviatedDayNames[e.getDay()];case"dd":return i.paddingZero(e.getDate(),2);case"d":return i.paddingZero(e.getDate(),1);case"hh":return o=e.getHours()%12,i.paddingZero(o?o:12,2);case"h":return o=e.getHours()%12,i.paddingZero(o?o:12,1);case"HH":return i.paddingZero(e.getHours(),2);case"H":return i.paddingZero(e.getHours(),1);case"ss":return i.paddingZero(e.getSeconds(),2);case"s":return i.paddingZero(e.getSeconds(),1);case"tt":return e.getHours()<12?s.AM[0]:s.PM[0];case"t":return e.getHours()<12?s.AM[0].length>0?s.AM[0].charAt(0):"":s.PM[0].length>0?s.PM[0].charAt(0):"";case"a/p":return e.getHours()<12?"a":"p"}return"N"});return o},e.prototype.replaceWith=function(e,n){var r=e.start,i=new t.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(n,r,i)?i:null},e}();t.wijDateTextProvider=o})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function t(e,t,n){this.filterLabel=e,this._include=n,this._owner=t}return t.prototype.Check=function(e,t){var n={};n.success=!1,n.strValue="",n.index=t;var r=e.Substring(t,t+1),i=this.IsValid(r);if(i)return e=e.Substring(t,t+1),t++,n.strValue=e,n.index=t,n;if(this._owner.GetAutoConvert()&&(r.length===1||r.length===3)){n=this.Convert(e,t);if(n.success)return n}return n},t.prototype.IsValid=function(t){return t.length===2&&(t.charCodeAt(1)===65438||t.charCodeAt(1)===65439)&&!e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsKatakana(t)?this.IsValidTwoByte(t):t.length>1?this.IsValidMoreByte(t):this.IsValidTwoByte(t)},t.prototype.IsValidTwoByte=function(e){return!1},t.prototype.IsValidMoreByte=function(e){return!1},t.prototype.Convert=function(t,n){var r={};r.success=!0,r.strValue="",r.index=n;var i=t.Substring(n,n+1),s,o=e.CharProcess.CharEx;if(o.IsAlphabet(i)){var u=o.IsLower(i)?i.toUpperCase():i.toLowerCase();return s=this.IsValid(u),s&&this._include||!s&&!this._include?(n++,r.index=n,r.strValue=u,r):(i=o.IsFullWidth(i)?o.ToHalfWidth(i):o.ToFullWidth(i).text,s=this.IsValid(i),s&&this._include||!s&&!this._include?(n++,r.index=n,r.strValue=i,r):(u=o.IsFullWidth(u)?o.ToHalfWidth(u):o.ToFullWidth(u).text,s=this.IsValid(u),s&&this._include||!s&&!this._include?(n++,r.index=n,r.strValue=u,r):(r.success=!1,r)))}if(o.IsHiragana(i)){if(o.IsLowerKana(i)){var a=o.ToUpperKana(i);s=this.IsValid(a);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=a,r}else if(o.HasLowerKana(i)){var f=o.ToLowerKana(i);s=this.IsValid(f);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=f,r}i=o.ToKatakana(i),s=this.IsValid(i);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=i,r;if(o.IsLowerKana(i)){var a=o.ToUpperKana(i);s=this.IsValid(a);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=a,r}else if(o.HasLowerKana(i)){var f=o.ToLowerKana(i);s=this.IsValid(f);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=f,r}var l=o.ToHalfWidthEx(i);s=this.IsValid(l);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=l,r;if(o.IsLowerKana(l)){l=o.ToUpperKana(l),s=this.IsValid(l);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=l,r}else if(o.HasLowerKana(l)){l=o.ToLowerKana(l),s=this.IsValid(l);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=l,r}return r.success=!1,r}if(o.IsKatakana(i)){if(o.IsLowerKana(i)){var a=o.ToUpperKana(i);s=this.IsValid(a);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=a,r}else if(o.HasLowerKana(i)){var f=o.ToLowerKana(i);s=this.IsValid(f);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=f,r}var u=i,c=!1;if(o.IsFullWidth(i)){var h=o.ToHalfWidthEx(i);if(h.GetLength()>0){s=this.IsValid(h);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=h,r}if(o.IsLowerKana(h)){h=o.ToUpperKana(h),s=this.IsValid(h);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=h,r}else if(o.HasLowerKana(h)){h=o.ToLowerKana(h),s=this.IsValid(h);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=h,r}}else{if(n==null){u=o.ToFullWidth(i).text;if(!o.IsKatakana(u))return r;s=this.IsValid(u);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=u,r}else{if(n+1<t.GetLength()){var p=o.ToFullWidth(t.Substring(n,n+2));u=p.text,c=p.processedAll}else u=o.ToFullWidth(i).text;if(!o.IsKatakana(u))return r;s=this.IsValid(u);if(s&&this._include||!s&&!this._include)return n++,c&&n++,r.index=n,r.strValue=u,r}if(o.IsLowerKana(u)){var a=o.ToUpperKana(u);s=this.IsValid(a);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=a,r}else if(o.HasLowerKana(u)){var f=o.ToLowerKana(u);s=this.IsValid(f);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=f,r}}u=o.ToHiragana(u),s=this.IsValid(u);if(s&&this._include||!s&&!this._include)return n++,c&&n++,r.index=n,r.strValue=u,u==="\u3094"&&(c?r.strValue="\u3046\u309b":(n--,r.index=n,r.strValue="",r.success=!1)),r;if(o.IsLowerKana(u)){var a=o.ToUpperKana(u);s=this.IsValid(a);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=a,r}else if(o.HasLowerKana(u)){var f=o.ToLowerKana(u);s=this.IsValid(f);if(s&&this._include||!s&&!this._include)return n++,r.index=n,r.strValue=f,r}}return i=o.IsFullWidth(i)?o.ToHalfWidth(i):o.ToFullWidth(i).text,s=this.IsValid(i),s&&this._include||!s&&!this._include?(n++,r.index=n,r.strValue=i,r):(r.success=!1,r)},t}();e.CharacterFilter=n;var r=function(t){function n(e,n){t.call(this,"HalfWidthFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsFullWidth(t)?t==="\r"||t==="\n"?!0:!1:!0},n}(n),i=function(t){function n(e,n){t.call(this,"FullWidthFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsFullWidth(t)?!0:t==="\r"||t==="\n"?!0:!1},n}(n),s=function(t){function n(e,n){t.call(this,"HiraganaFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsHiragana(t)?!0:t==="\r"||t==="\n"?!0:!1},n}(n),o=function(t){function n(e,n){t.call(this,"ShiftJISFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsShiftJIS(t)},n}(n),u=function(t){function n(e,n){t.call(this,"JISX0208Filter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsJISX0208(t)},n}(n),a=function(t){function n(e,n){t.call(this,"DBCSHiraganaFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsUpperKana(t)&&e.CharProcess.CharEx.IsHiragana(t)},n}(n),f=function(t){function n(e,n){t.call(this,"DBCSKatakanaFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsKatakana(t)&&!e.CharProcess.CharEx.IsLowerKana(t)},n}(n),l=function(t){function n(e,n){t.call(this,"SBCSKatakanaFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return!e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsKatakana(t)&&!e.CharProcess.CharEx.IsLowerKana(t)},n}(n),c=function(t){function n(e,n){t.call(this,"SurrogateFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsSurrogatePair(t)?!0:t==="\r"||t==="\n"?!0:!1},n.prototype.IsValidMoreByte=function(t){for(var n=0;n<t.length;n++)if(e.CharProcess.CharEx.IsSurrogate(t[n]))return!0;return!1},n}(n),h=function(t){function n(e,n){t.call(this,"HalfWidthKatakanaFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return!e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsKatakana(t)?!0:t==="\r"||t==="\n"?!0:!1},n}(n),p=function(t){function n(e,n){t.call(this,"FullWidthKatakanaFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsKatakana(t)?!0:t==="\r"||t==="\n"?!0:!1},n}(n),d=function(t){function n(e,n){t.call(this,"HalfWidthSymbolsFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return!e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsSymbol(t)?!0:t==="\r"||t==="\n"?!0:!1},n}(n),v=function(t){function n(e,n){t.call(this,"FullWidthSymbolsFilter",e,n)}return __extends(n,t),n.prototype.IsValidTwoByte=function(t){return e.CharProcess.CharEx.IsFullWidth(t)&&e.CharProcess.CharEx.IsSymbol(t)?!0:t==="\r"||t==="\n"?!0:!1},n}(n),m=function(e){function t(t,n,r,i){e.call(this,"LimitedFilter",r,i),this._includeChars=t,this._excludeChars=n}return __extends(t,e),t.prototype.IsValidTwoByte=function(e){return this._includeChars!==""&&this._includeChars.IndexOf(e)>-1||this._excludeChars!==""&&this._excludeChars.IndexOf(e)===-1?!0:e==="\r"||e==="\n"?!0:!1},t.prototype.IsValidMoreByte=function(e){return this._includeChars!==""&&this._includeChars.IndexOf(e)>-1||this._excludeChars!==""&&this._excludeChars.IndexOf(e)===-1?!0:e==="\r"||e==="\n"?!0:!1},t}(n),g=function(e){function t(t,n,r,i){e.call(this,"RangeFilter",r,i),this._startChar=t,this._endChar=n}return __extends(t,e),t.prototype.IsValidTwoByte=function(e){return e>=this._startChar&&e<=this._endChar?!0:e==="\r"||e==="\n"?!0:!1},t}(n),y=function(e){function t(t,n){e.call(this,"UnionFilter",t,n),this.filterArray=[]}return __extends(t,e),t.prototype.Add=function(e){if(e==null)return;e.filterLabel==="HiraganaFilter"?this.hiranagaFilter=e:e.filterLabel==="FullWidthKatakanaFilter"&&(this.katakanaFilter=e),this.filterArray.push(e)},t.prototype.AddRange=function(e){for(var t=0;t<e.length;t++)this.Add(e[t])},t.prototype.IsValidTwoByte=function(e){if(this.filterArray.length===0)return e==="\r"||e==="\n"?!0:!1;var t=!1,n=!1;for(var r=0;r<this.filterArray.length;r++)this.filterArray[r]._include&&(n=!0);var i=e==="\u30fc";if(i)if(this.hiranagaFilter&&this.katakanaFilter){if(n)return!0}else{if(this.hiranagaFilter)return!0;if(this.katakanaFilter)return!0}for(var r=0;r<this.filterArray.length;r++)if(this.filterArray[r].IsValid(e)){if(!this.filterArray[r]._include)return!1;t=!0}else n||(t=!0);return t?!0:e==="\r"||e==="\n"?!0:!1},t.prototype.IsValidMoreByte=function(e){return this.IsValidTwoByte(e)},t}(n),b=function(){function e(e){this.minLength=-1,this.maxLength=-1,this.text="",this.oldText="",this.fieldLabel=e}return e.prototype.Snap=function(){var e={};return e.text=this.text,e.oldText=this.oldText,e},e.prototype.Revert=function(e){this.text=e.text,this.oldText=e.oldText},e.prototype.GetFieldText=function(){return this.oldText==null?null:this.oldText},e.prototype.GetText=function(){return this.text},e.prototype.SetText=function(e){this.text=e},e.prototype.GetFillingString=function(e){if(!e)return null;var t="";for(var n=0;n<this.minLength;n++)t+=e;return t},e.prototype.GetFieldStatus=function(){return 0},e.prototype.GetTextExcludeLiterals=function(e,t){var n=this.text.GetLength();n<t&&(t=n);var r=this.text.Substring(e,t);return r=r.replace(/[^\d]/g,""),r},e.prototype.SaveOldState=function(){},e.prototype.RollBack=function(){},e.prototype.PerformSpin=function(e,t,n){return 0},e.prototype.Insert=function(e,t,n,r){},e.prototype.Replace=function(e,t,n){},e.prototype.Delete=function(e,t){},e.prototype.SaveUndoState=function(){},e.prototype.Clear=function(){this.text=null},e.prototype.Undo=function(){},e.prototype.SetTextInternal=function(e,t,n,r){},e.prototype.GetLength=function(){return this.text.GetLength()>this.minLength?this.text.GetLength():this.minLength},e}();e.Field=b;var w=function(e){function t(t){e.call(this,"PromptField"),this.text=t,this.minLength=this.text.GetLength(),this.maxLength=this.text.GetLength()}return __extends(t,e),t.prototype.GetFillingString=function(){return this.text},t.prototype.SetText=function(e){var t={};return e===this.promptText?(t.existInvalid=!1,e=e.Substring(this.text.GetLength())):t.existInvalid=!0,t.text=e,t},t.prototype.GetLength=function(){return this.text.GetLength()},t}(b),E=function(t){function r(e){t.call(this,"FilterField"),this._minLength=0,this._maxLength=0,this._filter=new n,this._bitStates=null,this._oldBitState=null,this.undoText="",this.undoTempText="",this._undoBitState=null,this._trueLength=0,this._bitState=null,this._owner=e}return __extends(r,t),r.prototype.GetPromptChar=function(){return this._owner.GetPromptChar()},r.prototype.GetAutoConvert=function(){return this._owner.GetAutoConvert()},r.prototype.FilterField=function(e,t,n,r){if(e>t)return!1;if(!n)return!1;this._minLength=e,this._maxLength=t,this._filter=n,this._bitState=r,this._oldBitState=r,this._undoBitState=r,this._trueLength=0;if(this._bitState!=null){var i=0;while(this._bitState[i]!=null)i++;for(var s=i;s>=0;s--)if(this._bitState[s]!=null)this._bitState[s]===!1&&this._trueLength--;else{if(this._bitState[s]!=null)break;this._trueLength--}}return this.Clear(),!0},r.prototype.InitialText=function(e){while(e.IndexOf("@#GCD#@")!=-1)e=e.replace("@#GCD#@","'");while(e.IndexOf("@#GCM#@")!=-1)e=e.replace("@#GCM#@",'"');this.text=e,this.oldText=e,this.undoText=e,this.undoTempText=e},r.prototype.GetFieldStatus=function(){return this._trueLength>=this._minLength&&this._trueLength>0?2:this._trueLength>0&&this._trueLength<this._minLength?1:0},r.prototype.GetFieldIsFull=function(){if(this._trueLength>=this._minLength&&this._trueLength>0){for(var e=0;e<this._trueLength;e++)if(this._bitState[e]===!1)return!1;return!0}return!1},r.prototype.SetTextInternal=function(t,n,r,i){var s={};s.offset=n,s.text=t,s.existInvalid=!1,s.exception=!1;var o=!1;if(n>this._maxLength||t===""||t.GetLength()===0)return s;var u="",a=0,f=[],l=n;for(var c=0;c<n;c++)f[c]=this._bitState[c];while(a<t.GetLength()){var h=this._filter.Check(t,a),p=h.strValue;a=h.index;if(p===""&&t.Substring(a,a+1)!==this.GetPromptChar()){if(!r&&n+u.GetLength()>=this._minLength&&n+u.GetLength()===this._trueLength+u.GetLength())break;o=!0,a++;break}p!==""?(i&&i!==""&&i.Substring(l,l+1)===e.Utility.MaskValChar?(u+=this.GetPromptChar(),f[l]=!1):p==="\r"||p==="\n"?(u+=this.GetPromptChar(),f[l]=!1):(u+=p,f[l]=!0),l++,p.GetLength()===2&&(f[l]=!0,l++)):(u+=this.GetPromptChar(),a++,f[l]=!1,l++);if(n+u.GetLength()===this._maxLength)break;if(n+u.GetLength()>this._maxLength){u=u.Substring(0,u.GetLength()-1);break}}n+u.GetLength()<this._minLength&&(t=t.Substring(a,t.GetLength()-a),s.existInvalid=o,s.exception=!0);var d=this.text.Substring(0,n)+u+this.text.Substring(n,this.text.GetLength());d.GetLength()>this._maxLength&&(d=d.Substring(0,this._maxLength));if(d.GetLength()>n+u.GetLength())for(var v=1;v<=d.GetLength()-n-u.GetLength();v++)this._bitState[n+v]!=null&&(f[l]=this._bitState[n+v],l++);this._bitState=new Array(l),this._bitState=f,this._trueLength=l;for(var v=l-1;v>=0;v--){if(this._bitState[v]!==!1)break;this._trueLength--}if(d.GetLength()<this._minLength)for(var v=0;v<this._minLength-d.GetLength();v--)d+=this.GetPromptChar();for(var v=d.GetLength();v>this._minLength;v--){if(!(d.Substring(v-1,v)===this.GetPromptChar()&&v>this._trueLength))break;d=d.Substring(0,v-1)}return this.text=d,a===t.GetLength()?t="":t=t.Substring(a,t.GetLength()),n+=u.GetLength(),s.offset=n,s.text=t,s},r.prototype.SaveOldState=function(){this.oldText=this.text,this._oldBitState=this._bitState},r.prototype.SaveUndoState=function(){this.undoText=this.text,this.undoTempText=this.text,this._undoBitState=this._bitState},r.prototype.GetValue=function(){},r.prototype.GetText=function(){return this._text},r.prototype.UpdateState=function(e){},r.prototype.RollBack=function(){if(this.oldText===this.text)return;var e=this.oldText;this.text=e,this._bitState=this._oldBitState,this._trueLength=e.GetLength();for(var t=e.GetLength()-1;t>=0;t--){if(this._bitState[t]!=0)break;this._trueLength--}},r.prototype.Undo=function(){if(this.undoTempText===this.text)return!1;var e=this.undoTempText;this.undoTempText=this.text;var t=this._bitState;this.text=e,this._bitState=this._undoBitState,this._trueLength=e.GetLength();if(this._bitState.length===0)this._trueLength=0;else for(var n=e.GetLength()-1;n>=0;n--){if(this._bitState[n]!==!1)break;this._trueLength--}return this._undoBitState=t,!0},r.prototype.Clear=function(){this._trueLength=0;var e="",t=[];if(this._minLength>0){for(var n=0;n<this._minLength;n++)t[n]=!1;this._bitState=new Array(this._minLength),this._bitState=t;if(this.GetPromptChar()!=="")for(var n=0;n<this._minLength;n++)e+=this.GetPromptChar();else for(var n=0;n<this._minLength;n++)e+=" ";this.text=e}else this.text="",this._bitStates=null},r.prototype.Insert=function(e,t,n,r){r||(r=!0);var i={};i.offset=e,i.text=t,i.existInvalid=!1,i.exception=!1;var s=!1;if(e>this._maxLength||t===""||t.GetLength()===0)return i;var o=[],u=e;for(var a=0;a<e;a++)o[a]=this._bitState[a];var f="",l=0;while(l<t.GetLength()){var c=this._filter.Check(t,l),h=c.strValue;l=c.index;if(!(h!==""||!r&&t.CharAt(l)===" ")){if(!n&&e+f.GetLength()>=this._minLength&&e+f.GetLength()>=this._trueLength+f.GetLength())break;s=!0,l++;continue}h===""&&!r&&t.CharAt(l)===" "?(f+=this.GetPromptChar(),o[u]=!1,u++,l++):h==="\r"||h==="\n"?(f+=this.GetPromptChar(),o[u]=!1,u++):(f+=h,o[u]=!0,u++,h.GetLength()===2&&(o[u]=!0,u++));if(e+f.GetLength()===this._maxLength)break;if(e+f.GetLength()>this._maxLength){f=f.Substring(0,f.GetLength()-1);break}}if(f.GetLength()===0)return t=t.Substring(l,t.GetLength()-l),i.existInvalid=s,i.exception=!0,i;var p=this.text.Substring(0,e)+f+this.text.Substring(e,this.text.GetLength());p.GetLength()>this._maxLength&&(p=p.Substring(0,this._maxLength));if(p.GetLength()>e+f.GetLength())for(var d=0;d<p.GetLength()-e-f.GetLength();d++)this._bitState[e+d]!=null?o[u]=this._bitState[e+d]:o[u]=!1,u++;this._bitState=new Array(u),this._bitState=o,this._trueLength=u;for(var d=u-1;d>=0;d--){if(this._bitState[d]!==!1)break;this._trueLength--}if(p.GetLength()<this._minLength)for(var d=0;d<this._minLength-p.GetLength();d--)p+=this.GetPromptChar();for(var d=p.GetLength();d>this._minLength;d--){if(!(p.Substring(d-1,d)===this.GetPromptChar()&&d>this._trueLength))break;p=p.Substring(0,d-1)}return this.text=p,l===t.GetLength()?t="":t=t.Substring(l,t.GetLength()),e+=f.GetLength(),i.offset=e,i.text=t,i},r.prototype.Replace=function(t,n,r,i){var s={};s.offset=t,s.text=r;if(n===0)return s;var o=r.charCodeAt(0),u=[12364,12460,12366,12462,12376,12472];if(e.Utility.ArrayIndexOf(u,o)!==-1&&n===1){var a=this._filter.Check(r,0);a.strValue&&a.strValue.length===2&&(n=2)}return t=this.Delete(t,n),s=this.Insert(t,r,i),s},r.prototype.Delete=function(e,t){if(t===0||e>=this.text.GetLength())return e;e+t>this.text.GetLength()&&(t=this.text.GetLength()-e);var n=[],r=e;for(var i=0;i<e;i++)n[i]=this._bitState[i];var s=this.text.Substring(0,e)+this.text.Substring(e+t,this.text.GetLength());if(e+t<this.text.GetLength())for(var o=0;o<this.text.Substring(e+t,this.text.GetLength()).GetLength();o++)this._bitState[e+t+o]!=null?n[r]=this._bitState[e+t+o]:n[r]=!1,r++;if(r<this._minLength)for(var o=r;o<this._minLength;o++)n[o]=!1;this._bitState=new Array(r),this._bitState=n,this._trueLength=r;for(var o=r-1;o>=0;o--){if(this._bitState[o]!==!1)break;this._trueLength--}if(s.GetLength()<this._minLength){var u=this._minLength-s.GetLength();for(var o=0;o<u;o++)s+=this.GetPromptChar()}return this.text=s,e},r}(b),S=function(t){function n(e){t.call(this,"EnumField"),this._activeItem=-1,this._trueLength=0,this._lastActiveItem=-1,this.undoText="",this.undoTempText="",this._undoItem=-1,this._minLength=0,this._maxLength=0,this._itemCount=0,this._owner=e}return __extends(n,t),n.prototype.GetPromptChar=function(){return this._owner.GetPromptChar()},n.prototype.GetText=function(){var t="";return this._activeItem<0?t=e.Utility.ToString(this.GetPromptChar(),this._minLength):t+=this._items[this._activeItem],t},n.prototype.GetFieldStatus=function(){return this._activeItem===-1?0:2},n.prototype.GetFieldIsFull=function(){return this._activeItem===-1?!1:!0},n.prototype.IsOver=function(){return this._activeItem!==-1},n.prototype.Init=function(e){var t=Number.MAX_VALUE,n=Number.MIN_VALUE;for(var r=0;r<e.length;r++)t=Math.min(t,e[r].length),n=Math.max(n,e[r].length);this.EnumField(t,n,e,e.length,-1)},n.prototype.EnumField=function(e,t,n,r,i){this._minLength=e,this._maxLength=t;if(!n)return!1;this._itemCount=r,this._activeItem=i,this._lastActiveItem=i,this._undoItem=i,this.InitialItems(n),i!==-1?this._trueLength=n[i].toString().GetLength():this._trueLength=0,this.text=this.GetText()},n.prototype.InitialItems=function(e){this._items=new Array(e.length);for(var t=0;t<e.length;t++){var n=e[t];while(n.IndexOf("@#GCD#@")!==-1)n=n.replace("@#GCD#@","'");while(n.IndexOf("@#GCM#@")!==-1)n=n.replace("@#GCM#@",'"');n&&(n=n.replace(/@#GCX0D#@/g,"\r").replace(/@#GCX0A#@/g,"\n")),this._items[t]=n}},n.prototype.InitialText=function(e){while(e.IndexOf("@#GCD#@")!==-1)e=e.replace("@#GCD#@","'");while(e.IndexOf("@#GCM#@")!==-1)e=e.replace("@#GCM#@",'"');e&&(e=e.replace(/@#GCX0D#@/g,"\r").replace(/@#GCX0A#@/g,"\n")),this.text=e,this.oldText=e,this.undoText=e,this.undoTempText=e},n.prototype.Insert=function(e,t,n){var r={};r.offset=e,r.text=t,r.existInvalid=!1,r.exception=!1;var i=e,s="";this._activeItem===-1&&(i=0),i!==0&&(s=this._items[this._activeItem].toString().Substring(0,i));var o=new Array(this._itemCount),u=new Array(this._itemCount),a=new Array(this._itemCount),f=new Array(this._itemCount);for(var l=0;l<this._itemCount;l++)o[l]=i,u[l]=0,a[l]=99999,f[l]=new Array;for(var l=0;l<this._itemCount;l++){var c=this._items[l].toString();if(s.GetLength()>0&&c.Substring(0,s.GetLength())!==s)continue;while(u[l]<t.GetLength()){if(o[l]>=c.length)break;var h=this.JudgeIfValid(c,o[l],t,u[l]);o[l]=h.index1,u[l]=h.index2,h.isValid?a[l]===99999&&(a[l]=u[l]):u[l]++}}var p=0,d=0,v=!1,m=o[p];for(var g=0;g<this._itemCount;g++){var c=this._items[g].toString();if(o[g]===t.GetLength()+i&&t.GetLength()===c.length){p=g,m=o[p],v=!0;break}if(a[g]===99999)continue;if(a[p]>=a[g])if(a[p]===a[g]){var y=o[g];m<y?(p=g,m=y,d=1):m===y&&d++}else p=g,m=o[p],d=1}var b;if(v)return u[p]===0?(b=!0,r.existInvalid=!0,r):(t=t.Substring(u[p]+1,t.GetLength()),e=this._items[p].toString().GetLength(),b=f[p].Count===0?!1:!0,this._activeItem=p,this.text=this._items[p].toString(),this._trueLength=this._items[p].toString().GetLength(),r.offset=e,r.text=t,r.existInvalid=b,r);if(m===i)return n===!1&&this._activeItem!==-1&&e===this._items[this._activeItem].toString().GetLength()?(t=t.Substring(u[p],t.GetLength()),b=!1,r.offset=e,r.text=t,r):(b=!0,r.exception=!0,r.existInvalid=!0,r);var w=-1;for(var l=0;l<f[p].Count;l++)w=0;return d===1?e=this._items[p].toString().GetLength():e=m,w===-1?(t=t.Substring(u[p],t.GetLength()),b=!1):(t=t.Substring(u[p],t.GetLength()),b=!0),this._activeItem=p,this.text=this._items[p].toString(),this._trueLength=this._items[p].toString().GetLength(),r.offset=e,r.text=t,r},n.prototype.Replace=function(e,t,n,r){return this.Insert(e,n,r)},n.prototype.Delete=function(e,t){if(t===0||e>=this.text.GetLength())return e;e=0,this._activeItem=-1,this.text="";if(this._minLength>0)for(var n=0;n<this._minLength;n++)this.text+=this.GetPromptChar();return this._trueLength=0,e},n.prototype.SaveOldState=function(){this._lastActiveItem=this._activeItem,this.oldText=this.text},n.prototype.RollBack=function(){if(this.oldText===this.text)return;var e=this._lastActiveItem;this._activeItem=e;if(e>=0&&e<this._itemCount)this.text=this._items[e].toString();else{this.text="";for(var t=0;t<this._minLength;t++)this.text+=this.GetPromptChar()}var n=0;for(var t=this.text.GetLength();t>0;t--){if(this.text.Substring(t-1,t)!==this.GetPromptChar())break;n++}this._trueLength=this.text.GetLength()-n},n.prototype.SaveUndoState=function(){this.undoText=this.text,this.undoTempText=this.text,this._undoItem=this._activeItem},n.prototype.Undo=function(){if(this.undoTempText===this.text)return;this.undoTempText=this.text;var e=this._activeItem;this._activeItem=this._undoItem,this._undoItem=e;if(this._activeItem>=0&&this._activeItem<this._itemCount)this.text=this._items[this._activeItem].toString();else{this.text="";for(var t=0;t<this._minLength;t++)this.text+=this.GetPromptChar()}var n=0;for(var t=this.text.GetLength();t>0;t--){if(this.text.Substring(t-1,t)!==this.GetPromptChar())break;n++}this._trueLength=this.text.GetLength()-n},n.prototype.SetTextInternal=function(e,t,n,r){var i,s=new Array(this._itemCount),o=new Array(this._itemCount),u=new Array(this._itemCount);for(i=0;i<this._itemCount;i++)s[i]=0,o[i]=0,u[i]=!1;for(i=0;i<this._itemCount;i++){var a=this._items[i].toString();while(s[i]<e.GetLength()){var f=this.JudgeIfValid(a,o[i],e,s[i]);o[i]=f.index1,s[i]=f.index2;if(!f.isValid&&n===!0){u[i]=!0;break}if(!f.isValid&&a.GetLength()===s[i])break;if(!f.isValid&&a.GetLength()>s[i]){u[i]=!0;break}if(o[i].toString().GetLength()===a.GetLength()&&s[i].toString().GetLength()<e.GetLength()&&n===!0){u[i]=!0;break}if(s[i].toString().GetLength()===e.GetLength()&&o[i].toString().GetLength()<a.GetLength()){u[i]=!0;break}}}var l=this._itemCount;for(i=0;i<this._itemCount;i++)if(u[i]===!1){l===this._itemCount&&(l=i);var a=this._items[i].toString();if(a.GetLength()===this._maxLength&&e.GetLength()>=this._maxLength){l=i;break}}var c=l,h={};h.existInvalid=!1,h.exception=!1;if(c>=this._itemCount){var p="";h.exception=!0;for(i=0;i<this._minLength;i++)p+=this.GetPromptChar();return e.Substring(0,this._minLength)===p?(e=e.Substring(this._minLength,e.GetLength()),h.offset=this._minLength,h.text=e,h.existInvalid=!1,h.exception=!0,this.Clear(),h):(h.text=e,this.text=p,this._activeItem=-1,h.existInvalid=!0,h.exception=!0,h)}return this._activeItem=c,this.text=this._items[c].toString(),this._trueLength=this._items[c].toString().GetLength(),h.offset=this._trueLength,h.text=e.Substring(this._trueLength,e.GetLength()),h},n.prototype.PerformSpin=function(e,t,n){var r=this._itemCount;if(r<t)if(r>1)while(r<t)t-=r;else t=1;else if(r<-t)if(r>1)while(r<-t)t+=r;else t=-1;if(t===0)return e;var i;if(this._activeItem===-1)i=t>0?0:r-1;else{i=this._activeItem+t;if(i<0||i>=r)n?(i=t>0?i-r:i+r,t>0&&i<this._activeItem?this._activeItem<r-1?i=r-1:i=0:t<0&&i>this._activeItem&&(this._activeItem>0?i=0:i=r-1)):i=t>0?r-1:0}var s=this._items[i].toString().GetLength();return e=Math.min(e,s),this._activeItem=i,this.text=this._items[i].toString(),this._trueLength=this._activeItem===-1?0:this.text.GetLength(),e},n.prototype.Clear=function(){this._activeItem=-1},n.prototype.JudgeIfValid=function(t,n,r,i){var s=e.CharProcess.CharEx,o={};o.index1=n,o.index2=i,o.isValid=!1;if(n>=t.GetLength())return o;if(t.Substring(n,n+1)===r.Substring(i,i+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;if(this._owner.GetAutoConvert()===!1)return o;if(r.Substring(i,i+1).charCodeAt(0)>=65345&&r.Substring(i,i+1).charCodeAt(0)<=65370){var u=String.fromCharCode(r.Substring(i,i+1).charCodeAt(0)-32);if(u===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var a=s.ToHalfWidth(r.Substring(i,i+1));if(a===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var f=s.ToHalfWidth(u);return f===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(r.Substring(i,i+1).charCodeAt(0)>=65313&&r.Substring(i,i+1).charCodeAt(0)<=65338){var l=String.fromCharCode(r.Substring(i,i+1).charCodeAt(0)-32);if(l===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var f=s.ToHalfWidth(r.Substring(i,i+1));if(f===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var a=s.ToHalfWidth(l);return a===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(s.IsUpper(r.Substring(i,i+1))){var a=r.Substring(i,i+1).toLowerCase();if(a===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var u=s.ToFullWidth(r.Substring(i,i+1)).text;if(u===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var l=s.ToFullWidth(a).text;return l===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(s.IsLower(r.Substring(i,i+1))){var f=r.Substring(i,i+1).toUpperCase();if(f===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var l=s.ToFullWidth(r.Substring(i,i+1)).text;if(l===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var u=s.ToFullWidth(l).text;return u===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(s.IsHiragana(r.Substring(i,i+1))){var c=s.ToKatakana(r.Substring(i,i+1));if(c===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var h=s.ToKatakana(c),p=s.ToHalfWidthEx(h);return p.length===1&&p===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):p.length===2&&p.Substring(0,1)===t.Substring(n,n+1)&&n+1<t.GetLength()&&p.Substring(1,2)===t.Substring(n+1,n+2)?(n+=2,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(s.IsKatakana(r.Substring(i,i+1))&&s.IsFullWidth(r.Substring(i,i+1))){var h=s.ToKatakana(r.Substring(i,i+1)),p=s.ToHalfWidthEx(h);if(p.length===1&&p===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;if(p.length===2&&p.Substring(0,1)===t.Substring(n,n+1)&&n+1<t.GetLength()&&p.Substring(1,2)===t.Substring(n+1,n+2))return n+=2,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var d=s.ToHiragana(r.Substring(i,i+1));return d==="\u3094"?o:d===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(s.IsKatakana(r.Substring(i,i+1))&&!s.IsFullWidth(r.Substring(i,i+1))){var v;i+1<r.GetLength()&&s.IsKatakana(r.Substring(i+1,i+2))&&!s.IsFullWidth(r.Substring(i+1,i+2))?v=r.Substring(i+1,i+2):v=" ";if(v===" "){var c=s.ToFullWidth(r.Substring(i,i+1)).text;if(c===t.Substring(n,n+1))return n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o;var d=s.ToHiragana(c);return d==="\u3094"?o:d===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}var m=s.ToFullWidth(r.Substring(i,i+2)),c=m.text,g=m.processedAll;if(c===t.Substring(n,n+1))return n++,g?i+=2:i++,o.index1=n,o.index2=i,o.isValid=!0,o;var d=s.ToHiragana(c);return d==="\u3094"?g?"\u3046\u309b"===t.Substring(n,n+2)?(n+=2,i+=2,o.index1=n,o.index2=i,o.isValid=!0,o):o:o:d===t.Substring(n,n+1)?(n++,g?i+=2:i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}if(s.IsFullWidth(r.Substring(i,i+1))){var y=s.ToHalfWidth(r.Substring(i,i+1));return y===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o}var b=s.ToFullWidth(r.Substring(i,i+1)).text;return b===t.Substring(n,n+1)?(n++,i++,o.index1=n,o.index2=i,o.isValid=!0,o):o},n}(b),x=function(){function e(e){this.fieldArray=[],this.fieldCount=0,this.fieldCount=e}return e.prototype.GetLength=function(){var e=0;for(var t=0;t<this.fieldCount;t++){var n=this.GetFieldByIndex(t);e+=n.GetLength()}return e},e.prototype.Add=function(e){e&&this.fieldArray.push(e)},e.prototype.AddRange=function(e){if(!e||e.length===0||this.fieldCount!==e.length)return;var t=new Array;for(var n=0;n<e.length;n++)t[n]=e[n];this.fieldArray=t},e.prototype.GetFieldByIndex=function(e){return this.fieldArray[e]},e.prototype.GetText=function(){var e="";for(var t=0;t<this.fieldCount;t++)e+=this.GetFieldByIndex(t).GetText();return e},e.prototype.GetFillingString=function(e){var t="";for(var n=0;n<this.fieldCount;n++){var r=this.fieldArray[n];if(r.fieldLabel==="PromptField")t+=r.GetText();else for(var i=0;i<r._minLength;i++)t+=e}return t},e.prototype.SetText=function(e,t){},e.prototype.Insert=function(e,t,n){},e.prototype.Replace=function(e,t,n,r){},e.prototype.Delete=function(e,t){},e.prototype.PerformSpin=function(e,t,n){},e.prototype.GetFieldIndex=function(e,t){var n={},r=0;for(var i=0;i<this.fieldCount;i++){var s=this.fieldArray[i],o=s.GetLength();if(e===r&&o===0||e>=r&&e<r+o)return n.index=i,n.offset=e-r,n;r+=o}if(e>=r){var s=this.fieldArray[this.fieldCount-1];return n.index=this.fieldCount-1,n.offset=s.GetLength(),n}},e.prototype.GetFieldRange=function(e){var t={};t.start=0,t.length=0;var n=0;for(var r=0;r<e;r++){var i=this.GetFieldByIndex(r);n+=i.GetLength()}var s=this.GetFieldByIndex(e);return s?(t.start=n,t.length=s.GetLength(),t):t},e}();e.FieldCollection=x;var T=function(){function n(){this.KeyActionList=null,this.Text="",this.Value=null,this.DroppedDown=!1,this.SelectionLength=0,this.SelectionStart=0,this.SelectionEnd=0,this.IsMouseDown=!1,this.OldSelectionStart=0,this.OldSelectionEnd=0,this._acceptCrlf=e.CrLfMode.NoControl,this._clipContent=e.ClipContent.IncludeLiterals,this._editMode=e.EditMode.Insert,this.__editModeInternal=e.EditMode.Insert,this._useClipboard=!0,this._readOnly=!1,this._autoPostBack=!1,this._highlightText=e.HighlightText.None,this._exitOnLeftRightKey=e.ExitOnLeftRightKey.None,this.FocusType=e.FocusType.None,this.IsInUpdatePanelAndAsyncPostBack=!1,this.NeedResetFocus=!1,this.NeedReCalCursorPos=!0,this.SpinBtnPressed=!1,this.DropDownBtnPressed=!1,this.OldValue="",this.ValueBeforeUndo="",this.FocusExit=!1,this.Delay=0,this.SpinOnKeys=!0,this.Wrap=!0,this.SpinEnabled=!0,this.Increment=1,this.Visible=!1,this.MouseButton=e.MouseButton.Default,this.TouchDropDownScale=1,this.UIUpdate=new e.InputUIUpdate(this),this.Format={Fields:null}}return n.prototype.Snap=function(){var e={Text:this.Text,Value:this.Value,SelectionStart:this.SelectionStart,SelectionEnd:this.SelectionEnd};return e},n.prototype.Revert=function(e){this.Text=e.Text,this.Value=e.Value,this.SelectionStart=e.SelectionStart,this.SelectionEnd=e.SelectionEnd},n.prototype.ReLoadData=function(){},n.prototype.GetOverwrite=function(){return this.GetEditMode()===e.EditMode.FixedInsert||this.GetEditMode()===e.EditMode.FixedOverwrite?this.GetEditMode()===e.EditMode.FixedOverwrite:this._getEditModeInternal()!==e.EditMode.Insert&&this._getEditModeInternal()!==e.EditMode.FixedInsert},n.prototype.GetImeMode=function(){return this.InputElement.style.imeMode||"auto"},n.prototype.SetImeMode=function(e){this.GetInputElement().style.imeMode=e},n.prototype.GetEnabled=function(){return this.GetInputElement().disabled},n.prototype.SetEnabled=function(e){e?t(this.GetInputElement()).removeAttr("diabled"):t(this.GetInputElement()).attr("diabled","true")},n.prototype.SetFocus=function(){t(this.GetInputElement()).focus()},n.prototype.GetDroppedDown=function(){return this.DroppedDown},n.prototype.GetSelectionStart=function(){return Math.min(this.SelectionStart,this.SelectionEnd)},n.prototype.SetSelectionStart=function(t){t=e.Utility.CheckInt(t,0,Math.pow(2,31)),t=Math.min(t,this.Text.GetLength()),this.SetInnerSelectionStart(t),this.SetInnerSelectionEnd(t+this.SelectionLength),this.NeedReCalCursorPos=!0},n.prototype.GetSelectionLength=function(){return Math.abs(this.SelectionEnd-this.SelectionStart)},n.prototype.SetSelectionLength=function(t){t=e.Utility.CheckInt(t,0,Math.pow(2,31)),this.SelectionStart+t>this.Text.GetLength()&&(t=this.Text.GetLength()-this.SelectionStart),this.SelectionLength=t,this.SetInnerSelectionEnd(this.SelectionStart+t),this.NeedReCalCursorPos=!0},n.prototype.SetInnerSelectionStart=function(e){this.SelectionStart=e},n.prototype.SetInnerSelectionEnd=function(e){this.SelectionEnd=e},n.prototype.SetDroppedDown=function(e){if(!this.Enabled)return;this.DroppedDown=e},n.prototype.DoSpinUp=function(e,t){t==null&&(t=this.Increment),this.DoSpin("up",this.SelectionEnd,t)},n.prototype.DoSpinDown=function(e,t){t==null&&(t=this.Increment),this.DoSpin("down",this.SelectionEnd,t)},n.prototype.DoSpin=function(e,t,n){e==="down"&&(n*=-1);if(typeof t=="number"&&isNaN(t)||typeof n=="number"&&isNaN(n))return;var r=this.UIProcess.PerformSpin(t,n,this.Wrap);if(!r)return;typeof r.SelectionStart=="number"&&!isNaN(r.SelectionStart)&&(this.SelectionStart=r.SelectionStart),typeof r.SelectionEnd=="number"&&!isNaN(r.SelectionEnd)&&(this.SelectionEnd=r.SelectionEnd);if(r.Text!=null&&!this.UpdateText(r))return;this.UpdateDisplayText(this.Text),e==="up"?this.UIProcess.FireEvent(this,this.SpinUpEvent,null,"SpinUp"):e==="down"&&this.UIProcess.FireEvent(this,this.SpinDownEvent,null,"SpinDown")},n.prototype.GetExitOnLeftRightKey=function(){return this._exitOnLeftRightKey},n.prototype.SetExitOnLeftRightKey=function(e){this._exitOnLeftRightKey=e},n.prototype.GetAcceptsCrlf=function(){return this._acceptCrlf},n.prototype.SetAcceptsCrlf=function(e){this._acceptCrlf=e},n.prototype.SetInnerFocus=function(){this.FocusType=e.FocusType.ClientEvent,this.UIUpdate.SetFocus(),this.SetSelection(this.SelectionStart,this.SelectionEnd)},n.prototype.UpdateDisplayText=function(e){this.UIUpdate.SetText(e),this.SetHideValue()},n.prototype.SetHideText=function(e){},n.prototype.SetSelection=function(t,n,r){if(t==null||n==null||isNaN(t)||isNaN(n))return;if(r&&e.Utility.IsIE10OrLater()){var i=this;setTimeout(function(){e.Utility.SetSelection(i.InputElement,t,n)},0)}else e.Utility.SetSelection(this.InputElement,t,n);this.SelectionStart=t,this.SelectionEnd=n,t===n&&(this.UIProcess.isMulSelected=!1)},n.prototype._getAutoPostBack=function(){return this._autoPostBack},n.prototype._setAutoPostBack=function(t){t=e.Utility.CheckBool(t),this._autoPostBack=t},n.prototype.GetUseClipboard=function(){return this._useClipboard},n.prototype.SetUseClipboard=function(e){this._useClipboard=e},n.prototype.GetClipContent=function(){return this._clipContent},n.prototype.SetClipContent=function(e){this._clipContent=e},n.prototype.GetTextHAlign=function(){return this.UIUpdate.GetTextHAlign()},n.prototype.SetTextHAlign=function(e){this.UIUpdate.SetTextHAlign(e)},n.prototype.GetEditMode=function(){return this._editMode},n.prototype.SetEditMode=function(e){if(e!==this._editMode){var t=!1;this._isinsertGroup(e)&&this._isOverwriteGroup(this._editMode)?t=!0:this._isinsertGroup(this._editMode)&&this._isOverwriteGroup(e)&&(t=!0),this._editMode=e,this.__editModeInternal=e,t&&this.UIProcess.FireEvent(this,this.EditStatusChangedEvent,null,"EditStatusChanged")}},n.prototype._getEditModeInternal=function(){return this.__editModeInternal},n.prototype._setEditModeInternal=function(e){if(e!==this.__editModeInternal){var t=!1;this._isinsertGroup(e)&&this._isOverwriteGroup(this.__editModeInternal)?t=!0:this._isinsertGroup(this.__editModeInternal)&&this._isOverwriteGroup(e)&&(t=!0),this.__editModeInternal=e,t&&this.UIProcess.FireEvent(this,this.EditStatusChangedEvent,null,"EditStatusChanged")}},n.prototype._isinsertGroup=function(t){return t===e.EditMode.Insert||t===e.EditMode.FixedInsert},n.prototype._isOverwriteGroup=function(t){return t===e.EditMode.Overwrite||t===e.EditMode.FixedOverwrite},n.prototype.GetHighlightText=function(){return this._highlightText},n.prototype.SetHighlightText=function(e){this._highlightText=e},n.prototype.GetReadOnly=function(){return this._readOnly},n.prototype.SetReadOnly=function(e){this._readOnly=e},n.prototype.GetTextboxValue=function(){return this.UIUpdate.GetText()},n.prototype.GetOldValue=function(){return this.OldValue},n.prototype.CanUndo=function(){return this.GetValue()===this.GetOldValue()?!1:!0},n.prototype.GetValue=function(){return""},n.prototype.DragStart=function(){this.DragStartElementID=this.ID},n.prototype.DragEnd=function(t){return this.DragStartElementID="",e.Utility.PreventDefault(t),!1},n.prototype.MouseOut=function(){if(this.IsMouseDown!==!0)return;if(this.MouseUpPointerType!==undefined&&this.MouseUpPointerType!==4&&this.MouseUpPointerType!=="mouse")return;var t=Math.min(this.OldSelectionStart,this.OldSelectionEnd),n=Math.max(this.OldSelectionStart,this.OldSelectionEnd),r=this.GetText().Substring(t,n);r!==""&&(this.SetSelection(this.OldSelectionStart,this.OldSelectionEnd),e.Utility.DragDrop(this.InputElement)),this.IsMouseDown=!1},n.prototype.GetText=function(){return""},n.prototype.Focus=function(t){t.SelectionStart=this.SelectionStart;var n=this.UIProcess.Focus(t);e.Utility.CurrentActiveControlId=this.ID;if(!n)return;return n.Text!=null&&(this.Text=n.Text),n.SelectionStart!=null&&(this.SelectionStart=n.SelectionStart),n.SelectionEnd!=null&&(this.SelectionEnd=n.SelectionEnd),this.GetReadOnly()&&this.FocusType===e.FocusType.None&&(this.SelectionStart=0,this.SelectionEnd=this.Text.length),this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd,!0),n},n.prototype.LoseFocus=function(t){this.FireKeyExit();if((this.SpinBtnPressed||this.DropDownBtnPressed||this.DropDownObj&&this.DropDownObj.IsMouseOver)&&this.FocusType!==e.FocusType.KeyExit)return;return this.DroppedDown&&(this.DropDownBtnPressed=!1,this.CloseDropDown()),this.SetLastClientValues(),this.UIProcess.LoseFocus(t)},n.prototype.FireKeyExit=function(){},n.prototype.SetLastClientValues=function(){},n.prototype.MouseDown=function(t){var n=e.Utility.GetMouseButton(t);this.MouseButton=n,this.FocusType=e.FocusType.Click,this.OldSelectionStart=this.SelectionStart,this.OldSelectionEnd=this.SelectionEnd,this.IsMouseDown=!0,this.MouseDownX=t.x,this.MouseButton===e.MouseButton.Left&&(e.Utility.IsIE()||e.Utility.firefox)&&e.Utility.ClearSelection(this.GetInputElement()),this.DroppedDown&&this.CloseDropDown();if(this.IsNullFormat())return;var r=this.UIProcess.MouseDown(n);if(!r)return;r.SelectionStart!=null&&(this.SelectionStart=r.SelectionStart),r.SelectionEnd!=null&&(this.SelectionEnd=r.SelectionEnd,this.SetSelection(this.SelectionStart,this.SelectionEnd))},n.prototype.GetInputElement=function(){return this.InputElement},n.prototype.MouseUp=function(t){this.IsMouseDown=!1,this.MouseUpX=t.x,this.IsNullFormat();var n=this.UIProcess.MouseUp(this.InputElement,this.SelectionStart,this.SelectionEnd,this.MouseButton);if(!n)return;n.SelectionStart!=null&&(this.SelectionStart=n.SelectionStart),n.SelectionEnd!=null&&(this.SelectionEnd=n.SelectionEnd);if(e.Utility.GetMouseButton(t)===e.MouseButton.Left&&this.MouseDownX!=null&&this.MouseDownX>this.MouseUpX){var r=this.SelectionStart;this.SelectionStart=this.SelectionEnd,this.SelectionEnd=r}this.MouseDownX=null,this.MouseButton=e.MouseButton.Default},n.prototype.MouseWheel=function(t){if(this.ImeMode===!0)return!1;if(this.GetSpinEnabled()){var n=e.Utility.GetMouseWheelValue(0,t);return n>0?this.PerformSpin("up"):n<0&&this.PerformSpin("down"),e.Utility.PreventDefault(t),!1}},n.prototype.PreProcessContextMenu=function(e){return!1},n.prototype.ProcessReservedKey=function(e){switch(e){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 112:case 114:case 115:case 116:case 117:case 121:case 122:case 123:case 65657:case 131081:case 196617:case 131179:case 131181:case 131120:case 131259:case 131261:case 131146:case 196680:case 196681:case 196682:case 131153:case 131156:case 196689:case 262157:return!0}return!1},n.prototype.IsNullFormat=function(){return!1},n.prototype.SetHideValue=function(){var e="";this.GetValue()!=null&&(e=this.GetValue().toString()),this.SetHideText(e)},n.prototype.KeyDown=function(t){var n={},r=t.FuncKeysPressed,i=t.KeyCode;if(this.PreProcessContextMenu(i))return n.System=!1,n;if(i===229)return n.System=!0,n;r.Shift&&(i|=65536),r.Ctrl&&(i|=131072);if(r.Alt){if(this.AccessKey!=null&&this.AccessKey.toLowerCase()===String.fromCharCode(i).toLowerCase())return this.SelectionStart=0,this.SelectionEnd=this.Text.GetLength(),n.System=!0,n;i|=262144}if(this.ProcessReservedKey(i))return n.System=!0,n;var s=i|524288;if(i!==s){var o=this.UIProcess.GetKeyActionName(s,this.Shortcuts);if(o!=null){var u=!0,a=!1;if(u)return n.System=!1,n}}var f=this.UIProcess.GetKeyActionName(i,this.Shortcuts);switch(f){case"DropDown":return this.GetDropDownEnabled()&&(this.PerformDropDown(),n.System=!1),n;case"SpinUp":return this.GetSpinEnabled()&&this.SpinOnKeys&&(this.PerformSpin("up"),n.System=!1),n;case"SpinDown":return this.GetSpinEnabled()&&this.SpinOnKeys&&(this.PerformSpin("down"),n.System=!1),n}var l=!1;if(this.KeyActionList)for(var c=0;c<this.KeyActionList.length;c++)if(this.KeyActionList[c]===i.toString()){l=!0;break}if(this.DroppedDown&&this.DropDownObj&&i!=262182&&i!=262184&&i!=27&&i!=118&&i!=9&&i!=65545){f!=null&&this.DropDownObj.IsShortcut(i)&&(f=null);if(!f){if(i===93)return this.CloseDropDown(),!0;n.System=!1;if(!l){var h={keyCode:0,shiftKey:!1,ctrlKey:!1,altKey:!1};return h.keyCode=t.KeyCode,h.shiftKey=r.Shift,h.ctrlKey=r.Ctrl,h.altKey=r.Alt,this.DropDownObj.KeyDown(h),n}}}t.KeyAction=f,t.KeyCode=i;var p=this.UIProcess.KeyDown(t);if(!p){switch(i){case 27:return this.DroppedDown&&(this.CloseDropDown(),this.SetInnerFocus()),n.System=!1,n;case 262182:case 262184:return l||(this.PerformDropDown(),n.System=!0),n;case 262152:return n.KeyCode=10,n;case 38:return l||(this.GetSpinEnabled()&&this.SpinOnKeys&&this.PerformSpin("up"),n.System=!1),n;case 40:return l||(this.GetSpinEnabled()&&this.SpinOnKeys&&this.PerformSpin("down"),n.System=!1),n;case 13:return n.System=!0,n}if(this.IsNullFormat()||i===20||r&&(r.Ctrl||r.Alt)||i===91||i===144||i===145||i===93||i===92)return n.System=!0,n;if(r&&r.Shift&&i===65552)return n.System=!0,n;if(this.Type==="Number")return n.System=!0,n;if(i===120||i===123||i===113||i===118||i===119)return n;var d=this.UIProcess.FireEvent(this,this.InvalidInputEvent,null,"InvalidInput");return d!=null&&(this.FocusType=d),n}p.Overwrite!=null&&this.GetOverwrite()!==p.Overwrite&&(this._getEditModeInternal()===e.EditMode.Insert?this._setEditModeInternal(e.EditMode.Overwrite):this._getEditModeInternal()===e.EditMode.Overwrite&&this._setEditModeInternal(e.EditMode.Insert));if(p.Text!=null&&!this.UpdateText(p))return n.System=!1,n;var v=this.GetSelectionLength();p.SelectionStart!=null&&(this.SelectionStart=p.SelectionStart),p.SelectionEnd!=null&&(this.SelectionEnd=p.SelectionEnd);var m=this.GetSelectionLength();p.System||(p.FocusExit?(this.SetHideValue(),p.System=!1):(this.UpdateDisplayText(this.Text),v===0&&m!==0?e.Utility.ShouldFireOnSelectStart=!0:e.Utility.ShouldFireOnSelectStart=!1,this.SetSelection(this.SelectionStart,this.SelectionEnd),e.Utility.ShouldFireOnSelectStart=!1,p.HasSetSelection=!0));if(p.EventInfo)if(p.EventInfo.Type==="KeyExit")this.EventInfo=p.EventInfo;else{var d=this.UIProcess.FireEvent(this,p.EventInfo.Name,p.EventInfo.Args,p.EventInfo.Type);d!=null&&(this.FocusType=d)}return p.FocusType!=null&&(this.FocusType=p.FocusType),n=p,n.KeyAction=f,n},n.prototype.GetImeInputText=function(t){var n=this.GetTextboxValue();if(n===this.Text)return"";var r;if(this.Text!==""){var i=Math.min(this.SelectionStart,this.SelectionEnd),s=Math.max(this.SelectionStart,this.SelectionEnd);if(s<this.Text.GetLength()){var o=this.Text.Substring(s,this.GetText().GetLength()),u=n.IndexOf(o);u!==-1?r=n.Substring(i,n.GetLength()-o.GetLength()):r=""}else r=n.Substring(i,n.GetLength())}else r=n;t==="ReInput"&&(r=r.Substring(0,r.GetLength()));if(t==="Record")return r;if(t==="LoseFocusInput"&&r==="")return"";this.ImeMode=!1,this.ImeSelect=!1;if(t==="ReInput"||t==="ClickInput")this.FocusType=e.FocusType.ImeInput,this.InputElement.blur(),this.InputElement.focus();return r},n.prototype.KeyUp=function(e){},n.prototype.GetVisible=function(){return!0},n.prototype.PerformDropDown=function(){if(!this.Enabled||!this.GetDropDownEnabled())return;if(!this.GetVisible())return;if(!this.DroppedDown){if(this.DropDownObj&&this.DropDownObj.GetDropDownContainer!==undefined){var t=this.DropDownObj.GetDropDownContainer();e.Utility.IsTouchMouseDown?e.Utility.SetZoomStyle(t,this.TouchDropDownScale,this.DropDownObj.GetAlign()):e.Utility.SetZoomStyle(t,"")}this.ShowDropDown()}else this.CloseDropDown()},n.prototype.DropDownBtnMouseDown=function(t){this.DropDownBtnPressed=!0;if(t!==e.MouseButton.Left&&t!=null)return;this.PerformDropDown(),this.SetInnerFocus(),this.DroppedDown&&this.ResetLocation()},n.prototype.DropDownBtnMouseUp=function(){this.DropDownBtnPressed=!1,this.SetInnerFocus()},n.prototype.ResetLocation=function(){},n.prototype.DropDownBtnMouseOut=function(){this.DropDownBtnPressed&&(this.SetInnerFocus(),this.DropDownBtnPressed=!1)},n.prototype.ShowDropDown=function(e){e!=null&&this.UIUpdate.WriteCssStyle(e)},n.prototype.CloseDropDown=function(){this.DroppedDown=!1,this.DropDownObj.Close(),this.UIUpdate.ClearCssStyle();var e=this.UIProcess.FireEvent(this,this.DropDownCloseEvent,null,"DropDownClose");e!=null&&(this.FocusType=e)},n.prototype.PerformSpin=function(t){var n=this.Increment;if(this.IsNullFormat())this.SetSelection(this.SelectionStart,this.SelectionEnd);else if(!this.GetReadOnly()){t==="down"&&(n*=-1);var r=this.UIProcess.PerformSpin(this.SelectionEnd,n,this.Wrap);if(!r)return;if(r.Text!=null&&!this.UpdateText(r))return;r.SelectionStart!=null&&(this.SelectionStart=r.SelectionStart,this.SelectionEnd=r.SelectionStart),this.UpdateDisplayText(this.Text),this.SetInnerFocus(),this.SetSelection(this.SelectionStart,this.SelectionEnd)}var i=e.FocusType.ClientEvent;t==="up"?i=this.UIProcess.FireEvent(this,this.SpinUpEvent,null,"SpinUp"):t==="down"&&(i=this.UIProcess.FireEvent(this,this.SpinDownEvent,null,"SpinDown")),i!=null&&(this.FocusType=i)},n.prototype.SpinBtnMouseDown=function(t,n){this.SpinBtnPressed=!0;if(this.DroppedDown){this.CloseDropDown(),this.SetInnerFocus();return}if(t!=e.MouseButton.Left&&t!=null)return;var r=n===!0?"up":"down";this.PerformSpin(r),this.SetInnerFocus();if(e.Utility.SpinTimer==null){var i=this;e.Utility.SpinTimer=setInterval(function(){i.PerformSpin(r)},this._getRealSpinDelay())}},n.prototype._getRealSpinDelay=function(){return this.Delay===0?150:this.Delay},n.prototype.SpinBtnMouseUp=function(){this.SpinBtnPressed&&(this.SetInnerFocus(),this.SpinBtnPressed=!1),e.Utility.SpinTimer!=null&&(clearInterval(e.Utility.SpinTimer),e.Utility.SpinTimer=null)},n.prototype.SelectStart=function(e){if(this.IsNullFormat())return!0;var t=this.UIProcess.SelectStart(this.InputElement,e,this.MouseButton);t.SelectionStart!=null&&(this.SelectionStart=t.SelectionStart);if(t.SetFalse!=null)return t.SetFalse},n.prototype.DoubleClick=function(){if(this.IsNullFormat())return!0;var e=this.UIProcess.DoubleClick(this.SelectionStart);e.SelectionStart!=null&&(this.SelectionStart=e.SelectionStart),e.SelectionEnd!=null&&(this.SelectionEnd=e.SelectionEnd,this.SetSelection(this.SelectionStart,this.SelectionEnd))},n.prototype.Undo=function(){if(this.GetReadOnly())return;var e=this.UIProcess.Undo();if(!e)return;if(e.Text!=null){if(!this.UpdateText(e))return;this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd)}},n.prototype.Cut=function(){if(this.GetReadOnly())return;var e=this.UIProcess.Cut(this.GetClipContent(),this.SelectionStart,this.SelectionEnd);if(!e)return;if(e.Text!=null&&!this.UpdateText(e))return;e.SelectionStart!=null&&(this.SelectionStart=e.SelectionStart),e.SelectionEnd!=null&&(this.SelectionEnd=e.SelectionEnd),e.Text!=null&&(this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd)),e.Color!==null&&this.UIUpdate.SetForeColor(e.Color)},n.prototype.Copy=function(){this.UIProcess.Copy(this.GetClipContent(),this.SelectionStart,this.SelectionEnd)},n.prototype.Paste=function(t){if(this.GetReadOnly())return!1;if(this.IsNullFormat())return!1;var n=e.Utility.GetPasteData(this.GetUseClipboard());t&&(n=t);var r=this.UIProcess.Paste(this.SelectionStart,this.SelectionEnd,n);return r?r.Text!=null&&!this.UpdateText(r)?!1:(r.SelectionStart!=null&&(this.SelectionStart=r.SelectionStart),r.SelectionEnd!=null&&(this.SelectionEnd=r.SelectionEnd),this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),r.EventInfo!=null&&this.UIProcess.FireEvent(this,r.EventInfo.Name,r.EventInfo.Args,r.EventInfo.Type),r.FocusExit!=null&&(this.FocusExit=r.FocusExit),!0):!1},n.prototype.Delete=function(){if(this.GetReadOnly())return;var e=this.UIProcess.ProcessDelete(this.SelectionStart,this.SelectionEnd);if(!e)return;if(e.Text!=null&&!this.UpdateText(e))return;e.SelectionStart!=null&&(this.SelectionStart=e.SelectionStart),e.SelectionEnd!=null&&(this.SelectionEnd=e.SelectionEnd),e.Text!=null&&(this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.DoDeleteExtraWork())},n.prototype.DoDeleteExtraWork=function(){},n.prototype.SelectAll=function(){var t=this.UIProcess.SelectAll();t.SelectionStart!=null&&(this.SelectionStart=t.SelectionStart),t.SelectionEnd!=null&&(this.SelectionEnd=t.SelectionEnd),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.FocusType=e.FocusType.ContextMenu},n.prototype.DragDrop=function(t){if(!e.Utility.IsIE()&&this.GetReadOnly())return!1;if(this.DragStartElementID===this.ID)return this.DragStartElementID="",!1;var n=this.UIProcess.Paste(0,0,t);if(!n)return;if(n.Text!=null){if(!this.UpdateText(n))return;e.Utility.IsIE()||this.SetInnerFocus()}n.SelectionStart!=null&&(this.SelectionStart=n.SelectionStart),n.SelectionEnd!=null&&(this.SelectionEnd=n.SelectionEnd),this.SetSelection(this.SelectionStart,this.SelectionEnd),n.EventInfo!=null&&this.UIProcess.FireEvent(this,n.EventInfo.Name,n.EventInfo.Args,n.EventInfo.Type)},n.prototype.SetInnerText=function(e){this.SetText(e)},n.prototype.SetText=function(e){},n.prototype.GetInnerText=function(){return this.Text},n.prototype.UpdateText=function(e){return e!=null&&e.Text!=null&&(this.Text=e.Text),!0},n.prototype.RollBack=function(){},n.prototype.AddAllEventsHandler=function(){var n=this,r=this.GetInputElement();r!=null&&(t(r).bind("mousedown.wijinput",function(t){e.GlobalEventHandler.OnMouseDown(n,t)}),t(r).bind("mouseup.wijinput",function(t){e.GlobalEventHandler.OnMouseUp(n,t)}),t(r).bind("selectstart.wijinput",function(t){e.GlobalEventHandler.OnSelectStart(n,t)}),t(r).bind("keydown.wijinput",function(t){e.GlobalEventHandler.OnKeyDown(n,t)}),t(r).bind("keypress.wijinput",function(t){e.GlobalEventHandler.OnKeyPress(n,t)}),t(r).bind("keyup.wijinput",function(t){e.GlobalEventHandler.OnKeyUp(n,t)}),t(r).bind("dblclick.wijinput",function(t){e.GlobalEventHandler.OnDblClick(n,t)}),t(r).bind("beforecopy.wijinput",function(t){e.GlobalEventHandler.OnHTML5BeforeCopy(n,t)}),t(r).bind("cut.wijinput",function(t){e.GlobalEventHandler.OnHTML5Cut(n,t)}),t(r).bind("paste.wijinput",function(t){e.GlobalEventHandler.OnHTML5Paste(n,t)}),t(r).bind("focus.wijinput",function(t){e.GlobalEventHandler.OnFocus(n,t)}),t(r).bind("blur.wijinput",function(t){e.GlobalEventHandler.OnLostFocus(n,t)}),t(r).bind("mousewheel.wijinput",function(t){e.GlobalEventHandler.OnMouseWheel(n,t)}),t(r).bind("DOMMouseScroll.wijinput",function(t){e.GlobalEventHandler.OnMouseWheel(n,t)}),t(r).bind("dragstart.wijinput",function(t){e.GlobalEventHandler.OnDragStart(n,t)}),t(r).bind("dragend.wijinput",function(t){e.GlobalEventHandler.OnDragEnd(n,t)}),t(r).bind("mouseout.wijinput",function(t){e.GlobalEventHandler.OnMouseOut(n,t)}),t(r).bind("drop.wijinput",function(t){e.GlobalEventHandler.OnDrop(n,t)}),t(r).bind("touchstart.wijinput",function(t){e.GlobalEventHandler.OnTouchStart(n,t)}),t(r).bind("touchend.wijinput",function(t){e.GlobalEventHandler.OnTouchEnd(n,t)}),t(r).bind("select.wijinput",function(t){e.GlobalEventHandler.OnSelect(n,t)}),e.Utility.safari&&(t(r).bind("dragenter.wijinput",function(e){n._safariDropText=getSelection().toString()}),t(r).bind("dragleave.wijinput",function(e){n._safariDropText=null})),t(r).bind("compositionstart.wijinput",function(t){e.GlobalEventHandler.OnCompositionStart(n,t)}),t(r).bind("compositionupdate.wijinput",function(t){e.GlobalEventHandler.OnCompositionUpdate(n,t)}),t(r).bind("compositionend.wijinput",function(t){e.GlobalEventHandler.OnCompositionEnd(n,t)}),e.Utility.GetClientOS()==="Android"&&t(r).bind("webkitEditableContentChanged.wijinput",function(t){e.GlobalEventHandler.OnWebkitEditableContentChanged(n,t)}))},n.prototype.ResetData=function(e){this.SetText(e.ResetData)},n.prototype._createElementForNoSpinAndNoDropDown=function(e){return e},n.prototype._addControlEventHandler=function(){},n.prototype._reCreate=function(){},n.prototype._onSpinPropertyChanged=function(e){e=e.toLowerCase(),e==="alignment"||e==="position"?this._getRealSpinVisible()&&this._reCreate():e==="visible"?this._reCreate():e!=="enabled"&&(e==="spinupimage"||e==="spindownimage"||e==="pressedspinupimage"||e==="pressedspindownimage")},n.prototype._onDropDownPropertyChanged=function(e){e=e.toLowerCase(),e==="position"?this._getRealDropDownVisible()&&this._reCreate():e==="visible"?this._reCreate():e!=="enabled"&&(e==="buttonimage"||e==="pressedbuttonimage")},n.prototype._isSupportClipBoard=function(){return this.GetUseClipboard()?e.Utility.IsIE()?!0:!1:!0},n.prototype._onpropertyChanged=function(){},n.prototype.GetSpinDelay=function(){return this.Delay},n.prototype.SetSpinDelay=function(e){this.Delay=e},n.prototype.GetSpinEnabled=function(){return this.SpinEnabled&&this.Enabled},n.prototype.SetSpinEnabled=function(e){this.SpinEnabled=e},n.prototype.GetSpinIncrement=function(){return this.Increment},n.prototype.SetSpinIncrement=function(e){this.Increment=e},n.prototype.GetSpinOnKeys=function(){return this.SpinOnKeys},n.prototype.SetSpinOnKeys=function(e){this.SpinOnKeys=e},n.prototype.GetSpinVisible=function(){return this.Visible},n.prototype._getRealSpinVisible=function(){return this.GetSpinVisible()},n.prototype.SetSpinVisible=function(e){this.Visible=e},n.prototype.GetSpinWrap=function(){return this.Wrap},n.prototype.SetSpinWrap=function(e){this.Wrap=e},n.prototype.GetAutoDropDown=function(){return this._dropDown.AutoDropDown},n.prototype.SetAutoDropDown=function(e){this._dropDown.SetAutoDropDown(e)},n.prototype.GetDropDownButtonImageUrl=function(){return this._dropDown.GetButtonImage()},n.prototype.SetDropDownButtonImageUrl=function(e){this._dropDown.SetButtonImage(e)},n.prototype.GetDropDownClosingAnimation=function(){return this._dropDown.ClosingAnimation},n.prototype.SetDropDownClosingAnimation=function(e){this._dropDown.SetClosingAnimation(e)},n.prototype.GetDropDownShadow=function(){return this._dropDown.DropDownShadow},n.prototype.SetDropDownShadow=function(e){this._dropDown.SetDropDownShadow(e)},n.prototype.GetDropDownEnabled=function(){return this._dropDown.GetEnabled()&&this.Enabled},n.prototype.SetDropDownEnabled=function(e){this._dropDown.SetEnabled(e)},n.prototype.GetDropDownOpeningAnimation=function(){return this._dropDown.OpeningAnimation},n.prototype.SetDropDownOpeningAnimation=function(e){this._dropDown.SetOpeningAnimation(e)},n.prototype.GetDropDownPosition=function(){return this._dropDown.Position},n.prototype.SetDropDownPosition=function(e){this._dropDown.SetPosition(e)},n.prototype.GetPressedDropDownButtonImageUrl=function(){return this._dropDown.GetPressedButtonImage()},n.prototype.SetPressedDropDownButtonImageUrl=function(e){this._dropDown.SetPressedButtonImage(e)},n.prototype.GetDropDownVisible=function(){return this._dropDown.Visible},n.prototype._getRealDropDownVisible=function(){return this.GetDropDownVisible()},n.prototype.SetDropDownVisible=function(e){this._dropDown.SetVisible(e)},n}();e.BaseInputControl=T;var N;(function(e){e._map=[],e.OctalAscII=0,e.HexAscII=1,e.HexUnicode=2,e.DefinedCharBase=3,e.DefinedCharAddition=4,e.CharSubset=5,e.EnumGroup=6,e.Quantifier=7,e.PromptChar=8,e.Unknow=9})(N||(N={}));var C=function(){function t(){}return t.DBCS_A=e.CharProcess.CharEx.ToFullWidth("A").text,t.DBCS_a=e.CharProcess.CharEx.ToFullWidth("a").text,t.DBCS_B=e.CharProcess.CharEx.ToFullWidth("B").text,t.DBCS_D=e.CharProcess.CharEx.ToFullWidth("D").text,t.DBCS_J=e.CharProcess.CharEx.ToFullWidth("J").text,t.DBCS_K=e.CharProcess.CharEx.ToFullWidth("K").text,t.DBCS_W=e.CharProcess.CharEx.ToFullWidth("W").text,t.DBCS_X=e.CharProcess.CharEx.ToFullWidth("X").text,t.DBCS_Z=e.CharProcess.CharEx.ToFullWidth("Z").text,t.DBCS_T=e.CharProcess.CharEx.ToFullWidth("T").text,t.DBCS_M=e.CharProcess.CharEx.ToFullWidth("M").text,t.DBCS_I=e.CharProcess.CharEx.ToFullWidth("I").text,t.DBCS_N=e.CharProcess.CharEx.ToFullWidth("N").text,t.DBCS_G=e.CharProcess.CharEx.ToFullWidth("G").text,t.DBCS_E=e.CharProcess.CharEx.ToFullWidth("E").text,t.DBCS_V=e.CharProcess.CharEx.ToFullWidth("V").text,t.DBCS_z=e.CharProcess.CharEx.ToFullWidth("z").text,t.DBCS_0=e.CharProcess.CharEx.ToFullWidth("0").text,t.DBCS_1=e.CharProcess.CharEx.ToFullWidth("1").text,t.DBCS_9=e.CharProcess.CharEx.ToFullWidth("9").text,t.DBCS_F=e.CharProcess.CharEx.ToFullWidth("F").text,t.DBCS_f=e.CharProcess.CharEx.ToFullWidth("f").text,t.DBCS__=e.CharProcess.CharEx.ToFullWidth("_").text,t.ParseFormat=function(d,v){t.Owner=v;var m=new k(t.Owner,0,!1);if(d===null||d.length===0){var g=new E(t.Owner),b=new Array;g._bitState=b;var x=new y(t.Owner,!0),T=new i(t.Owner,!0);x.Add(T);var C=new r(t.Owner,!0);x.Add(C);var L=new c(t.Owner,!0);return x.Add(L),g.FilterField(0,2147483647,x,b),g.InitialText(""),g._trueLength=0,m.PushBack(g),m.formatIsNull=!0,m}var A=0,O="",M=N.PromptChar,_=N.CharSubset,D=t.GetKeyWord(d,A),P=D.KeyWord,H=D.KeyType,B=D.KeyLen,j;while(d.length>A){switch(H){case N.Unknow:throw"InvalidParameter";case N.CharSubset:var F=t.AnalyseCharSubset(P),x=F.uf;if(!F.Result)throw"Invalid parameter";j=x,M=N.CharSubset;break;case N.DefinedCharAddition:if(P==="\\K")j=new h(t.Owner,!0);else if(P==="\\H")j=new r(t.Owner,!0);else if(P==="\\N")j=new l(t.Owner,!0);else if(P==="\\"+t.DBCS_K)j=new p(t.Owner,!0);else if(P==="\\"+t.DBCS_J)j=new s(t.Owner,!0);else if(P==="\\"+t.DBCS_M)j=new o(t.Owner,!0);else if(P==="\\"+t.DBCS_I)j=new u(t.Owner,!0);else if(P==="\\"+t.DBCS_G)j=new a(t.Owner,!0);else if(P==="\\"+t.DBCS_N)j=new f(t.Owner,!0);else if(P==="\\"+t.DBCS_Z)j=new i(t.Owner,!0);else{if(P!=="\\"+t.DBCS_T)throw"argument null";j=new c(t.Owner,!0)}M=N.CharSubset;break;case N.EnumGroup:var I=[];if(t.AnalyseEnumGroup(P,I)){var q=new S(t.Owner);q.Init(I),m.PushBack(q),M=N.EnumGroup,A+=B;var R=t.GetKeyWord(d,A);P=R.KeyWord,H=R.KeyType,B=R.KeyLen;continue}throw"invalid parameter";case N.OctalAscII:try{var U=P.Substring(1);U=parseInt(U,8);if(U===0)throw"argument exception";var z=String.fromCharCode(U);M===N.PromptChar?O+=z:(O=z,M=N.PromptChar)}catch(W){throw"invalid parameter"}break;case N.HexAscII:case N.HexUnicode:try{var U=P.Substring(2);U=parseInt(U,16);if(U===0)throw"argument exception";var z=String.fromCharCode(U);M===N.PromptChar?O+=z:(O=z,M=N.PromptChar)}catch(W){throw"invalid parameter"}break;case N.PromptChar:M===N.PromptChar?O+=P:(O=P,M=N.PromptChar);break;case N.Quantifier:throw"invalid parameter";default:throw"invalid parameter"}A+=B;var X=1,V=1;if(A<d.length){D=t.GetKeyWord(d,A),P=D.KeyWord,H=D.KeyType,B=D.KeyLen;switch(H){case N.Unknow:throw"invalid parameter";case N.CharSubset:case N.DefinedCharAddition:case N.EnumGroup:_=N.CharSubset;break;case N.Quantifier:var $=t.AnalyseQuantifier(P);V=$.Min,X=$.Max;if(!$.Result)throw"invalid parameter";A+=B,D=t.GetKeyWord(d,A),P=D.KeyWord,H=D.KeyType,B=D.KeyLen,_=N.Quantifier;break;case N.OctalAscII:case N.HexUnicode:case N.HexAscII:case N.PromptChar:_=N.PromptChar}if(M===N.PromptChar){if(_!==N.PromptChar){if(_===N.Quantifier)throw"invalid parameter";m.PushBack(new w(O))}}else{var J=new E(t.Owner);J.FilterField(V,X,j,[!1,!1,!1]),J.InitialText(e.Utility.ToString(J.GetPromptChar(),V)),J._trueLength=0,m.PushBack(J)}}else if(M===N.PromptChar)m.PushBack(new w(O));else{var J=new E(t.Owner);J.FilterField(1,1,j,[]),m.PushBack(J)}}for(var K=0;K<m.fieldCount;K++)if(!(m.GetFieldByIndex(K)instanceof w))break;if(K===m.fieldCount)throw"invalid parameter";return m},t.ParseFillExpression=function(n,r){var i={};i.Expression="",i.Result=!0;if(n==="{}")return i.Expression="{}",i.Result=!0,i;if(n!==undefined&&n!==null&&n.length>0)try{var s=n,o="\0",u=t.ParseFillingString(s);s=u.Format,o=u.FillingChar;if(o!=="\0"){if(!t.NullParse(s))throw"argument exception";r!==undefined&&r!==null&&r.fieldCount>0?i.Expression=r.GetFillingString(o):i.Expression=n}else i.Expression=s}catch(a){throw"argument exception"}else i.Expression=null;return i},t.ParseFillingString=function(n){var r={};r.Format=n,r.FillingChar="\0",r.Result=!1;if(n===undefined||n===null||n.length===0)return r.Result=!1,r;var i=n.indexOf("{"),s=n.indexOf("}");if(i===-1&&s===-1)return n=t.RemoveEscapeChar(n),r.Format=n,r.Result=!1,r;while(i>0&&n.charAt(i-1)==="\\")i=n.indexOf("{",i+1);while(s>0&&n.charAt(s-1)==="\\")s=n.indexOf("}",s+1);if(i<s){if(i===-1)return n=t.RemoveEscapeChar(n),r.Format=n,r.Result=!1,r;if(s-i===1)r.Format="";else{if(n.charAt(i+1)==="{")throw"argument exception";if(n.charAt(i+1)==="\\"){if(!(i+2<s))throw"arugment exception";i++}r.FillingChar=n.charAt(i+1)}return r.Result=!0,r}return n=t.RemoveEscapeChar(n),r.Format=n,r.Result=!1,r},t.RemoveEscapeChar=function(t){if(t.indexOf("\\")!==-1){var n="",r=t.length;for(var i=0;i<r;i++){if(t.charAt(i)==="\\"){i+1<r&&(n+=t.charAt(++i));continue}n+=t.charAt(i)}return n}return t},t.NullParse=function(n){var r=t.FindSpecialCh(n,"{",0),i=t.FindSpecialCh(n,"}",0);if(r>-1&&i>-1&&i>r){if(t.FindSpecialCh(n,"{",r+1)>-1)return!1;if(t.FindSpecialCh(n,"}",i+1)>-1)return!1}return!0},t.FindSpecialCh=function(t,n,r){var i=0,s=r-1;do{s=t.indexOf(n,s+1);if(s===0||s===-1)return s;for(var o=s-1;o>0;o--){if(t.charAt(o)!=="\\")break;i++}}while(t.charAt(s-1)==="\\"&&i%2!==0);return s},t.GetKeyWord=function(n,r){var i={};i.KeyLen=0,i.KeyType=N.Unknow,i.KeyWord=null;if(r>=n.length)return i;var s=n.charAt(r);switch(s){case"\\":var o=t.GetEscapeCharLength(n.Substring(r),i.KeyType,i.KeyLen);if(o.Result)return i.KeyLen=o.KeyLen,i.KeyType=o.KeyType,i.KeyWord=n.substr(r,i.KeyLen),i;var u=n.charAt(r+1);return u==="A"?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="[A-Z]",i):u===t.DBCS_A?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="["+t.DBCS_A+"-"+t.DBCS_Z+"]",i):u==="a"?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="[a-z]",i):u===t.DBCS_a?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="["+t.DBCS_a+"-"+t.DBCS_z+"]",i):u==="D"?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="[0-9]",i):u===t.DBCS_D?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="["+t.DBCS_0+"-"+t.DBCS_9+"]",i):u==="B"?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="[0-1]",i):u===t.DBCS_B?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="["+t.DBCS_0+"-"+t.DBCS_1+"]",i):u==="X"?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="[0-9A-Fa-f]",i):u===t.DBCS_X?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="["+t.DBCS_0+"-"+t.DBCS_9+t.DBCS_A+"-"+t.DBCS_F+t.DBCS_a+"-"+t.DBCS_f+"]",i):u==="W"?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="[a-zA-Z_0-9]",i):u===t.DBCS_W?(i.KeyLen=2,i.KeyType=N.CharSubset,i.KeyWord="["+t.DBCS_a+"-"+t.DBCS_z+t.DBCS_A+"-"+t.DBCS_Z+t.DBCS__+t.DBCS_0+"-"+t.DBCS_9+"]",i):u==="K"||u===t.DBCS_K||u===t.DBCS_J||u===t.DBCS_Z||u==="H"||u===t.DBCS_T||u===t.DBCS_M||u===t.DBCS_I||u===t.DBCS_G||u===t.DBCS_N||u==="N"||u===t.DBCS_E||u===t.DBCS_V?(i.KeyLen=2,i.KeyType=N.DefinedCharAddition,i.KeyWord=n.substr(r,2),i):t.IsSpecialChar(u)?(i.KeyLen=2,i.KeyType=N.PromptChar,i.KeyWord=n.substr(r+1,1),i):(i.KeyWord="",i);case"{":var a=n.indexOf("}",r+1);return a===-1?(i.KeyWord="",i):(i.KeyType=N.Quantifier,i.KeyLen=a+1-r,i.KeyWord=n.substr(r,i.KeyLen),i);case"[":var a=r,f=0;do{a=n.indexOf("]",a+1);if(a===-1)return"";for(var l=a-1;l>0;l--){if(n.charAt(l)!=="\\")break;f++}}while(n.charAt(a-1)==="\\"&&f%2!==0);return i.KeyType=N.CharSubset,i.KeyLen=a+1-r,i.KeyWord=n.substr(r,i.KeyLen),i;case"(":var a=r;do{a=n.indexOf(")",a+1);if(a===-1)return""}while(n.charAt(a-1)==="\\");return i.KeyType=N.EnumGroup,i.KeyLen=a+1-r,i.KeyWord=n.substr(r,i.KeyLen),i;case"*":return i.KeyLen=1,i.KeyType=N.Quantifier,i.KeyWord="{0,}",i;case"+":return i.KeyLen=1,i.KeyType=N.Quantifier,i.KeyWord="{1,}",i;case"?":return i.KeyLen=1,i.KeyType=N.Quantifier,i.KeyWord="{0,1}",i;default:var c=r+1;for(;c<n.length;c++)if(t.IsSpecialChar(n.charAt(c)))break;return i.KeyType=N.PromptChar,i.KeyLen=c-r,i.KeyWord=n.substr(r,i.KeyLen),i}},t.IsSpecialChar=function(t){return t==="\\"||t==="{"||t==="}"||t==="["||t==="]"||t==="("||t===")"||t==="."||t==="*"||t==="+"||t==="?"},t.GetEscapeCharLength=function(n,r,i){var s={};s.Result=!1,s.KeyType=r,s.Length=i;if(n.charAt(0)!=="\\")return s;var o=1,u=n.charAt(1);return u==="x"?n.length<o+3?s:(s.Length=4,s.KeyType=N.HexAscII,s.Result=!0,s):u==="u"?n.length<o+5?s:(s.Length=6,s.KeyType=N.HexUnicode,s.Result=!0,s):t.IsOctalChar(u)?n.length<o+3?s:(s.Length=4,s.KeyType=N.OctalAscII,s.Result=!0,s):s},t.IsOctalChar=function(t){return t>="0"&&t<="7"},t.AnalyseQuantifier=function(t){var n={};n.Min=-1,n.Max=-1,n.Result=!1;var r=t.indexOf(",",1);if(r===-1)try{return n.Min=parseInt(t.substr(1,t.length-2)),n.Max=n.Min,n.Result=n.Max>0,n}catch(i){return n.Result=!1,n}try{return n.Min=parseInt(t.substr(1,r-1)),r===t.length-2?n.Max=Math.pow(2,31):n.Max=parseInt(t.substr(r+1,t.length-r-2)),n.Min<0||n.Min>n.Max||n.Max===0?(n.Result=!1,n):(n.Result=!0,n)}catch(i){return n.Result=!1,n}},t.AnalyseCharSubset=function(n,d){var v={};v.uf=d,v.Result=!1;var b=[],w=1,E=!0,S="";if(n==="[]"){b.push(new i(t.Owner,!0)),b.push(new r(t.Owner,!0)),b.push(new c(t.Owner,!0));if(v.uf&&v.uf.filterArray.length>0)for(var x=0;x<d.filterArray.length;x++)b.push(d.filterArray[x]);return v.uf=new y(t.Owner,!0),v.uf.AddRange(b),v.Result=!0,v}if(n==="[^]"){b.push(new i(t.Owner,!1)),b.push(new r(t.Owner,!1)),b.push(new c(t.Owner,!1));if(v.uf&&v.uf.filterArray.length>0)for(var x=0;x<d.filterArray.length;x++)b.push(d.filterArray[x]);return v.uf=new y(t.Owner,!0),v.uf.AddRange(b),v.uf.filterArray[0]._include=!1,v.uf.filterArray[1]._include=!1,v.uf.filterArray[2]._include=!1,v.Result=!0,v}n.charAt(w)==="^"&&(E=!1,w++);while(w<n.length-1){var T=n.charAt(w),C=N.HexAscII,k=0;switch(T){case"-":return v.Result=!1,v;case"^":if(E===!1)throw"invalid fromat";if(S.length>0){var L=new m(S,"");L._include=E,b.push(L)}if(b.length>0){v.uf=new y(t.Owner,!0),v.uf.AddRange(b);for(var x=0;x<v.uf.filterArray.length;x++)if(!v.uf.filterArray[x]._include)return v.Result=!1,v;var A=t.AnalyseCharSubset("["+n.substr(w,n.length-w),v.uf);return v.uf=A.uf,v.Result=A.Result,v}return v.Result=!1,v;case"\\":var O=t.GetEscapeCharLength(n.substr(w),C,k);C=O.KeyType,k=O.Length;if(O.Result){var M=16,_=null;C===N.OctalAscII?(M=8,_=n.substr(w+1,k-1)):_=n.substr(w+2,k-2),n=n.substring(0,w)+n.substr(w+k);var D=String.fromCharCode(parseInt(_,M));n=n.substring(0,w)+D+n.substr(w);continue}var P=n.charAt(w+1);if(P==="A")b.push(new g("A","Z",t.Owner,!0)),w++;else if(P===t.DBCS_A)b.push(new g(t.DBCS_A,t.DBCS_Z,t.Owner,!0)),w++;else if(P==="a")b.push(new g("a","z",t.Owner,!0)),w++;else if(P===t.DBCS_a)b.push(new g(t.DBCS_a,t.DBCS_z,t.Owner,!0)),w++;else if(P==="D")b.push(new g("0","9",t.Owner,!0)),w++;else if(P===t.DBCS_D)b.push(new g(t.DBCS_0,t.DBCS_9,t.Owner,!0)),w++;else if(P==="B")b.push(new g("0","1",t.Owner,!0)),w++;else if(P===t.DBCS_B)b.push(new g(t.DBCS_0,t.DBCS_1,t.Owner,!0)),w++;else if(P==="X")b.push(new g("0","9",t.Owner,!0)),b.push(new g("A","F",t.Owner,!0)),b.push(new g("a","f",t.Owner,!0)),w++;else if(P===t.DBCS_X)b.push(new g(t.DBCS_0,t.DBCS_9,t.Owner,!0)),b.push(new g(t.DBCS_A,t.DBCS_F,t.Owner,!0)),b.push(new g(t.DBCS_a,t.DBCS_f,t.Owner,!0)),w++;else if(P==="W")b.push(new g("0","9",t.Owner,!0)),b.push(new g("A","Z",t.Owner,!0)),b.push(new g("a","z")),S+="_",w++;else if(P===t.DBCS_W)b.push(new g(t.DBCS_0,t.DBCS_9,t.Owner,!0)),b.push(new g(t.DBCS_A,t.DBCS_Z,t.Owner,!0)),b.push(new g(t.DBCS_a,t.DBCS_z,t.Owner,!0)),S+=t.DBCS__,w++;else if(P==="K")b.push(new h(t.Owner,!0)),w++;else if(P==="H")b.push(new r(t.Owner,E)),w++;else if(P===t.DBCS_K)b.push(new p(t.Owner,!0)),w++;else if(P===t.DBCS_J)b.push(new s(t.Owner,!0)),w++;else if(P===t.DBCS_M)b.push(new o(t.Owner,!0)),w++;else if(P===t.DBCS_I)b.push(new u(t.Owner,!0)),w++;else if(P==="N")b.push(new l(t.Owner,!0)),w++;else if(P===t.DBCS_N)b.push(new f(t.Owner,!0)),w++;else if(P===t.DBCS_G)b.push(new a(t.Owner,!0)),w++;else if(P===t.DBCS_Z)b.push(new i(t.Owner,!0)),w++;else if(P===t.DBCS_T)b.push(new c(t.Owner,!0)),w++;else{if(P!=="\\"&&P!=="]"&&P!=="["&&P!=="-"&&P!=="^")return!1;if(S.indexOf(P)!==-1){w++;continue}S+=P,w++}break;default:if(n.length>w+2&&n.charAt(w+1)==="-"){var H=t.GetEscapeCharLength(n.substr(w+2),C,k);C=H.KeyType,k=H.Length;if(H.Result){var _=null,M=16;C===N.OctalAscII?(M=8,_=n.substr(w+2+1,k-1)):_=n.substr(w+2+2,k-2);var B=w+2;n=n.substring(0,B)+n.substr(B+k);var D=String.fromCharCode(parseInt(_,M));n=n.substring(0,B)+D+n.substr(B)}var j,F;n.charAt(w)>n.charAt(w+2)?(j=n.charAt(w+2),F=n.charAt(w)):(j=n.charAt(w),F=n.charAt(w+2));var I=new g(j,F,t.Owner,!0);b.push(I),w+=2;break}if(S.indexOf(T)!==-1){w++;continue}S+=T}w++}S.length>0&&b.push(new m(S,"",t.Owner,!0));var q=b.length;if(v.uf&&v.uf.filterArray.length>0)for(var x=0;x<v.uf.filterArray.length;x++)b.push(d.filterArray[x]);v.uf=new y(t.Owner,!0),v.uf.AddRange(b);for(var x=0;x<q;x++)v.uf.filterArray[x]._include=E;return v.Result=!0,v},t.AnalyseEnumGroup=function(n,r){n=n.Substring(1,1+n.length-2);var i=0,s=0;while(i<n.length){var o=e.Utility.IndexOfAny(n,["|",")","\\","("],i);if(o===-1){var u=n.Substring(s);if(u.length===0)return!1;r.push(u),i=n.length;continue}if(n.charAt(o)==="\\"){var a=n.charAt(o+1);if(a==="\\"||a===")"||a==="|"||a==="("){n=n.Substring(0,o)+n.Substring(o+1,n.length),i=o+1;if(i===n.length){var u=n.Substring(s);if(u.length===0)return!1;r.push(u)}continue}return!1}if(n.charAt(o)==="|"){var u=n.Substring(s,o);if(u.length===0)return!1;r.push(u),i=o+1,s=i;continue}return!1}return!0},t}(),k=function(t){function n(e,n,r){t.call(this,n),this._focusNull="",this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this._owner=e,this.formatIsNull=r}return __extends(n,t),n.prototype.GetShowLiterals=function(){return this._owner.GetShowLiterals()},n.prototype.GetFieldByIndex=function(e){return this.fieldArray[e]},n.prototype.GetLength=function(){var e=this.ValueIsNull();if(e&&this._focusNull!==""&&!this.formatIsNull)return this._focusNull.GetLength();if(e===!0&&this._focusNull!=="")return 0;var t=this.GetLastVisibleFieldIndex(this.GetShowLiterals()),n=0;for(var r=0;r<=t;r++){var i=this.GetFieldByIndex(r);n+=i.GetLength()}return n},n.prototype.GetInputFieldIndexByPos=function(e){var t=null,n=0,r,i=this.GetFieldIndex(e,n);r=i.index,n=i.offset,r!==0&&n===0&&this.fieldArray[r-1].fieldLabel!=="PromptField"&&(r--,n=this.fieldArray[r].text.GetLength());var s=this.fieldArray[r];if(n===s.text.GetLength()){var o;if(n<s._maxLength){t=r;if(t!==this.fieldCount-1)for(o=r+1;o<this.fieldCount;o++)if(this.fieldArray[o].fieldLabel!=="PromptField")break}else for(o=r+1;o<this.fieldCount;o++)if(this.fieldArray[o].fieldLabel!=="PromptField"){t=o;break}}else t=r;var u={},a={};if(t){var f=!1;while(f===!1){s=this.fieldArray[t];if(s.fieldLabel==="FilterField")a.fieldMark=s._filter.filterLabel,f=!0;else if(s.fieldLabel==="EnumField")a.fieldMark="Enum",f=!0;else{if(t===this.fieldCount-1){a=null;break}t++}a.fieldIndex=t}}else a=null;return a!=null?(u.currentField=a,u):null},n.prototype.GetCurrentField=function(e){var t={},n=0,r=0;for(var i=0;i<this.fieldCount;i++){var s=this.fieldArray[i];s.fieldLabel==="PromptField"&&r++;var o=s.GetLength();n+=o;if(e<=n)return s.fieldLabel==="PromptField"?e===n-o?t.index=i-r:e===n?t.index=i-r+1:t.index=-1:t.index=i-r,t}},n.prototype.GetText=function(){var e="";for(var t=0;t<this.fieldCount;t++){var n=this.fieldArray[t];e+=n.text}return e},n.prototype.GetTextSimpleMode=function(e){var t="";for(var n=0;n<this.fieldCount;n++){var r=this.fieldArray[n];if(r.fieldLabel==="PromptField"&&!e)continue;t+=r.text}return t},n.prototype.GetExistLength=function(){var e=this.fieldCount,t,n;for(t=this.fieldCount-1;t>=0;t--){n=this.fieldArray[t];if(n.fieldLabel==="PromptField")continue;e=t;break}var r=0;for(t=0;t<=e;t++)n=this.fieldArray[t],t===e?r>=21474e3?r=n._maxLength:r+=n._maxLength:r+=n.text.GetLength();return r},n.prototype.GetNonLiteralsText=function(e,t){var n="",r=0,i,s=this.GetFieldIndex(e,r);i=s.index,r=s.offset;var o=0,u;s=this.GetFieldIndex(e+t,o),u=s.index,o=s.offset,u!==0&&o===0&&(u--,o=this.fieldArray[u].text.GetLength());for(var a=i;a<=u;a++){var f=this.fieldArray[a];f.fieldLabel!=="PromptField"&&(i===u?(n=f.text.Substring(r,o),n.GetLength()>f._trueLength&&(n=n.Substring(0,f._trueLength))):a===i?n+=f.text.Substring(r,f.text.GetLength()):a===u?n+=f.text.Substring(0,o):n+=f.text.Substring(0,f.text.GetLength()))}return n},n.prototype.GetNonPromptText=function(e,t){var n="",r=0,i,s=this.GetFieldIndex(e,r);i=s.index,r=s.offset;var o=0,u;s=this.GetFieldIndex(e+t,o),u=s.index,o=s.offset,u!==0&&o===0&&(u--,o=this.fieldArray[u].text.GetLength());for(var a=i;a<=u;a++){var f=this.fieldArray[a];f.fieldLabel!=="PromptField"&&(i===u?n=f.text.Substring(r,o):a===i?n+=f.text.Substring(r,f.text.GetLength()):a===u?n+=f.text.Substring(0,o):n+=f.text)}return n},n.prototype.ValueIsNull=function(){for(var e=0;e<this.fieldCount;e++){var t=this.fieldArray[e];if(t.fieldLabel==="PromptField")continue;if(t.GetFieldStatus()!==0)return!1}return!0},n.prototype.ValueIsFull=function(e){e=e?e:0;var t,n;if(e!=null&&e===1)for(t=0;t<this.fieldCount;t++){n=this.fieldArray[t];if(this.fieldCount===1&&n._minLength===0)return!0;if(n.fieldLabel==="PromptField")continue;if(!n.GetFieldIsFull())return!1}else for(t=0;t<this.fieldCount;t++){n=this.fieldArray[t];if(n.fieldLabel==="PromptField")continue;if(n.GetFieldStatus()!==2)return!1}return!0},n.prototype.GetShowText=function(t,n,r){if(!r){var i=this.ValueIsNull();if(i===!0&&this._focusNull!==""&&n=="")return this._focusNull;if(i===!0&&this._focusNull!==""&&n==null)return"";if(i===!0&&n==="LoseFocus")return this._owner._getDisplayNullExpression()!==null?this._owner._getDisplayNullExpression():this.GetText()}var s=this.GetLastVisibleFieldIndex(t);if(s<0)return"";var o="";for(var u=0;u<s;u++)o+=this.fieldArray[u].text;if(s<this.fieldCount){var a=this.fieldArray[s];a.fieldLabel==="PromptField"||t===e.ShowLiterals.Always?o+=this.fieldArray[s].text:o+=a.text.Substring(0,a._trueLength)}return o},n.prototype.GetLastVisibleFieldIndex=function(t){var n=this.fieldCount-1;if(t!==e.ShowLiterals.Always){var r=this.fieldCount-1,i=!0;for(n=r;n>=0;n--){var s=this.fieldArray[n];if(s.fieldLabel==="PromptField")continue;if(s._trueLength===0){i=!1;continue}if(s._trueLength>0&&s._trueLength<s._minLength)break;if(t===e.ShowLiterals.PostDisplay){i&&(n=r);break}while(n<r&&this.fieldArray[n+1].fieldLabel==="PromptField")n++;break}}return n},n.prototype.GetValue=function(){var e=this.fieldCount-1,t;for(;e>=0;e--){t=this.fieldArray[e];if(t.fieldLabel!=="PromptField"&&t._trueLength!==0)break}if(e<0)return"";var n="";for(var r=0;r<=e;r++){t=this.fieldArray[r];if(t.fieldLabel==="PromptField")continue;var i=t._trueLength,s=t.text,o=s;if(t.fieldLabel==="FilterField"){o=o.Substring(0,i);for(var u=0;u<i;u++)t._bitState[u]===!1&&(o=o.Substring(0,u)+" "+o.Substring(u+1,o.GetLength()));var a=s.GetLength(),f=o.GetLength();if(i===0&&a!==0){if(r!==e){var l="";for(var c=0;c<a;c++)l+=" ";o=l}}else if(a>f&&r!==e){var l="";for(var c=0;c<a-f;c++)l+=" ";o+=l}}else t._activeItem===-1&&(o=" ");n+=o}return n},n.prototype.GetOldValue=function(){var e="",t;for(var n=0;n<this.fieldCount;n++){t=this.fieldArray[n];if(t.fieldLabel==="PromptField")continue;var r;if(t.fieldLabel==="FilterField"){r=t.undoText;if(t._undoBitState&&t._undoBitState.length>0){var i=!0;for(var s=t._undoBitState.length-1;s>=0;s--)t._undoBitState[s]===!1?i?r=r.Substring(0,r.GetLength()-1):r=r.Substring(0,s)+" "+r.Substring(s+1,r.GetLength()):i=!1}else r=""}else t._undoItem!==-1?r=t.undoText:r="";e+=r}return e},n.prototype.SetValue=function(e,t){if(!e)return this.ClearContent(),!0;var n=!1;return t!=null&&(n=t),this.SetFieldCollectionValue(e,n)?!0:(this.RollBack(),!1)},n.prototype.SetFieldCollectionValue=function(e,t){this.ClearContent();var n=!1;return t!=null&&(n=t),e.GetLength()!==0&&this.Insert(0,e,n,!1),!0},n.prototype.ClearContent=function(){this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this.formatIsNull&&this.SaveUndoState();if(this.fieldCount>0)for(var e=0;e<this.fieldCount;e++){var t=this.fieldArray[e];t.oldText=t.text,t.Delete(0,t.text.GetLength())}},n.prototype.RollBack=function(){if(this.fieldCount>0)for(var e=0;e<this.fieldCount;e++){var t=this.fieldArray[e];t.RollBack()}},n.prototype.SaveOldState=function(){if(this.fieldCount>0)for(var e=0;e<this.fieldCount;e++){var t=this.fieldArray[e];t.fieldLabel!=="PromptField"&&t.SaveOldState()}},n.prototype.SaveUndoState=function(){if(this.formatIsNull){var e=this.fieldArray[0],t=-1;if(this.oldStart===-1)e.SaveUndoState(),t=this.newStart;else{var n=e.text.substr(this.newStart,this.newLength);t=e.undoText.IndexOf(n,this.oldStart),t!==this.oldStart+this.oldLength&&(t=this.newStart,t+this.newLength!==this.oldStart&&e.SaveUndoState())}this.oldStart>0?this.oldStart=Math.min(this.oldStart,t):this.oldStart=t,this.oldLength+=this.newLength}else if(this.fieldCount>0)for(var r=0;r<this.fieldCount;r++){var e=this.fieldArray[r];e.fieldLabel!=="PromptField"&&e.SaveUndoState()}},n.prototype.Undo=function(){this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0;if(this.fieldCount>0)for(var e=0;e<this.fieldCount;e++){var t=this.fieldArray[e];t.fieldLabel!=="PromptField"&&t.Undo()}},n.prototype.PerformSpin=function(e,t,n){var r,i=this.GetFieldIndex(e,r),s=i.index;r=i.offset,this.SaveOldState();if(r>0||this.fieldArray[s].fieldLabel==="EnumField"){r=this.fieldArray[s].PerformSpin(r,t,n);var o=0;for(var u=0;u<s;u++)o+=this.fieldArray[u].text.GetLength();e=o+r}else{var a=s,f;for(;a<this.fieldCount;a++){f=this.fieldArray[a];if(f._minLength===0){if(f.text.GetLength()===0)continue;break}if(f.fieldLabel==="EnumField"){r=f.PerformSpin(r,t,n);var o=0;for(var u=0;u<s;u++)o+=this.fieldArray[u].text.GetLength();return e=o+r,e}break}if(s>0){f=this.fieldArray[s-1],r=f.text.GetLength(),r<f._minLength&&(r=f._minLength),r=f.PerformSpin(r,t,n);if(f.fieldLabel==="EnumField"){var o=0;for(var u=0;u<s-1;u++)o+=this.fieldArray[u].text.GetLength();e=o+r}}}return e},n.prototype.Delete=function(e,t){if(this.fieldCount===0)return e;var n=0;this.SaveOldState();var r=this.GetFieldIndex(e,n),i=r.index;n=r.offset,this.fieldArray[i].fieldLabel==="PromptField"&&t>this.fieldArray[i].text.GetLength()-n&&(e+=this.fieldArray[i].text.GetLength()-n,t-=this.fieldArray[i].text.GetLength()-n,i++,n=0),this.newStart=e,this.newLength=t,this.formatIsNull&&this.SaveUndoState();var s=0;r=this.GetFieldIndex(e+t,s);var o=r.index;s=r.offset;while(o!==0&&s===0){var u=this.fieldArray[o-1];if(u.fieldLabel==="PromptField")break;o--,s=this.fieldArray[o].text.GetLength()>this.fieldArray[o]._minLength?this.fieldArray[o].text.GetLength():this.fieldArray[o]._minLength}for(var a=i;a<=o;a++){var u=this.fieldArray[a],f=n;if(i===o)s>n?n=u.Delete(n,s-n):n-=n-s;else if(a===i){var l=u.text.GetLength()-n;l>0&&(n=u.Delete(n,u.text.GetLength()-n))}else a===o?n=u.Delete(n,s):n=u.Delete(n,u.text.GetLength());n!=null&&(e+=n-f),n=0}return e},n.prototype.Replace=function(e,t,n,r){var i={};i.cursorPos=e,i.text=n;var s=this.GetFieldIndex(e,o),o=0,s=0,u={};u=this.GetFieldIndex(e,o),s=u.index,o=u.offset,this.SaveOldState();var a;for(;s<this.fieldCount;s++){a=this.fieldArray[s];if(a._minLength>0||a.text.GetLength()>0)break}while(s!==0&&o===0){if(this.fieldArray[s].fieldLabel!=="PromptField")break;s--,a=this.fieldArray[s],o=a.text.GetLength(),o<a._minLength&&(o=a._minLength)}this.newStart=e,this.newLength=t;var f=0,l;u=this.GetFieldIndex(e+t,f),l=u.index,f=u.offset;var c=0;for(var h=s;h<l;h++)a=this.fieldArray[l-1],c+=a.text.GetLength();c+=f,-w;while(l!==0&&f===0){a=this.fieldArray[l-1];if(!(a.fieldLabel!=="PromptField"&&a.text.GetLength()<a._maxLength))break;l--,f=this.fieldArray[l].text.GetLength()}var p=n,d=!1,v=e-o;for(var m=s;m<=this.fieldCount-1;m++){d=!1,a=this.fieldArray[m];var g=a.text.GetLength()>a._minLength?a.text.GetLength():a._minLength;if(a.fieldLabel==="PromptField"){g=a.GetLength();if(r){var y=a.text.Substring(o,a.text.GetLength()),b=n.GetLength();n.GetLength()>=y.GetLength()?(n.Substring(0,y.GetLength())!==y&&(d=!0),n=n.Substring(y.GetLength(),n.GetLength()),e+=y.GetLength()):(n.Substring(0,y.GetLength())!==y&&(d=!0),n="",e+=n.GetLength());if(d){T;if(b===n.GetLength())break}}else v+o===e&&(e+=g-o);v+=a.text.GetLength()-o}else{var w=o,E=m===this.fieldCount-1;if(m>l){var S={},E=m===this.fieldCount-1;S=a.Insert(o,n,E),o=S.offset,n=S.text,d=S.existInvalid}else if(s===l){var x={};x=a.Replace(o,f-o,n,E),o=x.offset,n=x.text,d=x.existInvalid}else if(m===s){var x={};x=a.Replace(o,g-o,n,E),o=x.offset,n=x.text,d=x.existInvalid}else if(m===l){var x={};f-o>0?x=a.Replace(o,f-o,n,E):t>0&&(x=a.Replace(o,t,n,E)),o=x.offset,n=x.text,d=x.existInvalid}else{var x={};x=a.Replace(o,g,n),o=x.offset,n=x.text,d=x.existInvalid}var T=a.GetFieldStatus()!==2;if(T&&d)break;e+=o-w,v+=a._minLength>a.text.GetLength()?a._minLength:a.text.GetLength()}o=0;if(n===""){if(m<l){m++;var h=m,N=0;for(;m<l;m++)this.fieldArray[m].fieldLabel!=="PromptField"&&this.fieldArray[m].Delete(o,this.fieldArray[m].text.GetLength());for(var C=0;C<h;C++){var a=this.fieldArray[C],g=a.GetLength();N+=g}if(e===N&&a._trueLength===a._maxLength)for(;h<=l;h++){if(this.fieldArray[h].fieldLabel!=="PromptField"||h===this.fieldCount-1)break;e+=this.fieldArray[h].text.GetLength()}if(f===0)break;this.fieldArray[l].fieldLabel!=="PromptField"&&this.fieldArray[l].Delete(o,f)}break}}return p===n?(this.RollBack(),i.success=!1):i.success=!0,i.cursorPos=e,i.text=n,i},n.prototype.SetText=function(e,t){var n=0,r={};r.cursorPos=n,r.text=e;if(this.fieldCount===0||!e||n<0)return r;var i=0,s=0,o={};o=this.GetFieldIndex(n,i),s=o.index,i=o.offset;if(i===this.fieldArray[s]._maxLength)return r;while(s!==0&&i===0){var u=this.fieldArray[s-1];if(!(u.fieldLabel!=="PromptField"&&u.text.GetLength()<u._maxLength))break;s--,i=this.fieldArray[s]._trueLength,i<this.fieldArray[s]._minLength&&(i=this.fieldArray[s]._minLength)}var a=!1,f=s,l=n-i;for(;f<this.fieldCount;f++){a=!1;var u=this.fieldArray[f];if(u.fieldLabel==="PromptField"){if(t){var c=u.text.Substring(i,u.text.GetLength()),h=e.GetLength();e.GetLength()>=c.GetLength()?e.Substring(0,c.GetLength())!==c?a=!0:(e=e.Substring(c.GetLength(),e.GetLength()),n+=c.GetLength()):(c.Substring(0,e.GetLength())!==e&&(a=!0),e="",n+=e.GetLength());if(a){m;if(e.GetLength()===h)return r.isValid=!1,r}}else l+i===n&&(n+=u.maxLength-i);l+=u.maxLength-i}else{var p=i,d={},v=f===this.fieldCount-1;d=u.SetTextInternal(e,i,v),this.oldStart=-1,this.oldLength=0,this.newStart=-1,this.newLength=0,this.formatIsNull&&this.SaveUndoState(),i=d.offset,e=d.text,a=d.existInvalid;var m=d.exception;if(a&&m)return r.isValid=!1,r;n+=i-p,l+=u._minLength<u._trueLength?u._trueLength:u._minLength}i=0;if(e.GetLength()===0&&(a||m)){if(!t)break;if(a)return r.isValid=!1,r}}if(f>=this.fieldCount&&e!==""&&e.GetLength()>0)return r.isValid=!1,r;var g=this.GetFieldIndex(n,i),y=g.index,b=g.offset;return f<this.fieldCount&&y===f+1&&b===0&&this.fieldArray[f].text.GetLength()===this.fieldArray[f]._maxLength&&this.fieldArray[f+1].fieldLabel==="PromptField"&&(n+=this.fieldArray[f+1].GetLength()),r.isValid=!0,r.cursorPos=n,r.text=e,r},n.prototype.Insert=function(e,t,n,r){var i={};i.cursorPos=e,i.text=t;if(this.fieldCount===0||!t||e<0)return i;var s=0,o=this.GetFieldIndex(e,s),u=o.index;s=o.offset;if(s===this.fieldArray[u]._maxLength)return i;while(u!==0&&s===0){var a=this.fieldArray[u-1];if(!(a.fieldLabel!=="PromptField"&&a.text.GetLength()<a._maxLength))break;u--,s=this.fieldArray[u]._trueLength;if(s<this.fieldArray[u]._minLength){s=this.fieldArray[u]._minLength,i=this.InsertProcess(u,s,e,t,n);if(i.text==="")return i;if(e===s){u++,s=0;break}}}return this.InsertProcess(u,s,e,t,n,r)},n.prototype.InsertProcess=function(t,n,r,i,s,o){var u={},a=!1,f=t,l=r-n;this.SaveOldState();for(;f<this.fieldCount;f++){a=!1;var c=this.fieldArray[f];if(c.fieldLabel==="PromptField"){if(s){var h=c.text.Substring(n,c.text.GetLength()),p=i.GetLength();i.GetLength()>=h.GetLength()?(i.Substring(0,h.GetLength())!==h&&(a=!0),i=i.Substring(h.GetLength(),i.GetLength()),r+=h.GetLength()):(h.Substring(0,i.GetLength())!==i&&(a=!0),i="",r+=i.GetLength());if(a){g;if(i.GetLength()===p)break}}else r+=c.maxLength-n;l+=c.maxLength-n}else{var d=n,v=f===this.fieldCount-1,m=c.Insert(n,i,v,o);n=m.offset,i=m.text,a=m.existInvalid;var g=m.exception;if(a&&g){if(i===u.text)return u;break}r+=n-d,l+=c._minLength<c._trueLength?c._trueLength:c._minLength}n=0;if(i.GetLength()===0)break}if(f>=this.fieldCount&&i!==""&&i.GetLength()>0&&i===u.text)return u;var y=this.GetFieldIndex(r,n),b=y.index,w=y.offset;return f<this.fieldCount&&b===f+1&&w===0&&this.fieldArray[f].text.GetLength()===this.fieldArray[f]._maxLength&&this.GetShowLiterals()!==e.ShowLiterals.PostDisplay&&this.fieldArray[f+1].fieldLabel==="PromptField"&&f+1!==this.fieldCount-1&&(r+=this.fieldArray[f+1].GetLength()),u.cursorPos=r,u.text=i,u},n.prototype.MoveField=function(e,t){var n=this.GetFieldIndex(e),r=n.index,i=n.offset;if(r===-1)return-1;if(t){if(r===this.fieldCount-1)return-1;while(this.GetFieldByIndex(r).text.GetLength()===0&&r<this.fieldCount)r++;if(r===this.fieldCount-1)return-1;r++;if(this.GetFieldByIndex(r).fieldLabel==="PromptField"){if(r===this.fieldCount-1)return-1;r++}var s=0;for(var o=0;o<r;o++)s+=this.GetFieldByIndex(o).GetLength();return s}if(r===0||r===1&&i===0)return-1;while(this.GetFieldByIndex(r).text.GetLength()===0&&r>0)r--;if(r===0)return-1;r--;if(this.GetFieldByIndex(r).fieldLabel==="PromptField"){if(r===0)return-1;r--}var s=0;for(var o=0;o<r;o++)s+=this.GetFieldByIndex(o).GetLength();return s},n.prototype.GetPosByCurrentField=function(e){if(e==null)return null;var t=0,n=-1,r=!1;for(;t<this.fieldCount;t++){var i=this.fieldArray[t];i.fieldLabel!=="PromptField"&&n++;if(n===e){r=!0;break}}if(r)return this.GetFieldRange(t);if(n===-1)return null;t>=this.fieldCount&&(t=this.fieldCount-1);while(this.fieldArray[t].fieldLabel==="PromptField")t--;return this.GetFieldRange(t)},n.prototype.GetFirstInputPosition=function(){var e=this.ValueIsNull();return e&&this._focusNull!==""&&!this.formatIsNull?0:this.fieldArray[0].fieldLabel==="PromptField"?this.GetFieldRange(1).start:0},n.prototype.GetTotalInputFieldCount=function(){var e=0;if(this.fieldCount>0)for(var t=0;t<this.fieldCount;t++){var n=this.fieldArray[t];n.fieldLabel!=="PromptField"&&e++}return e},n.prototype.GetFieldIndexByPos=function(e){return this.GetFieldIndex(e)},n.prototype.CanUndo=function(){if(this.fieldCount>0)for(var e=0;e<this.fieldCount;e++){var t=this.fieldArray[e];if(t.fieldLabel!=="PromptField"&&t.undoTempText!==t.text)return!0}return!1},n.prototype.GetRealFieldRange=function(e){var t={};t.start=0,t.length=0;var n=0,r=-1,i=-1;for(var s=0;s<this.fieldCount;s++){this.fieldArray[s].fieldLabel!=="PromptField"&&r++;if(r===e){i=s;break}}for(var s=0;s<i;s++){var o=this.GetFieldByIndex(s);n+=o.GetLength()}var u=this.GetFieldByIndex(i);return u?(t.start=n,t.length=u.GetLength(),t):t},n.prototype.PushBack=function(e){this.Add(e),this.fieldCount++},n}(x);e.MaskFieldCollection=k;var L=function(t){function n(e){t.call(this),this.OldPosition=0,this.IsFocus=!1,this.isSelectionDeterminedByHighlightText=!1,this.Format=null,e.HelpID!=null&&(this.HelpID=e.HelpID),e.Owner&&(this.Owner=e.Owner)}return __extends(n,t),n.prototype.GetCurrentField=function(e){var t=this.GetShowText(this.GetShowLiterals());if(this.Format.Fields.ValueIsNull()&&t!=null&&(this.Format.Fields._focusNull!==""&&t===this.Format.Fields._focusNull||t!=null&&t=="")){var n={};return n.index=-1,n}return this.Format.Fields.GetCurrentField(e)},n.prototype.FocusInternal=function(t,n,r,i,s){var o={},u=this.GetShowText(this.GetShowLiterals());this.OldValue=this.Format.Fields.GetText(),this.isMulSelected=!1,this.isDblClick=!1,this.isTriClick=!1,o.SelectionStart=s,t===e.FocusType.Click&&(o.SelectionStart=e.Utility.GetCursorPosition(n),o.SelectionEnd=o.SelectionStart),o.Text=u,this.Format.Fields.ValueIsNull()&&o.Text!=null&&this.Format.Fields._focusNull!==""&&o.Text===this.Format.Fields._focusNull&&(o.SelectionStart=0,o.SelectionEnd=0),this.Format.Fields.ValueIsNull()&&this.Format.Fields._owner._getDisplayNullExpression()!==null&&(o.SelectionStart=0,o.SelectionEnd=0);if(o.SelectionStart===-1||o.SelectionStart>o.Text.GetLength())o.SelectionStart=0,o.SelectionEnd=0;t===e.FocusType.Left?(o.SelectionStart=0,o.SelectionEnd=0):t===e.FocusType.Right&&(o.SelectionStart=o.Text.GetLength(),o.SelectionEnd=o.Text.GetLength());var a=o.SelectionStart;if(t!==e.FocusType.SpinButton&&t!==e.FocusType.ContextMenu&&t!==e.FocusType.ClientEvent&&t!==e.FocusType.ImeInput&&(r!==e.HighlightText.None||i!==-1))if(this.Format.Fields.ValueIsNull()&&o.Text!=null&&this.Format.Fields._focusNull!=""&&o.Text===this.Format.Fields._focusNull)o.SelectionEnd=o.Text.GetLength();else{var f=this.SetCursorPositionAndSelection(r,"",i,a);f!=null&&(o.SelectionStart=f.SelectionStart,o.SelectionEnd=f.SelectionEnd)}return o.SelectionStart!=null&&(this.OldPosition=o.SelectionStart),this.IsFocus=!0,o},n.prototype.SetCursorPositionAndSelection=function(t,n,r,i){var s;if(t===e.HighlightText.All)this.isSelectionDeterminedByHighlightText=!0,s=this.SelectAll();else if(t===e.HighlightText.Field){this.isSelectionDeterminedByHighlightText=!0;if(r<=-1)if(i>0){var o=this.Format.Fields.GetFieldIndex(i).index,u=this.Format.Fields.fieldArray[o];u.fieldLabel==="PromptField"&&(o===this.Format.Fields.fieldCount-1?o--:o++);var a=this.Format.Fields.GetFieldRange(o);s={},s.SelectionStart=a.start,s.SelectionEnd=a.length+a.start}else s=this.GetPosByCurrentField(i);else s=this.GetPosByCurrentField(r)}else s=this.GetPosByCurrentField(r),s!=null&&(s.SelectionStart=s.SelectionStart,s.SelectionEnd=s.SelectionStart);return s},n.prototype.GetPosByCurrentField=function(e){var t={},n=this.Format.Fields.GetPosByCurrentField(e);return n!=null&&n!=-1?(t.SelectionStart=n.start,t.SelectionEnd=n.start+n.length,t):null},n.prototype.LoseFocus=function(){var e={};return this.Owner._getFormatIsNull()!=1&&this.Format.Fields.SaveUndoState(),e.Text=this.GetShowText(this.GetShowLiterals(),"LoseFocus"),e.Value=this.Format.Fields.GetValue(),this.IsFocus=!1,e},n.prototype.GetSepText=function(){if(this.Owner._getFormatIsNull())return this.Format.Fields.GetText();var t="",n=this.Format.Fields.fieldCount-1;for(var r=0;r<=n;r++){var i=this.Format.Fields.fieldArray[r];if(i.fieldLabel==="PromptField")continue;var s=i._trueLength,o=i.text;if(i.fieldLabel==="FilterField")for(var u=0;u<s;u++)i._bitState[u]===!1&&(o=o.Substring(0,u)+" "+o.Substring(u+1,o.GetLength()));else i._activeItem===-1&&(o="");if(r!=n){var a=o.Substring(0,s);a=a.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\");if(i.fieldLabel==="FilterField"&&!this.Owner._getFormatIsNull()){var f=o.Substring(0,s);for(var u=0;u<s;u++)i._bitState[u]===!1&&(f=f.Substring(0,u)+e.Utility.MaskValChar+f.Substring(u+1,f.GetLength()));a+=e.Utility.Hold+","+f.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\")}t+=a+e.Utility.Hold+";"}else{var a=o.Substring(0,s);a=a.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\");if(i.fieldLabel==="FilterField"&&!this.Owner._getFormatIsNull()){var f=o.Substring(0,s);for(var u=0;u<s;u++)i._bitState[u]===!1&&(f=f.Substring(0,u)+e.Utility.MaskValChar+f.Substring(u+1,f.GetLength()));a+=e.Utility.Hold+","+f.replace(/'/g,"@#GCD#@").replace(/"/g,"@#GCM#@").replace(/,/g,"@#GCC#@").replace(/@#GCF#@/g,"\\")}t+=a}}return t},n.prototype.SetSepText=function(t){if(!t){for(var n=0;n<this.Format.Fields.fieldCount;n++){var r=this.Format.Fields.fieldArray[n];if(r.fieldLabel==="PromptField")continue;r.Clear()}return!0}var i=e.Utility.Hold+";",s=t.split(i);for(var o=0;o<s.length;o++)s[o]=s[o].replace(/@#GCC#@/g,",").replace(/@#GCD#@/g,"'").replace(/@#GCM#@/g,'"');var u=!1,a=0;for(var n=0;n<this.Format.Fields.fieldCount;n++){var r=this.Format.Fields.fieldArray[n];if(r.fieldLabel==="PromptField")continue;if(a<s.length){var f=s[a].split(e.Utility.Hold+","),l=f[0],c="";if(f.length>1){c=f[1];if(c&&c!=""&&l!=c){var h=0,p=l.IndexOf(" ",h);while(p!=-1)c.Substring(p,p+1)===e.Utility.MaskValChar&&(l=l.Substring(0,p)+this.Owner.GetPromptChar()+l.Substring(p+1,l.GetLength())),h=p,p=l.IndexOf(" ",h)}}u=a===this.Format.Fields.fieldCount-1;var d=l.GetLength();if(d<r._minLength)for(var o=0;o<r._minLength-d;o++)l+=this.Owner.GetPromptChar(),c+=e.Utility.MaskValChar;var v;r.fieldLabel==="FilterField"?v=r.SetTextInternal(l,0,u,c):v=r.SetTextInternal(l,0,u);if(v.existInvalid&&v.exception)return!1;a++}else r.Clear()}return!0},n.prototype.ProcessShortcutKey=function(e,n,r){var i={};switch(e){case"Clear":return n||this.Format.Fields.ClearContent(),i.SelectionStart=this.Format.Fields.GetFirstInputPosition(),i.SelectionEnd=i.SelectionStart,i.Text=this.GetShowText(this.GetShowLiterals()),i;case"NextField":if(this.IsLastInputField(r,!0))return!0;break;case"PreviousField":if(this.IsLastInputField(r,!1))return!0}return i=t.prototype.ProcessShortcutKey.call(this,e,n,r),i},n.prototype.KeyDown=function(n){var r=n.KeyCode,i=t.prototype.KeyDown.call(this,n);r===27&&this.Owner.Clear();if(n.KeyAction!=null)return i;if(n.ReadOnly===!0)return i;if(r!=undefined&&r!=null){if(r>=48&&r<=57||r>=65&&r<=90||r>=96&&r<=105||r===0||r===229||r===231)return i||(i={}),A.Mask_ImeResponse=!0,i.inputChar=!0,i;if(r===32||r===106||r===107||r===109||r===110||r===111||r===219||r===220||r===221||r===222||r>=186&&r<=192||r===226)return i||(i={}),A.Mask_ImeResponse=!0,i.inputChar=!0,i;if(!e.Utility.IsIE()&&(r===61||r===59))return i||(i={}),A.Mask_ImeResponse=!0,i.inputChar=!0,i;var s=r;n.FuncKeysPressed.Shift&&r!=65552&&(s=r-65536),r>65600&&r<65627&&(s=r-65536);if(s>=48&&s<=57||s>=65&&s<=90||s>=96&&s<=105||s===229||s===0||s===231)return i||(i={}),A.Mask_ImeResponse=!0,i.inputChar=!0,i;if(s===32||s===106||s===107||s===109||s===110||s===111||s===219||s===220||s===221||s===222||s>=186&&s<=192||s===226)return i||(i={}),A.Mask_ImeResponse=!0,i.inputChar=!0,i;if(!e.Utility.IsIE()&&(s===61||s===59))return i||(i={}),A.Mask_ImeResponse=!0,i.inputChar=!0,i}return i},n.prototype.KeyPressInternal=function(e,t,n,r,i){if(A.Mask_ImeResponse===!0){A.Mask_ImeResponse=!1;var s={};this.Format.Fields.ValueIsNull()&&this.Format.Fields._focusNull!=""&&(t=0,n=0);var o=this.ProcessCharKey(t,n,i,r);if(o.success){s.SelectionStart=o.start,s.SelectionEnd=s.SelectionStart,s.Text=this.GetShowText(this.GetShowLiterals()),this.isMulSelected=!1;if(this.moveFocusExitOnLastChar){var u=this.MoveControl(this.GetElementId(),!0,!1,"CharInput");u!=null&&(s.EventInfo=u.EventInfo,s.FocusType=u.FocusType,s.FocusExit=!0),this.moveFocusExitOnLastChar=!1}}else s.SelectionStart=o.start,s.SelectionEnd=Math.max(t,n),s.Text=this.GetShowText(this.GetShowLiterals()),s.EventInfo=o.EventInfo,s.exception=!0,this.moveFocusExitOnLastChar&&(s.FocusExit=!0,this.moveFocusExitOnLastChar=!1);return s}return!1},n.prototype.ProcessCharKey=function(e,n,r,i){var s=t.prototype.ProcessCharKey.call(this,e,n,r,i),o=Math.min(e,n);return s.success&&(o=s.start),i&&(this.moveFocusExitOnLastChar=!1,o===this.Format.Fields.GetExistLength()&&(this.moveFocusExitOnLastChar=!0)),s},n.prototype.ContextMenu=function(){},n.prototype.Click=function(){},n.prototype.Undo=function(e){var t={};return this.Format.Fields.Undo(),t.SelectionStart=this.OldPosition,t.SelectionEnd=this.OldPosition,this.OldPosition=e,t.Value=this.Format.Fields.GetText(),t.Text=this.GetShowText(this.GetShowLiterals()),t},n.prototype.Paste=function(t,n,r,i,s){var o={};o.SelectionStart=t,o.SelectionEnd=n;var u;s!=null&&s===!0?u=r:this.Owner?(u=e.Utility.GetPasteData(this.Owner.GetUseClipboard()),u=this.UpdateCrLfString(u,this.Owner.GetAcceptsCrlf())):u=e.Utility.GetPasteData(!0);var a=null;u!=null&&(u.IndexOf("\r")!=-1&&(u=u.Substring(0,u.IndexOf("\r"))),u.IndexOf("\n")!=-1&&(u=u.Substring(0,u.IndexOf("\n"))));if(!u)return o;this.FireClientEvent("OnBeforePaste");var f=Math.min(t,n),l=Math.max(t,n),c=l-f;if(f===l)o.SelectionStart=this.Format.Fields.Insert(f,u,!1).cursorPos,o.Text=this.GetShowText(this.GetShowLiterals()),o.SelectionEnd=o.SelectionStart;else{var h=this.GetShowText(this.GetShowLiterals());h!=null&&this.Format.Fields._focusNull!=""&&h===this.Format.Fields._focusNull&&this.Format.Fields.fieldArray[0].text!=h?a=this.Format.Fields.Insert(0,u,!1):a=this.Format.Fields.Replace(f,c,u,!1),o.SelectionStart=a.cursorPos,o.Text=this.GetShowText(this.GetShowLiterals()),h===o.Text&&a.success===!1?(o.SelectionStart=f,o.SelectionEnd=l):o.SelectionEnd=o.SelectionStart}if(o.Text.Substring(f,f+u.GetLength())!=u&&o.SelectionStart-f<u.GetLength()&&this.InvalidInput!=""){var p={};p.Name=this.InvalidInput,p.Args=null,p.Type="InvalidInput",o.EventInfo=p}if(i)if(o.SelectionStart===this.Format.Fields.GetExistLength())this.moveFocusExitOnLastChar=!0;else{var d=this.Format.Fields.GetFieldIndex(o.SelectionStart),v=d.index,m=d.offset;v===this.Format.Fields.fieldCount-1&&m===0&&this.Format.Fields.GetFieldByIndex(v).fieldLabel==="PromptField"&&(this.moveFocusExitOnLastChar=!0)}if(this.moveFocusExitOnLastChar){var g=this.MoveControl(this.GetElementId(),!0,!1,"CharInput");g!=null&&(o.EventInfo=g.EventInfo,o.FocusType=g.FocusType,o.FocusExit=!0),this.moveFocusExitOnLastChar=!1}return o.SelectionStart!=f&&this.FireClientEvent("OnPaste"),o},n.prototype.UpdateCrLfString=function(t,n){return n!==e.CrLfMode.NoControl?e.BaseUIProcess.UpdateCrLfString(t,n):e.BaseUIProcess.UpdateCrLfString(t,e.CrLfMode.Cut)},n.prototype.DragStart=function(){},n.prototype.DragEnd=function(){},n.prototype.DragOver=function(){},n.prototype.DragInit=function(){},n.prototype.SetValue=function(e){this.Format.Fields.SetValue(e)},n.prototype.GetShowText=function(e,t,n){var r="";return t?t==="LoseFocus"&&(r=this.Format.Fields.GetShowText(e,"LoseFocus",n)):r=this.Format.Fields.GetShowText(e,"",n),r},n.prototype.ProcessBackSpaceKey=function(e,t){var n=Math.min(e,t),r=Math.abs(e-t),i={};i.SelectionStart=n,i.SelectionEnd=n+r;if(n===0&&r===0)return i;var s,o,u=this.Format.Fields.GetFieldIndex(n);s=u.index,o=u.offset;if(s===-1)return i;if(r===0){var a=this.Format.Fields.GetFieldByIndex(s);if(s===0&&o===0)return i;while((o===0||a.fieldLabel==="PromptField")&&s>0)s--,r+=o,a=this.Format.Fields.GetFieldByIndex(s),o=a.GetLength(),a.fieldLabel==="PromptField"&&(r+=o,o=0);if(s===0){if(this.Format.Fields.GetFieldByIndex(s).fieldLabel==="PromptField")return i;if(this.Format.Fields.GetFieldByIndex(s).GetLength()===0)return i}if(this.Format.Fields.GetFieldByIndex(s).fieldLabel==="FilterField")r+=1,n-=r,r=1;else{if(this.Format.Fields.GetFieldByIndex(s).fieldLabel!=="EnumField")return i;r+=this.Format.Fields.GetFieldByIndex(s).GetLength(),n-=r,n=n>0?n:0}n=this.Format.Fields.Delete(n,r),i.SelectionStart=n,i.SelectionEnd=i.SelectionStart}else{var f;u=this.Format.Fields.GetFieldIndex(n+r),f=u.index;if(f===-1)return i;o===0&&s!=0&&s--;if(s===f&&this.Format.Fields.GetFieldByIndex(f).fieldLabel==="PromptField")return i;i.SelectionStart=this.Format.Fields.Delete(n,r),i.SelectionEnd=i.SelectionStart}return i},n.prototype.PerformSpinInternal=function(e,t,n,r,i){if(this.Format.Fields.fieldCount<=0)return null;var s={};s.SelectionStart=e,s.SelectionEnd=t,s.Text=this.GetShowText(this.GetShowLiterals());var o=this.Format.Fields.GetFieldIndex(t),u=o.index,a=o.offset;u!=0&&a===0&&(e===t?this.Format.Fields.fieldArray[u].fieldLabel!="EnumField"&&u--:e<t&&u--);if(this.Format.Fields.fieldArray[u].fieldLabel=="EnumField"||this.Format.Fields.fieldArray[u].text.GetLength()==0)i?s.SelectionStart=this.Format.Fields.PerformSpin(t,n,r):s.SelectionStart=this.Format.Fields.PerformSpin(t,-n,r),s.SelectionEnd=s.SelectionStart,s.Text=this.GetShowText(this.GetShowLiterals());if(i){if(this.SpinUp!=""){var f={};f.Name=this.SpinUp,f.Args=null,f.Type="SpinUp",s.EventInfo=f}}else if(this.SpinDown!=""){var f={};f.Name=this.SpinDown,f.Args=null,f.Type="SpinDown",s.EventInfo=f}return s},n.prototype.ProcessBackSpace=function(e,t){var n=this.ProcessBackSpaceKey(e,t);return n.Text=this.GetShowText(this.GetShowLiterals()),this.isMulSelected=!1,n},n.prototype.ProcessDeleteKey=function(e,t){var n=Math.min(e,t),r=Math.abs(e-t),i={};i.SelectionStart=n,i.SelectionEnd=n+r;if(n===this.Format.Fields.GetLength()&&r===0)return i;var s,o=this.Format.Fields.GetFieldIndex(n);s=o.index;if(s===-1)return i;if(r===0){if(this.Format.Fields.GetFieldByIndex(s).fieldLabel==="PromptField")return i;n=this.Format.Fields.Delete(n,1),i.SelectionStart=n,i.SelectionEnd=i.SelectionStart}else{var u,a;o=this.Format.Fields.GetFieldIndex(n+r),u=o.offset,a=o.index;if(a===-1)return i;u===0&&a--;if(s===a&&this.Format.Fields.GetFieldByIndex(s).fieldLabel==="PromptField")return i;i.SelectionStart=this.Format.Fields.Delete(n,r),i.SelectionEnd=i.SelectionStart}return i},n.prototype.ProcessDelete=function(e,t){var n=this.ProcessDeleteKey(e,t);return n.Text=this.GetShowText(this.GetShowLiterals()),this.isMulSelected=!1,n},n.prototype.GetNullCasePosition=function(e,t){var n=this.Format.Fields;switch(t){case 36:case 65572:case 131109:case 196645:case 196644:case 131108:e=0;break;case 35:case 65571:e=n.GetLength();break;case 65573:case 37:e!=0&&e--;break;case 39:case 65575:e!=n.GetLength()&&e++;break;case 131111:case 196647:case 196643:case 131107:e=n.GetLength();break;case 131118:case 131080:case 196616:return e}return e},n.prototype.GetCaretPosition=function(n,r){if(this.Format.Fields.ValueIsNull()&&this.Format.Fields._focusNull!="")return this.GetNullCasePosition(n,r);var i=this.Format.Fields,s=i.GetFieldIndex(n),o=s.index,u,a,f=0,l=0;for(l=0;l<i.fieldCount;l++)if(i.GetFieldByIndex(l).fieldLabel!="PromptField"){a=i.GetFieldRange(l).start;break}var c=i.GetLastVisibleFieldIndex(this.GetShowLiterals());if(this.ShowLiterals===e.ShowLiterals.PreDisplay)for(l=c;l>=0;l--)i.GetFieldByIndex(l).fieldLabel!="PromptField"&&(f+=i.GetFieldByIndex(l)._trueLength);else for(l=c;l>=0;l--)if(i.GetFieldByIndex(l).fieldLabel!="PromptField"){u=i.GetFieldRange(l),f=u.start+u.length;break}var h=n;n=t.prototype.GetCaretPosition.call(this,n,r,a,f,"PromptField");var s=i.GetFieldIndexByPos(h),o=s.index,u;if(r===196647&&n===h){for(;o<c;o++){u=i.GetFieldRange(o+1),n=u.start;if(n>a)break}o===c&&(n+=u.length)}if(r===131111&&i.GetFieldByIndex(o).fieldLabel!="PromptField"&&i.GetFieldRange(o).length===0){while(i.GetFieldRange(o).length===0&&o<i.fieldCount-1)o++;for(l=o+1;l<i.fieldCount;l++)if(i.GetFieldByIndex(l).fieldLabel!="PromptField")return u=i.GetFieldRange(l),u.start}return n},n.prototype.ProcessTabKey=function(n,r,i){var s;return i!==e.TabAction.Field||!!this.Format.Fields.ValueIsNull()&&this.Format.Fields._focusNull!=""&&this.GetShowText(this.GetShowLiterals())===this.Format.Fields._focusNull?s=t.prototype.ProcessTabKey.call(this,n,r,i):s=this.MoveFieldAndControl(n,r),s},n.prototype.ProcessLeftDirection=function(e,t,n){var r={};!this.isMulSelected||n===36||n===131108?(r.SelectionStart=this.GetCaretPosition(t,n),r.SelectionEnd=r.SelectionStart):(r.SelectionStart=Math.min(e,t),r.SelectionEnd=r.SelectionStart);if(n===37||n===131109){if(!this.Format.Fields.ValueIsNull()||this.Format.Fields._focusNull=="")if(r.SelectionStart>0){var i=this.Format.Fields.GetFieldIndex(r.SelectionStart),s=i.index,o=i.offset;this.Format.Fields.GetFieldByIndex(s).fieldLabel==="PromptField"&&this.isMulSelected===!1&&(r.SelectionStart-=o),r.SelectionEnd=r.SelectionStart}return this.isMulSelected=!1,r}this.isMulSelected=!1;if(!this.isMulSelected||n===36||n===131108)r.SelectionStart=this.GetCaretPosition(t,n),r.SelectionEnd=r.SelectionStart;else{r.SelectionStart=Math.min(e,t);var i=this.Format.Fields.GetFieldIndex(r.SelectionStart),s=i.index,o=i.offset;this.Format.Fields.GetFieldByIndex(s).fieldLabel==="PromptField"&&(r.SelectionStart-=o),r.SelectionEnd=r.SelectionStart}return r},n.prototype.ProcessRightDirection=function(e,t,n){var r={};if(!this.isMulSelected||n===35||n===131107)return r.SelectionStart=this.GetCaretPosition(t,n),r.SelectionEnd=r.SelectionStart,this.isMulSelected=!1,r;r.SelectionStart=Math.max(e,t);if(this.Format.Fields.ValueIsNull()===!0&&this.Format.Fields._focusNull!="")return r.SelectionEnd=r.SelectionStart,this.isMulSelected=!1,r;var i,s,o=this.Format.Fields.GetFieldIndex(r.SelectionStart);i=o.index,s=o.offset;if(this.Format.Fields.GetFieldByIndex(i).fieldLabel==="PromptField"&&this.isMulSelected===!1){var u=this.Format.Fields.fieldArray[i];r.SelectionStart+=u.text.GetLength()-s}return r.SelectionEnd=r.SelectionStart,this.isMulSelected=!1,r},n.prototype.IsLastInputField=function(e,t){var n=this.Format.Fields.GetFieldIndex(e,0),r=n.index;if(t){while(r<this.Format.Fields.fieldCount-1&&this.Format.Fields.fieldArray[r+1].fieldLabel!="PromptField"&&this.Format.Fields.fieldArray[r+1].text.GetLength()===0)r++;var i=this.Format.Fields.fieldCount-1;for(;i>r;i--)if(this.Format.Fields.fieldArray[i].fieldLabel!="PromptField")break;return i===r?!0:!1}while(r>0&&this.Format.Fields.fieldArray[r-1].fieldLabel!="PromptField"&&this.Format.Fields.fieldArray[r-1].text.GetLength()===0)r--;var i=0;for(;i<r;i++)if(this.Format.Fields.fieldArray[i].fieldLabel!="PromptField")break;return i===r?!0:!1},n.prototype.DoubleClick=function(e){var n={},r=this.GetShowText(this.GetShowLiterals());if(this.Format.Fields.ValueIsNull()&&r!=null&&(this.Format.Fields._focusNull!=""&&r===this.Format.Fields._focusNull||r!=null&&r=="")){var r=this.GetShowText(this.GetShowLiterals());n.SelectionStart=0,n.SelectionEnd=r.GetLength()}else n=t.prototype.DoubleClick.call(this,e);return n},n}(e.BaseUIProcess);e.MaskUIProcess=L;var A=function(n){function r(){n.call(this),this.IMControlType="Mask",this._promptChar="_",this._autoConvert=!0,this._displayNull=null,this._null="",this._formatPattern="",this._exitOnLastChar=!1,this._displayNullExpresson=null,this._showLiterals=e.ShowLiterals.Always,this._tabAction=e.TabAction.Control,this._hideEnter=!1,this._hidePromptOnLeave=!1,this._textWithPromptChar=null,this.PerformSpin=function(e){var t=this.Spin.Increment,n=!0;e==="down"&&(n=!1),this.PerformSpinProcess(this.SelectionStart,this.SelectionEnd,t,this.Spin.Wrap,n,!0),this.UIUpdate.SetFocus(),this.SetSelection(this.SelectionStart,this.SelectionEnd)},this.Init()}return __extends(r,n),r.Mask_ImeResponse=!1,r.prototype.AttachInput=function(e){this.InputElement=e,this.AddAllEventsHandler()},r.prototype.DetachInput=function(){t(this.InputElement).unbind(".wijinput"),this.InputElement=null},r.prototype.GetAutoConvert=function(){return this._autoConvert},r.prototype.SetAutoConvert=function(e){this._autoConvert=e},r.prototype.GetExitOnLastChar=function(){return this._exitOnLastChar},r.prototype.SetExitOnLastChar=function(t){t=e.Utility.CheckBool(t),this._exitOnLastChar=t},r.prototype.GetNull=function(){return this._null},r.prototype.SetNull=function(e){if(e!==this._null){var t=C.ParseFillExpression(e,this.Format.Fields);t.Expression===null?this.Format.Fields._focusNull=e:this.Format.Fields._focusNull=t.Expression,this._null=e}},r.prototype._getDisplayNullExpression=function(){return this._displayNullExpresson!==null?this._displayNullExpresson:this._displayNull},r.prototype.GetDisplayNull=function(){return this._displayNull},r.prototype.SetDisplayNull=function(t){t===undefined&&(t=null),t!==null&&(t=e.Utility.CheckString(t));if(t!==this._displayNull){var n=C.ParseFillExpression(t,this.Format.Fields);this._displayNullExpresson=n.Expression,this._displayNull=t;var r=this.GetValue();this.SetValue(r)}},r.prototype.GetFormatPattern=function(){return this._formatPattern},r.prototype.SetFormatPattern=function(t){t=e.BaseUIProcess.UpdateCrLfString(t,e.CrLfMode.Filter);if(t!==this._formatPattern)try{var n=C.ParseFormat(t,this);this.Clear(),this.Format.Fields=n,this.ResetNullAndDispalyNull(),this.FormatIsNull=this.Format.Fields.formatIsNull,this.Clear(),this.SetSelectionStart(0),this._formatPattern=t;var r=this.GetDisplayText();this.UpdateDisplayText(r)}catch(i){throw"Format pattern is invalid"}},r.prototype.ResetNullAndDispalyNull=function(){var e=C.ParseFillExpression(this.GetNull(),this.Format.Fields);e.Expression===null?this.Format.Fields._focusNull=this.GetNull():this.Format.Fields._focusNull=e.Expression,e=C.ParseFillExpression(this.GetDisplayNull(),this.Format.Fields),this._displayNullExpresson=e.Expression},r.prototype.GetPromptChar=function(){return this._promptChar},r.prototype.SetPromptChar=function(e){e||(e="_"),e.length>1&&(e=e.charAt(0));if(e!==this._promptChar){this._promptChar=e;var t=this.GetValue();this.SetValue(t)}},r.prototype.GetShowLiterals=function(){return this._showLiterals},r.prototype.SetShowLiterals=function(e){if(e!=this._showLiterals){this._showLiterals=e;var t=this.GetValue();this.SetValue(t)}},r.prototype.GetTabAction=function(){return this._tabAction},r.prototype.SetTabAction=function(e){this._tabAction=e},r.prototype.GetCursorPosition=function(){return this.CursorPosition},r.prototype.SetCursorPosition=function(t){t=e.Utility.CheckInt(t,-1,Math.pow(2,31)),t=Math.min(t,this.Format.Fields.GetTotalInputFieldCount()-1),t!==this.CursorPosition&&(this.CursorPosition=t)},r.prototype.Init=function(){this._autoConvert=!0,this.FormatIsNull=!0,this.CursorPosition=-1,this.truePosition=-1,this.japInput=!1,this.ImeMode=!1,this.IsImplementImeInput=!1,this.IsJapanConvertKeyPress=!1,this.HelpID="__"+this.ID+"_State",this.IsDragDrop=!1;var t={};t.ID=this.ID,t.HelpID=this.HelpID,t.Owner=this,this.UIProcess=this._createUIProcess(t),this.Format.Fields=C.ParseFormat("",this),this.FormatIsNull=this.Format.Fields.formatIsNull,this.UIProcess.Format=this.Format,this.NewSelectionStart=0,this.NewSelectionEnd=0,this.IsInUpdatePanelAndAsyncPostBack||this.UIUpdate&&(this.UIProcess.Format.Fields.ClearContent(),this.UIProcess.Format.Fields.SetText(this.UIUpdate.GetText(),!0)),this.Text=this.UIProcess.Format.Fields.GetText(),this.Value=this.UIProcess.Format.Fields.GetValue(),this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText(),this.MouseButton=e.MouseButton.Default,this.FocusType=e.FocusType.None;if(this.IsInUpdatePanelAndAsyncPostBack){var n=this.UIUpdate.GetText();if(n!=this.UIProcess.GetShowText(this.GetShowLiterals(),null,true)&&n!=this.UIProcess.GetShowText(this.GetShowLiterals(),"LoseFocus",false))if(this.ShowLiterals===e.ShowLiterals.Always)this.UIProcess.Format.Fields.ClearContent(),this.UIProcess.Format.Fields.SetText(n,!0),this.SetHideValue();else{this.UIProcess.Format.Fields.ClearContent();var r=this.UIProcess.GetShowText("Always",null,!0);n.GetLength()<r.GetLength()&&(n+=r.Substring(n.GetLength(),r.GetLength())),this.UIProcess.Format.Fields.SetText(n,!0),this.SetHideValue()}this.Text=this.UIProcess.Format.Fields.GetText(),this.Value=this.UIProcess.Format.Fields.GetValue(),this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText()}this.UIUpdate&&(this.DisplayText=this.GetTextboxValue()),this.LastStart=0,this.LastEnd=0,this.OrientText="",this.ImeSelect=!1,this.ImeSelectTimes=0,this.Type="Mask",this.UIUpdate&&this.ReLoadData()},r.prototype._createUIProcess=function(e){return new L(e)},r.prototype.Clear=function(){this.SetValue(""),this.SelectionStart=this.SelectionEnd=this.Format.Fields.GetFirstInputPosition()},r.prototype.SetValue=function(t){t&&(typeof t!="string"&&(t=t.toString()),this.FormatIsNull&&(t=t.replace(/[\r\n]/g,"")),t=e.BaseUIProcess.UpdateCrLfString(t,e.CrLfMode.Filter)),this.UIProcess.Format.Fields.SetValue(t,!1)&&this.AfterSetTextValue()},r.prototype.GetValue=function(){return this.Value},r.prototype.GetSelectedText=function(){var t=Math.min(this.SelectionStart,this.SelectionEnd),n=Math.max(this.SelectionStart,this.SelectionEnd),r=this.Text.Substring(t,n);if(this.GetClipContent()===e.ClipContent.ExcludeLiterals){var i=Math.min(this.SelectionStart,this.SelectionEnd),s=this.GetSelectionLength();r=this.UIProcess.Format.Fields.GetNonPromptText(i,s)}return r},r.prototype.SetSelectedText=function(e){if(!e)return;var t=this.Value,n=this.Text;this.UIProcess.Paste(this.SelectionStart,this.SelectionEnd,e,!1,!0);var r={};r.Text=this.GetDisplayText("Focus");if(!this.UpdateText(r))return;this.UpdateDisplayText(this.Text),this.Value=this.UIProcess.Format.Fields.GetValue(),this.Text!=n&&this.FireClientEvent("TextChanged",null),this.Value!=t&&this.FireClientEvent("ValueChanged",null)},r.prototype.SetText=function(t){try{this.ShowPromptChar(),this.Value=this.UIProcess.Format.Fields.GetValue();if(!t){this.SetValue("");return}if(t===this.UIProcess.Format.Fields._focusNull&&!this.UIProcess.Format.Fields.formatIsNull){this.SetValue("");return}this.UIProcess.Format.Fields.ClearContent(),this.FormatIsNull&&(t=t.replace(/[\r\n]/g,"")),t=e.BaseUIProcess.UpdateCrLfString(t,e.CrLfMode.Filter),this.UIProcess.Format.Fields.SetText(t,!0).isValid===!1?this.UIProcess.Format.Fields.RollBack():this.AfterSetTextValue()}finally{this.HidePromptChar()}},r.prototype.AfterSetTextValue=function(){var e=this.Value,t=this.Text,n={};n.Text=this.GetDisplayText("Focus");if(!this.UpdateText(n))return;this.Value=this.UIProcess.Format.Fields.GetValue(),this.UpdateDisplayText(this.GetDisplayText()),this.Text!=t&&(this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText(),this.FireClientEvent("TextChanged",null)),this.Value!=e&&this.FireClientEvent("ValueChanged",null)},r.prototype.GetText=function(){return this.GetDisplayText("Focus")},r.prototype.GetDisplayText=function(e){return e?e==="Focus"?this.UIProcess.GetShowText(this.GetShowLiterals()):"":this.UIProcess.GetShowText(this.GetShowLiterals(),"LoseFocus")},r.prototype.GetCurrentField=function(){return this.UIProcess.GetCurrentField(this.SelectionEnd)!=null?this.UIProcess.GetCurrentField(this.SelectionEnd).index:0},r.prototype.GetValueIsFull=function(){return this.UIProcess.Format.Fields.ValueIsFull(1)},r.prototype._getFormatIsNull=function(){return this.FormatIsNull},r.prototype.FireClientEvent=function(e,t){var n="";switch(e){case"TextChanged":this.TextChanged!=""&&(n=this.TextChanged);break;case"ValueChanged":this.ValueChanged!=""&&(n=this.ValueChanged);break;default:return}return this.UIProcess.FireEvent(this,n,t,e)},r.prototype.Focus=function(){this.ShowPromptChar(),!this.IsDragDrop&&this.FocusType!=e.FocusType.ClientEvent&&this.FocusType!=e.FocusType.SpinButton&&(this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText());if(this.UIProcess.Format.Fields.fieldCount>0){var t=this.UIProcess.FocusInternal(this.FocusType,this.InputElement,this.GetHighlightText(),this.CursorPosition,this.SelectionStart);if(!t)return;t.Text!=null&&(this.Text=t.Text),t.SelectionStart!=null&&this.NeedReCalCursorPos&&(this.SelectionStart=t.SelectionStart),t.SelectionEnd!=null&&this.NeedReCalCursorPos&&(this.SelectionEnd=t.SelectionEnd,this.SelectionLength=this.GetSelectionLength()),this.NeedReCalCursorPos||(this.NeedReCalCursorPos=!0),this.japInput===!0&&(this.truePosition!=-1&&(this.SelectionStart=this.truePosition,this.SelectionEnd=this.truePosition),this.japInput=!1),this.GetReadOnly()===!0&&this.FocusType===e.FocusType.None&&(this.SelectionStart=0,this.SelectionEnd=this.Text.length),this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd,!0),!this.IsDragDrop&&this.FocusType!=e.FocusType.ClientEvent&&this.FocusType!=e.FocusType.SpinButton&&this.FocusType!=e.FocusType.DropDown&&(this.OldValue=this.Value)}else this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.OldValue=this.Value;this.IsDragDrop=!1},r.prototype._shouldFireValueChangedEvent=function(){return this.OldText!=this.Text},r.prototype.LoseFocus=function(){this.FireKeyExit();var t=this.ImeMode;e.Utility.IsIE()?this.ImeInput("LoseFocusInput"):this.ImeInput("ReInput",!0);if(this.SpinBtnPressed)return;this.SetLastClientValues();var n=this.UIProcess.LoseFocus();this.DisplayText=n.Text,this.Value=n.Value,this.Text=this.UIProcess.Format.Fields.GetText(),(e.Utility.IsIE()||!t)&&this.UpdateDisplayText(this.DisplayText),!e.Utility.IsIE()&&t&&this.UpdateDisplayText(this.DisplayText),this.FocusType=e.FocusType.None;var r;n.EventInfo!=null&&(r=this.UIProcess.FireEvent(this,n.EventInfo.Name,n.EventInfo.Args,n.EventInfo.Type),r!=null&&(this.FocusType=r));var i=this;!e.Utility.IsIE()&&this.DisplayText!=this.UIUpdate.GetText()&&t&&window.setTimeout(function(){i.UpdateDisplayText(i.DisplayText)},0),this.GetHighlightText()===e.HighlightText.All&&(this.SelectionStart=0),this._shouldFireValueChangedEvent()&&(r=this.FireClientEvent("TextChanged",null),r!=null&&(this.FocusType=r),r=this.FireClientEvent("ValueChanged",null),r!=null&&(this.FocusType=r),this.OldText=this.UIProcess.Format.Fields.GetText(),this.OldFocusText=this.UIProcess.Format.Fields.GetText(),e.Utility.FireSystemEvent(this.InputElement,"onchange"),this._getAutoPostBack()),window.setTimeout(function(){i.HidePromptChar()},50)},r.prototype.shouldFireValueChangedEvent=function(){return this.OldText!=this.Text},r.prototype.MouseDown=function(t){var r=e.Utility.GetMouseButton(t);this.FocusedWhenMouseDown=document.activeElement===(t.srcElement||t.target),this.MouseDownOnClearButton=e.Utility.IsMouseDownOnClearButton(t),n.prototype.MouseDown.call(this,t),this.MouseButton===e.MouseButton.Right?this.FocusType=e.FocusType.ContextMenu:this.MouseButton=e.MouseButton.Left,this.UIProcess.isDblClick=!1,this.SelectionLength=this.GetSelectionLength(),!e.Utility.IsIE()&&this.ImeMode&&r===e.MouseButton.Left&&(this.IsImplementImeInput=!0)},r.prototype.MouseUp=function(t){if(!e.Utility.IsIE()&&this.ImeMode){if(!this.IsImplementImeInput)return;this.IsImplementImeInput=!1}this.LastStart=this.SelectionStart,this.LastEnd=this.SelectionEnd,n.prototype.MouseUp.call(this,t);if(!this.ImeMode)this.SelectionLength=this.GetSelectionLength();else{this.SelectionStart=this.LastStart,this.SelectionEnd=this.LastEnd,this.SelectionLength=this.GetSelectionLength(),e.Utility.IsIE()?this.ImeInput("ClickInput"):this.ImeInput("ReInput",!0);if(!e.Utility.IsIE()&&this.Text!=this.UIUpdate.GetText()){var r=this;window.setTimeout(function(){r.UpdateDisplayText(r.Text)},0)}}this.MouseUpPointerType==undefined&&(this.MouseUpHasValue=this.GetInputElement().value.length>0),this.HandleClearButton(t)},r.prototype.KeyDown=function(t){var r=t.keyCode,i={};i.Shift=!1,i.Ctrl=!1,i.Alt=!1,t.shiftKey&&(i.Shift=!0),t.ctrlKey&&(i.Ctrl=!0),t.altKey&&(i.Alt=!0);var s={},o=this.ImeMode;this.ImeMode=!1;if(r===229)return e.Utility.IsIE8OrBelow()&&(this.ImeMode=!0),!0;!this.ImeMode&&o&&!i.Shift&&!i.Ctrl&&r!=9&&r!=65545&&(this.ImeInput("ReInput",!0),this.ImeSelectTimes=0),s.KeyCode=r,s.Text=this.Text,s.FuncKeysPressed=i,s.SelectionStart=this.SelectionStart,s.SelectionEnd=this.SelectionEnd,s.EditMode=this._getEditModeInternal(),s.ReadOnly=this.GetReadOnly(),s.ClipContent=this.GetClipContent(),s.ExitOnLastChar=this.GetExitOnLastChar(),s.ExitOnLeftRightKey=this.GetExitOnLeftRightKey(),s.TabAction=this.GetTabAction();var u=n.prototype.KeyDown.call(this,s);return u.inputChar!=null?!0:(i.Shift||i.Ctrl||i.Alt)&&!u?!0:this.GetHideEnter()&&r===13?!1:u.System},r.prototype.KeyPress=function(t,n){var r=n.keyCode||n.charCode,i=r===192&&n.altKey;if(!e.Utility.IsIE()&&this.ImeMode&&i)return this.ImeInput("ReInput",!0),!1;if(!e.Utility.IsIE()&&(r===229||i))return!1;var s=t,o=this.UIProcess.KeyPressInternal(this.InputElement,this.SelectionStart,this.SelectionEnd,this.GetExitOnLastChar(),s);if(this.japInput!=1){o.SelectionStart!=null&&(this.NewSelectionStart=o.SelectionStart),o.SelectionEnd!=null&&(this.NewSelectionEnd=o.SelectionEnd);if(o.Text!=null){if(!this.UpdateText(o))return!1;this.UpdateDisplayText(this.Text)}var u=this._doExtraWorkForKeyPress(t);if(u===!0)return;o.SelectionStart!=null&&(this.SelectionStart=o.SelectionStart),o.SelectionEnd!=null&&(this.SelectionEnd=o.SelectionEnd,this.SelectionLength=this.GetSelectionLength(),o.FocusExit!=1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)),o.exception!=null&&(this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd)),o.EventInfo!=null&&(this.UIProcess.FireEvent(this,o.EventInfo.Name,o.EventInfo.Args,o.EventInfo.Type),o.EventInfo.Type==="KeyExit"&&(this.EventInfo=o.EventInfo,this.FireKeyExit()),this.FocusType=e.FocusType.ClientEvent);if(n.keyCode===13)return!0}else{if(n.keyCode===13)return!0;o.SelectionStart!=null&&(this.truePosition=o.SelectionStart),o.EventInfo!=null&&this.UIProcess.FireEvent(this,o.EventInfo.Name,o.EventInfo.Args,o.EventInfo.Type)}},r.prototype._doExtraWorkForKeyPress=function(e){return!1},r.prototype.innerKeyPress=function(t,n,r){var i=t;n=!!n;var s=this.UIProcess.KeyPressInternal(this.InputElement,this.SelectionStart,this.SelectionEnd,this.GetExitOnLastChar(),i);if(this.japInput!=1){if(s.Text!=null){if(!this.UpdateText(s))return!1;r||this.UpdateDisplayText(this.Text)}s.SelectionStart!=null&&(this.SelectionStart=s.SelectionStart),s.SelectionEnd!=null&&(this.SelectionEnd=s.SelectionEnd,this.SelectionLength=this.GetSelectionLength(),s.FocusExit!=1&&!n&&!r&&s.FocusExit!=1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)),s.exception!=null&&(r||this.UpdateDisplayText(this.Text),s.FocusExit!=1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)),s.EventInfo!=null&&(this.UIProcess.FireEvent(this,s.EventInfo.Name,s.EventInfo.Args,s.EventInfo.Type),this.FocusType=e.FocusType.ClientEvent);if(window.event!=null&&event.keyCode===13)return!0}else{if(window.event!=null&&event.keyCode===13)return!0;s.SelectionStart!=null&&(this.truePosition=s.SelectionStart),s.EventInfo!=null&&this.UIProcess.FireEvent(this,s.EventInfo.Name,s.EventInfo.Args,s.EventInfo.Type)}},r.prototype.KeyUp=function(t){if(this.ImeMode===!0&&e.Utility.IsIE8OrBelow()){var n=t.keyCode,r=e.CharProcess.CharEx,i=this.GetTextboxValue(),s=i;if(this.SelectionEnd<this.Text.GetLength()){var o=this.Text.GetLength()-this.SelectionEnd;s=i.Substring(0,i.GetLength()-o)}s=s.Substring(s.GetLength()-1,s.GetLength());if(n===13)this.ImeInput("DirectInput");else if(n>=48&&n<=57||n>=96&&n<=105)n>=96&&(n-=48),s=r.ToHalfWidth(s),s==String.fromCharCode(n)&&(s===String.fromCharCode(n)&&this.ImeSelectTimes<1||this.ImeSelect||this.ImeInput("ReInput")),this.ImeSelectTimes=0;else if(n===32){if(this.ImeSelect===!1)if(this.ImeSelectTimes===1)this.ImeSelect=!0;else if(r.ToHalfWidth(s)!=String.fromCharCode(n))this.ImeSelectTimes++;else{var u=i.Substring(this.SelectionStart,i.GetLength()-o);r.ToHalfWidth(u)===String.fromCharCode(n)&&this.ImeInput("DirectInput")}}else n>=65&&n<=90?this.ImeSelectTimes=0:n===32||n===106||n===107||n===109||n===110||n===111||n===219||n===220||n===221||n===222||n>=186&&n<=192?(this.ImeSelectTimes>=1&&this.ImeInput("ReInput"),this.ImeSelectTimes=0):n===40||n===38?this.ImeSelect===!1&&this.ImeSelectTimes===1&&(this.ImeSelect=!0):n===8||n===46||n===27?this.ImeSelectTimes=0:n===244&&(this.IsJapanConvertKeyPress=!0)}if(t.keyCode!==13)return!1},r.prototype.PerformSpinProcess=function(t,n,r,i,s,o){if(this.GetReadOnly()&&o)return;var u=this.UIProcess.PerformSpinInternal(t,n,r,i,s);this.FocusType=e.FocusType.SpinButton;if(!u){this.UIUpdate.SetFocus();return}if(u.Text!=null&&!this.UpdateText(u))return;u.SelectionStart!=null&&(this.SelectionStart=u.SelectionStart),u.SelectionEnd!=null&&(this.SelectionEnd=u.SelectionEnd,this.SelectionLength=this.GetSelectionLength());if(u.EventInfo){var a=this.UIProcess.FireEvent(this,u.EventInfo.Name,u.EventInfo.Args,u.EventInfo.Type);a!=null&&(this.FocusType=a)}if(this.Text!==this.GetTextboxValue()){var f=this.Format.Fields.fieldArray;for(var l=0;l<f.length;l++)if(f[l].fieldLabel==="EnumField")break;if(l===f.length)return;this.UpdateDisplayText(this.Text)}},r.prototype.SelectStart=function(e){if(!!this.ImeMode)return!1;n.prototype.SelectStart.call(this,e)},r.prototype.Click=function(){},r.prototype.DragDrop=function(t){return!e.Utility.IsIE()&&this.GetReadOnly()?!1:(this.IsDragDrop=!0,this.Paste(t,!0,0,0),!1)},r.prototype.DragOver=function(){},r.prototype.DragInit=function(){},r.prototype.ImeInput=function(t,n){var i=this.UIUpdate.GetText();if(i===this.Text)return window.event&&e.Utility.PreventDefault(window.event),this.ImeMode=!1,!1;var s;if(this.Text!==""){var o=Math.min(this.SelectionStart,this.SelectionEnd),u=Math.max(this.SelectionStart,this.SelectionEnd);if(u<this.Text.GetLength()){var a=this.Text.Substring(u,this.Text.GetLength()),f=i.IndexOf(a);f!==-1?s=i.Substring(o,i.GetLength()-a.GetLength()):s=""}else s=i.Substring(o,i.GetLength())}else s=i;t==="ReInput"&&(n?s=s.Substring(0,s.GetLength()):s=s.Substring(0,s.GetLength()-1));if(t==="Record")return s;var l=!1;if(t==="LoseFocusInput"){if(s==="")return;r.Mask_ImeResponse=!0,l=!0}for(var c=0;c<s.GetLength();c++){c===s.GetLength()-1&&t==="LoseFocusInput"&&(this.japInput=!0),r.Mask_ImeResponse=!0;if(s.GetLength()>c+1){var h=s.Substring(c+1,c+2),p=new e.CharCategory,d=h.charCodeAt(0)-(p.KATAKANA_VOICED.charCodeAt(0)-1);d===1||d===2?(this.innerKeyPress(s.Substring(c,c+2),l),c++):t==="ReInput"?this.innerKeyPress(s.Substring(c,c+1),l,!0):this.innerKeyPress(s.Substring(c,c+1),l)}else t==="ReInput"?this.innerKeyPress(s.Substring(c,c+1),l,!0):this.innerKeyPress(s.Substring(c,c+1),l)}this.japInput=!1,this.ImeMode=!1,this.ImeSelect=!1;if(t==="ReInput"||t==="ClickInput")this.truePosition=this.SelectionStart,this.FocusType=e.FocusType.ImeInput},r.prototype.SetInnerText=function(e){this.Clear(),this.UIProcess.Format.Fields.SetText(e,!0).isValid===!1?this.UIProcess.Format.Fields.RollBack():this.UIProcess.Format.Fields.SaveOldState();var t={};t.Text=this.GetDisplayText("Focus");if(!this.UpdateText(t))return;this.UpdateDisplayText(this.Text)},r.prototype.Copy=function(){this.SetSelection(this.SelectionStart,this.SelectionEnd),n.prototype.Copy.call(this)},r.prototype.Cut=function(){this.SetSelection(this.SelectionStart,this.SelectionEnd),n.prototype.Cut.call(this)},r.prototype.Paste=function(t,n,r,i){var s="";t!=null&&(s=t),r||(r=this.SelectionStart),i||(i=this.SelectionEnd);var o=this.UIProcess.Paste(r,i,s,this.GetExitOnLastChar(),n);if(!o)return!1;o.Value!=null&&(this.Value=o.Value);if(o.Text!=null){if(!this.UpdateText(o))return!1;this.UpdateDisplayText(this.Text),e.Utility.IsIE()||this.SetInnerFocus()}return o.SelectionStart!=null&&(this.SelectionStart=o.SelectionStart),o.SelectionEnd!=null&&(this.SelectionEnd=o.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart)),(!o||o.FocusExit==null||!o.FocusExit)&&this.SetSelection(this.SelectionStart,this.SelectionEnd),o.EventInfo&&this.UIProcess.FireEvent(this,o.EventInfo.Name,o.EventInfo.Args,o.EventInfo.Type),!0},r.prototype.SetHideValue=function(){},r.prototype.GetHideValue=function(){},r.prototype.CanUndo=function(){return this.Format.Fields.CanUndo()?!0:!1},r.prototype.DoSpinUp=function(e,t){arguments.length===1&&(t=e,e=undefined),this.DoSpin("up",e,t)},r.prototype.DoSpinDown=function(e,t){arguments.length===1&&(t=e,e=undefined),this.DoSpin("down",e,t)},r.prototype.DoSpin=function(t,n,r){if(typeof n=="number"&&isNaN(n)||typeof r=="number"&&isNaN(r))return;var i=this.SelectionStart,s=this.SelectionEnd,o=this.Increment;if(n!=undefined){n=e.Utility.CheckInt(n,0,Math.pow(2,31));var u={};u.start=0,u.length=0,u=this.Format.Fields.GetRealFieldRange(n),i=u.start,s=u.start+u.length}r!=undefined&&(o=r),o=e.Utility.CheckInt(o,-Math.pow(2,31),Math.pow(2,31)),t==="up"?this.PerformSpinProcess(i,s,o,this.Wrap,!0,!1):this.PerformSpinProcess(i,s,o,this.Wrap,!1,!1)},r.prototype.UpdateText=function(e){if(!e)return!1;var t="";e.Text!=null&&(t=e.Text);if(t!==this.Text&&this.TextChanging!=null&&this.TextChanging!=""){var n={},r={};r.Result=t,r.Cancel=!1,n.Name=this.TextChanging,n.Args=r,e.SelectionStart!=null&&(this.NewSelectionStart=e.SelectionStart),e.SelectionEnd!=null&&(this.NewSelectionEnd=e.SelectionEnd);var i=this.UIProcess.GetSepText();this.RollBack(),typeof this.NeedSetHideValue=="undefined"&&(this.NeedSetHideValue=!0),this.NeedSetHideValue&&this.SetHideValue(),n.Name.IndexOf&&n.Name.IndexOf("gcsh_InputManWeb_AjaxServerEventHandler")>-1&&(this.UIProcess.Format.Fields.ClearContent(),this.FormatIsNull?this.UIProcess.Format.Fields.SetText(i,!0):this.UIProcess.SetSepText(i));var s=this.UIProcess.FireEvent(this,n.Name,n.Args,"TextChanging");n.Name.IndexOf&&n.Name.IndexOf("gcsh_InputManWeb_AjaxServerEventHandler")>-1,s!=null&&(this.FocusType=s),typeof this.TextChanging!="undefined"&&(this.NeedSetHideValue=!1);if(r.Cancel)return this.UpdateDisplayText(this.Text),this.SetSelection(this.SelectionStart,this.SelectionEnd),!1;this.UIProcess.Format.Fields.ClearContent(),this.FormatIsNull?this.UIProcess.Format.Fields.SetText(i,!0):this.UIProcess.SetSepText(i)}return this.Text=t,this.Value=this.UIProcess.Format.Fields.GetValue(),!0},r.prototype.UpdateDisplayText=function(e){typeof this.NeedSetHideValue=="undefined"&&(this.NeedSetHideValue=!0),this.NeedSetHideValue&&(n.prototype.UpdateDisplayText.call(this,e),this.EditingTextChanged&&this.EditingTextChanged.call(this))},r.prototype.RollBack=function(){this.UIProcess.Format.Fields.RollBack()},r.prototype.ProcessReservedKey=function(e){var t=n.prototype.ProcessReservedKey.call(this,e);if(!t){switch(e){case 118:case 119:return!0}return!1}return!0},r.prototype.AddAllEventsHandler=function(){n.prototype.AddAllEventsHandler.call(this);var r=this;e.Utility.IsIE10OrLater()&&t(this.GetInputElement()).bind("MSPointerUp.wijinput",function(t){e.GlobalEventHandler.OnMSPointerUp(r,t)},!1)},r.prototype.CompositionStart=function(e){this.ImeMode=!0},r.prototype.CompositionUpdate=function(e){},r.prototype.CompositionEnd=function(t){var n=this,r=function(){try{n.ImeInput("DirectInput")}finally{n.ImeMode=!1}};e.Utility.IsIE9OrLater()?r():window.setTimeout(r,0)},r.prototype.Select=function(){if(this.ImeMode)return;this.SelectionStart=e.Utility.GetSelectionStartPosition(this.GetInputElement()),this.SelectionEnd=this.SelectionStart+e.Utility.GetSelectionText(this.GetInputElement()).GetLength()},r.prototype.MSPointerUp=function(e){e&&(this.MouseUpPointerType=e.pointerType,this.MouseUpHasValue=(e.srcElement||e.target).value.length>0)},r.prototype.HandleClearButton=function(t){if(e.Utility.IsIE10OrLater()&&this.FocusedWhenMouseDown&&this.MouseDownOnClearButton&&(t.srcElement||t.target)===this.InputElement){var n=document.activeElement===(t.srcElement||t.target),r=e.Utility.IsMouseDownOnClearButton(t);if(this.MouseUpHasValue&&n&&r){this.Clear();var i=this.GetText(),s=this;window.setTimeout(function(){s.UpdateDisplayText(i),s.SelectionStart=s.SelectionEnd=s.Format.Fields.GetFirstInputPosition(),s.SetSelection(s.SelectionStart,s.SelectionEnd)},0)}}},r.prototype.HidePromptChar=function(){if(this.GetHidePromptOnLeave()){var e=this.GetInputElement().value;this._textWithPromptChar=e,e=e.replace(new RegExp(this.GetPromptChar(),"g")," "),this.GetInputElement().value=e}},r.prototype.ShowPromptChar=function(){this._textWithPromptChar!==null&&(this.GetInputElement().value=this._textWithPromptChar,this._textWithPromptChar=null)},r.prototype.GetHideEnter=function(){return this._hideEnter},r.prototype.SetHideEnter=function(e){this._hideEnter=e},r.prototype.GetHidePromptOnLeave=function(){return this._hidePromptOnLeave},r.prototype.SetHidePromptOnLeave=function(e){e!==this._hidePromptOnLeave&&(this._hidePromptOnLeave=e,e&&document.activeElement!==this.GetInputElement()&&this.HidePromptChar(),!e&&document.activeElement!==this.GetInputElement()&&this.ShowPromptChar())},r.prototype.FireKeyExit=function(){this.EventInfo!=null&&this.EventInfo.Type=="KeyExit"&&(this.KeyExit&&this.KeyExit.call(this),this.FocusType=e.FocusType.KeyExit,this.EventInfo=null)},r.prototype.OnEditStatusChanged=function(t){t=e.Utility.CheckFunction(t),this.EditStatusChangedEvent=t},r.prototype.OnInvalidInput=function(t){t=e.Utility.CheckFunction(t),this.InvalidInputEvent=t},r.prototype.OnKeyExit=function(t){t=e.Utility.CheckFunction(t),this.KeyExit=t},r.prototype.OnSpinDown=function(t){t=e.Utility.CheckFunction(t),this.SpinDown=t},r.prototype.OnSpinUp=function(t){t=e.Utility.CheckFunction(t),this.SpinUp=t},r.prototype.OnTextChanged=function(t){t=e.Utility.CheckFunction(t),this.TextChanged=t},r.prototype.OnTextChanging=function(t){t=e.Utility.CheckFunction(t),this.TextChanging=t},r.prototype.OnValueChanged=function(t){t=e.Utility.CheckFunction(t),this.ValueChanged=t},r.prototype.OnMouseDownCallBack=function(t){t=e.Utility.CheckFunction(t),this.MouseDownEvent=t},r.prototype.OnMouseUpCallBack=function(t){t=e.Utility.CheckFunction(t),this.MouseUpEvent=t},r.prototype.OnEditingTextChanged=function(t){t=e.Utility.CheckFunction(t),this.EditingTextChanged=t},r.prototype.IsFocused=function(){try{return document.activeElement===this.GetInputElement()}catch(e){return!1}},r.prototype.GetTextOnSimpleMode=function(){if(!this.IsFocused()&&this.Format.Fields.ValueIsNull()&&this._getDisplayNullExpression()!==null)return this.GetTextboxValue();var e=this.Format.Fields.GetTextSimpleMode(!1),t=new RegExp("\\"+this.GetPromptChar(),"g");return e=e.replace(t," "),e},r.prototype.GetPostValueOnSimpleMode=function(){if(!this.IsFocused()&&this.Format.Fields.ValueIsNull()&&this._getDisplayNullExpression()!==null)return this.GetTextboxValue();var e=this.Format.Fields.GetTextSimpleMode(!0),t=new RegExp("\\"+this.GetPromptChar(),"g");return e=e.replace(t," "),e},r}(T);e.MaskControl=A})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(t){(function(e){e._map=[],e.editOptional=1,e.editRequired=2,e.separator=4,e.literal=8})(t.wijchartype||(t.wijchartype={}));var n=t.wijchartype,r=function(){function r(e,t,n){this.inputWidget=e,this.mask=t,this.asciiOnly=n,this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.noMask=!1,this._autoConvertPosition=0,this._needCheckNextChar=!1,this.descriptors=[],this.initialize()}return r.FK_K="K",r.FK_H="H",r.FK_DB_9="\uff19",r.FK_N="N",r.FK_DB_N="\uff2e",r.FK_DB_G="\uff27",r.FK_DB_K="\uff2b",r.FK_DB_J="\uff2a",r.FK_DB_Z="\uff3a",r.FK_DB_T="\uff34",r.DBCS_0="\uff10",r.DBCS_9="\uff19",r.DBCS_A="\uff21",r.DBCS_a="\uff41",r.DBCS_Z="\uff3a",r.DBCS_z="\uff5a",r.prototype.initialize=function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.descriptors=[];var e="none",t=!1,s=n.literal,o="",u=this.inputWidget._getCulture();for(var a=0;a<this.mask.length;a++){var f=!1,l=this.mask.charAt(a);t&&(t=!1,f=!0);if(!f){var c=l;if(c<="C"){switch(c){case"#":case"9":case"?":case"C":l=this.getPromtChar(),s=n.editOptional,f=!0;break;case"$":o=u.numberFormat.currency.symbol,s=n.separator,f=!0;break;case"%":case"-":case";":case"=":case"@":s=n.literal,f=!0;break;case"&":case"0":case"A":l=this.getPromtChar(),s=n.editRequired,f=!0;break;case",":o=u.numberFormat[","],s=n.separator,f=!0;break;case".":o=u.numberFormat["."],s=n.separator,f=!0;break;case"/":o=u.calendars.standard["/"],s=n.separator,f=!0;break;case":":o=u.calendars.standard[":"],s=n.separator,f=!0;break;case"<":e="lower";continue;case">":e="upper";continue}f||(s=n.literal,f=!0)}if(!f){if(c<="\\"){switch(c){case r.FK_K:case r.FK_H:case r.FK_N:case"L":l=this.getPromtChar(),s=n.editRequired,f=!0;break;case"\\":t=!0,s=n.literal;continue}f||(s=n.literal,f=!0)}if(!f){c==="a"&&(l=this.getPromtChar(),s=n.editOptional,f=!0);switch(c){case r.FK_DB_K:case r.FK_DB_J:case r.FK_DB_9:case r.FK_DB_Z:case r.FK_DB_N:case r.FK_DB_G:case r.FK_DB_T:l=this.getPromtChar(),s=n.editRequired,f=!0}if(!f){c!=="|"&&(s=n.literal,f=!0);if(!f){e="none";continue}}}}}if(f){var h=new i(a,s);this.isEditDesc(h)&&(h.caseConversion=e),s!==n.separator&&(o=l);for(var p=0;p<o.length;p++)this.testString=this.testString+o.charAt(p),this.descriptors[this.descriptors.length]=h}}},r.prototype.getAllowPromptAsInput=function(){return this.inputWidget?this.inputWidget._getAllowPromptAsInput():!1},r.prototype.getPasswordChar=function(){var e=this.inputWidget?this.inputWidget._getPasswordChar():"*";return e===""&&(e="*"),e.length>1?e.charAt(0):e},r.prototype.isPassword=function(){return this.inputWidget?this.inputWidget._isPassword():!1},r.prototype.getResetOnPrompt=function(){return this.inputWidget?this.inputWidget._getResetOnPrompt():!0},r.prototype.getResetOnSpace=function(){return this.inputWidget?this.inputWidget._getResetOnSpace():!0},r.prototype.getSkipLiterals=function(){return this.inputWidget?this.inputWidget._getSkipLiterals():!0},r.prototype.getHidePromptOnLeave=function(){return this.inputWidget?this.inputWidget._getHidePromptOnLeave():!1},r.prototype._trueOR=function(e,t){return(e>>>1|t>>>1)*2+(e&1|t&1)},r.prototype.setValue=function(e){return!1},r.prototype.getValue=function(){return null},r.prototype.getPromtChar=function(){var e=this.inputWidget?this.inputWidget._getPromptChar():"_";return e===""&&(e="_"),e.length>1?e.charAt(0):e},r.prototype.getAutoConvert=function(){return this.inputWidget?this.inputWidget._getAutoConvert():!0},r.prototype.updatePromptChar=function(){if(this.noMask)return;for(var e=0;e<this.descriptors.length;e++){var t=this.descriptors[e];if(t.charType===n.editOptional||t.charType===n.editRequired)t.isAssigned||(this.testString=$.wij.charValidator.setChar(this.testString,this.getPromtChar(),e))}},r.prototype.resetChar=function(e){var t=this.descriptors[e];this.isEditPos(e)&&t.isAssigned&&(t.isAssigned=!1,this.testString=$.wij.charValidator.setChar(this.testString,this.getPromtChar(),e),this.assignedCharCount--,t.charType===n.editRequired&&this.requiredCharCount--)},r.prototype.getAdjustedPos=function(e){return this.noMask?e=Math.min(e,this.testString.length-1):e>=this.descriptors.length&&e--,Math.max(0,e)},r.prototype.findNonEditPositionInRange=function(e,t,r){var i=this._trueOR(n.literal,n.separator);return this.findPositionInRange(e,t,r,i)},r.prototype.findPositionInRange=function(e,t,n,r){e=Math.max(0,e),t=Math.min(t,this.testString.length-1);if(e<=t)while(e<=t){var i=n?e++:t--,s=this.descriptors[i];if((s.charType&4294967295&(r&4294967295))===s.charType)return i}return-1},r.prototype.findAssignedEditPositionInRange=function(e,t,r){return this.assignedCharCount===0?-1:this.findEditPositionInRange(e,t,r,n.editRequired)},r.prototype.findEditPositionInRange=function(e,t,r,i){do{var s=this._trueOR(n.editRequired,n.editOptional),o=this.findPositionInRange(e,t,r,s);if(o===-1)break;var u=this.descriptors[o];switch(i){case n.editOptional:if(!u.isAssigned)return o;break;case n.editRequired:if(u.isAssigned)return o;break;default:return o}r?e++:t--}while(e<=t);return-1},r.prototype.findAssignedEditPositionFrom=function(e,t){if(!this.assignedCharCount)return-1;var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findAssignedEditPositionInRange(n,r,t)},r.prototype.findEditPositionFrom=function(e,t){var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findEditPositionInRange(n,r,t,0)},r.prototype.setChar=function(t,r,i){if(this.getAutoConvert()){var s=new e.input.wijInputResult,o=this.testInternal(t,r,s);if(!o){var u=this._convert(t,0);if(t.length===0)debugger;t=u.strValue.charAt(0),u.strValue.length>1&&(this.inputWidget._appendChar=u.strValue.charAt(1)),u.index===2&&(this.inputWidget._skipNextChar=!0)}}r=Math.max(0,r),i||(i=this.descriptors[r]),this.testEscapeChar(t,r,i)?this.resetChar(r):($.wij.charValidator.isLetter(t)&&($.wij.charValidator.isUpper(t)?i.caseConversion==="lower"&&(t=t.toLowerCase()):i.caseConversion==="upper"&&(t=t.toUpperCase())),this.testString=$.wij.charValidator.setChar(this.testString,t,r),i.isAssigned||(i.isAssigned=!0,this.assignedCharCount++,i.charType===n.editRequired&&this.requiredCharCount++))},r.prototype.internalInsertAt=function(e,n,r,i){if(e.length===0)return r.testPosition=n,r.hint=r.noEffect,!0;if(!this._testString(e,n,r))return!1;var s=this.findEditPositionFrom(n,!0),o=this.findAssignedEditPositionInRange(s,r.testPosition,!0)!==-1;if(o&&r.testPosition===this.testString.length-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;var u=this.findEditPositionFrom(r.testPosition+1,!0);if(o){var a=new t.wijInputResult;a.hint=a.unknown;var f=!0,l=this.findAssignedEditPositionFrom(this.testString.length-1,!1);while(f){f=!1;if(u===-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;var c=this.testChar(this.testString.charAt(s),u,a);if(this.descriptors[s].isAssigned&&!c)return r.hint=a.hint,r.testPosition=u,!1;if(s!==l){s=this.findEditPositionFrom(s+1,!0),u=this.findEditPositionFrom(u+1,!0),f=!0;continue}}r.hint=Math.max(r.hint,a.hint)}if(!i){if(o)while(s>=n)this.descriptors[s].isAssigned?this.setChar(this.testString.charAt(s),u):this.resetChar(u),u=this.findEditPositionFrom(u-1,!1),s=this.findEditPositionFrom(s-1,!1);this.setString(e,n)}return!0},r.prototype.insertAt=function(e,n,r){typeof r=="undefined"&&(r=new t.wijInputResult);if(e===undefined)throw"InsertAt: input";return this.noMask?(this.testString=this.testString.substring(0,n)+e+this.testString.substring(n,this.testString.length),r.testPosition=n+e.length-1,!0):n>=0&&n<this.testString.length?this.internalInsertAt(e,n,r,!1):(r.testPosition=n,r.hint=r.positionOutOfRange,!1)},r.prototype.clear=function(e){if(this.noMask){this.testString="",e.hint=e.success;return}if(!this.assignedCharCount)e.hint=e.noEffect;else{e.hint=e.success;for(var t=0;t<this.testString.length;t++)this.resetChar(t)}},r.prototype.isLiteral=function(e){return e?e.charType===n.literal||e.charType===n.separator:!1},r.prototype.testEscapeChar=function(e,t,n){t=Math.max(0,t),n||(n=this.descriptors[t]);if(this.isLiteral(n))return this.getSkipLiterals()?e===this.testString.charAt(t):!1;var r=this.getResetOnPrompt()&&e===this.getPromtChar(),i=this.getResetOnSpace()&&e===" ";return r||i},r.prototype.testChar=function(e,t,n){var r=this.testInternal(e,t,n);if(!r&&this.getAutoConvert()){this._autoConvertPosition=t;var i=this._convert(e,0);r=i.strValue.length>0,i.strValue.length>1&&(this.inputWidget._appendChar=i.strValue.charAt(1)),i.index===2&&(this.inputWidget._skipNextChar=!0)}return r},r.prototype.testInternal=function(e,n,i){if(!$.wij.charValidator.isPrintableChar(e))return i.hint=i.invalidInput,!1;var s=this.descriptors[n];if(!s)return!1;if(this.isLiteral(s))return this.getSkipLiterals()&&e===this.testString.charAt(n)?(i.hint=i.characterEscaped,!0):(i.hint=i.nonEditPosition,!1);if(e===this.getPromtChar()){if(this.getResetOnPrompt())return this.isEditDesc(s)&&s.isAssigned?i.hint=i.sideEffect:i.hint=i.characterEscaped,!0;if(!this.getAllowPromptAsInput())return i.hint=i.promptCharNotAllowed,!1}if(e===" "&&this.getResetOnSpace())return this.isEditDesc(s)&&s.isAssigned?i.hint=i.sideEffect:i.hint=i.characterEscaped,!0;switch(this.mask.charAt(s.maskPosition)){case"L":if(!$.wij.charValidator.isLetter(e))return i.hint=i.letterExpected,!1;if(!$.wij.charValidator.isAsciiLetter(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"?":if(!$.wij.charValidator.isLetter(e)&&e!==" ")return i.hint=i.letterExpected,!1;if(!$.wij.charValidator.isAsciiLetter(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"A":if(!$.wij.charValidator.isAlphanumeric(e))return i.hint=i.alphanumericCharacterExpected,!1;if(!$.wij.charValidator.isAciiAlphanumeric(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"a":if(!$.wij.charValidator.isAlphanumeric(e)&&e!==" ")return i.hint=i.alphanumericCharacterExpected,!1;if(!$.wij.charValidator.isAciiAlphanumeric(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"&":if(!$.wij.charValidator.isAscii(e)&&this.asciiOnly)return i.hint=i.asciiCharacterExpected,!1;break;case"C":if(!$.wij.charValidator.isAscii(e)&&this.asciiOnly&&e!==" ")return i.hint=i.asciiCharacterExpected,!1;break;case"0":if(!$.wij.charValidator.isDigit(e))return i.hint=i.digitExpected,!1;break;case"9":if(!$.wij.charValidator.isDigit(e)&&e!==" ")return i.hint=i.digitExpected,!1;break;case r.FK_N:if(!(!t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)&&!t.CharProcess.CharEx.IsLowerKana(e)))return!1;break;case r.FK_DB_N:if(!(t.CharProcess.CharEx.IsFullWidth(e)&&t.CharProcess.CharEx.IsKatakana(e)&&!t.CharProcess.CharEx.IsLowerKana(e)))return!1;break;case r.FK_DB_G:if(!t.CharProcess.CharEx.IsUpperKana(e)||!t.CharProcess.CharEx.IsHiragana(e))return!1;break;case r.FK_DB_9:if(!(e>=r.DBCS_0&&e<=r.DBCS_9)&&e!==" ")return!1;break;case"#":if(!$.wij.charValidator.isDigit(e)&&e!=="-"&&e!=="+"&&e!==" ")return i.hint=i.digitExpected,!1;break;case r.FK_K:if(!!t.CharProcess.CharEx.IsFullWidth(e)||!t.CharProcess.CharEx.IsKatakana(e))return!1;break;case r.FK_H:if(t.CharProcess.CharEx.IsFullWidth(e))return!1;break;case r.FK_DB_K:if(!t.CharProcess.CharEx.IsFullWidth(e)||!t.CharProcess.CharEx.IsKatakana(e))return!1;break;case r.FK_DB_T:if(!t.CharProcess.CharEx.IsSurrogate(e))return!1;break;case r.FK_DB_J:if(!t.CharProcess.CharEx.IsHiragana(e))return!1;break;case r.FK_DB_Z:if(!t.CharProcess.CharEx.IsFullWidth(e))return!1}return e===this.testString.charAt(n)&&s.isAssigned?i.hint=i.noEffect:i.hint=i.success,!0},r.prototype._convert=function(e,n){var r={};r.success=!0,r.strValue="",r.index=n;var i=e.Substring(n,n+1),s,o=t.CharProcess.CharEx,u=!0;if(o.IsAlphabet(i)){var a=o.IsLower(i)?i.toUpperCase():i.toLowerCase();return s=this._isValid(a),s&&u||!s&&!u?(n++,r.index=n,r.strValue=a,r):(i=o.IsFullWidth(i)?o.ToHalfWidth(i):o.ToFullWidth(i).text,s=this._isValid(i),s&&u||!s&&!u?(n++,r.index=n,r.strValue=i,r):(a=o.IsFullWidth(a)?o.ToHalfWidth(a):o.ToFullWidth(a).text,s=this._isValid(a),s&&u||!s&&!u?(n++,r.index=n,r.strValue=a,r):(r.success=!1,r)))}if(o.IsHiragana(i)){if(o.IsLowerKana(i)){var f=o.ToUpperKana(i);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(i)){var l=o.ToLowerKana(i);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}i=o.ToKatakana(i),s=this._isValid(i);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=i,r;if(o.IsLowerKana(i)){var f=o.ToUpperKana(i);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(i)){var l=o.ToLowerKana(i);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}var c=o.ToHalfWidthEx(i);s=this._isValid(c);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=c,r;if(o.IsLowerKana(c)){c=o.ToUpperKana(c),s=this._isValid(c);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=c,r}else if(o.HasLowerKana(c)){c=o.ToLowerKana(c),s=this._isValid(c);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=c,r}return r.success=!1,r}if(o.IsKatakana(i)){if(o.IsLowerKana(i)){var f=o.ToUpperKana(i);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(i)){var l=o.ToLowerKana(i);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}var a=i,h=!1;if(o.IsFullWidth(i)){var p=o.ToHalfWidthEx(i);if(p.GetLength()>0){s=this._isValid(p);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=p,r}if(o.IsLowerKana(p)){p=o.ToUpperKana(p),s=this._isValid(p);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=p,r}else if(o.HasLowerKana(p)){p=o.ToLowerKana(p),s=this._isValid(p);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=p,r}}else{if(n==null){a=o.ToFullWidth(i).text;if(!o.IsKatakana(a))return r;s=this._isValid(a);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=a,r}else{var d=this.inputWidget._nextChar;if(this._needCheckNextChar&&d&&d.length>0){var v=o.ToFullWidth(e+d);a=v.text,h=v.processedAll}else a=o.ToFullWidth(i).text;if(!o.IsKatakana(a))return r;s=this._isValid(a);if(s&&u||!s&&!u)return n++,h&&n++,r.index=n,r.strValue=a,r}if(o.IsLowerKana(a)){var f=o.ToUpperKana(a);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(a)){var l=o.ToLowerKana(a);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}}a=o.ToHiragana(a),s=this._isValid(a);if(s&&u||!s&&!u)return n++,h&&n++,r.index=n,r.strValue=a,a=="\u3094"&&(h?r.strValue="\u3046\u309b":(n--,r.index=n,r.strValue="",r.success=!1)),r;if(o.IsLowerKana(a)){var f=o.ToUpperKana(a);s=this._isValid(f);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=f,r}else if(o.HasLowerKana(a)){var l=o.ToLowerKana(a);s=this._isValid(l);if(s&&u||!s&&!u)return n++,r.index=n,r.strValue=l,r}}return i=o.IsFullWidth(i)?o.ToHalfWidth(i):o.ToFullWidth(i).text,s=this._isValid(i),s&&u||!s&&!u?(n++,r.index=n,r.strValue=i,r):(r.success=!1,r)},r.prototype._isValid=function(t){var n=new e.input.wijInputResult;return this.testInternal(t,this._autoConvertPosition,n)},r.prototype._testString=function(e,n,r){r.hint=r.unknown,r.testPosition=n;if(e.length){var i=new t.wijInputResult;i.testPosition=r.testPosition,i.hint=r.hint;for(var s=0;s<e.length;s++){if(r.testPosition>this.testString.length)return r.hint=r.unavailableEditPosition,!1;var o=e.charAt(s);if(!this.testEscapeChar(o,r.testPosition)){r.testPosition=this.findEditPositionFrom(r.testPosition,!0);if(r.testPosition===-1)return r.testPosition=this.testString.length,r.hint=r.unavailableEditPosition,!1}this._needCheckNextChar=!0,this.inputWidget._batchKeyPress||(this.inputWidget._nextChar=s===e.length-1?"":e.charAt(s+1));if(!this.testChar(o,r.testPosition,i))return r.hint=i.hint,this._needCheckNextChar=!1,this.inputWidget._batchKeyPress||(this.inputWidget._nextChar=""),!1;this._needCheckNextChar=!1;if(!this.inputWidget._batchKeyPress){this.inputWidget._nextChar="";var u=this.inputWidget._appendChar;if(u&&u.length>0){this.inputWidget._appendChar="",r.testPosition++;if(!this.testChar(u,r.testPosition,i))return r.hint=i.hint,this._needCheckNextChar=!1,!1}this.inputWidget._skipNextChar&&(s++,this.inputWidget._skipNextChar=!1)}r.hint=Math.max(i.hint,r.hint),r.testPosition++;if(r.testPosition===this.testString.length)break}r.testPosition--}return!0},r.prototype.setText=function(e,n){typeof n=="undefined"&&(n=new t.wijInputResult);if(e===undefined)throw"SetFromPos: input parameter is null or undefined.";n.hint=n.unknown,n.testPosition=0;if(!e.length)return this.clear(n),!0;if(this.noMask)return this.testString=e,!0;if(!this.testSetString(e,n.testPosition,n))return!1;var r=this.findAssignedEditPositionFrom(n.testPosition+1,!0);return r!==-1&&this.resetString(r,this.testString.length-1),!0},r.prototype.resetString=function(e,t){if(this.noMask){this.testString="";return}e=this.findAssignedEditPositionFrom(e,!0);if(e!==-1){t=this.findAssignedEditPositionFrom(t,!1);while(e<=t)e=this.findAssignedEditPositionFrom(e,!0),this.resetChar(e),e++}},r.prototype.setString=function(e,t){for(var n=0;n<e.length;n++){var r=e.charAt(n);this.testEscapeChar(r,t)||(t=this.findEditPositionFrom(t,!0));if(t<0||t>=this.testString.length)return;this.inputWidget._batchKeyPress||(this.inputWidget._nextChar=n===e.length-1?"":e.charAt(n+1)),this._needCheckNextChar=!0,this.setChar(r,t),t++,this._needCheckNextChar=!1;if(!this.inputWidget._batchKeyPress){this.inputWidget._nextChar="";var i=this.inputWidget._appendChar;i&&i.length>0&&(this.inputWidget._appendChar="",this.inputWidget._nextChar="",this.testEscapeChar(i,t)||(t=this.findEditPositionFrom(t,!0)),this.setChar(i,t),t++),this.inputWidget._skipNextChar&&(n++,this.inputWidget._skipNextChar=!1)}}},r.prototype.testSetString=function(e,t,n){return e.length>this.testString.length&&(e=e.substring(0,this.testString.length)),this._testString(e,t,n)?(this.setString(e,t),!0):!1},r.prototype.isAllDecriptorUnAssigned=function(){for(var e=0;e<this.testString.length;e++){var t=this.descriptors[e];if(t&&(t.charType===n.editOptional||t.charType===n.editRequired)&&t.isAssigned)return!1}return!0},r.prototype.toString=function(e,t,r,i,s){var o=this.inputWidget._showNullText(),u=!this.inputWidget.isFocused(),a=this.isAllDecriptorUnAssigned();if(o&&u&&a)return this.inputWidget._getNullText();e=e===undefined?!this.isPassword():e;var f=this.getHidePromptOnLeave()?this.inputWidget.isFocused():!0;t=t===undefined?f:t,r=r===undefined?!0:r;if(this.noMask){if(!e){var l="";for(var c=0;c<this.testString.length;c++)l+=this.getPasswordChar();return l}return this.testString}i=i===undefined?0:i,s=s===undefined?this.testString.length:s;if(s<=0)return"";i=Math.max(0,i);if(i>=this.testString.length)return"";var h=this.testString.length-i;s=Math.min(s,h),o=!this.isPassword()||e,u=t&&r;if(o&&u)return this.testString.substring(i,s-i);var p="",d=i+s-1;for(var v=i;v<=d;v++){var m=this.testString.charAt(v),g=this.descriptors[v];switch(g.charType){case n.editOptional:case n.editRequired:if(!g.isAssigned)break;if(!this.isPassword()||e){p+=m;continue}p+=this.getPasswordChar();continue;case n.editRequired|n.editOptional:p+=m;continue;case n.separator:case n.literal:if(!r)continue;p+=m;continue;default:p+=m;continue}if(t){p+=m;continue}p+=" ";continue}return p},r.prototype.isEditDesc=function(e){return this.noMask?!0:e.charType===n.editRequired||e.charType===n.editOptional},r.prototype.isEditPos=function(e){if(this.noMask)return!0;if(e<0||e>=this.testString.length)return!1;var t=this.descriptors[e];return this.isEditDesc(t)},r.prototype.internalRemoveAt=function(e,n,r,i){typeof i=="undefined"&&(i=!1);if(this.noMask){try{this.testString=this.testString.substring(0,e)+this.testString.substring(n+1,this.testString.length),r.testPosition=e}catch(s){}return!0}var o=this.findAssignedEditPositionFrom(this.testString.length-1,!1),u=this.findEditPositionInRange(e,n,!0,0);r.hint=r.noEffect;if(u===-1||u>o)return r.testPosition=e,!0;r.testPosition=e,this.findAssignedEditPositionInRange(e,n,!0)!==-1&&(r.hint=r.success);if(n<o){var a=this.findEditPositionFrom(n+1,!0),f=a;e=u;var l=!0,c=new t.wijInputResult;while(l){l=!1;var h=this.testString.charAt(a),p=this.descriptors[a],d=h!==this.getPromtChar()||p.isAssigned,v=!this.testChar(h,u,c);if(d&&v)return r.hint=c.hint,r.testPosition=u,!1;if(a!==o){a=this.findEditPositionFrom(a+1,!0),u=this.findEditPositionFrom(u+1,!0),l=!0;continue}}r.sideEffect>r.hint&&(r.hint=r.sideEffect);if(i)return!0;a=f,u=e,l=!0;while(l){l=!1;var m=this.testString.charAt(a),g=this.descriptors[a];m===this.getPromtChar()&&!g.isAssigned?this.resetChar(u):(this.setChar(m,u),this.resetChar(a));if(a!==o){a=this.findEditPositionFrom(a+1,!0),u=this.findEditPositionFrom(u+1,!0),l=!0;continue}}e=u+1}return e<=n&&this.resetString(e,n),!0},r.prototype.removeAt=function(e,n,r,i){return typeof n=="undefined"&&(n=e),typeof r=="undefined"&&(r=new t.wijInputResult),n>=this.testString.length?(r.testPosition=n,r.hint=r.positionOutOfRange,!1):e>=0&&e<=n?this.internalRemoveAt(e,n,r,!1):(r.testPosition=e,r.hint=r.positionOutOfRange,!1)},r.prototype._isLastCharAssigned=function(){var e=this.findEditPositionFrom(this.testString.length,!1);return e>=0&&e<this.testString.length?this.descriptors[e].isAssigned:!1},r.prototype._getFieldList=function(){var e=[],t=this.findEditPositionFrom(0,!0);while(t>=0&&t<this.testString.length)e.push(t),t=this.findEditPositionFrom(t+1,!0);var n=[];if(e.length>0){var r=e[0],i=1,s=r;while(i<e.length)e[i]-r!=1&&(n.push({start:s,end:r}),s=e[i]),r=e[i],i++;n.push({start:s,end:r})}return n},r.prototype.replaceWith=function(e,n){var r=e.start,i=new t.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(n,r,i)?i:null},r}();t.wijMaskedTextProvider=r;var i=function(){function e(e,t){this.maskPos=e,this.charType=t,this.caseConversion="none",this.isAssigned=!1,this.maskPosition=0,this.maskPosition=e,this.charType=t}return e}();t.wijCharDescriptor=i;var s=function(){function e(e){this._imaskOptions=e}return e.prototype._getCulture=function(){return Globalize.findClosestCulture(this._imaskOptions.culture)},e.prototype._getAllowPromptAsInput=function(){return!1},e.prototype._getPasswordChar=function(){return""},e.prototype._getResetOnPrompt=function(){return!0},e.prototype._getResetOnSpace=function(){return!0},e.prototype._getSkipLiterals=function(){return!0},e.prototype._getHidePromptOnLeave=function(){return!1},e.prototype._getPromptChar=function(){return"_"},e.prototype._getAutoConvert=function(){return this._imaskOptions.autoConvert},e.prototype._getNullText=function(){return""},e.prototype._isPassword=function(){return!1},e.prototype._showNullText=function(){return!1},e.prototype.isFocused=function(){return!1},e}();t.MaskStub=s})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={})),$.wijinputcore=$.wijinputcore||{},$.wijinputcore.formatmask=$.wijinputcore.formatmask||function(e,t,n){var r=n||{};r.autoConvert!==!1&&(r.autoConvert=!0),r.culture="";var i=new wijmo.input.MaskStub(r),s=new wijmo.input.wijMaskedTextProvider(i,t,!1),o=s.setText(e);return o?s.toString(!0,!0,!0):s.toString(!0,!1,!1)},$.wijinputcore.validateMask=function(e,t){var n={autoConvert:!1};n.culture="";var r=new wijmo.input.MaskStub(n),i=new wijmo.input.wijMaskedTextProvider(r,t,!1);i.setText(e);var s=i.toString(!0,!0,!0);return s===e};;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments),this._imMask=null,this._advanceMode=!1}return __extends(r,n),r._imMaskAssociatedoptions=["disabled","disableUserInput","blurOnLastChar","imeMode","blurOnLeftRightKey","tabAction","nullText","placeholder","readonly","promptChar","autoConvert","showNullText","hideEnter","hidePromptOnLeave","highlightText"],r.prototype._createTextProvider=function(){this._textProvider=new e.wijMaskedTextProvider(this,this.options.mask,!1)},r.prototype._checkMaskAndPassword=function(){var e=!this.options.mask||this.options.mask.length<0;if(e&&this._isPassword())throw'Option "passwordChar" requires a mask'},r.prototype._updateIsPassword=function(){var e=this.options.passwordChar.length>0&&this.element.attr("type")!=="password";this.element.data("isPassword",e),this._checkMaskAndPassword()},r.prototype._beginUpdate=function(){this.element.addClass(this.options.wijCSS.wijinputmask),this._updateIsPassword(),this.element.data("defaultText",this.options.text)},r.prototype._setOption=function(e,t){switch(e){case"maskFormat":this._super(e,t),e="mask"}n.prototype._setOption.call(this,e,t);if(this._advanceMode)if(r._imMaskAssociatedoptions.indexOf)r._imMaskAssociatedoptions.indexOf(e)!==-1&&this._syncProperties();else for(var i=0;i<r._imMaskAssociatedoptions.length;i++)if(r._imMaskAssociatedoptions[i]===e){this._syncProperties();break}switch(e){case"text":this._advanceMode&&this.options.textWithPromptAndLiterals&&(t=this.options.textWithPromptAndLiterals),this.setText(t);break;case"mask":case"culture":if(typeof t=="undefined"||t.length<=0)t="";this._checkMaskAndPassword();var s=this.getText();s===this._getNullText()&&(s=""),e==="mask"&&(this._textProvider.mask=t),this._checkFormatPattern(t),this._advanceMode?(this._imMask.SetText(s),this._updateText()):(this._textProvider.initialize(),this._textProvider.setText(s),this._updateText());break;case"promptChar":case"nullText":this._textProvider&&(this._textProvider.updatePromptChar(),this._updateText());break;case"hidePromptOnLeave":case"resetOnPrompt":this._updateText();break;case"passwordChar":this._updateIsPassword(),this._updateText()}},r.prototype._checkFormatPattern=function(t){if(t instanceof RegExp||this.options.formatMode==="advanced"){this._advanceMode||(this._detachInputEvent(),this._imMask||(this._imMask=new e.MaskControl,this._addimMaskCustomEvent()),this._imMask.AttachInput(this.element.get(0)),this._attachKeyEventForDropDownList(),this._advanceMode=!0);if(t instanceof RegExp){var r=t;this._imMask.SetFormatPattern(r.source)}else this._imMask.SetFormatPattern(t);this._syncProperties()}else this._advanceMode&&(this._imMask.DetachInput(),this._detachEventForDropDownList(),n.prototype._attachInputEvent.call(this)),this._advanceMode=!1},r.prototype._attachKeyEventForDropDownList=function(){this.element.bind({"keydown.wijinput":t.proxy(this._onKeyDownForDropDownList,this)})},r.prototype._detachEventForDropDownList=function(){this.element.unbind(".wijinput")},r.prototype._onKeyDownForDropDownList=function(e){n.prototype._processKeyForDropDownList.call(this,e)},r.prototype._syncProperties=function(){this._imMask.SetEnabled(!this.options.disabled),this._imMask.SetReadOnly(!!this.options.disableUserInput),this._imMask.SetExitOnLastChar(!!this.options.blurOnLastChar),this._imMask.SetImeMode(this.options.imeMode),this._imMask.SetExitOnLeftRightKey(this._convertExistOnLeftRightKey(this.options.blurOnLeftRightKey)),this._imMask.SetTabAction(this._convertTabAction(this.options.tabAction)),this._imMask.SetDisplayNull(this.options.nullText),this._imMask.SetHideEnter(!!this.options.hideEnter),this._imMask.SetPromptChar(this.options.promptChar),this._imMask.SetAutoConvert(!!this.options.autoConvert),this._imMask.SetHidePromptOnLeave(!!this.options.hidePromptOnLeave),this._imMask.SetHighlightText(this._convertHighlightText(this.options.highlightText))},r.prototype._convertExistOnLeftRightKey=function(t){t||(t="none"),t=t.toLowerCase();if(t==="none")return e.ExitOnLeftRightKey.None;if(t==="left")return e.ExitOnLeftRightKey.Left;if(t==="right")return e.ExitOnLeftRightKey.Right;if(t==="both")return e.ExitOnLeftRightKey.Both},r.prototype._convertHighlightText=function(t){return t?(t=t.toLowerCase(),t==="field"?e.HighlightText.Field:t==="all"?e.HighlightText.All:e.HighlightText.None):e.HighlightText.None},r.prototype._convertTabAction=function(t){return t||(t="control"),t=t.toLowerCase(),t==="control"?e.TabAction.Control:e.TabAction.Field},r.prototype._addimMaskCustomEvent=function(){var e=this;this._imMask.OnInvalidInput(function(t){e._fireIvalidInputEvent("")}),this._imMask.OnTextChanged(function(t){e._raiseTextChanged()}),this._imMask.OnEditingTextChanged(function(t){e._updateText(!0)}),this._imMask.OnKeyExit(function(t){e._trigger("keyExit")})},r.prototype._processClearButton=function(){this._textProvider.clear(new e.wijInputResult),this._updateText();var t=this._textProvider.findEditPositionFrom(0,!0);this.selectText(t,t)},r.prototype._resetData=function(){var e=this.element.data("defaultText");if(e===undefined||e===null)e=this.element.data("elementValue");if(e===undefined||e===null)e="";this.setText(e)},r.prototype._isPassword=function(){return!!this.element.data("isPassword")},r.prototype._getTextWithPrompts=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!1):this.element.val()},r.prototype._getTextWithLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},r.prototype._getTextWithPromptAndLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!0):this.element.val()},r.prototype._getTextWithPromptAndLiteralsAndPassword=function(){return this._isInitialized()?this._textProvider.toString(!1,!0,!0):this.element.val()},r.prototype._onChange=function(){if(!this.element)return;var e=this.element.val();this.getText()!==e&&this._getTextWithPrompts()!==e&&this._getTextWithPromptAndLiterals()!==e&&(this._textProvider.getPasswordChar()!==""?this._getTextWithPromptAndLiteralsAndPassword()!==e&&this.setText(e):this.setText(e))},r.prototype._afterFocused=function(){(this._isNullText()||!!this.options.hidePromptOnLeave)&&this._doFocus();if(this.options.highlightText==="field"){var e=this._getCurrentField(),t=e.currentField,n=e.fieldList;t>=n.length&&(t=n.length-1);var r=n[t];r&&this.selectText(r.start,r.end+1)}else this.options.highlightText==="all"&&this.selectText(0,this.element.get(0).value.length)},r.prototype._processTabKey=function(e){var t=this,n=this.options.tabAction;return n=n?n.toLowerCase():"control",n==="control"?(setTimeout(function(){t._trigger("keyExit")},0),!1):this._moveField(!e.shiftKey)},r.prototype._getCurrentField=function(){var e=this._textProvider._getFieldList(),t=this.element.wijtextselection(),n=t.start,r=-1;e.length>0&&n>e[e.length-1].end&&(r=e.length);if(r===-1)for(var i=0;i<e.length;i++){if(n>=e[i].start&&n<=e[i].end){r=i;break}if(n<e[i].start){i!=0?r=i:r=-1;break}}var s={};return s.currentField=r,s.fieldList=e,s},r.prototype._moveField=function(e){var t=this._getCurrentField(),n=t.currentField,r=t.fieldList;if(e){if(n===r.length-1)return!1;this.element.wijtextselection(r[n+1].start,r[n+1].start)}else{if(n<=0)return!1;this.element.wijtextselection(r[n-1].start,r[n-1].start)}return!0},r.prototype._processLeftRightKey=function(e){var t=this.element.wijtextselection(),n=this.options.blurOnLeftRightKey?this.options.blurOnLeftRightKey.toLowerCase():"none";if(e&&t.start===0){if(n==="both"||n==="left")return this._moveControl(this.element.get(0),!1,!0),!0}else{var r=n==="both"||n==="right",i=!1;this._textProvider.noMask&&t.start===this.options.text.length?i=!0:!this._textProvider.noMask&&t.start===this._textProvider.testString.length&&(i=!0);if(!e&&r&&i)return this._moveControl(this.element.get(0),!0,!0),!0}return!1},r.prototype._onKeyPress=function(e){if(!this._textProvider.noMask&&this.options.blurOnLastChar)var t=this._textProvider._isLastCharAssigned();n.prototype._onKeyPress.call(this,e);if(!this._textProvider.noMask&&this.options.blurOnLastChar){var r=this._textProvider._isLastCharAssigned();!t&&r&&this._moveControl(this.element.get(0),!0,!0)}},r.prototype.setText=function(e){if(e===undefined)return;this._advanceMode?e==this.options.textWithPromptAndLiterals?(this.options.textWithPromptAndLiterals=undefined,this._imMask.SetText(e)):this._imMask.SetValue(e):n.prototype.setText.call(this,e)},r.prototype.getText=function(){return this._advanceMode?this._imMask.GetTextOnSimpleMode():n.prototype.getText.call(this)},r.prototype.selectText=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this.getText().length),isNaN(e)&&(e=0),isNaN(t)&&(t=0),this._advanceMode?(this._imMask.SetSelectionStart(e),this._imMask.SetSelectionLength(Math.abs(t-e)),this._imMask.SetFocus()):n.prototype.selectText.call(this,e,t)},r.prototype.getSelectedText=function(){return this._advanceMode?this._imMask.GetSelectedText():n.prototype.getSelectedText.call(this)},r.prototype._attachInputEvent=function(){this._advanceMode?this._imMask.AttachInput(this.element.get(0)):n.prototype._attachInputEvent.call(this)},r.prototype._detachInputEvent=function(){this._advanceMode?this._imMask.DetachInput():n.prototype._detachInputEvent.call(this)},r.prototype.getPostValue=function(){return this._advanceMode?this._imMask.GetPostValueOnSimpleMode():n.prototype.getPostValue.call(this)},r.prototype._initialize=function(){this.options.maskFormat&&(this.options.mask=this.options.maskFormat),n.prototype._initialize.call(this)},r.prototype._init=function(){n.prototype._init.call(this);var e=this.options.text||this.element.val();this.options.mask&&this._setOption("mask",this.options.mask),e&&e!==this._getNullText()&&this._setOption("text",e)},r.prototype._updateText=function(e){typeof e=="undefined"&&(e=!1);if(!this.element.data("initialized"))if(this.options.mask instanceof RegExp||this.options.formatMode==="advanced")return;if(this._advanceMode){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;var t=this._imMask.GetTextOnSimpleMode();this.options.advancedText=this._imMask.GetText(),t!==this.options.text&&(this.options.text=t,this._raiseTextChanged())}else n.prototype._updateText.call(this,e)},r.prototype.isFocused=function(){return this._advanceMode?this._imMask.IsFocused():n.prototype.isFocused.call(this)},r.prototype._getAllowPromptAsInput=function(){return this.options.allowPromptAsInput},r.prototype._getPasswordChar=function(){return this.options.passwordChar},r.prototype._getResetOnPrompt=function(){return this.options.resetOnPrompt},r.prototype._getResetOnSpace=function(){return this.options.resetOnSpace},r.prototype._getSkipLiterals=function(){return this.options.skipLiterals},r.prototype._getHidePromptOnLeave=function(){return this.options.hidePromptOnLeave},r.prototype._getPromptChar=function(){return this.options.promptChar},r.prototype._getAutoConvert=function(){return this.options.autoConvert},r.prototype._getNullText=function(){return this.options.nullText},r}(e.wijinputcore);e.wijinputmask=n;var r=function(){function t(){this.wijCSS={wijinputmask:e.wijinputcore.prototype.options.wijCSS.wijinput+"-mask"},this.autoConvert=!0,this.text=null,this.highlightText="none",this.mask="",this.maskFormat="",this.promptChar="_",this.hidePromptOnLeave=!1,this.resetOnPrompt=!0,this.allowPromptAsInput=!1,this.passwordChar="",this.resetOnSpace=!0,this.skipLiterals=!0,this.blurOnLastChar=!1,this.tabAction="control",this.imeMode="auto",this.allowSpinLoop=!1,this.spinnerAlign="verticalRight",this.showSpinner=!1}return t}();n.prototype.options=t.extend(!0,{},e.wijinputcore.prototype.options,new r),t.wijmo.registerWidget("wijinputmask",n.prototype)})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(t){"use strict";function i(t,n,i){r||(r=new e.input.wijNumberFormat),n||(n="numeric"),i||(typeof n=="string"?i={}:i=n);if(r._showNullText(i)&&t===null)return i.nullText;if(t===null||t===undefined)return"";r._currentValueInString=t.toString();var o=Globalize.findClosestCulture(i.culture);return i.type=i.type||n,i.showGroup=i.showGroup||!1,typeof i.decimalPlaces!="number"&&(i.decimalPlaces=2),s(o,i),r.getFormattedValue(0,!1,o,i.positivePrefix,i.positiveSuffix,i.negativePrefix,i.negativeSuffix,i)}function s(e,t){var n=e.numberFormat,r=n[t.type]||n,i=r.pattern[0],s=r.pattern[1]||"n",o=i.split("n"),u=s.split("n"),a=n.percent.symbol;t.currencySymbol===undefined&&(t.currencySymbol=n.currency.symbol),t.negativePrefix=(t.negativePrefix?t.negativePrefix:o[0]).replace(/%/g,a).replace(/\$/g,t.currencySymbol),t.negativeSuffix=(t.negativeSuffix?t.negativeSuffix:o[1]).replace(/%/g,a).replace(/\$/g,t.currencySymbol),t.positivePrefix=(t.positivePrefix?t.positivePrefix:u[0]).replace(/%/g,a).replace(/\$/g,t.currencySymbol),t.positiveSuffix=(t.positiveSuffix?t.positiveSuffix:u[1]).replace(/%/g,a).replace(/\$/g,t.currencySymbol)}function u(e,t){var n=Globalize.findClosestCulture(t),r=n.numberFormat,i=r.currency,s=r.percent,o=r.pattern,u=i.pattern,a=s.pattern,f,l=[];for(var c in u){var h=new RegExp(u[c].replace(/n/g,"\\d*\\.?\\d+"));l.push(h)}for(var c in l){var p=e.replace(new RegExp(i[","],"g"),"");f=p.match(l[c]);if(f)return Globalize.parseFloat(f[0],t)}var d=[];for(var c in a){var h=new RegExp(a[c].replace(/n/g,"\\d*\\.?\\d+"));d.push(h)}for(var c in d){var v=e.replace(new RegExp(s[","],"g"),"");f=v.match(d[c]);if(f)return Globalize.parseFloat(f[0],t)/100}var m=[];for(var c in o){var h=new RegExp(o[c].replace(/n/g,"\\d*\\.?\\d+"));m.push(h)}var g=e.replace(new RegExp(r[","],"g"),"");for(var c in m){f=g.match(m[c]);if(f)return Globalize.parseFloat(f[0],t)}return f=g.match(/\d*\.?\d+/),f?Globalize.parseFloat(f[0],t):Globalize.parseFloat(e,t)}function a(e,t,n,r){var i=u(e,r);return i>=t&&i<=n}var n=function(){function e(){this._currentValueInString="0",this._currentText="0",this._strippedText="0",this._groupSeparator=" "}return e.prototype._isNegtive=function(e){return e.indexOf("-")!==-1||e.indexOf("(")!==-1},e.prototype._stripValue=function(e,t,n){var r=t.numberFormat,i=r[n.type]||r,s=this._isNegtive(e),o=i[","],u=i["."],a=new RegExp("["+o+r.percent.symbol+n.currencySymbol+" ]","g"),f;return this._groupSeparator=o,e=this._removeNegativeSign(e),e=e.replace(a,""),e=e.replace(u,"."),f=/([\d\.])+/.exec(e),f&&(e=f[0]),s&&(e="-"+e),e},e.prototype.tryParseValue=function(e,t,n){try{var r=parseFloat(this._stripValue(e,t,n));return isNaN(r)&&(r=null),r}catch(i){return null}},e.prototype.deFormatValue=function(e,t,n,r,i,s,o){e=this._stripValue(e,t,o),this._currentValueInString=e,this._currentText=this._formatValue(e,t,n,r,i,s,o)},e.prototype._formatValue=function(e,t,n,r,i,s,o){var u=o,a=t.numberFormat,f=a[u.type]||a,l=u.decimalPlaces,c=f[","],h=f["."],p=l!==-2?l:f.decimals,d=u.showGroup?f.groupSizes:[0],v;e=this._removeLeadingZero(e),v=this._formatDigit(e,c,h,p,d),v=this._removeLeadingZero(v,u.showGroup?c:""),v.indexOf(h)===0&&(v="0"+v),v===""&&(v="0"),this._currentValueInString=e,this._strippedText=v;var m=this.isNegative()?i:n,g=this.isNegative()?s:r;return this._currentText=m+v+g,this._currentText},e.prototype._showNullText=function(e){return!!e.nullText||e.nullText===""},e.prototype.getFormattedValue=function(e,t,n,r,i,s,o,u){return!this._showNullText(u)&&t&&(this._currentValueInString=e+""),this._formatValue(this._currentValueInString,n,r,i,s,o,u)},e.prototype.getJSFloatValue=function(){try{return this._currentValueInString===""||this._currentValueInString==="."?0:parseFloat(this._currentValueInString)}catch(e){return Number.NaN}},e.prototype.clear=function(){this._currentValueInString="0",this._currentText="0",this._strippedText="0"},e.prototype.setValueFromJSFloat=function(e,t,n,r,i,s,o){var u=e.toFixed(o.decimalPlaces+1);try{return this._currentValueInString=u,this._formatValue(u,t,n,r,i,s,o),!0}catch(a){return!1}},e.prototype.isZero=function(e){typeof e=="undefined"&&(e=this._currentValueInString);var t=this._removeNegativeSign(e),n;return t?(n=parseFloat(t),!isNaN(n)&&!n):!0},e.prototype.setPositiveSign=function(){this._currentValueInString=this._removeNegativeSign(this._currentValueInString)},e.prototype._removeNegativeSign=function(e){return e.replace(/[()\-]/g,"")},e.prototype._removeLeadingZero=function(e,t){typeof t=="undefined"&&(t="");var e=e.replace(/^0+/,"");while(t.length>0&&e.indexOf(t)===0){e=e.substr(t.length);var e=e.replace(/^0+/,"")}return e},e.prototype.isNegative=function(){return this._currentValueInString.indexOf("-")!==-1||this._currentValueInString.indexOf("(")!==-1},e.prototype.invertSign=function(e,t,n,r,i,s){var o=this.isNegative();o?this.setPositiveSign():this._currentValueInString=this._currentValueInString.length?"-"+this._currentValueInString:"0",this.isZero()&&(this._currentValueInString=o?"0":"-0"),this._formatValue(this._currentValueInString,e,t,n,r,i,s)},e.prototype.checkDigitsLimits=function(e){var t=this._currentValueInString.split("."),n="";if(!t.length||t.length===1&&t[0]==="")return;t.length>1&&(n=t[1]),n=n.substring(0,e);while(n.length<e)n+="0";this._currentValueInString=t[0],n&&(this._currentValueInString+="."+n)},e.prototype.checkMinValue=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=!0,i,s,o,u,a;try{i=this._currentValueInString.split("."),s=parseFloat(i[0]===""||i[0]==="-"?"0":i[0]),o=0,i.length>1&&parseFloat(i[1])>=0&&(o=parseFloat("1."+i[1]));if(s<0||i[0]==="-"||i[0].length>0&&i[0][0]==="-")o*=-1;e=""+e.toFixed(12)+"",i=e.split("."),u=parseFloat(i[0]===""||i[0]==="-"?"0":i[0]),a=0,i.length>1&&parseFloat(i[1])>=0&&(a=parseFloat("1."+i[1]));if(u<0||i[0]==="-"||i[0].length>0&&i[0][0]==="-")a*=-1;if(s>u)return!0;s<u||n&&s===u&&o<=a?r=!1:s===u&&s<0&&o<a?r=!1:s===u&&s>=0&&o<a&&(r=!1),!r&&t&&(this._currentValueInString=""+e+"")}catch(f){}return r},e.prototype.checkMaxValue=function(e,t){var n=!0,r,i,s,o,u;try{r=this._currentValueInString.split("."),i=parseFloat(r[0]===""||r[0]==="-"?"0":r[0]),s=0,r.length>1&&parseFloat(r[1])>=0&&(s=parseFloat("1."+r[1]));if(i<0||r[0]==="-"||r[0].length>0&&r[0][0]==="-")s*=-1;e=""+e.toFixed(12)+"",r=e.split("."),o=parseFloat(r[0]===""||r[0]==="-"?"0":r[0]),u=0,r.length>1&&parseFloat(r[1])>=0&&(u=parseFloat("1."+r[1]));if(o<0||r[0]==="-"||r[0].length>0&&r[0][0]==="-")u*=-1;if(i<o)return!0;i>o&&(n=!1),i===o&&i>=0&&s>u&&(n=!1),i===o&&i<0&&s>u&&(n=!1),!n&&t&&(this._currentValueInString=""+e+"")}catch(a){}return n},e.prototype._formatDigit=function(e,t,n,r,i){var s=this._removeNegativeSign(e),o,u,a,f,l,c;o=s.indexOf("."),o===-1&&(o=s.length),u="",a=0,f=0;for(c=s.length-1;c>=0;c--)l=s.charAt(c),c<o&&(u=l+u,f++,f===i[a]*1&&i[a]*1&&c&&(u=t+u,f=0,i.length-1>a&&a++));if(r>0){u+=n;for(c=0;c<r;c++)l="0",c+o+1<s.length&&(l=s.charAt(c+o+1)),u+=l}return r===-1&&o<s.length-1&&(u+=n,u+=s.substr(o+1)),u},e}();t.wijNumberFormat=n;var r,o=jQuery;o.wijinputcore=o.wijinputcore||{},o.wijinputcore.formatnumber=o.wijinputcore.formatnumber||i,o.wijinputcore.parseNumber=o.wijinputcore.parseNumber||u,o.wijinputcore.validateNumber=o.wijinputcore.validateNumber||a})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=e.getKeyCodeEnum(),i=function(e){function i(){e.apply(this,arguments),this._initialValue=0}return __extends(i,e),i.prototype._init=function(){e.prototype._init.call(this),this._initUserCultureOptions(),this._updateCultureRelatedOptions(),this._updateText()},i.prototype._initUserCultureOptions=function(){this.options.negativePrefix!==null&&(this._userNegativePrefix=this.options.negativePrefix),this.options.negativeSuffix!==null&&(this._userNegativeSuffix=this.options.negativeSuffix),this.options.positivePrefix!==null&&(this._userPositivePrefix=this.options.positivePrefix),this.options.positiveSuffix!==null&&(this._userPositiveSuffix=this.options.positiveSuffix),this.options.currencySymbol!==null&&(this._userCurrencySymbol=this.options.currencySymbol)},i.prototype._updateCultureRelatedOptions=function(){var e=this._getCulture().numberFormat,t=e[this.options.type]||e,n=t.pattern[0],r=t.pattern[1]||"n",i=n.split("n"),s=r.split("n"),o=this._getPercentSymbol(),u=this._getCulture().numberFormat.currency.symbol;this._userNegativePrefix===undefined&&(this.options.negativePrefix=i[0].replace(/%/g,o).replace(/\$/g,u)),this._userNegativeSuffix===undefined&&(this.options.negativeSuffix=i[1].replace(/%/g,o).replace(/\$/g,u)),this._userPositivePrefix===undefined&&(this.options.positivePrefix=s[0].replace(/%/g,o).replace(/\$/g,u)),this._userPositiveSuffix===undefined&&(this.options.positiveSuffix=s[1].replace(/%/g,o).replace(/\$/g,u)),this._userCurrencySymbol===undefined&&(this.options.currencySymbol=e.currency.symbol)},i.prototype._createTextProvider=function(){if(this._textProvider)return this._textProvider;this._textProvider=new o(this,this.options.type),this._textProvider.setNullValue(this.element.val()===""&&this.options.value===null)},i.prototype._beginUpdate=function(){this._initialValue=0;var e=this.options;this.element.addClass(e.wijCSS.wijinputnumber),this.element.data({defaultValue:e.value,preValue:e.value}).attr({"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":e.value||this._initialValue})},i.prototype.focus=function(){this._doFocus()},i.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"minValue":this.element.attr("aria-valuemin",n),this._updateText();break;case"maxValue":this.element.attr("aria-valuemax",n),this._updateText();break;case"value":this.setValue(n),this._updateText();break;case"showGroup":case"decimalPlaces":case"culture":this._updateCultureRelatedOptions(),this._updateText();break;case"positivePrefix":this._userPositivePrefix=n,this._updateText();break;case"negativePrefix":this._userNegativePrefix=n,this._updateText();break;case"positiveSuffix":this._userPositiveSuffix=n,this._updateText();break;case"negativeSuffix":this._userNegativeSuffix=n,this._updateText();break;case"currencySymbol":this._userCurrencySymbol=n,this._updateCultureRelatedOptions(),this._updateText();break;case"type":this._updateCultureRelatedOptions(),this._updateText()}},i.prototype._setData=function(e){this.setValue(e)},i.prototype._resetData=function(){var e=this.element.data("defaultValue");if(e===0){var t=this.element.data("elementValue");t!==undefined&&t!==null&&t!==""&&(e=t)}(e!==this._textProvider.getValue()||this._textProvider._nullvalue&&e===0)&&this.setValue(e)},i.prototype._validateData=function(){!this._textProvider.checkAndRepairBounds(!0,!1)&&this.options.value!==null&&this._updateText()},i.prototype._raiseDataChanged=function(){var e=this.options.value,t=this.element.data("preValue");this.element.data("preValue",e),t!==e&&(this.element.attr("aria-valuenow",e),this._trigger("valueChanged",null,{value:e}))},i.prototype._onChange=function(){},i.prototype._getPrefix=function(){return this._textProvider._stringFormat.isNegative()?this._userNegativePrefix!==undefined?this._userNegativePrefix:this.options.negativePrefix:this._userPositivePrefix!==undefined?this._userPositivePrefix:this.options.positivePrefix},i.prototype._getInvertPrefix=function(){return this._textProvider._stringFormat.isNegative()?this._userPositivePrefix!==undefined?this._userPositivePrefix:this.options.positivePrefix:this._userNegativePrefix!==undefined?this._userNegativePrefix:this.options.negativePrefix},i.prototype._getSuffix=function(){return this._textProvider._stringFormat.isNegative()?this._userNegativeSuffix!==undefined?this._userNegativeSuffix:this.options.negativeSuffix:this._userPositiveSuffix!==undefined?this._userPositiveSuffix:this.options.positiveSuffix},i.prototype._getCurrencySymbol=function(){return this._userCurrencySymbol!==undefined?this._userCurrencySymbol:this._getCulture().numberFormat.currency.symbol},i.prototype._getPercentSymbol=function(){return this._getCulture().numberFormat.percent.symbol},i.prototype.getValue=function(){if(this._textProvider._nullvalue)return null;var e=this._textProvider.getValue();if(e===undefined||e===null)e=this.getText();return e},i.prototype.setValue=function(e,t){typeof t=="undefined"&&(t=!1);try{t=!!t,e===null||typeof e=="undefined"||isNaN(e)?e=null:typeof e=="boolean"?e=e?1:0:typeof e=="string"&&(e=this._textProvider.tryParseValue(e));if(this._textProvider.setValue(e))this._updateText();else if(t){var n=this.getText();this.setText(e);var r=this.getText().trim();e=e.trim(),r!==e&&this.setText(n)}else this.setText(e);return!0}catch(i){return!1}},i.prototype._isLastValueNull=function(){return e.prototype._isLastValueNull.call(this)&&!this._textProvider._nullvalue},i.prototype.isValueNull=function(){try{return this._textProvider.isValueNull()}catch(e){return!0}},i.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(e.prototype._showNullText.call(this)&&this.isValueNull())return"0";var t=this.options.value?this.options.value:0;return this.options.type==="percent"&&(t=(t/100).toFixed(10)),t.toString()},i.prototype._updateText=function(t){typeof t=="undefined"&&(t=!1);if(!this._isInitialized())return;this._textProvider._stringFormat.isNegative()?this.element.addClass(this.options.negativeClass):this.element.removeClass(this.options.negativeClass),this._textProvider._nullvalue?this.options.value=null:this.options.value=this._textProvider.getValue(),e.prototype._updateText.call(this,t),this._textProvider.checkAndRepairBounds(!0,!1)||(this._trigger("valueBoundsExceeded"),this.isFocused()||(this._textProvider.setNullValue(!1),this.options.value=this._textProvider.getValue(),this._textProvider._stringFormat.isNegative()?this.element.addClass(this.options.negativeClass):this.element.removeClass(this.options.negativeClass),e.prototype._updateText.call(this,t)))},i.prototype._doSpin=function(e,r,i){if(!this._allowEdit())return!1;if(r&&this.element.data("breakSpinner"))return!1;var s=this.element.wijtextselection(),o=new t.wijInputResult;this.element.data("focusNotCalledFirstTime")!==-9&&(new Date).getTime()-this.element.data("focusNotCalledFirstTime")<600&&(this.element.data("focusNotCalledFirstTime",-9),this.element.data("prevSelection",{start:0,end:0})),this.element.data("prevSelection")===null?this.element.data("prevSelection",{start:s.start,end:s.start}):s.start=this.element.data("prevSelection").start,o.testPosition=s.start;if(this.options.increment<0){var u=this.options.increment;this.options.increment*=-1,this._textProvider.spinEnumPart(s.start,o,this.options.increment,!e),this.options.increment=u}else this._textProvider.spinEnumPart(s.start,o,this.options.increment,e);e?this._trigger("spinUp",null):this._trigger("spinDown",null),this._updateText(),this.element.data("prevSelection",{start:o.testPosition,end:o.testPosition}),i||this.selectText(o.testPosition,o.testPosition);if(r&&!this.element.data("breakSpinner")){var a=window.setTimeout(n.proxy(function(){this._doSpin(e,!0)},this),this._calcSpinInterval());this.element.data("spintimer",a)}return!0},i.prototype._deleteSelText=function(t){typeof t=="undefined"&&(t=!1);var n=this.element.wijtextselection(),r=n.start===0&&n.end===this.element.val().length,i;if(n.start===n.end&&!t){i=this._textProvider._stringFormat._currentText;if(i.charAt(n.end)===this._textProvider.getGroupSeparator()||i.charAt(n.end)===this._textProvider.getDecimalSeparator()){n.start++,n.end++,this.element.wijtextselection(n);return}}var s=this._textProvider.getEditingValue();e.prototype._deleteSelText.call(this,t),s===0&&(r||this._textProvider.getEditingValue()===0)&&(this._textProvider.setNullValue(!0),this._updateText(!0),this.options.value=null)},i.prototype._processClearButton=function(){this._setOption("value",null)},i.prototype._processLeftRightKey=function(e){if(e){if(this.element.wijtextselection().start===0&&(this.options.blurOnLeftRightKey.toLowerCase()==="left"||this.options.blurOnLeftRightKey.toLowerCase()==="both"))return t.Utility.MoveFocus(this.element.get(0),!1),!0}else if(this.element.wijtextselection().start===this.element.val().length&&(this.options.blurOnLeftRightKey.toLowerCase()==="right"||this.options.blurOnLeftRightKey.toLowerCase()==="both"))return t.Utility.MoveFocus(this.element.get(0),!0),!0;return!1},i.prototype._processTabKey=function(e){var t=e.keyCode||e.which;switch(t){case r.TAB:if(this.options.tabAction!=="field"){this._trigger("keyExit");break}var n=this.element.val().indexOf(".");n===-1&&(n=this.element.val().length);var i=this.element.wijtextselection();return e.shiftKey?i.start>n&&this._toPrevField():i.start<n&&this._toNextField(),!0}return!1},i.prototype._toPrevField=function(){var e=this._getPrefix();this.element.wijtextselection(e.length,e.length)},i.prototype._toNextField=function(){var e=this.element.val().indexOf(".");e===-1?this._toPrevField():this.element.wijtextselection(e+1,e+1)},i.prototype.spinUp=function(){this._doSpin(!0,!1,!0)},i.prototype.spinDown=function(){this._doSpin(!1,!1,!0)},i.prototype._getRealNegativePrefix=function(){return this._userNegativePrefix!==undefined?this._userNegativePrefix.replace(/\$/g,this.options.currencySymbol):this.options.negativePrefix===null?"":this.options.negativePrefix.replace(/\$/g,this.options.currencySymbol)},i.prototype._getRealPositivePrefix=function(){return this._userPositivePrefix!==undefined?this._userPositivePrefix.replace(/\$/g,this.options.currencySymbol):this.options.positivePrefix===null?"":this.options.positivePrefix.replace(/\$/g,this.options.currencySymbol)},i.prototype._getRealNegativeSuffix=function(){return this._userNegativeSuffix!==undefined?this._userNegativeSuffix.replace(/\$/g,this.options.currencySymbol):this.options.negativeSuffix===null?"":this.options.negativeSuffix.replace(/\$/g,this.options.currencySymbol)},i.prototype._getRealPositiveSuffix=function(){return this._userPositiveSuffix!==undefined?this._userPositiveSuffix.replace(/\$/g,this.options.currencySymbol):this.options.positiveSuffix===null?"":this.options.positiveSuffix.replace(/\$/g,this.options.currencySymbol)},i.prototype._afterFocused=function(){this._isNullText()?e.prototype._doFocus.call(this):this._doFocus()},i.prototype._doFocus=function(){e.prototype.focus.call(this);if(this.options.highlightText)this.element.wijtextselection(0,this.element.val().length);else{var t=this.element.data("prevSelection");t&&this.element.wijtextselection(t.start,t.end)}this.element.data("isFocusSelecting",!0)},i}(t.wijinputcore);t.wijinputnumber=i;var s=function(){function e(){this.wijCSS={wijinputnumber:t.wijinputcore.prototype.options.wijCSS.wijinput+"-numeric",wijinputnumberNegative:"ui-state-negative"},this.type="numeric",this.value=0,this.minValue=-1e9,this.maxValue=1e9,this.showGroup=!1,this.decimalPlaces=2,this.increment=1,this.currencySymbol=null,this.negativePrefix=null,this.negativeSuffix=null,this.positivePrefix=null,this.positiveSuffix=null,this.imeMode="",this.highlightText=!1,this.valueChanged=null,this.spinUp=null,this.spinDown=null,this.valueBoundsExceeded=null,this.negativeClass=this.wijCSS.wijinputnumberNegative}return e}();i.prototype.options=n.extend(!0,{},t.wijinputcore.prototype.options,new s),n.wijmo.registerWidget("wijinputnumber",i.prototype);var o=function(){function e(e,n){this._type="numeric",this._stringFormat=null,this._nullvalue=!1,this.inputWidget=e,this._type=n,this._stringFormat=new t.wijNumberFormat,this._stringFormat.setValueFromJSFloat(this.getValue(),this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options)}return e.prototype.getEditingValue=function(){return this._stringFormat.tryParseValue(this._stringFormat._strippedText,this.inputWidget._getCulture(),this.inputWidget.options)},e.prototype._getCulture=function(){return this.inputWidget._getCulture()},e.prototype.getDecimalSeparator=function(){return this._getCulture().numberFormat["."]},e.prototype.getGroupSeparator=function(){return this._getCulture().numberFormat[","]},e.prototype.tryParseValue=function(e){return this._stringFormat.tryParseValue(e,this.inputWidget._getCulture(),this.inputWidget.options)},e.prototype.toString=function(){return this.inputWidget._showNullText()&&!this.inputWidget.isFocused()&&this.isValueNull()?this.inputWidget.options.nullText:this.isValueNull()?"":this._stringFormat.getFormattedValue(this.inputWidget._initialValue,this.isValueNull(),this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options)},e.prototype.isValueNull=function(){var e=this.inputWidget.options;return null===e.value||undefined===e.value||this._nullvalue},e.prototype.setText=function(e,t){return this.clear(),this.insertAt(e,0,t),!0},e.prototype.clear=function(){this._stringFormat.clear()},e.prototype.checkAndRepairBounds=function(e,t,n){typeof n=="undefined"&&(n=!1);if(this._nullvalue)return!0;var r=!0,i,s;typeof e=="undefined"&&(e=!1),i=this.inputWidget.options.minValue,s=this.inputWidget.options.maxValue;if(typeof t!="undefined"&&t)return this._stringFormat.checkMinValue(i,!1,!0);var o=!0;return this._stringFormat.checkMinValue(i,e,!1)||(r=!1,n&&(o=!1,this._stringFormat._currentValueInString=s.toString())),o&&!this._stringFormat.checkMaxValue(s,e)&&(r=!1,n&&(this._stringFormat._currentValueInString=i.toString())),this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces),r},e.prototype._countSubstring=function(e,t){var n=0,r=e.indexOf(t);while(r!==-1)n++,r=e.indexOf(t,r+1);return n},e.prototype._getAdjustedPositionFromLeft=function(e){var t=this._stringFormat._strippedText,r,i;for(r=0;r<t.length;r++){i=t.charAt(r);if(!(!n.wij.charValidator.isDigit(i)&&i!==this.getGroupSeparator()&&i!==this.getDecimalSeparator()||i==="0"))break;this._stringFormat.isZero()?e<r&&e++:e<=r&&e++}return e},e.prototype._getDecimalSeparatorPos=function(){var e=this._stringFormat._strippedText;return e.indexOf(this.getDecimalSeparator())},e.prototype._removeLeadingZero=function(e){var t=0;(e.charAt(t)===" "||e.charAt(t)===this.inputWidget.options.currencySymbol)&&t++;var n=Globalize.findClosestCulture(this.inputWidget.options.culture),r=n.numberFormat,i=r[this.inputWidget.options.type]||r;while(e.charAt(t)==="0"&&e.charAt(t+1)!==i["."])e=e.substr(0,t)+e.substr(t+1);return e},e.prototype.insertAt=function(e,r,i){var s=this._getCulture().numberFormat,o,u,a,f,l,c,h,p,d,v=this._stringFormat._strippedText,m=this.inputWidget._getPrefix(),g=this.inputWidget._getInvertPrefix();r<m.length?r=m.length:r>m.length+v.length&&(r=m.length+v.length),r-=m.length,i||(i=new t.wijInputResult);var y=this._nullvalue;this.setNullValue(!1);if(e.length===1){if(e==="+"){var b=this._stringFormat.isNegative();this._stringFormat.setPositiveSign(),this.checkAndRepairBounds(!0,!1);var w=b!==this._stringFormat.isNegative();return w?i.testPosition=g.length+r-1:i.testPosition=m.length+r-1,!0}if(e==="-"||e===")"||e==="("){var E=this._stringFormat.isNegative();return this._stringFormat.invertSign(this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options),this.checkAndRepairBounds(!0,!1),this._stringFormat.isNegative()===E?(i.testPosition=m.length+r-1,!0):(i.testPosition=g.length+r-1,!0)}if(!n.wij.charValidator.isDigit(e)){if(e===this.getDecimalSeparator()){o=this._getDecimalSeparatorPos()+m.length;if(o>=0)return i.testPosition=o,!0}if(e!==this.getGroupSeparator()&&e!==this.getDecimalSeparator()&&e!==")"&&e!=="+"&&e!=="-"&&e!=="("&&e!==this.getDecimalSeparator())return this._type==="percent"&&e===s.percent.symbol?(i.testPosition=r,!0):this._type==="currency"&&e===this.inputWidget.options.currencySymbol?(i.testPosition=r,!0):(this.setNullValue(y),!1)}}r=this._getAdjustedPositionFromLeft(r),u=r,u>v.length&&(u=v.length-1),a=this._removeLeadingZero(v.substring(0,u)),f=v.substring(u,v.length),this._stringFormat.isZero()&&(f=f.replace(/0/,""));var S=e,x="";while(S.charAt(0)==="+"||S.charAt(0)==="-"||S.charAt(0)===")"||S.charAt(0)==="(")x=S.charAt(0),S=S.substring(1);S=S.replace(/[^0-9\.]/gi,"");var T=S.indexOf(".");if(T!==-1){var N=S.split("."),C,k;C=N.shift();var L=N;k=L.join(""),S=C+"."+k}else S=S;x==="+"&&(this._stringFormat.setPositiveSign(),this.checkAndRepairBounds(!0,!1));if(x==="-"||x===")"||x==="(")this._stringFormat.invertSign(this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options),this.checkAndRepairBounds(!0,!1);i.testPosition=m.length+a.length+S.length-1,this._stringFormat.deFormatValue((this._stringFormat.isNegative()?"-":"")+a+S+f,this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options),l=this._stringFormat._strippedText;try{this.inputWidget.options.showGroup?(c=this._countSubstring(a,this._stringFormat._groupSeparator),h=this._countSubstring(l.substring(0,a.length+S.length),this._stringFormat._groupSeparator),i.testPosition+=h-c):S.length===1&&(p=a.charAt(a.length-1),d=l.charAt(a.length-1),d!==p&&i.testPosition--)}catch(A){}return!0},e.prototype.removeAt=function(e,n,r,i){typeof r=="undefined"&&(r=new t.wijInputResult),typeof i=="undefined"&&(i=!1);var s=this._getCulture().numberFormat,o,u,a,f,l,c;r.testPosition=e;try{o=this._stringFormat._currentText;if(e===n&&o.substring(e,n+1)===this.getDecimalSeparator())return!1;u=o.slice(0,e),a=u,f=o.slice(e,n+1).indexOf(this.getDecimalSeparator())>=0,f&&(a+=this.getDecimalSeparator()),a+=o.slice(n+1),a=a||"0",this._stringFormat.deFormatValue(a,this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options),a=this._stringFormat._currentText,this.setNullValue(!1);if(this.inputWidget.options.showGroup)if(f)r.testPosition=a.indexOf(this.getDecimalSeparator());else try{l=this._countSubstring(u,this._stringFormat._groupSeparator),c=this._countSubstring(a.substring(0,Math.max(0,e-1)),this._stringFormat._groupSeparator),r.testPosition-=l-c,(o.indexOf(this.inputWidget.options.currencySymbol)===r.testPosition||o.indexOf(s.percent.symbol)===r.testPosition)&&r.testPosition++}catch(h){}return!0}catch(p){}return!0},e.prototype.replaceWith=function(e,n){if(n==="."&&this.inputWidget.options.decimalPlaces<=0){var r=new t.wijInputResult;return r.testPosition=e.start-1,r}var i=!1;this._stringFormat.isNegative()&&n==="-"&&e.text.length===this._stringFormat._currentText.length&&(i=!0);var s=this.superReplaceWith(e,n);return i&&this.insertAt("-",this.inputWidget.element.wijtextselection().start,s),s},e.prototype.superReplaceWith=function(e,n){var r=e.start,i=new t.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(n,r,i)?i:null},e.prototype._parseNumber=function(e){typeof e=="undefined"&&(e=this._stringFormat._currentValueInString);var t=e.split(".",2),n={integer:parseInt(t[0],10)||0,fraction:(t.length>1?parseInt(t[1],10):0)||0,isNegative:t[0].indexOf("-")!==-1};return n.integer===0&&n.fraction===0&&(n.isNegative=!1),n},e.prototype._doSpin=function(e,t){var n=this._parseNumber(),r=e>=0?1:-1,i=Math.abs(e)>=1?"integer":"decimal",s=this.inputWidget.options.increment;s>=Math.pow(10,this.inputWidget.options.decimalPlaces)&&(i==="integer"?s=Math.abs(e):s=Math.abs(e)*Math.pow(10,this.inputWidget.options.decimalPlaces));var o=r*s,u="",a,f,l=n.integer,c=n.fraction;if(i==="integer")l=n.integer+o,l<0&&(u="-",l=-l);else if(i==="decimal"){var h=n.isNegative?-n.fraction:n.fraction;l=n.integer,h<0?(c=-Math.abs(h+o),h*(h+o)<0&&(l=Math.abs(l),u="-")):c=h+o,h===0&&n.isNegative&&(c=-Math.abs(c),u="-",r===1&&(l=Math.abs(l))),c<=0&&(l>0?(l-=1,c=Math.pow(10,this.inputWidget.options.decimalPlaces)+c):(l=Math.abs(n.integer),c=Math.abs(c),u="-"))}a=l.toString(),f=c.toString(),parseInt(this.inputWidget.options.decimalPlaces)>0&&f.length>parseInt(this.inputWidget.options.decimalPlaces)&&(l++,f=f.substring(1),a=l.toString());while(f.length<this.inputWidget.options.decimalPlaces)f="0"+f;a.indexOf("-")!==-1&&(u=""),parseInt(a)===0&&parseInt(f)===0&&(u=""),t?e>=0?this._stringFormat._currentValueInString=this.inputWidget.options.minValue.toString():this._stringFormat._currentValueInString=this.inputWidget.options.maxValue.toString():this._stringFormat._currentValueInString=u+a+"."+f},e.prototype.spinUp=function(e,t){if(e===null||e===undefined)e=1;this._doSpin(e,t)},e.prototype.spinDown=function(e,t){if(e===null||e===undefined)e=1;this._doSpin(-e,t)},e.prototype.spinEnumPart=function(e,n,r,i){n||(n=new t.wijInputResult),r=parseInt(r.toString());var s=this.inputWidget._getPrefix(),o=this._stringFormat._currentText.indexOf(this._getCulture().numberFormat["."]),u=this._stringFormat._currentValueInString.replace("-",""),a=u.indexOf("."),f=!0;o===-1&&(f=!1,o=this._stringFormat._currentText.length),a===0?a=1:a===-1&&(a=o);var l=Math.pow(10,this.inputWidget.options.decimalPlaces);if(n.testPosition>o&&f){var c=r;r/=l,Math.abs(r)>=1&&(i?this.spinUp(parseInt(r),this._nullvalue):this.spinDown(parseInt(r),this._nullvalue),r=(c-parseInt(r)*l)/l)}i?this.spinUp(r,this._nullvalue):this.spinDown(r,this._nullvalue),this.setNullValue(!1);var h=this.inputWidget.options.allowSpinLoop;this.checkAndRepairBounds(!0,!1,h);var p=this._stringFormat._currentValueInString.replace("-",""),d=p.indexOf(".");d===-1&&(f=!1,d=p.length);var v=this.inputWidget._getPrefix();d!==a&&f?n.testPosition=n.testPosition-s.length+v.length+d-a:n.testPosition=n.testPosition-s.length+v.length},e.prototype.getValue=function(){return this._stringFormat.getJSFloatValue()},e.prototype.setValue=function(e){try{return e===null?(this.setNullValue(!0),e=this.inputWidget._initialValue):this.setNullValue(!1),this._stringFormat.setValueFromJSFloat(e,this.inputWidget._getCulture(),this.inputWidget._getRealPositivePrefix(),this.inputWidget._getRealPositiveSuffix(),this.inputWidget._getRealNegativePrefix(),this.inputWidget._getRealNegativeSuffix(),this.inputWidget.options),this.checkAndRepairBounds(!0,!1),!0}catch(t){return!1}},e.prototype.setNullValue=function(e){this._nullvalue=e},e}();t.wijNumberTextProvider=o})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(e){var t=function(){function e(){this.DBCS_UpperAlphabet=2147483650,this.SBCS_UpperAlphabet=1073741825,this.DBCS_LowerAlphabet=2147483656,this.SBCS_LowerAlphabet=1073741828,this.DBCS_Number=2147483680,this.SBCS_Number=1073741840,this.DBCS_Binary=2147483776,this.SBCS_Binary=1073741888,this.DBCS_Hexadecimal=2147484160,this.SBCS_Hexadecimal=1073742080,this.DBCS_Symbol=2147485696,this.SBCS_Symbol=1073742848,this.DBCS_NumberSymbol=2147491840,this.SBCS_NumberSymbol=1073745920,this.DBCS_Katakana=2147516416,this.SBCS_Katakana=1073758208,this.DBCS_Space=2147614720,this.SBCS_Space=1073807360,this.TwoBytes=2148007936,this.FourBytes=2147745792,this.DBCS_ShiftJIS=2148532224,this.DBCS_JISX0208=2149580800,this.Emoji=4194304,this.IVS=8388608,this.DBCS_Hiragana=2164260864,this.Upper_SBCS_Katakana=1207959552,this.Upper_DBCS_Katakana=2415919104,this.Upper_DBCS_Hiragana=2684354560,this.All=3321888768,this.DBCS_All=2214592512,this.SBCS_All=1107296256,this.DBCS=2147483648,this.SBCS=1073741824}return e}(),n=function(){function n(n,r){this.charType=new t,this.format=r,this.includeFormat="",this.excludeFormat="",this.includeNormalChar="",this.excludeNormalChar="",this.allowTypes=this.charType.All,this.excludeTypes=this.charType.All,this.include=!0,this.autoConvert=n,this.charExInstance=e.CharProcess.CharEx,this.isInputValid=!0,this.ParseFormat(this.format)}return n.prototype.allowDBCS=function(){return!((this.allowTypes&this.charType.DBCS_All)!=0^this.include)},n.prototype.allowSBCS=function(){return!((this.allowTypes&this.charType.SBCS_All)!=0^this.include)},n.prototype.GetIncludeFormat=function(e){if(e==null||e.GetLength()==0)return"";var t="";for(var n=0;n<e.GetLength();n++){var r=e.Substring(n,n+1);if(r=="\\"){if(n==e.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";t+=r,t+=e.Substring(n+1,n+2),n++}else{if(r=="^")return t;t+=r}}return t},n.prototype.GetExcludeFormat=function(e){if(e==null||e.GetLength()==0)return"";var t=0,n="";for(var r=0;r<e.GetLength();r++){var i=e.Substring(r,r+1);if(i=="\\"){if(r==e.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";t!=0&&(n+=i,n+=e.Substring(r+1,r+2)),r++}else if(i=="^"){t++;if(t>1)throw"Exception.TextFilter.Format.DuplicatedChar"}else t!=0&&(n+=i)}return t==1&&(n="^"+n),n},n.prototype.ParseIncludeFormat=function(e){if(e==null||e.GetLength()==0){this.allowTypes=this.charType.All,this.includeNormalChar="",this.includeFormat="";return}this.allowTypes=0,this.includeNormalChar="";for(var t=0;t<e.GetLength();t++)switch(e.charCodeAt(t)){case 94:break;case 92:if(t==e.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";this.includeNormalChar=this.includeNormalChar+e.Substring(t+1,t+2),t++;break;case 65313:(this.allowTypes&this.charType.DBCS_UpperAlphabet)!=(this.charType.DBCS_UpperAlphabet|0)&&(this.allowTypes|=this.charType.DBCS_UpperAlphabet);break;case 65:(this.allowTypes&this.charType.SBCS_UpperAlphabet)!=this.charType.SBCS_UpperAlphabet&&(this.allowTypes|=this.charType.SBCS_UpperAlphabet);break;case 65345:(this.allowTypes&this.charType.DBCS_LowerAlphabet)!=(this.charType.DBCS_LowerAlphabet|0)&&(this.allowTypes|=this.charType.DBCS_LowerAlphabet);break;case 97:(this.allowTypes&this.charType.SBCS_LowerAlphabet)!=this.charType.SBCS_LowerAlphabet&&(this.allowTypes|=this.charType.SBCS_LowerAlphabet);break;case 65323:(this.allowTypes&this.charType.DBCS_Katakana)!=(this.charType.DBCS_Katakana|0)&&(this.allowTypes|=this.charType.DBCS_Katakana);break;case 75:(this.allowTypes&this.charType.SBCS_Katakana)!=this.charType.SBCS_Katakana&&(this.allowTypes|=this.charType.SBCS_Katakana);break;case 65305:(this.allowTypes&this.charType.DBCS_Number)!=(this.charType.DBCS_Number|0)&&(this.allowTypes|=this.charType.DBCS_Number);break;case 57:(this.allowTypes&this.charType.SBCS_Number)!=this.charType.SBCS_Number&&(this.allowTypes|=this.charType.SBCS_Number);break;case 65283:(this.allowTypes&this.charType.DBCS_NumberSymbol)!=(this.charType.DBCS_NumberSymbol|0)&&(this.allowTypes|=this.charType.DBCS_NumberSymbol);break;case 35:(this.allowTypes&this.charType.SBCS_NumberSymbol)!=this.charType.SBCS_NumberSymbol&&(this.allowTypes|=this.charType.SBCS_NumberSymbol);break;case 65312:(this.allowTypes&this.charType.DBCS_Symbol)!=(this.charType.DBCS_Symbol|0)&&(this.allowTypes|=this.charType.DBCS_Symbol);break;case 64:(this.allowTypes&this.charType.SBCS_Symbol)!=this.charType.SBCS_Symbol&&(this.allowTypes|=this.charType.SBCS_Symbol);break;case 65314:(this.allowTypes&this.charType.DBCS_Binary)!=(this.charType.DBCS_Binary|0)&&(this.allowTypes|=this.charType.DBCS_Binary);break;case 66:(this.allowTypes&this.charType.SBCS_Binary)!=this.charType.SBCS_Binary&&(this.allowTypes|=this.charType.SBCS_Binary);break;case 65336:(this.allowTypes&this.charType.DBCS_Hexadecimal)!=(this.charType.DBCS_Hexadecimal|0)&&(this.allowTypes|=this.charType.DBCS_Hexadecimal);break;case 88:(this.allowTypes&this.charType.SBCS_Hexadecimal)!=this.charType.SBCS_Hexadecimal&&(this.allowTypes|=this.charType.SBCS_Hexadecimal);break;case 65322:(this.allowTypes&this.charType.DBCS_Hiragana)!=(this.charType.DBCS_Hiragana|0)&&(this.allowTypes|=this.charType.DBCS_Hiragana);break;case 65338:(this.allowTypes&this.charType.DBCS_All)!=(this.charType.DBCS_All|0)&&(this.allowTypes|=this.charType.DBCS_All);break;case 65325:(this.allowTypes&this.charType.DBCS_ShiftJIS)!=(this.charType.DBCS_ShiftJIS|0)&&(this.allowTypes|=this.charType.DBCS_ShiftJIS);break;case 65321:(this.allowTypes&this.charType.DBCS_JISX0208)!=(this.charType.DBCS_JISX0208|0)&&(this.allowTypes|=this.charType.DBCS_JISX0208);break;case 72:(this.allowTypes&this.charType.SBCS_All)!=this.charType.SBCS_All&&(this.allowTypes|=this.charType.SBCS_All);break;case 78:(this.allowTypes&this.charType.Upper_SBCS_Katakana)!=this.charType.Upper_SBCS_Katakana&&(this.allowTypes|=this.charType.Upper_SBCS_Katakana);break;case 65326:(this.allowTypes&this.charType.Upper_DBCS_Katakana)!=this.charType.Upper_DBCS_Katakana&&(this.allowTypes|=this.charType.Upper_DBCS_Katakana);break;case 65319:(this.allowTypes&this.charType.Upper_DBCS_Hiragana)!=this.charType.Upper_DBCS_Hiragana&&(this.allowTypes|=this.charType.Upper_DBCS_Hiragana);break;case 65331:(this.allowTypes&this.charType.DBCS_Space)!=this.charType.DBCS_Space&&(this.allowTypes|=this.charType.DBCS_Space);break;case 83:(this.allowTypes&this.charType.SBCS_Space)!=this.charType.SBCS_Space&&(this.allowTypes|=this.charType.SBCS_Space);break;case 65332:(this.allowTypes&this.charType.FourBytes)!=this.charType.FourBytes&&(this.allowTypes|=this.charType.FourBytes);break;case 65316:(this.allowTypes&this.charType.TwoBytes)!=this.charType.TwoBytes&&(this.allowTypes|=this.charType.TwoBytes);break;case 65317:this.allowTypes|=this.charType.Emoji;break;case 65334:this.allowTypes|=this.charType.IVS;break;default:this.includeNormalChar=this.includeNormalChar+e.Substring(t,t+1)}},n.prototype.ParseExcludeFormat=function(e){if(e==null||e.GetLength()==0){this.excludeTypes=this.excludeTypes.All,this.excludeNormalChar="",this.excludeFormat="";return}if(e=="^"){this.excludeTypes=this.charType.All,this.excludeNormalChar="",this.excludeFormat="^";return}this.excludeTypes=0,this.excludeNormalChar="";for(var t=0;t<e.GetLength();t++)switch(e.charCodeAt(t)){case 94:break;case 92:if(t==e.GetLength()-1)throw"Exception.TextFilter.Format.Invalid";this.excludeNormalChar=this.excludeNormalChar+e.Substring(t+1,t+2),t++;break;case 65313:(this.excludeTypes&this.charType.DBCS_UpperAlphabet)!=(this.charType.DBCS_UpperAlphabet|0)&&(this.excludeTypes|=this.charType.DBCS_UpperAlphabet);break;case 65:(this.excludeTypes&this.charType.SBCS_UpperAlphabet)!=this.charType.SBCS_UpperAlphabet&&(this.excludeTypes|=this.charType.SBCS_UpperAlphabet);break;case 65345:(this.excludeTypes&this.charType.DBCS_LowerAlphabet)!=(this.charType.DBCS_LowerAlphabet|0)&&(this.excludeTypes|=this.charType.DBCS_LowerAlphabet);break;case 97:(this.excludeTypes&this.charType.SBCS_LowerAlphabet)!=this.charType.SBCS_LowerAlphabet&&(this.excludeTypes|=this.charType.SBCS_LowerAlphabet);break;case 65323:(this.excludeTypes&this.charType.DBCS_Katakana)!=(this.charType.DBCS_Katakana|0)&&(this.excludeTypes|=this.charType.DBCS_Katakana);break;case 75:(this.excludeTypes&this.charType.SBCS_Katakana)!=this.charType.SBCS_Katakana&&(this.excludeTypes|=this.charType.SBCS_Katakana);break;case 65305:if((this.excludeTypes&this.charType.DBCS_Number)==(this.charType.DBCS_Number|0))return;this.excludeTypes|=this.charType.DBCS_Number;break;case 57:(this.excludeTypes&this.charType.SBCS_Number)!=this.charType.SBCS_Number&&(this.excludeTypes|=this.charType.SBCS_Number);break;case 65283:(this.excludeTypes&this.charType.DBCS_NumberSymbol)!=(this.charType.DBCS_NumberSymbol|0)&&(this.excludeTypes|=this.charType.DBCS_NumberSymbol);break;case 35:(this.excludeTypes&this.charType.SBCS_NumberSymbol)!=this.charType.SBCS_NumberSymbol&&(this.excludeTypes|=this.charType.SBCS_NumberSymbol);break;case 65312:(this.excludeTypes&this.charType.DBCS_Symbol)!=(this.charType.DBCS_Symbol|0)&&(this.excludeTypes|=this.charType.DBCS_Symbol);break;case 64:(this.excludeTypes&this.charType.SBCS_Symbol)!=this.charType.SBCS_Symbol&&(this.excludeTypes|=this.charType.SBCS_Symbol);break;case 65314:(this.excludeTypes&this.charType.DBCS_Binary)!=(this.charType.DBCS_Binary|0)&&(this.excludeTypes|=this.charType.DBCS_Binary);break;case 66:(this.excludeTypes&this.charType.SBCS_Binary)!=this.charType.SBCS_Binary&&(this.excludeTypes|=this.charType.SBCS_Binary);break;case 65336:(this.excludeTypes&this.charType.DBCS_Hexadecimal)!=(this.charType.DBCS_Hexadecimal|0)&&(this.excludeTypes|=this.charType.DBCS_Hexadecimal);break;case 88:(this.excludeTypes&this.charType.SBCS_Hexadecimal)!=this.charType.SBCS_Hexadecimal&&(this.excludeTypes|=this.charType.SBCS_Hexadecimal);break;case 65322:(this.excludeTypes&this.charType.DBCS_Hiragana)!=(this.charType.DBCS_Hiragana|0)&&(this.excludeTypes|=this.charType.DBCS_Hiragana);break;case 65338:(this.excludeTypes&this.charType.DBCS_All)!=(this.charType.DBCS_All|0)&&(this.excludeTypes|=this.charType.DBCS_All);break;case 65325:(this.excludeTypes&this.charType.DBCS_ShiftJIS)!=(this.charType.DBCS_ShiftJIS|0)&&(this.excludeTypes|=this.charType.DBCS_ShiftJIS);break;case 65321:(this.excludeTypes&this.charType.DBCS_JISX0208)!=(this.charType.DBCS_JISX0208|0)&&(this.excludeTypes|=this.charType.DBCS_JISX0208);break;case 72:(this.excludeTypes&this.charType.SBCS_All)!=this.charType.SBCS_All&&(this.excludeTypes|=this.charType.SBCS_All);break;case 78:(this.excludeTypes&this.charType.Upper_SBCS_Katakana)!=this.charType.Upper_SBCS_Katakana&&(this.excludeTypes|=this.charType.Upper_SBCS_Katakana);break;case 65326:(this.excludeTypes&this.charType.Upper_DBCS_Katakana)!=this.charType.Upper_DBCS_Katakana&&(this.excludeTypes|=this.charType.Upper_DBCS_Katakana);break;case 65319:(this.excludeTypes&this.charType.Upper_DBCS_Hiragana)!=this.charType.Upper_DBCS_Hiragana&&(this.excludeTypes|=this.charType.Upper_DBCS_Hiragana);break;case 65331:(this.excludeTypes&this.charType.DBCS_Space)!=this.charType.DBCS_Space&&(this.excludeTypes|=this.charType.DBCS_Space);break;case 83:(this.excludeTypes&this.charType.SBCS_Space)!=this.charType.SBCS_Space&&(this.excludeTypes|=this.charType.SBCS_Space);break;case 65332:(this.excludeTypes&this.charType.FourBytes)!=this.charType.FourBytes&&(this.excludeTypes|=this.charType.FourBytes);break;case 65316:(this.excludeTypes&this.charType.TwoBytes)!=this.charType.TwoBytes&&(this.excludeTypes|=this.charType.TwoBytes);break;case 65317:this.excludeTypes|=this.charType.Emoji;break;case 65334:this.excludeTypes|=this.charType.IVS;break;default:this.excludeNormalChar=this.excludeNormalChar+e.Substring(t,t+1)}},n.prototype.ParseFormat=function(e){this.includeFormat=this.GetIncludeFormat(e),this.excludeFormat=this.GetExcludeFormat(e),this.ParseIncludeFormat(this.includeFormat),this.ParseExcludeFormat(this.excludeFormat)},n.prototype.IsValidProcess=function(e,t,n){if(n.IndexOf(e)!=-1)return!0;if(e=="	"||e=="\r"||e=="\n")return!0;if(t==0)return!1;var r=!1;if(t==this.charType.All)return!0;if((t&this.charType.Emoji)==(this.charType.Emoji|0)&&this.IsEmoji(e))return!0;if((t&this.charType.IVS)==(this.charType.IVS|0)&&this.IsIVS(e))return!0;if((t&this.charType.FourBytes)==(this.charType.FourBytes|0)&&this.IsFourBytes(e))return!0;if(e.GetLength()==1&&e.length>1)return!1;if((t&this.charType.DBCS_ShiftJIS)==(this.charType.DBCS_ShiftJIS|0)&&this.IsShiftJIS(e))return!0;if(this.charExInstance.IsFullWidth(e)){if((t&this.charType.DBCS)!=(this.charType.DBCS|0))return!1;if((t&this.charType.DBCS_All)==(this.charType.DBCS_All|0)&&e!="\u3000")r=!0;else if((t&this.charType.DBCS_LowerAlphabet)==(this.charType.DBCS_LowerAlphabet|0)&&this.IsLower(e))r=!0;else if((t&this.charType.DBCS_UpperAlphabet)==(this.charType.DBCS_UpperAlphabet|0)&&this.IsUpper(e))r=!0;else if((t&this.charType.DBCS_Number)==(this.charType.DBCS_Number|0)&&this.IsNumber(e))r=!0;else if((t&this.charType.DBCS_Binary)==(this.charType.DBCS_Binary|0)&&this.IsBinary(e))r=!0;else if((t&this.charType.DBCS_Hexadecimal)==(this.charType.DBCS_Hexadecimal|0)&&this.IsHex(e))r=!0;else if((t&this.charType.DBCS_Symbol)==(this.charType.DBCS_Symbol|0)&&this.IsSymbol(e))r=!0;else if((t&this.charType.DBCS_NumberSymbol)==(this.charType.DBCS_NumberSymbol|0)&&this.IsNumberSymbol(e))r=!0;else if((t&this.charType.DBCS_Katakana)==(this.charType.DBCS_Katakana|0)&&this.IsKatakana(e)){var i=this.IsHiragana(e);i?this.include?r=!0:r=(t&this.charType.DBCS_Hiragana)==(this.charType.DBCS_Hiragana|0):r=!0}else if((t&this.charType.DBCS_Hiragana)==(this.charType.DBCS_Hiragana|0)&&this.IsHiragana(e)){var i=this.IsKatakana(e);i?this.include?r=!0:r=(t&this.charType.DBCS_Katakana)==(this.charType.DBCS_Katakana|0):r=!0}else(t&this.charType.DBCS_JISX0208)==(this.charType.DBCS_JISX0208|0)&&this.IsJISX0208(e)?r=!0:(t&this.charType.Upper_DBCS_Katakana)==(this.charType.Upper_DBCS_Katakana|0)&&this.IsKatakana(e)&&this.IsUpperKana(e)?r=!0:(t&this.charType.Upper_DBCS_Hiragana)==(this.charType.Upper_DBCS_Hiragana|0)&&this.IsHiragana(e)&&this.IsUpperKana(e)?r=!0:(t&this.charType.DBCS_Space)==(this.charType.DBCS_Space|0)&&this.IsFormatSpace(e)?r=!0:(t&this.charType.FourBytes)==(this.charType.FourBytes|0)&&this.IsFourBytes(e)?r=!0:(t&this.charType.TwoBytes)==(this.charType.TwoBytes|0)&&!this.IsFourBytes(e)&&e!="\u3000"&&(r=!0)}else{if((t&this.charType.SBCS)!=this.charType.SBCS)return!1;(t&this.charType.SBCS_All)==this.charType.SBCS_All&&e!=" "?r=!0:(t&this.charType.SBCS_LowerAlphabet)==this.charType.SBCS_LowerAlphabet&&this.IsLower(e)?r=!0:(t&this.charType.SBCS_UpperAlphabet)==this.charType.SBCS_UpperAlphabet&&this.IsUpper(e)?r=!0:(t&this.charType.SBCS_Number)==this.charType.SBCS_Number&&this.IsNumber(e)?r=!0:(t&this.charType.SBCS_Binary)==this.charType.SBCS_Binary&&this.IsBinary(e)?r=!0:(t&this.charType.SBCS_Hexadecimal)==this.charType.SBCS_Hexadecimal&&this.IsHex(e)?r=!0:(t&this.charType.SBCS_Symbol)==this.charType.SBCS_Symbol&&this.IsSymbol(e)?r=!0:(t&this.charType.SBCS_NumberSymbol)==this.charType.SBCS_NumberSymbol&&this.IsNumberSymbol(e)?r=!0:(t&this.charType.SBCS_Katakana)==this.charType.SBCS_Katakana&&this.IsKatakana(e)?r=!0:(t&this.charType.Upper_SBCS_Katakana)==this.charType.Upper_SBCS_Katakana&&this.IsKatakana(e)&&this.IsUpperKana(e)?r=!0:(t&this.charType.SBCS_Space)==this.charType.SBCS_Space&&this.IsFormatSpace(e)&&(r=!0)}return r},n.prototype.IsIncludeValid=function(e){return this.IsValidProcess(e,this.allowTypes,this.includeNormalChar)},n.prototype.IsExcludeValid=function(e){return this.IsValidProcess(e,this.excludeTypes,this.excludeNormalChar)},n.prototype.IsValid=function(e){if(this.excludeFormat!=""){if(!!this.IsExcludeValid(e))return!1;if(this.includeFormat!="")return this.IsIncludeValid(e)}else if(this.includeFormat!="")return this.IsIncludeValid(e);return!0},n.prototype.IsFormatSpace=function(e){return e==" "||e=="\u3000"?!0:!1},n.prototype.IsFourBytes=function(t){var n=e.CharProcess.CharEx,r=t.Substring(0,1);if(r.length>1)for(var i=0;i<r.length;i++)if(n.IsSurrogate(r[i]))return!0;return!1},n.prototype.IsUpper=function(e){return this.charExInstance.IsUpper(e)},n.prototype.IsLower=function(e){return this.charExInstance.IsLower(e)},n.prototype.IsNumber=function(e){return this.charExInstance.IsDigit(e)},n.prototype.IsBinary=function(e){return e=this.IsFullWidth(e)?this.ToHalfWidth(e):e,e=="0"||e=="1"},n.prototype.IsHex=function(e){return e=this.IsFullWidth(e)?this.ToHalfWidth(e):e,e=="A"||e=="B"||e=="C"||e=="D"||e=="E"||e=="F"||e=="a"||e=="b"||e=="c"||e=="d"||e=="e"||e=="f"||this.IsDigit(e)},n.prototype.IsSymbol=function(e){return this.charExInstance.IsHalfWidthSymbol(e)||this.charExInstance.IsFullWidthSymbol(e)},n.prototype.IsNumberSymbol=function(e){return e=this.IsFullWidth(e)?this.ToHalfWidth(e):e,this.IsDigit(e)||e=="+"||e=="-"||e=="$"||e=="%"||e=="\\"||e==","||e=="."},n.prototype.IsKatakana=function(e){return this.charExInstance.IsKatakana(e)},n.prototype.IsHiragana=function(e){return this.charExInstance.IsHiragana(e)},n.prototype.IsShiftJIS=function(e){return this.charExInstance.IsShiftJIS(e)},n.prototype.IsJISX0208=function(e){return this.charExInstance.IsJISX0208(e)},n.prototype.IsEmoji=function(e){var t={};return!1},n.prototype.IsIVS=function(e){var t={};return!1},n.prototype.IsDBCS=function(e){return this.IsFullWidth(e)},n.prototype.IsSBCS=function(e){return!this.IsFullWidth(e)},n.prototype.IsFullWidth=function(e){return this.charExInstance.IsFullWidth(e)},n.prototype.IsSurrogatePair=function(e){return this.charExInstance.IsSurrogatePair(e)},n.prototype.ToHalfWidth=function(e){return this.charExInstance.ToHalfWidth(e)},n.prototype.IsDigit=function(e){return this.charExInstance.IsDigit(e)},n.prototype.IsUpperKana=function(e){return this.charExInstance.IsUpperKana(e)},n.prototype.CheckValidSpace=function(e){return e==" "&&(this.allowTypes&this.charType.SBCS_Space)==(this.charType.SBCS_Space|0)?!0:e=="\u3000"&&(this.allowTypes&this.charType.DBCS_Space)==(this.charType.DBCS_Space|0)?!0:!1},n.prototype.Check=function(e,t){var n;t!=null?n=e.Substring(t,t+1):n=e;var r=this.IsValid(n);return r?n:this.autoConvert?t!=null?this.Convert(e,t):this.Convert(n):""},n.prototype.CheckText=function(e){var t=e.GetLength(),n={IsInputValid:!0,CheckedText:""};for(var r=0;r<t;){var i=e.Substring(r,r+1);if(i!="	"&&i!="\r"&&i!="\n"){var s=this.Check(e,r);s.index!=null?(r=s.index,i=s.strValue):(i=s,r++),i==""&&(n.IsInputValid=!1)}else r++;n.CheckedText+=i}return n},n.prototype.Convert=function(e,t){var n;t==null?n=e:n=e.Substring(t,t+1);var r=!1;if(this.charExInstance.IsAlphabet(n)){var i=this.charExInstance.IsLower(n)?n.toUpperCase():n.toLowerCase();return r=this.IsValid(i),r?i:(n=this.charExInstance.IsFullWidth(n)?this.charExInstance.ToHalfWidth(n):this.charExInstance.ToFullWidth(n).text,r=this.IsValid(n),r?n:(i=this.charExInstance.IsFullWidth(i)?this.charExInstance.ToHalfWidth(i):this.charExInstance.ToFullWidth(i).text,r=this.IsValid(i),r?i:""))}if(this.charExInstance.IsHiragana(n)){if(this.charExInstance.IsLowerKana(n)){var s=this.charExInstance.ToUpperKana(n);r=this.IsValid(s);if(r)return s}else if(this.charExInstance.HasLowerKana(n)){var o=this.charExInstance.ToLowerKana(n);r=this.IsValid(o);if(r)return o}var i=this.charExInstance.ToKatakana(n);r=this.IsValid(i);if(r)return i;if(this.charExInstance.IsLowerKana(i)){var s=this.charExInstance.ToUpperKana(i);r=this.IsValid(s);if(r)return s}else if(this.charExInstance.HasLowerKana(i)){var o=this.charExInstance.ToLowerKana(i);r=this.IsValid(o);if(r)return o}var u=this.charExInstance.ToHalfWidthEx(i);r=this.IsValid(u);if(r)return u;if(this.charExInstance.IsLowerKana(u)){u=this.charExInstance.ToUpperKana(u),r=this.IsValid(u);if(r)return u}else if(this.charExInstance.HasLowerKana(u)){u=this.charExInstance.ToLowerKana(u),r=this.IsValid(u);if(r)return u}return""}if(this.charExInstance.IsKatakana(n)){if(this.charExInstance.IsLowerKana(n)){var s=this.charExInstance.ToUpperKana(n);r=this.IsValid(s);if(r)return s}else if(this.charExInstance.HasLowerKana(n)){var o=this.charExInstance.ToLowerKana(n);r=this.IsValid(o);if(r)return o}var a=!1,i=n;if(this.charExInstance.IsFullWidth(n)){var f=this.charExInstance.ToHalfWidthEx(n);if(f.GetLength()>0){r=this.IsValid(f);if(r)return f}if(this.charExInstance.IsLowerKana(f)){f=this.charExInstance.ToUpperKana(f),r=this.IsValid(f);if(r)return f}else if(this.charExInstance.HasLowerKana(f)){f=this.charExInstance.ToLowerKana(f),r=this.IsValid(f);if(r)return f}}else{if(t==null){i=this.charExInstance.ToFullWidth(n).text;if(!this.charExInstance.IsKatakana(i))return"";r=this.IsValid(i);if(r)return i}else{if(t+1<e.GetLength()){var l=this.charExInstance.ToFullWidth(e.Substring(t,t+2));i=l.text,a=l.processedAll}else i=this.charExInstance.ToFullWidth(n).text;if(!this.charExInstance.IsKatakana(i))return"";r=this.IsValid(i);if(r)return t++,a&&t++,{index:t,strValue:i}}if(this.charExInstance.IsLowerKana(i)){var s=this.charExInstance.ToUpperKana(i);r=this.IsValid(s);if(r)return s}else if(this.charExInstance.HasLowerKana(i)){var o=this.charExInstance.ToLowerKana(i);r=this.IsValid(o);if(r)return o}}i=this.charExInstance.ToHiragana(i),r=this.IsValid(i);if(r){if(t!=null){t++,a&&t++;var c={index:t,strValue:i};return i=="\u3094"&&(a?c.strValue="\u3046\u309b":c.strValue=""),c}return i=="\u3094"?"":i}if(this.charExInstance.IsLowerKana(i)){var s=this.charExInstance.ToUpperKana(i);r=this.IsValid(s);if(r)return s}else if(this.charExInstance.HasLowerKana(i)){var o=this.charExInstance.ToLowerKana(i);r=this.IsValid(o);if(r)return o}}return n=this.charExInstance.IsFullWidth(n)?this.charExInstance.ToHalfWidth(n):this.charExInstance.ToFullWidth(n).text,r=this.IsValid(n),r?n:""},n}();e.TextFilter=n})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={})),$.wijinputcore=$.wijinputcore||{},$.wijinputcore.validateText=$.wijinputcore.validateText||function(e,t,n){if(n===undefined){var r=new wijmo.input.TextFilter(!1,t),i=r.CheckText(e),s=i.CheckedText;return s===e?!0:!1}var o=e.length;return o<t||o>n?!1:!0};;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijinputtext",i=function(){function e(){}return e.None="none",e.EllipsisEnd="ellipsisEnd",e.EllipsisPath="ellipsisPath",e}(),s;(function(e){e._map=[],e._map[0]="Append",e.Append=0,e._map[1]="Replace",e.Replace=1})(s||(s={}));var o=function(){function e(){}return e.Auto="auto",e.Active="active",e.Disabled="disabled",e.Inactive="inactive",e}(),u=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._getIMTextBox=function(){return this.imtextbox===undefined&&(this.imtextbox=new l(this.element[0],this.outerDiv)),this.imtextbox},r.prototype._create=function(){n.prototype._create.call(this);var e=this;e.imtextbox=e._getIMTextBox()},r.prototype._init=function(){n.prototype._init.call(this),this.options.disableUserInput&&this.imtextbox.SetReadOnly(!0),this.imtextbox.placeHolder=this.options.nullText?this.options.nullText:"";var e=this;this.imtextbox.readingImeStringOutputEvent=function(t,n){e._trigger("readingImeStringOutput",null,n)},this.imtextbox.InvalidInputEvent=function(t,n){e._fireIvalidInputEvent(n)},this.imtextbox.SetAutoConvert(this.options.autoConvert),this.imtextbox.SetExitOnLastChar(this.options.blurOnLastChar),this.imtextbox.SetExitOnLeftRightKey(this.options.blurOnLeftRightKey),this.imtextbox.SetFormat(this.options.format),this.imtextbox.SetMaxLength(this.options.maxLength),this.imtextbox.SetHighlightText(this.options.highlightText),this.imtextbox.SetOverflowTip(this.options.showOverflowTip),this.imtextbox.SetMaxLineCount(this.options.maxLineCount),this.imtextbox.SetCountWrappedLine(this.options.countWrappedLine),this.options.invalidInput!==null&&this.imtextbox.OnInvalidInput(this.options.invalidInput),this.options.keyExit!==null&&this.imtextbox.OnKeyExit(this.options.keyExit),this.imtextbox.TextChangedEvent=function(t,n){e.options.text=n,e._trigger("textChanged",null,{text:n})};var t=this.element,r=this.options.wijCSS,i={input:!0,textarea:!0},s={text:!0,password:!0,email:!0,url:!0},o=t.get(0).nodeName.toLowerCase();if(!i.hasOwnProperty(o))return;if(o==="input"&&this.element.attr("type")&&!s.hasOwnProperty(this.element.attr("type").toLowerCase()))return;if(o==="input"){this.imtextbox.SetMultiLine(!1);if(this.element.attr("type")==="password"){var u;this.options.passwordChar?u=this.options.passwordChar:u=this.imtextbox.SystemPasswordChar(),this.imtextbox.SetPasswordChar(u)}}else o==="textarea"&&this.imtextbox.SetMultiLine(!0);this.imtextbox.SetLengthAsByte(this.options.lengthAsByte),this.options.text===null&&(this.options.text=this.getText()),(this.options.text!==this.imtextbox.placeHolder||!this.imtextbox.isNullText)&&this.setText(this.options.text),this.imtextbox.SetEllipsisString(this.options.ellipsisString),this.imtextbox.SetEllipsis(this.options.ellipsis),t.is(":disabled")?(this._setOption("disabled",!0),t.addClass(r.stateDisabled)):(this._setOption("disabled",!1),t.removeClass(r.stateDisabled)),this.options.passwordChar&&this.imtextbox.SetPasswordChar(this.options.passwordChar)},r.prototype.destroy=function(){var e=this,t=e.options.wijCSS;e.element.removeClass(t.widget).removeClass(t.stateDefault).removeClass(t.cornerAll).removeClass(t.stateHover).removeClass(t.stateActive).off("."+e.widgetName),e.element.off(".imtextbox"),n.prototype.destroy.call(this)},r.prototype.getSelectedText=function(){return this.imtextbox.GetSelectedText()},r.prototype._setOption=function(e,t){switch(e){case"nullText":case"placeholder":this.imtextbox.placeHolder=t}n.prototype._setOption.call(this,e,t);switch(e){case"autoConvert":this.imtextbox.SetAutoConvert(t);break;case"blurOnLastChar":this.imtextbox.SetExitOnLastChar(t);break;case"blurOnLeftRightKey":this.imtextbox.SetExitOnLeftRightKey(t);break;case"showDropDownButton":var r=this.imtextbox.GetEllipsis();this.imtextbox.SetEllipsis(r);break;case"ellipsis":this.imtextbox.SetEllipsis(t);break;case"ellipsisString":this.imtextbox.SetEllipsisString(t);break;case"highlightText":this.imtextbox.SetHighlightText(t);break;case"showOverflowTip":this.imtextbox.SetOverflowTip(t);break;case"format":this.imtextbox.SetFormat(t);break;case"maxLineCount":this.imtextbox.SetMaxLineCount(t);break;case"countWrappedLine":this.imtextbox.SetCountWrappedLine(t);break;case"lengthAsByte":this.imtextbox.SetLengthAsByte(t);break;case"maxLength":this.imtextbox.SetMaxLength(t);break;case"readonly":case"disableUserInput":this.imtextbox.SetReadOnly(t);break;case"passwordChar":this.imtextbox.SetPasswordChar(t);break;case"text":this.setText(t);break;case"invalidInput":this.imtextbox.OnInvalidInput(t);break;case"keyExit":this.imtextbox.OnKeyExit(t);break;case"":}},r.prototype._updateTextOnLostFocus=function(){if(this.imtextbox.PasswordMode)return;n.prototype._updateTextOnLostFocus.call(this)},r.prototype._onMouseUp=function(e){},r.prototype._onCompositionStart=function(){},r.prototype._onCompositionEnd=function(){},r.prototype._onChange=function(){},r.prototype._onPaste=function(e){},r.prototype._onDrop=function(e){},r.prototype._onKeyDown=function(t){var n=this._getKeyCode(t),r=e.getKeyCodeEnum();if(this.options.disableUserInput){n===r.TAB?this._processTabKey(t)&&this._stopEvent(t):this._stopEvent(t);return}if(this._processKeyForDropDownList(t))return;n===r.ENTER&&this._onEnterDown(t)},r.prototype._onKeyPress=function(t){if(this.options.disableUserInput)return;var n=this._getKeyCode(t),r=e.getKeyCodeEnum();n===r.ENTER&&this._onEnterDown(t)},r.prototype._onKeyUp=function(e){if(this.options.disableUserInput){this._raiseTextChanged(),this._raiseDataChanged();return}},r.prototype._createTextProvider=function(){this._textProvider=new f(this)},r.prototype.selectText=function(e,n){typeof e=="undefined"&&(e=0),typeof n=="undefined"&&(n=this.getText().length),isNaN(e)&&(e=0),isNaN(n)&&(n=0);if(this.element.is(":disabled"))return;t.Utility.IsFireFox4OrLater()&&this.focus(),this.imtextbox.SetSelection(e,n)},r.prototype._updateText=function(){this.element.data("initialized")&&n.prototype._updateText.call(this)},r}(t.wijinputcore);t.wijinputtext=u;var a=function(){function e(){this.initSelector=":jqmData(role='wijinput')",this.wijCSS={},this.autoConvert=!0,this.blurOnLastChar=!1,this.blurOnLeftRightKey="none",this.ellipsis=i.None,this.ellipsisString=String.fromCharCode(8230),this.showOverflowTip=!1,this.highlightText=!1,this.format="",this.imeMode="auto",this.lengthAsByte=!1,this.maxLength=0,this.maxLineCount=0,this.countWrappedLine=!1,this.passwordChar="",this.text=null,this.allowSpinLoop=!1,this.spinnerAlign="verticalRight",this.showSpinner=!1,this.culture="",this.readingImeStringOutput=null}return e}();u.prototype.options=n.extend(!0,{},t.wijinputcore.prototype.options,new a),n.wijmo.registerWidget(r,u.prototype);var f=function(){function e(e){this.inputWidget=e}return e.prototype.toString=function(e){return this.inputWidget._showNullText()&&!this.inputWidget.isFocused()&&this.isValueNull()?(this.inputWidget.element.data("isShowNullText",!0),this.inputWidget.options.nullText):(!this.inputWidget._showNullText()||this.inputWidget.isFocused())&&this.inputWidget.element.data("isShowNullText")?(this.inputWidget.element.data("isShowNullText",!1),""):this.inputWidget.imtextbox&&this.inputWidget.imtextbox.GetPasswordChar()?e?this.inputWidget.options.text:this.inputWidget.imtextbox._getInputValueWithPlaceHolder():this.inputWidget.imtextbox?this.inputWidget.imtextbox._getInputValueWithPlaceHolder():this.inputWidget.options.text!==undefined?this.inputWidget.options.text:this.inputWidget.element.val()},e.prototype.isValueNull=function(){return this.inputWidget.imtextbox?this.inputWidget.imtextbox.isNullText:!0},e.prototype.setText=function(e){this.inputWidget.imtextbox.SetText(e)},e.prototype.replaceWith=function(e,n){var r=e.start,i=new t.wijInputResult;return e.start<e.end&&(this.removeAt(e.start,e.end-1,i,!0),r=i.testPosition),this.insertAt(n,r,i)?i:null},e.prototype.insertAt=function(e,t,n){},e.prototype.removeAt=function(e,t,n,r){},e}();t.wijInputTextProvider=f;var l=function(){function e(e,n){this.ToolTip=null,this.placeHolder="",this.Focused=!1,this.InputElement=e,this._container=n,this.InputElement.id===""&&(this.InputElement.id="wijmo_input_"+t.Utility.IdCounter++),this.ScrollBarMode=t.ScrollBarMode.Fixed,this.IsControlInPreview=null,this.AddressObj=null,this.KeyActionList=null,this.UseSystemPasswordChar=!1,this.Overwrite=!1,this.Format="",this.ShowHistory=!1,this.ReadOnly=!1,this.AutoConvert=!0,this.CausesValidation=!1,this.ValidationGroup="",this.LengthAsByte=!1,this.MaxLength=0,this.MaxHistoryCount=10,this.MultiLine=!1,this.AcceptsCrLf=t.CrLfMode.NoControl,this.AcceptReturn=!0,this.AcceptTab=!1,this.HighlightText=!1,this.Ellipsis=i.None,this.EllipsisString=String.fromCharCode(8230),this.ExitOnLastChar=!1,t.Utility.IPad?this.TouchDropDownScale=1:this.TouchDropDownScale=1.5,this.ExitOnLeftRightKey=t.ExitOnLeftRightKey.None,this.EditMode=t.EditMode.Insert,this.__editModeInternal=t.EditMode.Insert,this.AutoPostBack=!1,this.PasswordMode=!1,this.PasswordChar="",this.OverflowTip=!1,this.MaxLineCount=0,this.CountWrappedLine=!1,this.IsInUpdatePanelAndAsyncPostBack=!1,this.UseClipboard=!0,this.ReadingImeStringOutput=new Object,this.ReadingImeStringOutput.OutputMode=s.Append,this.ReadingImeStringOutput.TargetControl=null,this.ScrollBars=t.ScrollBars.None,this.prevval="",this.RubyText="",this.FocusType=t.FocusType.None,this.SelectionStart=0,this.SelectionEnd=0,this.SelectionLength=0,this.OldSelectionStart=this.SelectionStart,this.OldSelectionEnd=this.SelectionEnd;var r=this,u=r!=null;this.IsInUpdatePanelAndAsyncPostBack?u&&(this.OldText=r.GetOldValue()):this.OldText=this.Text,this.LastStart=this.SelectionStart,this.LastEnd=this.SelectionEnd,this.Text="",this.LastText=this.Text,this.BuffText="",this.IsUndoAfterDel=!1,this.MouseButton=t.MouseButton.Left,this.EnableOnSelectStartEvent=!0,this.isLeftMouseButtonPressed=!1,this.OrientText="",this.ImeSelect=!1,this.ImeSelectTimes=0,this.DragEdit=!1,this.DropEdit=!1,this.isFuncKeyPressed=!1,this.SystemChange=!0,this.ImeMode=!1,this.KeyDownAction=!1,this.FocusExit=!1,this.lastValue="",this.truePosition=-1,this.mouseupTimes=0,this.LastInputText="",this.BeforeDragSelectionStart=0,this.BeforeDragSelectionEnd=0,this.IsMouseDown=!1,this.Type="Edit",this.ToolTip=null;if(!this.MultiLine&&this.OverflowTip){var a=this;t.Utility.AttachEvent(document,"mousemove",function(e){t.GlobalEventHandler.OnMouseMove(a,e)},!1)}this.HasFocus=!1;var f={SelectionStart:this.SelectionStart,SelectionEnd:this.SelectionEnd,Text:this.Text,OldSelectionStart:this.OldSelectionStart,OldSelectionEnd:this.OldSelectionEnd,OldText:this.OldText,LastStart:this.LastStart,LastEnd:this.LastEnd,LastText:this.LastText,BuffText:this.BuffText};this.DropDownEditData=f,this.IsChangedByDropDownEdit=!1,this.DropText="",this.isTextEllipsis=!1,this.TextHeadLength=0,this.IsJapanConvertKeyPress=!1,this.NeedReCalCursorPos=!0,t.Utility.IsIE()||(this.IsActive=!1),this.HasValidatedImeInput=!0,this.IsFocusToDropDownEdit=!1,this.IsCausedByClickingDropDownBt=!1,this.IsCausedByImplementingDrop=!1,t.Utility.IsIE()||(this.MaxLineCount=0,this.Ellipsis=i.None,this.OverflowTip=!1,this.IsImplementImeInput=!1),this.Create(),this.AddAllEventsHandler(),this.EditStatusChangedEvent=null,this.InvalidInputEvent=null,this.KeyExitEvent=null,this.TextChangedEvent=null,this.DropDownCloseEvent=null,this.DropDownOpenEvent=null,this.readingImeStringOutputEvent=null,this.IsjQueryControl=!0,this.UIProcess=new c(this.AutoConvert,this.Format,this.PasswordMode,this.PasswordChar,this.IsjQueryControl,this),this.Text="",this.isPasting=!1,this.WordWrap=!0,this.Enabled=!0,this.AutoCompleteType="None",this.InputElement.style.imeMode===""&&this.SetImeMode(o.Auto),this._autoComplete=new h(this),this.IsFromServer=!1,this._historyList=[],this.IsFromServer?this.EnableAutoComplete=this.ShowHistory&&this.AutoCompleteType!="Disabled"&&!this.ReadOnly&&this.Enabled:this.EnableAutoComplete=this.ShowHistory&&!this.ReadOnly&&this.Enabled,this._lines=[],this.tempIMEMode="auto",this.HeightChangedBySet=!1,this.Width="",this.Height="",this.LastPassWordChar="",t.Utility.AttachFocusEventOfDocument(),this.ShouldShowClearButton=!0,this.switchPasswordChar=!1,this.InputElement.value===""?this.isNullText=!0:this.isNullText=!1}return e.prototype.GetId=function(){return this.InputElement.id},e.prototype.GetContainer=function(){return this._container},e.prototype.GetJQueryInputElement=function(){return n(this.InputElement)},e.prototype.GetInputElement=function(){return this.InputElement},e.prototype.Create=function(){t.Utility.IsIE10OrLater()&&this.CreateHideMSClearButtonForIE10Class()},e.prototype.CreateHideMSClearButtonForIE10Class=function(){if(e.HideMSClearButtonForIE10ClassName===undefined){e.HideMSClearButtonForIE10ClassName="gcsh_HideMSClearButtonForIE10";var n=t.Utility.CreateClassStyle(e.HideMSClearButtonForIE10ClassName+"::-ms-clear");n.style.display="none"}},e.prototype.IsNullFormat=function(){return!1},e.prototype.IsNeedFishEyeButton=function(){return t.Utility.IsIE10OrLater()&&!this.MultiLine&&this.PasswordMode},e.prototype.SetAddressObj=function(e){this.AddressObj=e},e.prototype.ShowClearButton=function(){this.InputElement.className=this.InputElement.className.replace(e.HideMSClearButtonForIE10ClassName,"")},e.prototype.HideClearButton=function(){this.InputElement.className!=null&&this.InputElement.className.indexOf(e.HideMSClearButtonForIE10ClassName)==-1&&(this.InputElement.className+=" "+e.HideMSClearButtonForIE10ClassName)},e.prototype.HandleClearButton=function(e){if(t.Utility.IsIE10OrLater()&&this.FocusedWhenMouseDown&&this.MouseDownOnClearButton&&e.target==this.InputElement&&!this.MultiLine){var n=document.activeElement==e.target,r=t.Utility.IsMouseDownOnClearButton(e);if(this.MouseUpHasValue&&n&&r){var i=this;setTimeout(function(e){i.Clear()},0)}}},e.prototype.GetAcceptsTab=function(){return this.AcceptTab},e.prototype.SetAcceptsTab=function(e){e=t.Utility.CheckBool(e),this.AcceptTab=e},e.prototype.GetAcceptsCrlf=function(){return this.AcceptsCrLf},e.prototype.SetAcceptsCrlf=function(e){e=t.Utility.CheckEnum(t.CrLfMode,e),this.AcceptsCrLf=e},e.prototype.GetAutoConvert=function(){return this.AutoConvert},e.prototype.SetAutoConvert=function(e){e=t.Utility.CheckBool(e),this.AutoConvert=e,this.UIProcess.Reset()},e.prototype.GetCountWrappedLine=function(){return this.CountWrappedLine},e.prototype.SetCountWrappedLine=function(e){e=t.Utility.CheckBool(e),this.CountWrappedLine=e,this.InternalSetText(this.GetText()),this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetEditMode=function(){return this.EditMode},e.prototype.SetEditMode=function(e){var n=e;n=t.Utility.CheckEnum(t.EditMode,n),n===t.EditMode.Insert||n===t.EditMode.FixedInsert?this.Overwrite=!1:this.Overwrite=!0;if(n!==this.EditMode){var r=!1;this._isinsertGroup(n)&&this._isOverwriteGroup(this.EditMode)?r=!0:this._isinsertGroup(this.EditMode)&&this._isOverwriteGroup(n)&&(r=!0),this.EditMode=n,this.__editModeInternal=n,r&&this.UIProcess.FireEvent(this,this.EditStatusChangedEvent,null,"EditStatusChanged")}},e.prototype._getEditModeInternal=function(){return this.__editModeInternal},e.prototype._setEditModeInternal=function(e){e=t.Utility.CheckEnum(t.EditMode,e),e===t.EditMode.Insert||e===t.EditMode.FixedInsert?this.Overwrite=!1:this.Overwrite=!0,e!==this.__editModeInternal&&(this.__editModeInternal=e)},e.prototype.GetEllipsis=function(){return this.Ellipsis},e.prototype.SetEllipsis=function(e){var n=e;n=t.Utility.CheckEnum(i,n),this.Ellipsis=n,this.InternalDirectSetText(this.Text),this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetEllipsisString=function(){return this.EllipsisString},e.prototype.SetEllipsisString=function(e){e=t.Utility.CheckString(e),this.EllipsisString=e,this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetExitOnLastChar=function(){return this.ExitOnLastChar},e.prototype.SetExitOnLastChar=function(e){e=t.Utility.CheckBool(e),this.ExitOnLastChar=e},e.prototype.GetExitOnLeftRightKey=function(){switch(this.ExitOnLeftRightKey){case t.ExitOnLeftRightKey.None:return"none";case t.ExitOnLeftRightKey.Both:return"both";case t.ExitOnLeftRightKey.Left:return"left";case t.ExitOnLeftRightKey.Right:return"right";default:}},e.prototype.SetExitOnLeftRightKey=function(e){t.Utility.CheckString(e);switch(e.toLowerCase()){case"none":this.ExitOnLeftRightKey=t.ExitOnLeftRightKey.None;break;case"both":this.ExitOnLeftRightKey=t.ExitOnLeftRightKey.Both;break;case"left":this.ExitOnLeftRightKey=t.ExitOnLeftRightKey.Left;break;case"right":this.ExitOnLeftRightKey=t.ExitOnLeftRightKey.Right;break;default:}},e.prototype.GetFormat=function(){return this.Format},e.prototype.SetFormat=function(e){e=t.Utility.CheckString(e),this.Format=e,this.UIProcess.Reset();var n=this.InternalSetText(this.GetText());this.Text=n,this.DropDownEditData.Text=n,this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetHighlightText=function(){return this.HighlightText},e.prototype.SetHighlightText=function(e){e=t.Utility.CheckBool(e),this.HighlightText=e},e.prototype.GetHistoryList=function(){return this._historyList},e.prototype.SetHistoryList=function(e){if(e===null)return;var t;arguments[0]instanceof Array?t=arguments[0]:t=Array.prototype.slice.call(arguments);if(t.length===0||t.length===1&&t[0]==="")return;this.IsFromServer=!1,this._historyList=[];for(var n=0;n<t.length;n++)this._historyList.push(t[n])},e.prototype.GetImeMode=function(){return this.InputElement!==null?this.InputElement.style.imeMode||"auto":""},e.prototype.SetImeMode=function(e){t.Utility.CheckString(e),this.InputElement!==null&&(this.InputElement.style.imeMode=e)},e.prototype.GetLengthAsByte=function(){return this.LengthAsByte},e.prototype.SetLengthAsByte=function(e){e=t.Utility.CheckBool(e),this.LengthAsByte=e,this.SetText(this.UIProcess.Filter.CheckText(this.GetText()).CheckedText)},e.prototype.GetLines=function(){var e=new Array,n=this.GetText(),r="\r\n";if(!t.Utility.IsIE()||t.Utility.IsIE9OrLater())r="\n";var i=n.IndexOf(r),s=0;while(i!=-1)e[s++]=n.Substring(0,i),n=n.Substring(i+r.GetLength(),n.GetLength()),i=n.IndexOf(r);return e[s]=n,e},e.prototype.SetLines=function(e){if(e===null)return;var n;arguments[0]instanceof Array?n=arguments[0]:n=Array.prototype.slice.call(arguments);if(n.length===0||n.length===1&&n[0]==="")return;this._lines=[];for(var r=0;r<n.length;r++)this._lines.push(n[r]);var i="";if(this.MultiLine)for(var s=0;s<this._lines.length;s++)s>0&&(t.Utility.IsIE()?i+="\r\n":i+="\n"),i+=this._lines[s];else for(var s=0;s<this._lines.length;s++)i+=this._lines[s];this.SetText(i)},e.prototype.GetMaxHistoryCount=function(){return this.MaxHistoryCount},e.prototype.SetMaxHistoryCount=function(e){e=t.Utility.CheckInt(e);if(e<0)throw"ArgumentOutOfRangeException";this.MaxHistoryCount=e},e.prototype.GetMaxLength=function(){return this.MaxLength},e.prototype.SetMaxLength=function(e){e=t.Utility.CheckInt(e);if(e<0)throw"ArgumentOutOfRangeException";this.MaxLength=e,this.InternalSetText(this.GetText()),this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.DropDownEditData.Text=this.GetText()},e.prototype.GetMaxLineCount=function(){return this.MaxLineCount},e.prototype.SetMaxLineCount=function(e){e=t.Utility.CheckInt(e);if(e<0)throw"ArgumentOutOfRangeException";this.MaxLineCount=e,this.InternalSetText(this.GetText()),this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetMultiLine=function(){return this.MultiLine},e.prototype.SetMultiLine=function(e){e=t.Utility.CheckBool(e);if(e===this.MultiLine)return;this.MultiLine=e,this.InternalDirectSetText(this.Text),this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.DropDownEditData.Text=this.GetText()},e.prototype.GetOverflowTip=function(){return this.OverflowTip},e.prototype.SetOverflowTip=function(e){e=t.Utility.CheckBool(e),this.OverflowTip=e},e.prototype.GetOverwrite=function(){return this.Overwrite},e.prototype.GetPasswordChar=function(){return this.PasswordChar},e.prototype.SetPasswordChar=function(e){if(e!==""){e=t.Utility.CheckChar(e);if(this.PasswordChar===this.SystemPasswordChar()&&this.GetUseSystemPasswordChar()){this.LastPassWordChar=e;return}this.LastPassWordChar=this.PasswordChar,this.PasswordChar=e,this.PasswordMode=!0,this.isNullText||this.InternalSetText(this.GetText()),this.tempIMEMode=this.GetImeMode(),this.SetImeMode(o.Disabled)}else{this.UseSystemPasswordChar===!1&&(this.PasswordMode=!1,this.SetText(this.hideText),this.tempIMEMode!==""&&this.SetImeMode(this.tempIMEMode));if(this.PasswordChar===this.SystemPasswordChar()&&!this.GetUseSystemPasswordChar()&&this.LastPassWordChar!==""){this.PasswordChar=t.Utility.CheckChar(this.LastPassWordChar),this.PasswordMode=!0,this.InternalSetText(this.GetText()),this.tempIMEMode=this.GetImeMode(),this.SetImeMode(o.Disabled),this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement);return}this.PasswordChar=e}this.switchPasswordChar=!0,this.UIProcess.Reset(),this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetReadingImeStringOutputMode=function(){return this.ReadingImeStringOutput.OutputMode},e.prototype.SetReadingImeStringOutputMode=function(e){e=t.Utility.CheckString(e),this.ReadingImeStringOutput.OutputMode=e},e.prototype.GetReadingImeStringOutputTargetControl=function(){return this.ReadingImeStringOutput.TargetControl},e.prototype.SetReadingImeStringOutputTargetControl=function(e){e=t.Utility.CheckString(e),this.ReadingImeStringOutput.TargetControl=e},e.prototype.GetReadOnly=function(){return this.ReadOnly},e.prototype.SetReadOnly=function(e){e=t.Utility.CheckBool(e),this.InputElement!=null&&(this.InputElement.readOnly=e),this.ReadOnly=e,this.IsFromServer?this.EnableAutoComplete=this.ShowHistory&&this.AutoCompleteType!="Disabled"&&!this.ReadOnly&&e:this.EnableAutoComplete=this.ShowHistory&&!this.ReadOnly&&e},e.prototype.GetScrollBarMode=function(){return this.ScrollBarMode},e.prototype.SetScrollBarMode=function(e){e=t.Utility.CheckEnum(t.ScrollBarMode,e),this.ScrollBarMode=e,this._CheckScrollBar(this.GetScrollBars(),e)},e.prototype.GetScrollBars=function(){return this.ScrollBars},e.prototype.SetScrollBars=function(e){e=t.Utility.CheckEnum(t.ScrollBars,e),this.ScrollBars=e,this._CheckScrollBar(e,this.GetScrollBarMode());var n=this.InputElement.style.width;this.InputElement.style.width=parseInt(this.InputElement.style.width)-5+"px";var r=this;setTimeout(function(){r.InputElement.style.width=n},10)},e.prototype.GetSelectionStart=function(){return Math.min(this.SelectionStart,this.SelectionEnd)},e.prototype.SetSelectionStart=function(e){e=t.Utility.CheckInt(e);if(e<0)throw"ArgumentOutOfRangeException";if(e==null)return;var n=e.toString(),r=parseInt(n);if(t.Utility.FilterText("0123456789",n)==n)if(r>this.GetText().GetLength())this.SelectionStart=this.GetText().GetLength(),this.SelectionEnd=this.GetText().GetLength(),this.MultiLine||(this.DropDownEditData.SelectionStart=this.DropDownEditData.Text.GetLength(),this.DropDownEditData.SelectionEnd=this.DropDownEditData.Text.GetLength());else{var i=this.GetSelectionLength();this.SelectionStart=r,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,r)),r-0+i<=this.GetText().GetLength()?(this.SelectionEnd=r-0+i,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,r+i))):(this.SelectionEnd=this.GetText().GetLength(),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.DropDownEditData.Text.GetLength()))}},e.prototype.GetSelectedText=function(){return this.GetText().Substring(Math.min(this.SelectionStart,this.SelectionEnd),Math.max(this.SelectionStart,this.SelectionEnd))},e.prototype.SetSelectedText=function(e){e=t.Utility.CheckString(e),this.OldText=this.GetText();var n=this.SelectionStart,r=this.SelectionEnd,s=this.GetText();this.MultiLine||(this.DropDownEditData.OldText=this.DropDownEditData.Text,n=this.DropDownEditData.SelectionStart,r=this.DropDownEditData.SelectionEnd,s=this.DropDownEditData.Text);var o=this.UIProcess.TextBoxPaste(n,r,s,this.ExitOnLastChar,this.AcceptTab,this.AcceptReturn,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.MultiLine,e,!0);o==null,o.Text!=null&&(this.DirectSetText(o.Text),this.MultiLine||(this.DropDownEditData.Text=o.Text)),o.SelectionStart!=null&&(this.SelectionStart=o.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=o.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(this.DropDownEditData.Text,o.SelectionStart))),o.SelectionEnd!=null&&(this.SelectionEnd=o.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=o.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(this.DropDownEditData.Text,o.SelectionEnd)));var u=this.OldText;this.OldText=this.GetText(),this.LastText=this.OldText,this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.LastText=this.DropDownEditData.OldText,this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetSelectionLength=function(){return Math.abs(this.SelectionEnd-this.SelectionStart)},e.prototype.SetSelectionLength=function(e){e=t.Utility.CheckInt(e);if(e<0)throw"ArgumentOutOfRangeException";e==null,e=e.toString();if(t.Utility.FilterText("0123456789",e)==e){var n=this.GetSelectionStart();this.SelectionStart=n,n+(e-0)<=this.GetText().GetLength()?(this.SelectionEnd=n+(e-0),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,n+parseInt(e)))):(this.SelectionEnd=this.GetText().GetLength(),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.DropDownEditData.Text.GetLength()))}},e.prototype.GetShowHistory=function(){return this.ShowHistory},e.prototype.SetShowHistory=function(e){e=t.Utility.CheckBool(e),this.ShowHistory=e,this.IsFromServer?this.EnableAutoComplete=this.ShowHistory&&this.AutoCompleteType!="Disabled"&&!this.ReadOnly&&this.Enabled:this.EnableAutoComplete=this.ShowHistory&&!this.ReadOnly&&this.Enabled},e.prototype.GetText=function(){var e=this._getInputValueWithPlaceHolder();this.isTextEllipsis&&!this.DragEdit&&(e=this.Text);if(this.PasswordMode){var n=this.hideText,r=n.LastIndexOf(":true"),i;return r==-1?i=n:i=n.Substring(0,r),i}return!t.Utility.IsIE()&&this.FFDragFlag&&(e=this.Text),e},e.prototype.SetText=function(e){e=t.Utility.CheckString(e),this.OldText=this.GetText(),this.switchPasswordChar=!1,this.InternalSetText(e,!1),this.GetText()!=this.OldText&&(this.OldText=this.GetText(),this.SetHideText(this.GetText())),this.LastText=this.GetText();var n=this.GetText().GetLength();this.SelectionStart=n,this.SelectionEnd=n,this.BuffText=this.LastText,this.DropDownEditData.Text=this.GetText(),this.DropDownEditData.LastText=this.DropDownEditData.Text,this.DropDownEditData.SelectionStart=n,this.DropDownEditData.SelectionEnd=n,this.DropDownEditData.BuffText=this.DropDownEditData.Text,this.Ellipsis!==i.None&&this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.GetTouchDropDownScale=function(){return this.TouchDropDownScale},e.prototype.SetTouchDropDownScale=function(e){e=t.Utility.CheckFloat(e,.25,4),this.TouchDropDownScale=e},e.prototype.GetUseClipboard=function(){return this.UseClipboard},e.prototype.SetUseClipboard=function(e){e=t.Utility.CheckBool(e),this.UseClipboard=e},e.prototype.GetUseSystemPasswordChar=function(){return this.UseSystemPasswordChar},e.prototype.SetUseSystemPasswordChar=function(e){e=t.Utility.CheckBool(e),this.UseSystemPasswordChar=e,e===!0?(this.PasswordMode=!0,this.SetPasswordChar(this.SystemPasswordChar())):this.SetPasswordChar(""),this.UIProcess.Reset()},e.prototype.GetWordWrap=function(){return this.WordWrap},e.prototype.SetWordWrap=function(e){e=t.Utility.CheckBool(e),this.WordWrap=e,e===!1?this.InputElement.style.wordWrap="normal":this.InputElement.style.wordWrap="break-word";var n=this.InputElement.style.width;this.InputElement.style.width=parseInt(this.InputElement.style.width)-5+"px";var r=this;setTimeout(function(){r.InputElement.style.width=n},10),this._CheckScrollBar(this.GetScrollBars(),this.GetScrollBarMode())},e.prototype.Drop=function(){},e.prototype.Clear=function(){this.SetText("")},e.prototype.SetFocus=function(){},e.prototype.OnDropDownClose=function(e){e=t.Utility.CheckFunction(e),this.DropDownCloseEvent=e},e.prototype.OnDropDownOpen=function(e){e=t.Utility.CheckFunction(e),this.DropDownOpenEvent=e},e.prototype.OnEditStatusChanged=function(e){e=t.Utility.CheckFunction(e),this.EditStatusChangedEvent=e},e.prototype.OnInvalidInput=function(e){e=t.Utility.CheckFunction(e),this.InvalidInputEvent=e,this.UIProcess.InvalidInputEvent=e},e.prototype.OnKeyExit=function(e){e=t.Utility.CheckFunction(e),this.KeyExitEvent=e},e.prototype.OnTextChanged=function(e){e=t.Utility.CheckFunction(e),this.TextChangedEvent=e},e.prototype.Undo=function(){var e=this.GetText(),t=this.BuffText,n=this.LastText,r=this.LastSelectionStart,i=this.LastSelectionEnd;this.MultiLine||(e=this.DropDownEditData.Text,t=this.DropDownEditData.BuffText,n=this.DropDownEditData.LastText,r=this.DropDownEditData.LastSelectionStart,i=this.DropDownEditData.LastSelectionEnd);var s=this.UIProcess.TextBoxUndo(e,t,n,r,i);if(s==null)return!1;s.Text!=null&&(s.DelInclude?(this.BuffText=this.Text,this.IsUndoAfterDel=!0,this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)):(this.LastText=this.Text,this.MultiLine||(this.DropDownEditData.LastText=this.DropDownEditData.Text)),this.InternalSetText(s.Text,!0)),s.SelectionStart!=null&&(this.LastSelectionStart=this.SelectionStart,this.SelectionStart=s.SelectionStart,this.MultiLine||(this.DropDownEditData.LastSelectionStart=this.DropDownEditData.SelectionStart,this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(s.Text,s.SelectionStart))),s.SelectionEnd!=null&&(this.LastSelectionEnd=this.SelectionEnd,this.SelectionEnd=s.SelectionEnd,this.MultiLine||(this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.SelectionEnd,this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(s.Text,s.SelectionEnd))),s.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)},e.prototype.Cut=function(){var e=this.SelectionStart,t=this.SelectionEnd,n=this.GetText();this.MultiLine||(e=this.DropDownEditData.SelectionStart,t=this.DropDownEditData.SelectionEnd,n=this.DropDownEditData.Text);var r=this.UIProcess.Cut(n,e,t);if(r==null)return!1;r.SelectionStart!=null&&(this.SelectionStart=r.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(r.Text,r.SelectionStart))),r.SelectionEnd!=null&&(this.SelectionEnd=r.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(r.Text,r.SelectionEnd))),r.DelInclude&&(this.IsUndoAfterDel=!0,this.BuffText=this.GetText(),this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)),r.Text!=null&&(this.DirectSetText(r.Text),this.MultiLine||(this.DropDownEditData.Text=r.Text)),r.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd),r.EventInfo!=null&&this.UIProcess.FireEvent(this,r.EventInfo.Name,r.EventInfo.Args,r.EventInfo.Type)},e.prototype.Copy=function(){this.PasswordMode||this.UIProcess.Copy(this.GetText(),this.SelectionStart,this.SelectionEnd)},e.prototype.Delete=function(){var e=this.SelectionStart,t=this.SelectionEnd,n=this.GetText();this.MultiLine||(e=this.DropDownEditData.SelectionStart,t=this.DropDownEditData.SelectionEnd,n=this.DropDownEditData.Text);var r=this.UIProcess.Delete(this.MultiLine,n,e,t);if(r==null)return!1;r.DelInclude&&(this.BuffText=this.Text,this.IsUndoAfterDel=!0,this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)),r.SelectionStart!=null&&(this.SelectionStart=r.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(r.Text,r.SelectionStart))),r.SelectionEnd!=null&&(this.SelectionEnd=r.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(r.Text,r.SelectionEnd))),r.Text!=null&&(this.DirectSetText(r.Text),this.MultiLine||(this.DropDownEditData.Text=r.Text)),r.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)},e.prototype.Paste=function(e){var t=this.SelectionStart,n=this.SelectionEnd,r=this.GetText();this.MultiLine||(t=this.DropDownEditData.SelectionStart,n=this.DropDownEditData.SelectionEnd,r=this.DropDownEditData.Text);var i=this.UIProcess.TextBoxPaste(t,n,r,this.ExitOnLastChar,this.AcceptTab,this.AcceptReturn,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.MultiLine,e,!1);if(i==null)return!1;i.SelectionStart!=null&&(this.SelectionStart=i.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(i.Text,i.SelectionStart))),i.SelectionEnd!=null&&(this.SelectionEnd=i.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(i.Text,i.SelectionEnd))),i.Text!=null&&(this.DirectSetText(i.Text),this.MultiLine||(this.DropDownEditData.Text=i.Text)),i.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd);if(i.EventInfo!=null)for(var s=0;s<i.EventInfo.length;s++)i.EventInfo[s]!=null&&this.UIProcess.FireEvent(this,i.EventInfo[s].Name,i.EventInfo[s].Args,i.EventInfo[s].Type)},e.prototype.SelectAll=function(){var e=this.GetText();this.MultiLine||(e=this.DropDownEditData.Text);var t=this.UIProcess.TextBoxSelectAll(e);if(t==null)return!1;t.SelectionStart!=null&&(this.SelectionStart=t.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(e,t.SelectionStart))),t.SelectionEnd!=null&&(this.SelectionEnd=t.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(e,t.SelectionEnd))),t.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)},e.prototype._CheckScrollBar=function(e,n){switch(e){case t.ScrollBars.Both:n==t.ScrollBarMode.Automatic?(this.InputElement.style.overflowX="auto",this.InputElement.style.overflowY="auto"):(this.InputElement.style.overflowX=this.GetWordWrap()?"auto":"scroll",this.InputElement.style.overflowY="scroll");break;case t.ScrollBars.None:this.InputElement.style.overflowX="hidden",this.InputElement.style.overflowY="hidden";break;case t.ScrollBars.Vertical:n==t.ScrollBarMode.Automatic?(this.InputElement.style.overflowX="hidden",this.InputElement.style.overflowY="auto"):(this.InputElement.style.overflowX="hidden",this.InputElement.style.overflowY="scroll");break;case t.ScrollBars.Horizontal:this.InputElement.style.overflowY="hidden",n==t.ScrollBarMode.Automatic?this.InputElement.style.overflowX="auto":this.InputElement.style.overflowX=this.GetWordWrap()?"auto":"scroll"}if(t.Utility.safari||t.Utility.chrome){var r=this.InputElement.style.width;this.InputElement.style.width=parseInt(this.InputElement.style.width)-1+"px";var i=this;setTimeout(function(){i.InputElement.style.width=r},0)}t.Utility.IPad&&(this.InputElement.style.webkitOverflowScrolling="touch"),this.InternalSetText(this.GetText())},e.prototype.Select=function(){if(this._isInnerKeyPressCall){delete this._isInnerKeyPressCall;return}this.SelectionStart=t.Utility.GetSelectionStartPosition(this.InputElement),this.SelectionEnd=this.SelectionStart+t.Utility.GetSelectionText(this.InputElement).GetLength(),this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))},e.prototype._IMSetSelection=function(e,n,r,i){var s={start:n,end:r};if(n>r){var o=n;n=r,r=o}if(t.Utility.IsIE())try{var u=e.createTextRange();if(!i){var a=e.value.GetStandardPosition(n);r=e.value.GetStandardPosition(r,a-n),n=a,r=e.value.length-r,u.moveEnd("character",-1*parseInt(r)),u.moveStart("character",parseInt(n)),t.Utility.InnerSelect=!0,u.select(),t.Utility.InnerSelect=!1}else{var f=e.value,l=0,c=0,h=0,p=f.lastIndexOf("\r\n");while(p!=-1)l++,p>=n&&c++,p>=r&&h++,f=f.substring(0,p),p=f.lastIndexOf("\r\n");c=l-c;var a=n;r=r,n=a-c,r=e.value.length-r-h,u.moveEnd("character",-1*parseInt(r)),u.moveStart("character",parseInt(n)),t.Utility.InnerSelect=!0,u.select(),t.Utility.InnerSelect=!1}}catch(d){}else{var a=n;r=r,n=a;try{var v=parseInt(n),m=parseInt(r);(e.selectionStart!=v||e.selectionEnd!=m)&&e.setSelectionRange(v,m)}catch(d){}}var g=e.value.substring(0,v),y=t.Utility.MeasureText(g,e).Width,b=e.scrollHeight,w=e.clientWidth,E=e.currentStyle||window.getComputedStyle(e,null);w-=parseInt(E.paddingLeft)+parseInt(E.paddingRight);var S=e.clientHeight;return S-=parseInt(E.paddingTop)+parseInt(E.paddingBottom),t.Utility.IsIE10OrLater()&&(w-=S),e.scrollLeft>y?e.scrollLeft=y:y>e.scrollLeft+w&&(e.scrollLeft=y-w+parseInt(E.paddingLeft)),e.scrollTop>b?e.scrollTop=b:b>e.scrollTop+S&&(e.scrollTop=b-S+parseInt(E.paddingTop)),s},e.prototype.SetSelection=function(e,t){this.MultiLine?this._IMSetSelection(this.InputElement,e,t,!0):this._IMSetSelection(this.InputElement,e,t),this.SelectionStart=e,this.SelectionEnd=t,this.DropDownEditData.SelectionStart=e,this.DropDownEditData.SelectionEnd=t},e.prototype.InternalSetSelection=function(e,t){this.MultiLine?this._IMSetSelection(this.InputElement,e,t,!0):(this._IMSetSelection(this.InputElement,e,t),this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,e),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,t)),this.SelectionStart=e,this.SelectionEnd=t},e.prototype.SetInnerSelectionStart=function(e){this.SelectionStart=e,this.DropDownEditData.SelectionStart=e},e.prototype.SetInnerSelectionEnd=function(e){this.SelectionEnd=e,this.DropDownEditData.SelectionEnd=e},e.prototype.GetTrueSelection=function(e,t,n,r){var i=new Object;return i.SelectionStart=e,i.SelectionEnd=t,this.isTextEllipsis?(i.SelectionStart=this.GetTruePosition(e,n,r,this.TextHeadLength),e==t?i.SelectionEnd=i.SelectionStart:i.SelectionEnd=this.GetTruePosition(t,n,r,this.TextHeadLength),i):i},e.prototype.DropDownListValidate=function(e){var t=e,n=new Array;for(var r=0,i=0;r<t.length;r++){var s=t[r];if(this.UIProcess.ListValidateCheck(t[r])){this.MaxLength!=0&&(s=this.UIProcess.MaxLengthCheck(s,this.MaxLength,this.LengthAsByte));if(this.MaxLineCount!=0&&this.MultiLine)if(this.PasswordMode){var o=this.UIProcess.GetPasswordText(s,this.PasswordChar,this.MultiLine);o=this.UIProcess.MaxLineCheck("","",o,this.MaxLineCount,this.CountWrappedLine),s=s.Substring(0,o.GetLength())}else s=this.UIProcess.MaxLineCheck("","",s,this.MaxLineCount,this.CountWrappedLine);s==t[r]&&(n[i]=t[r],i++)}}return n},e.prototype.SystemPasswordChar=function(){var e=t.Utility.GetClientOS();switch(e.toLowerCase()){case"win2000":return"*";case"win2003":case"winxp":case"vista":case"win7":case"win8":return"\u25cf";default:return"*"}},e.prototype.InternalSetText=function(e,n,r){var i=this.UIProcess.FormatCheck(e,this.AcceptTab,this.AcceptReturn),s=i;this.MaxLength!=0&&(s=this.UIProcess.MaxLengthCheck(i,this.MaxLength,this.LengthAsByte));if(this.MaxLineCount!=0&&this.MultiLine)if(this.PasswordMode){var o=this.UIProcess.GetPasswordText(s,this.PasswordChar,this.MultiLine);o=this.UIProcess.MaxLineCheck("","",o,this.MaxLineCount,this.CountWrappedLine),s=s.Substring(0,o.GetLength())}else s=this.UIProcess.MaxLineCheck("","",s,this.MaxLineCount,this.CountWrappedLine);return r&&(t.Utility.firefox||t.Utility.chrome)?this.DirectSetText(s,!0):this.DirectSetText(s),!this.MultiLine&&n&&(this.DropDownEditData.Text=s),s},e.prototype.DirectSetText=function(e,n){this.SystemChange=!1;var r=e;this.PasswordMode&&(r=this.UIProcess.GetPasswordText(e,this.PasswordChar,this.MultiLine)),!this.MultiLine&&!t.Utility.IsIE()&&(r=r.replace(/\r\n/g,""),r=r.replace(/\n/g,""),r=r.replace(/\r/g,"")),this.Text!=e&&(this.Text=e,this.switchPasswordChar||(this.switchPasswordChar=!1)),n||this._setInputValueWithPlaceHolder(r),this.SetHideText(e)},e.prototype.InternalDirectSetText=function(e){var t=e;this.PasswordMode&&(t=this.UIProcess.GetPasswordText(e,this.PasswordChar,this.MultiLine)),this._setInputValueWithPlaceHolder(t)},e.prototype._setInputValueWithPlaceHolder=function(e){if(e==="")this.isNullText=!0,this.Focused===!1&&(e=this.placeHolder);else if(e!==this.placeHolder||!this.isNullText)this.isNullText=!1;this.InputElement.value=e},e.prototype._getInputValueWithPlaceHolder=function(){return this.isNullText?"":this.InputElement.value},e.prototype.SetHideText=function(e){this.hideText!==e&&this.TextChangedEvent!=""&&this.TextChangedEvent!=null&&this.UIProcess.FireEvent(this,this.TextChangedEvent,e,"textChanged"),this.hideText=e},e.prototype.GetSingleCurPosition=function(e,t){if(t<0)return-1;var n=t;t>=e.GetLength()&&(n=e.GetLength());var r=e.Substring(0,n);for(;;){var i=r.GetLength();r=r.replace(/\r/g,""),r=r.replace(/\n/g,"");if(i==r.GetLength())break}return r.GetLength()},e.prototype.GetSingleText=function(e){var t=e;for(;;){var n=t.GetLength();t=t.replace(/\r/g,""),t=t.replace(/\n/g,"");if(t.GetLength()==n)break}return t},e.prototype.GetMultiPosition=function(e,t){if(t<=0)return 0;if(t>=e.GetLength())return e.GetLength();var n=t;while(n<e.GetLength()){var r=e.Substring(0,n);r=this.GetSingleText(r);if(r.GetLength()==t)break;n+=1}return n},e.prototype.GetOldValue=function(){return this.OldText},e.prototype.GetValue=function(){return this.GetText()},e.prototype.SetInnerText=function(e){this.SetText(e)},e.prototype.GetDisPlayText=function(e){var t=e;return this.PasswordMode&&(t=this.UIProcess.GetPasswordText(e,this.PasswordChar,this.MultiLine)),t},e.prototype.Focus=function(){this._destoryOverflowTip(),this.oldTextValue=this._getInputValueWithPlaceHolder();var e=this.oldTextValue;t.Utility.IsIE()||(this.IsActive=!0),this.HasFocus=!0;if(!this._autoComplete.GetIsFocusOnList()){this._autoComplete.HideDropdown();var n;this.AutoCompleteType!="None"?n=this.GetItem(this.AutoCompleteType):n=this.GetItem(this.GetId(),"focus");var r=n!=null?n.sort():null;t.Utility.LoadComplete==1&&this._autoComplete.SetDataList(r)}else this._autoComplete.SetIsFocusOnList(!1);var i=this.UIProcess.TextBoxFocus(this.FocusType,this.InputElement,this.GetText(),this.MultiLine,this.HighlightText,!1);t.Utility.CurrentActiveControlId=this.GetId();if(i==null)return;this.isTextEllipsis&&this.InternalDirectSetText(this.Text),i.SelectionStart!=null&&(this.SelectionStart=i.SelectionStart),i.SelectionEnd!=null&&(this.SelectionEnd=i.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart));if(i.SelectionStart!=null&&i.SelectionEnd!=null){var s=this.GetTrueSelection(this.SelectionStart,this.SelectionEnd,this.Text,e);this.isTextEllipsis&&(this.SelectionStart=s.SelectionStart,this.SelectionEnd=s.SelectionEnd),this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,s.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,s.SelectionEnd))}if(this.UIProcess.japInput==1)this.truePosition!=-1&&(this.SelectionStart=this.truePosition,this.SelectionEnd=this.truePosition,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))),this.UIProcess.japInput=!1;else if(this.FocusType!=t.FocusType.ContextMenu&&this.FocusType!=t.FocusType.ClientEvent&&this.FocusType!=t.FocusType.DropDown&&this.FocusType!=t.FocusType.DragDrop){this.OldText=this.GetText(),this.OldSelectionStart=this.SelectionStart,this.OldSelectionEnd=this.SelectionEnd,this.LastSelectionStart=this.OldSelectionStart,this.LastSelectionEnd=this.OldSelectionEnd;if(!this.MultiLine){this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.OldSelectionStart=this.DropDownEditData.SelectionStart,this.DropDownEditData.OldSelectionEnd=this.DropDownEditData.SelectionEnd,this.DropDownEditData.LastSelectionStart=this.DropDownEditData.OldSelectionStart,this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.OldSelectionEnd;var o=this;setTimeout(function(){o.DropDownEditData.SelectionStart=o.SelectionStart,o.DropDownEditData.SelectionEnd=o.SelectionEnd},0)}}this.ReadOnly==1&&this.FocusType==t.FocusType.None&&(this.SelectionStart=0,this.SelectionEnd=this.Text.length),(i.SetSelection==1||this.isTextEllipsis)&&this.SetSelection(this.SelectionStart,this.SelectionEnd),this.IsCausedByImplementingDrop&&(this.IsCausedByImplementingDrop=!1),this.FocusExit&&(this.UIProcess.MoveControl(this.InputElement,!0),this.FocusExit=!1),this.isTextEllipsis&&(this.isTextEllipsis=!1)},e.prototype.SetInnerFocus=function(e){e!==null&&e!==undefined?this.FocusType=e:this.FocusType=t.FocusType.ClientEvent,this.InputElement.focus(),this.SetSelection(this.SelectionStart,this.SelectionEnd),this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart),this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))},e.prototype.LoseFocus=function(e){t.Utility.IsIE()||(this.IsActive=!1),this.FireKeyExit(),t.Utility.IsIE()&&this.ImeMode&&this.ReadingImeOperation();if(t.Utility.IsIE())this.ImeMode?(this.ImeInput("LoseFocusInput",undefined,e),this.ImeSelectTimes=0):this.Text!=this.GetText()&&this.InternalSetText(this.Text,!0);else{this.ImeMode&&this.ImeInput("ReInput",!0,e);if(this.GetDisPlayText(this.Text)!=this._getInputValueWithPlaceHolder()){var n=this.Text;n=n.replace(/\\/g,"\\\\"),this.MultiLine?(n=n.replace(/\r/g,"\\r"),n=n.replace(/\n/g,"\\n")):(n=n.replace(/\r\n/g,""),n=n.replace(/\r/g,""),n=n.replace(/\n/g,"")),this.InternalSetText(n,!0)}}this.HasFocus=!1;if(this._autoComplete.IsVisible()){if(this._autoComplete.GetIsMouseOnList())return;this._autoComplete.HideDropdown()}this.FocusType!=t.FocusType.DropDown&&(this.FocusType=t.FocusType.None);var r;t.Utility.IsIE()?r=this.GetText():r=this.hideText;if(this.OldText!=r&&!this.UIProcess.japInput){this.OldText=this.Text,t.Utility.IsIE()&&(this.Text=this.GetText(),this.SetHideText(this.GetText())),this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement);if(!this.SystemChange||this.oldTextValue!=this.GetText())this.SystemChange=!0}else this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement),this.hideText!=this.GetText()&&t.Utility.IsIE()&&this.SetHideText(this.GetText())},e.prototype.FireKeyExit=function(){this.EventInfo!=null&&this.EventInfo.Type=="KeyExit"&&(this.UIProcess.FireEvent(this,this.EventInfo.Name,this.EventInfo.Args,this.EventInfo.Type),this.FocusType=t.FocusType.KeyExit,this.EventInfo=null)},e.prototype.GetTruePosition=function(e,t,n,r){var i=this.EllipsisString.GetLength();if(e<=r)return e;if(e>=r+i)return t.GetLength()-n.GetLength()+e;var s=t.GetLength()-n.GetLength()+i,o=Math.floor((e-r)*s/i)+r;return o},e.prototype.DealEllipsis=function(e,n,r,s){this.isTextEllipsis=!1;if(e||n==i.None)return;this.InternalDirectSetText(this.Text);var o=n,u=0,a=0,f=0,l=0,c=s.value,h=s.value,p="",d="",v=0,m=!0;s.value=c;if(t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)>s.clientWidth){this.isTextEllipsis=!0,s.value=r;var g=r;if(t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)>s.clientWidth)g="",c=r,h=r;else if(o==i.EllipsisPath){var y=h.LastIndexOf("\\");y!=-1&&(s.value=g+h.substr(y),t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)<=s.clientWidth&&(g=s.value,c=h.Substring(0,y),o=i.EllipsisEnd))}s.value=c+g;do u=s.value.GetLength(),a=Math.ceil(t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)/u),f=t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)-s.clientWidth,l=Math.ceil(f/a),o==i.EllipsisEnd?(s.value=c.Substring(0,c.GetLength()-l)+g,c=c.Substring(0,c.GetLength()-l)):o==i.EllipsisPath&&(v=Math.ceil((c.GetLength()-l)/2),p=c.substr(0,v),d=c.substr(v+l),s.value=p+g+d,c=p+d);while(t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)>s.clientWidth);var b=c.GetLength();do o==i.EllipsisEnd?(s.value=h.Substring(0,b+1)+g,b+=1):o==i.EllipsisPath&&(m?(d=h.substr(h.GetLength()-d.GetLength()-1),m=!1):(p=h.substr(0,p.GetLength()+1),m=!0),s.value=p+g+d);while(t.Utility.GetTextBoxScrollWidth(s,this.IsControlInPreview)==s.clientWidth);o==i.EllipsisEnd?(s.value=h.Substring(0,b-1)+g,this.TextHeadLength=b-1):o==i.EllipsisPath&&(m?p=h.substr(0,p.GetLength()-1):d=h.substr(h.GetLength()-d.GetLength()+1),s.value=p+g+d,this.TextHeadLength=p.GetLength())}},e.prototype.ImeInput=function(e,n,r,i){if(i)var s=this.Text,o=this.SelectionEnd,u=this.SelectionStart;var a;e=="DirectInput"&&!n?a=this.InputElement.value:e=="LoseFocusInput"&&this._getInputValueWithPlaceHolder()!=this.GetText()?a=this._getInputValueWithPlaceHolder():a=this.GetText();if(a==this.Text)return this.lastValue=this.Text,r!=null&&t.Utility.PreventDefault(r),this.ImeMode=!1,!1;if(t.Utility.IsIE()&&this.HasValidatedImeInput){this.InternalSetText(a,!0);if(i){var f=this.Text;if(s!==f){var l=u+f.length-(s.length-(o-u));this.SetSelection(l,l)}}return!1}var c;if(this.Text!=""){var h=Math.min(this.SelectionStart,this.SelectionEnd),p=Math.max(this.SelectionStart,this.SelectionEnd),d=this.Text;t.Utility.IsIE()||(d=this.GetDisPlayText(this.Text));if(p<d.GetLength()){var v=d.Substring(p,d.GetLength()),m=a.IndexOf(v);m!=-1?c=a.Substring(h,a.GetLength()-v.GetLength()):c=""}else c=a.Substring(h,a.GetLength())}else c=a;c!=""&&!this.MultiLine&&!this._autoComplete.IsDataListEmpty()&&this.EnableAutoComplete&&this._autoComplete.KeyUp(null,!0),e=="ReInput"&&(n?c=c.Substring(0,c.GetLength()):c=c.Substring(0,c.GetLength()-1));if(e=="Record")return c;var g=!1;if(e=="LoseFocusInput"){if(c==""){this.GetText()!=this.Text&&this._setInputValueWithPlaceHolder(this.Text);return}g=!0,this.UIProcess.japInput=!0}this.UIProcess.keypressResponse=!0,this.UIProcess.inputJap=!0,e=="ReInput"||!t.Utility.IsIE()&&e=="ClickInput"?this.InnerKeyPress(c,!0,g):this.InnerKeyPress(c,!1,g),this.HasValidatedImeInput=!0,this.UIProcess.inputJap=!1,this.UIProcess.japInput=!1,this.ImeMode=!1,this.ImeSelect=!1;if(e=="ReInput"||e=="ClickInput")this.truePosition=this.SelectionStart,this.FocusType=t.FocusType.ImeInput},e.prototype.CanUndo=function(){return this.IsChangedByDropDownEdit?(this.IsUndoAfterDel?this.BuffText=this.GetText():this.LastText=this.GetText(),this.IsChangedByDropDownEdit=!1,!0):this.IsUndoAfterDel?this.GetText()!=this.BuffText:this.GetText()!=this.LastText},e.prototype.GetCookie=function(e){var t=document.cookie.split("; ");for(var n=0;n<t.length;n++){var r=t[n].split("=");if(e==r[0]&&r[1]!=null)return window.unescape(r[1])}return null},e.prototype.SetCookie=function(e,t){var n=new Date(2020,8,20);if(document.cookie.IndexOf(e)==-1){if(t!="")while(t.IndexOf(",")!=-1)t=t.replace(",","@#GCD#@");document.cookie=e+"="+window.escape(t)+"; expires="+n.toGMTString()}else{var r=document.cookie.split("; "),i="";for(var s=0;s<r.length;s++){var o=r[s].split("=");if(e==o[0]){if(o[1]!=null){i=window.unescape(o[1]);break}document.cookie=e+"="+window.escape(t.replace(",","@#GCD#@"))+"; expires="+n.toGMTString();return}}if(t!=""){while(t.IndexOf(",")!=-1)t=t.replace(",","@#GCD#@");var u=i.split(","),a=!1;for(var f=0;f<u.length;f++)u[f]==t&&(a=!0);if(!a){i=t+","+i;var l=i.split(",");if(l.length>this.MaxHistoryCount){var c="";for(var h=0;h<this.MaxHistoryCount;h++)h!=this.MaxHistoryCount-1?c+=l[h]+",":c+=l[h];i=c}document.cookie=e+"="+window.escape(i)+"; expires="+n.toGMTString()}}}},e.prototype.DelCookie=function(e){document.cookie=e+"="+window.escape("")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},e.prototype.DeleteItem=function(e){while(e.IndexOf("&nbsp;")!=-1)e=e.replace("&nbsp;"," ");var t=new Date(2020,8,20),n;this.AutoCompleteType!="None"?n=this.GetCookie(this.AutoCompleteType):n=this.GetCookie(this.GetId());if(n!=null)try{var r=n.split(","),i=n.split(",");if(r.length>0){var s;for(s=0;s<r.length;s++){while(r[s].IndexOf("@#GCD#@")!=-1)r[s]=r[s].replace("@#GCD#@",",");if(r[s].IndexOf("&")!=-1){var o=r[s],u="";while(o.IndexOf("&")!=-1){o=o.replace("&","&amp;");var a=o.IndexOf("&");u+=o.Substring(0,a+5),o=o.Substring(a+5,o.GetLength())}o.IndexOf("&")==-1&&o!=""&&(u+=o),r[s]=u}while(r[s].IndexOf("<")!=-1)r[s]=r[s].replace("<","&lt;");while(r[s].IndexOf(">")!=-1)r[s]=r[s].replace(">","&gt;");if(r[s]==e)break}if(s<i.length&&i.length>1){var f;for(f=s;f<i.length-1;f++)i[f]=i[f+1];i[r.length-1]=null;var l="";for(f=0;f<i.length-1;f++)f!=i.length-2?l+=i[f]+",":l+=i[f];if(this.AutoCompleteType!="None"){document.cookie=this.AutoCompleteType+"="+window.escape(l)+"; expires="+t.toGMTString();var c=this.GetItem(this.AutoCompleteType).sort();for(var s=0;s<c.length;s++)while(c[s].IndexOf("@#GCD#@")!=-1)c[s]=c[s].replace("@#GCD#@",",");this._autoComplete.SetDataList(c)}else{document.cookie=this.GetId()+"="+window.escape(l)+"; expires="+t.toGMTString();var c=this.GetItem(this.GetId()).sort();for(s=0;s<c.length;s++)while(c[s].IndexOf("@#GCD#@")!=-1)c[s]=c[s].replace("@#GCD#@",",");this._autoComplete.SetDataList(c)}}else this._autoComplete.SetDataList([]),this.AutoCompleteType!="None"?document.cookie=this.AutoCompleteType+"="+window.escape("")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT;":document.cookie=this.GetId()+"="+window.escape("")+"; expires=Fri, 31 Dec 1999 23:59:59 GMT;"}}catch(h){}},e.prototype.GetItem=function(e,t){if(this.IsFromServer){var n;this.AutoCompleteType!="None"&&(n=this.GetCookie(this.AutoCompleteType));if(n!=null)try{var r=n.split(","),i=r.length>this.MaxHistoryCount?this.MaxHistoryCount:r.length;for(var s=0;s<i;s++)while(r[s].IndexOf("@#GCD#@")!=-1)r[s]=r[s].replace("@#GCD#@",",");if(i!=r.length){var o=new Array;for(var u=0;u<i;u++)o[u]=r[u];while(u<r.length)this.DeleteItem(r[u]),u++;r=o}return r.length>0&&(r=this.DropDownListValidate(r)),r}catch(a){}return null}var r=this._historyList;r=r.sort();if(r!=null)try{var i=r.length>this.MaxHistoryCount?this.MaxHistoryCount:r.length;t!==undefined&&t==="focus"&&(i=r.length);if(i!=r.length){var o=new Array;for(var u=0;u<i;u++)o[u]=r[u];while(u<r.length)this.DeleteItem(r[u]),u++;r=o}return r.length>0&&(r=this.DropDownListValidate(r)),r}catch(a){}return null},e.prototype.ResetData=function(e){this.SetText(e.ResetData)},e.prototype.ReadingImeOperation=function(){if(this.RubyText=="")return;t.Utility.FireEvent(this,this.readingImeStringOutputEvent,{readingString:this.RubyText},"readingImeStringOutput"),this.prevval="",this.RubyText=""},e.prototype.ReadingImeKeyUpProcess=function(e,n,r){var i=this.ImeMode?this.InputElement.value:this._getInputValueWithPlaceHolder(),s=i;if(this.SelectionEnd<this.Text.GetLength()){var o=this.Text.GetLength()-this.SelectionEnd;s=i.Substring(0,i.GetLength()-o)}var u=s.Substring(this.SelectionStart,s.GetLength()),a=u,f;for(f=this.prevval.length;f>=0;f--)if(u.substring(0,f)==this.prevval.substring(0,f)){a=u.substring(f);break}this.prevval=u;if(i==this.Text&&e!=13&&!r.altKey)this.prevval="",this.RubyText="";else if(e!=32&&e!=229&&!(e>=112&&e<=123)&&e!=37&&e!=39&&e!=38&&e!=40&&e!=27&&e!=28&&e!=29&&e!=8){var l=this.ConvertReadingIMEString(a,n);t.Utility.IsIE()&&(this.ImeMode?((e==192||e==219||e==221)&&a.length==1&&l.length==2&&this.RubyText.charAt(this.RubyText.length-1)==l.charAt(0)&&(l=l.charAt(1)),this.RubyText+=l):this.ReadingImeOperation())}},e.prototype.IsValidReadingString=function(e){if(e===undefined||e===null||e.length===0)return!1;for(var t=0;t<e.length;t++)if(!this.IsValidCharacter(e[t]))return!1;return!0},e.prototype.IsValidCharacter=function(e){var n=t.CharProcess.CharEx;if(n.IsSpace(e))return!0;var r=n.GetCharType(e),i=r&~n.Ctype.FullWidth;return i==n.Ctype.Hiragana||i==n.Ctype.Katakana||i==n.Ctype.UpperCase||i==n.Ctype.LowerCase||i==n.Ctype.Numeric||i==n.Ctype.Symbol||i==n.Ctype.MathSymbol||i==n.Ctype.Punctuation||n.CharCategory._jpnMixed.indexOf(e)!==-1?!0:!1},e.prototype.UpdateReadingIME=function(e){this.RubyText=this.ConvertReadingIMEString(e),this.ReadingImeOperation()},e.prototype.ConvertReadingIMEString=function(e,n){n===undefined&&(n=t.CharProcess.CharEx);var r="";for(var i=0;i<e.length;i++){var s=e.charAt(i),o=n.ToHalfKatakana(s);s=="\u309b"&&(o="\uff9e"),s=="\u309c"&&(o="\uff9f"),o=="\uff65"&&(o=""),r+=o}return r},e.prototype.AddAllEventsHandler=function(){var e=this;if(this.GetInputElement()!=null){var r=function(n){t.GlobalEventHandler.OnMouseDown(e,n)},i=function(n){t.GlobalEventHandler.OnMouseUp(e,n)},s=function(n){t.GlobalEventHandler.OnMouseOver(e,n)},o=function(n){t.GlobalEventHandler.OnSelectStart(e,n)},u=function(n){t.GlobalEventHandler.OnKeyDown(e,n)},a=function(n){t.GlobalEventHandler.OnKeyPress(e,n)},f=function(n){t.GlobalEventHandler.OnKeyUp(e,n)},l=function(n){t.GlobalEventHandler.OnDblClick(e,n)},c=function(n){t.GlobalEventHandler.OnHTML5BeforeCopy(e,n)},h=function(n){t.GlobalEventHandler.OnHTML5Cut(e,n)},p=function(n){t.GlobalEventHandler.OnHTML5Paste(e,n)},d=function(n){t.GlobalEventHandler.OnDragStart(e,n)},v=function(n){t.GlobalEventHandler.OnDragEnd(e,n)},m=function(n){t.GlobalEventHandler.OnMouseOut(e,n)},g=function(n){t.GlobalEventHandler.OnDrop(e,n)},y=function(n){t.GlobalEventHandler.OnTouchStart(e,n)},b=function(n){t.GlobalEventHandler.OnTouchEnd(e,n)},w=function(n){t.GlobalEventHandler.OnSelect(e,n)};if(t.Utility.safari){var E=function(t){e._safariDropText=getSelection().toString()},S=function(t){e._safariDropText=null};this.GetJQueryInputElement().on({"dragenter.imtextbox":E,"dragleave.imtextbox":S})}var x=function(n){t.GlobalEventHandler.OnDragEnter(e,n)},T=function(n){t.GlobalEventHandler.OnDragLeave(e,n)};if(t.Utility.IsIE7OrLater()&&!t.Utility.IsIE11OrLater()){var N=function(n){t.GlobalEventHandler.OnPropertyChanged(e,n)};this.GetJQueryInputElement().on({"onpropertychange.imtextbox":N})}else{var C=function(n){t.GlobalEventHandler.OnPropertyChanged(e,n)};this.GetJQueryInputElement().on({"propertychange.imtextbox":C})}var k=function(n){t.GlobalEventHandler.OnCompositionStart(e,n)},L=function(n){t.GlobalEventHandler.OnCompositionUpdate(e,n)},A=function(n){t.GlobalEventHandler.OnCompositionEnd(e,n)};if(t.Utility.IsIE10OrLater()){var O=function(n){t.GlobalEventHandler.OnMSPointerUp(e,n)},M=function(n){t.GlobalEventHandler.OnMSPointerDown(e,n)},_=function(n){t.GlobalEventHandler.OnMSGestureTap(e,n)};this.GetJQueryInputElement().on({"MSPointerUp.imtextbox":O,"MSPointerDown.imtextbox":M,"MSGestureTap.imtextbox":_})}var D=function(n){t.GlobalEventHandler.OnEditFieldLoseFocus(e,n)},P=function(n){t.GlobalEventHandler.OnFocusOut(e,n)},H=function(n){t.GlobalEventHandler.OnEditFieldFocus(e,n)},B=function(n){t.GlobalEventHandler.OnActivate(e,n)},j=function(n){t.GlobalEventHandler.OnDeActivate(e,n)};if(t.Utility.GetClientOS()==="Android"){var F=function(n){t.GlobalEventHandler.OnWebkitEditableContentChanged(e,n)};this.GetJQueryInputElement().on({"webkitEditableContentChanged.imtextbox":F})}this.GetJQueryInputElement().on({"mousedown.imtextbox":r,"mouseup.imtextbox":i,"selectstart.imtextbox":o,"keydown.imtextbox":u,"keypress.imtextbox":a,"keyup.imtextbox":f,"dblclick.imtextbox":l,"beforecopy.imtextbox":c,"cut.imtextbox":h,"paste.imtextbox":p,"dragstart.imtextbox":d,"dragend.imtextbox":v,"mouseout.imtextbox":m,"drop.imtextbox":g,"touchstart.imtextbox":y,"touchend.imtextbox":b,"select.imtextbox":w,"dragenter.imtextbox":x,"dragleave.imtextbox":T,"compositionstart.imtextbox":k,"compositionupdate.imtextbox":L,"compositionend.imtextbox":A,"blur.imtextbox":D,"focusout.imtextbox":P,"focus.imtextbox":H,"activate.imtextbox":B,"deactivate.imtextbox":j}),n(this.GetJQueryInputElement()[0].parentElement).on("mouseover",s)}},e.prototype.WebkitEditableContentChanged=function(e){var t=this,n=function(){try{t.ImeInput()}finally{t.ImeMode=!1}};setTimeout(n,0)},e.prototype.KeyDown=function(e){var n=this,r=e.keyCode,i=new Object;i.Shift=!1,i.Ctrl=!1,i.Alt=!1,e.shiftKey&&(i.Shift=!0),e.ctrlKey&&(i.Ctrl=!0),e.altKey&&(i.Alt=!0),this.LastInputText=this.GetText(),this.isFuncKeyPressed=!1;if(!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete){var s=this._autoComplete.KeyDown(e);if(s!=null&&s==0)return}this.KeyDownAction=!0;if(r==229&&!this.IsJapanConvertKeyPress||r==13&&this.GetText()!=this.Text)return this.ImeMode=!0,!0;if(this.ImeMode){var o=i.Shift||i.Ctrl||r==20||r>=112&&r<=123;o=o||r==8&&!t.Utility.IsIE(),o||(this.ImeInput("ReInput",!0,e),this.ImeSelectTimes=0,this.ImeMode=!1)}r==229&&this.IsJapanConvertKeyPress&&(this.IsJapanConvertKeyPress=!1);var u=new Object;i.Shift&&(r|=65536),i.Ctrl&&(r|=131072);if(i.Alt&&r===40)var a="DropDown";i.Alt&&(r|=262144);var f=!1,l;if(this.KeyActionList!=null)for(l=0;l<this.KeyActionList.length;l++)if(this.KeyActionList[l]==r.toString()){f=!0;break}if(a=="DropDown"||(r==262182||r==262184)&&!f)return!1;95<r&&r<106&&(r-=48);var c=this.SelectionStart,h=this.SelectionEnd,p=this.GetText(),d=this.BuffText,v=this.LastText,m=this.LastSelectionStart,g=this.LastSelectionEnd;this.MultiLine||(c=this.DropDownEditData.SelectionStart,h=this.DropDownEditData.SelectionEnd,p=this.DropDownEditData.Text,d=this.DropDownEditData.BuffText,v=this.DropDownEditData.LastText,m=this.DropDownEditData.LastSelectionStart,g=this.DropDownEditData.LastSelectionEnd),u=this.UIProcess.TextBoxKeyDown(r,i,this._getEditModeInternal(),this.Overwrite,c,h,this.ReadOnly,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.ExitOnLastChar,this.ExitOnLeftRightKey,this.MultiLine,this.PasswordMode,p,this.AcceptTab,this.AcceptReturn,d,v,m,g,a,e);if(u==null)return!1;if(u.inputChar!=null)return!0;u.InputTab==1&&(this.Text=this.GetText(),this.InnerKeyPress("	")),u.DelInclude&&(this.IsUndoAfterDel=!0,u.SerialDel||(this.BuffText=this.GetText(),this.LastSelectionStart=this.BuffText.GetLength(),this.LastSelectionEnd=this.BuffText.GetLength(),this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text,this.DropDownEditData.LastSelectionStart=this.DropDownEditData.BuffText.GetLength(),this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.BuffText.GetLength()))),u.Text!=null&&(u.Undo==1&&(this.LastText=this.Text,this.BuffText=this.LastText,this.MultiLine||(this.DropDownEditData.LastText=this.DropDownEditData.Text,this.DropDownEditData.BuffText=this.DropDownEditData.LastText)),this.DirectSetText(u.Text),this.MultiLine||(this.DropDownEditData.Text=u.Text));var y=this.GetSelectionLength();u.SelectionStart!=null&&(u.Undo==1&&(this.isFuncKeyPressed=!0,this.LastSelectionStart=this.SelectionStart,this.MultiLine||(this.DropDownEditData.LastSelectionStart=this.DropDownEditData.SelectionStart)),this.SelectionStart=u.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(this.DropDownEditData.Text,u.SelectionStart))),u.SelectionEnd!=null&&(u.Undo==1&&(this.LastSelectionEnd=this.SelectionEnd,this.MultiLine||(this.DropDownEditData.LastSelectionEnd=this.DropDownEditData.SelectionEnd)),this.SelectionEnd=u.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(this.DropDownEditData.Text,u.SelectionEnd)));var b=this.GetSelectionLength();if(u.KeyCode!=null){var w=new Object;return w.KeyCode=u.KeyCode,w}u.FocusType!=null&&(this.FocusType=u.FocusType),u.Overwrite!=null&&this.GetOverwrite()!=u.Overwrite&&(this._getEditModeInternal()==t.EditMode.Insert?this._setEditModeInternal(t.EditMode.Overwrite):this._getEditModeInternal()==t.EditMode.Overwrite&&this._setEditModeInternal(t.EditMode.Insert));if(u.EventInfo!=null)for(l=0;l<u.EventInfo.length;l++)u.EventInfo[l]!=null&&(u.EventInfo[l].Type=="KeyExit"?this.EventInfo=u.EventInfo[l]:this.UIProcess.FireEvent(this,u.EventInfo[l].Name,u.EventInfo[l].Args,u.EventInfo[l].Type));return u.System!=null?(setTimeout(function(){u.System&&n.InputElement.value===""&&n.Clear()},0),u.System):(u.SetSelection==1&&(y==0&&b!=0?t.Utility.ShouldFireOnSelectStart=!0:t.Utility.ShouldFireOnSelectStart=!1,this.SetSelection(this.SelectionStart,this.SelectionEnd),t.Utility.ShouldFireOnSelectStart=!1),!1)},e.prototype.KeyPress=function(e,n,r){var i=e;if(!t.Utility.IsIE()&&this.ImeMode){var s=n.keyCode==192&&n.altKey;if(s){this.ImeInput("ReInput",!0,n),this.ImeSelectTimes=0,this.ImeMode=!1;return}}if(!t.Utility.IsIE()&&n.charCode==0){var o=n.keyCode||n.charCode;if(o=!this.MultiLine||!this.AcceptReturn&&this.MultiLine&&!n.ctrlKey)return!0}return this.InnerKeyPress(i,r)},e.prototype.KeyUp=function(e){!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&(e.keyCode!=8&&e.keyCode!=46&&e.keyCode!=9||this.GetText()!=""?this.isFuncKeyPressed?this._autoComplete.HideDropdown():this.LastInputText!=this.GetText()&&this.GetText()!=""&&this._autoComplete.KeyUp(e):this._autoComplete.GetIsDeleteItem()||this._autoComplete.HideDropdown(),this._autoComplete.SetIsDeleteItem(!1)),this.KeyDownAction=!1;var n=e.keyCode,r=t.CharProcess.CharEx;n==13&&this._getInputValueWithPlaceHolder()!=this.Text&&(t.Utility.IsIE()&&this.ImeMode?this.HasValidatedImeInput=!1:t.Utility.IsIE()||(this.ImeMode=!0));if(this.ImeMode==1){var i=this._getInputValueWithPlaceHolder(),s=i;if(this.SelectionEnd<this.Text.GetLength()){var o=this.Text.GetLength()-this.SelectionEnd;s=i.Substring(0,i.GetLength()-o)}s=s.Substring(s.GetLength()-1,s.GetLength()),n==13?(this.ImeInput("DirectInput",undefined,e),this.ImeSelectTimes=0):n>=48&&n<=57||n>=96&&n<=105?(n>=96&&(n-=48),s=r.ToHalfWidth(s),s!=String.fromCharCode(n)&&!this.ImeSelect?this.HasValidatedImeInput=!1:s==String.fromCharCode(n)&&this.ImeSelectTimes<1?this.HasValidatedImeInput=!1:this.ImeSelect||(this.ImeInput("ReInput",undefined,e),this.HasValidatedImeInput=!1,this.ImeMode=!0),this.ImeSelectTimes=0):n==32?this.ImeSelect==0&&(this.ImeSelectTimes==1?this.ImeSelect=!0:r.ToHalfWidth(s)!=String.fromCharCode(n)?this.ImeSelectTimes++:this.HasValidatedImeInput&&(this.UIProcess.inputJap=!0,t.Utility.IsIE()&&(this.HasValidatedImeInput=!1),this.ImeInput("DirectInput",undefined,e),this.ImeSelectTimes=0)):n>=65&&n<=90?(this.ImeSelectTimes=0,this.HasValidatedImeInput=!1):n==32||n==106||n==107||n==109||n==173&&t.Utility.IsFireFox4OrLater()||n==110||n==111||n==219||n==220||n==221||n==222||n>=186&&n<=192||n==226?(this.ImeSelectTimes>=1&&this.ImeInput("ReInput",undefined,e),this.ImeSelectTimes=0,t.Utility.IsIE()&&(this.HasValidatedImeInput=!1)):n==40||n==38?this.ImeSelect==0&&this.ImeSelectTimes==1&&(this.ImeSelect=!0):n==8||n==46?this.ImeSelectTimes=0:n==27?this.ImeSelectTimes=0:n==244?this.IsJapanConvertKeyPress=!0:!t.Utility.IsIE()&&n==243?(this.ImeInput("ReInput",!0,e),this.ImeSelectTimes=0,this.ImeMode=!1):t.Utility.IsIE()&&n==229&&(this.HasValidatedImeInput=!1)}n==242&&this.ImeInput("ReInput",!0,e),this.ReadingImeKeyUpProcess(n,r,e);if(this.UIProcess.keyupResponse==1){this.UIProcess.keyupResponse=!1;var u=this.UIProcess.TextBoxKeyUp(this.InputElement,this.MultiLine,this.SelectionStart,this.SelectionEnd,this.GetText()),a=this.SelectionStart,f=this.SelectionEnd,l=!1,c=!1;this.MultiLine||(a=this.DropDownEditData.SelectionStart,f=this.DropDownEditData.SelectionEnd),u.SelectionStart!=null&&this.SelectionStart!=u.SelectionStart&&(l=!0,this.SelectionStart=u.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart))),u.SelectionEnd!=null&&this.SelectionEnd!=u.SelectionEnd&&(this.SelectionEnd=u.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart),c=!0,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd)));var h=this._getInputValueWithPlaceHolder(),p=this.MultiLine?this.Text:this.GetSingleText(this.Text),d=p.GetLength()-h.GetLength(),v;this.MultiLine?this.PasswordMode?d!=0&&(v=this.Text,l&&c?p=v.Substring(0,this.SelectionStart)+v.Substring(f,v.GetLength()):l||(f=this.SelectionStart+d,p=v.Substring(0,a)+v.Substring(f,v.GetLength()))):p=this.GetText():(d!=0&&(v=this.DropDownEditData.Text,l&&c?this.DropDownEditData.Text=v.Substring(0,this.DropDownEditData.SelectionStart)+v.Substring(f,v.GetLength()):l||(f=this.GetMultiPosition(v,this.SelectionStart+d),this.DropDownEditData.Text=v.Substring(0,a)+v.Substring(f,v.GetLength()))),p=this.GetSingleText(this.DropDownEditData.Text)),u.SystemEdit==1&&(this.Text=p,this.SetHideText(p)),u.Text!=null&&this.InternalSetText(u.Text,!0),u.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)}},e.prototype.PropertyChange=function(e){e!=null&&t.Utility.IsIE10OrLater()&&e.propertyName=="value";if(this.DragEdit)this.DragEdit=!1,this.MultiLine||this.Text!=this.GetText()&&(this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.Text=this.DropDownEditData.Text.Substring(0,this.DropDownEditData.SelectionStart)+this.DropDownEditData.Text.Substring(this.DropDownEditData.SelectionEnd,this.DropDownEditData.Text.GetLength()),this.DropDownEditData.LastText=this.DropDownEditData.OldText,this.DropDownEditData.SelectionEnd=this.DropDownEditData.SelectionStart),this.OldText=this.Text,this.Text=this.GetText(),this.SetHideText(this.GetText()),this.SystemChange=!0,this.LastText=this.OldText,this.SetSelectionLength(0);else if(this.DropEdit){this.DropEdit=!1,this.FocusType=t.FocusType.DragDrop,this.SelectionStart=t.Utility.GetSelectionStartPosition(this.InputElement),this.SelectionEnd=this.SelectionStart+t.Utility.GetSelectionText(this.InputElement).GetLength();var n=this._getInputValueWithPlaceHolder();if(!this.MultiLine){var r,i=this.GetSingleText(this.DropDownEditData.Text),s=n.GetLength()-i.GetLength();this.PasswordMode?r=this.DropText:r=n.Substring(this.SelectionEnd-s,this.SelectionEnd),s!=0&&(this.DropDownEditData.OldText=this.DropDownEditData.Text,this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd-s),this.DropDownEditData.Text=this.DropDownEditData.Text.Substring(0,this.DropDownEditData.SelectionStart)+r+this.DropDownEditData.Text.Substring(this.DropDownEditData.SelectionStart,this.DropDownEditData.Text.GetLength()),this.DropDownEditData.LastText=this.DropDownEditData.OldText,this.DropDownEditData.SelectionEnd=this.DropDownEditData.SelectionStart+s),this.PasswordMode&&(n=this.GetSingleText(this.DropDownEditData.Text))}else if(this.PasswordMode){var o=this.SelectionEnd-this.DropText.GetLength();n=this.Text.Substring(0,o)+this.DropText+this.Text.Substring(o,this.Text.GetLength())}this.OldText=this.Text,this.Text=n,this.SetHideText(n),this.SystemChange=!0,this.LastText=this.OldText}else!this.MultiLine&&!this.isTextEllipsis&&!this.PasswordMode&&this.SetHideText(this.GetText());return!1},e.prototype.MouseDown=function(e){this._isInnerKeyPressCall=!1;var n=t.Utility.GetMouseButton(e);this.FocusedWhenMouseDown=document.activeElement==e.target,this.MouseDownOnClearButton=t.Utility.IsMouseDownOnClearButton(e),t.Utility.IsIE()||(this.IsActive=!0,this.ImeMode&&n==t.MouseButton.Left&&(this.IsImplementImeInput=!0)),this.MouseButton=n,this.BeforeDragSelectionStart=this.SelectionStart,this.BeforeDragSelectionEnd=this.SelectionEnd;if(this.MouseButton==t.MouseButton.Right)this.FocusType!=t.FocusType.ClientEvent&&(this.FocusType=t.FocusType.Click);else{this.isLeftMouseButtonPressed=!0,this.FocusType!=t.FocusType.ClientEvent&&(this.FocusType=t.FocusType.Click);try{var r=t.Utility.GetSelectionText(this.InputElement);r!=""&&(this.IsMouseDown=!0,t.Utility.ClearSelection(this.InputElement))}catch(i){}}var s=this.UIProcess.TextBoxMouseDown(this.InputElement,n);if(s==null)return;s.SelectionStart!=null&&(this.SelectionStart=s.SelectionStart),s.SelectionEnd!=null&&(this.SelectionEnd=s.SelectionEnd)},e.prototype.MouseUp=function(e){var n=null;t.Utility.IsIE()&&this.ImeMode&&this.ReadingImeOperation(),this.IsMouseDown=!1;if(t.Utility.IsIE()&&(this.ImeMode||this.Text!=this.GetText()))this.ImeMode?(this.ImeInput("ClickInput",undefined,e),this.ImeSelectTimes=0):this.InternalSetText(this.Text,!0);else if(!t.Utility.IsIE()&&(this.ImeMode||this.GetDisPlayText(this.Text)!=this._getInputValueWithPlaceHolder())){if(!this.IsImplementImeInput)return;this.ImeInput("ClickInput",undefined,e),this.ImeSelectTimes=0;if(this.GetDisPlayText(this.Text)!=this._getInputValueWithPlaceHolder()){this.IsImplementImeInput=!1;var r=this.Text;this.MultiLine?(r=r.replace(/\r/g,"\\r"),r=r.replace(/\n/g,"\\n")):(r=r.replace(/\r\n/g,""),r=r.replace(/\r/g,""),r=r.replace(/\n/g,""));var i=this;window.setTimeout(function(){i.InternalSetText(r,!0)},0),this.Select()}}else{this.isLeftMouseButtonPressed=!1,this.LastStart=this.SelectionStart,this.LastEnd=this.SelectionEnd;var s=this.SelectionStart,o=this.SelectionEnd,u=this.GetText(),a=null;n!=null&&n.Ctrl!=null&&(a=n.Ctrl);var f=this.UIProcess.TextBoxMouseUp(this.InputElement,s,o,this.MouseButton,this.MultiLine,u,a,this.HighlightText,e);if(f==null)return;f.SelectionStart!=null&&(this.SelectionStart=f.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart))),f.SelectionEnd!=null&&(this.SelectionEnd=f.SelectionEnd,this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart),this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd))),f.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd)}this.MouseButton=t.MouseButton.Left,this.MouseUpPointerType==undefined&&(this.MouseUpHasValue=e.target.value.length>0),this.HandleClearButton(e)},e.prototype.MouseWheel=function(e){},e.prototype.ShouldCancelMouseWheelDefaultBehavior=function(){return!1},e.prototype.MouseOut=function(){if(this.IsMouseDown!=1)return;if(this.MouseUpPointerType!==4&&this.MouseUpPointerType!=undefined&&this.MouseUpPointerType!=="mouse")return;var e=Math.min(this.BeforeDragSelectionStart,this.BeforeDragSelectionEnd),n=Math.max(this.BeforeDragSelectionStart,this.BeforeDragSelectionEnd),r=this.GetText().Substring(e,n);r!=""&&(this.SetSelection(this.BeforeDragSelectionStart,this.BeforeDragSelectionEnd),t.Utility.DragDrop(this.InputElement)),this.IsMouseDown=!1},e.prototype.DoubleClick=function(){!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&!this.ReadOnly&&this._autoComplete.ShowDropdown();var e=this.UIProcess.TextBoxDoubleClick(this.InputElement,this.SelectionStart,this.GetText());return e.SelectionStart!=null&&(this.SelectionStart=e.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionStart))),e.SelectionEnd!=null&&(this.SelectionEnd=e.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,this.SelectionEnd)),this.SelectionLength=Math.abs(this.SelectionEnd-this.SelectionStart)),e.SetSelection==1&&this.SetSelection(this.SelectionStart,this.SelectionEnd),!0},e.prototype.DragStart=function(e){this.PasswordMode?e.dataTransfer.effectAllowed="none":this.DragEdit=!0},e.prototype.DragEnd=function(){this.DragEdit=!0},e.prototype.DragEnter=function(){this.isTextEllipsis&&this.InternalDirectSetText(this.GetText())},e.prototype.DragLeave=function(){this.DealEllipsis(this.MultiLine,this.Ellipsis,this.EllipsisString,this.InputElement)},e.prototype.MouseMove=function(e){},e.prototype.MouseOver=function(){var e=!(this.HasFocus||this.MultiLine||!this.OverflowTip);if(e){var r=this.InputElement,i=this.GetText();this.isTextEllipsis&&(i=this.Text);if(this.PasswordMode){var s="";for(var o=0;o<i.GetLength();o++)s+=this.PasswordChar;i=s}var u=t.Utility.MeasureText(i,r).Width;u>r.clientWidth?(this.ToolTip=n(this.InputElement.parentElement).wijtooltip({content:i,position:{my:"left bottom",at:"left+1 top"}}),n(this.InputElement.parentElement).wijtooltip("show")):e=!1}e||this._destoryOverflowTip()},e.prototype._destoryOverflowTip=function(){this.ToolTip!=null&&(this.ToolTip=null,n(this.InputElement.parentElement).wijtooltip("destroy"))},e.prototype._isinsertGroup=function(e){return e==t.EditMode.Insert||e==t.EditMode.FixedInsert},e.prototype._isOverwriteGroup=function(e){return e==t.EditMode.Overwrite||e==t.EditMode.FixedOverwrite},e.prototype.InnerKeyPress=function(e,t,n){var r=e,i;this.ImeMode||this.isPasting?i=this.Text:(i=this._getInputValueWithPlaceHolder(),i!=""&&(i=this.GetText())),this.isPasting=!1;var s=this.SelectionStart,o=this.SelectionEnd;this.MultiLine||(s=this.DropDownEditData.SelectionStart,o=this.DropDownEditData.SelectionEnd);var u=this.UIProcess.TextBoxKeyPress(s,o,r,i,this.MaxLength,this.LengthAsByte,this.ExitOnLastChar,this.Overwrite,this.MultiLine,this.MaxLineCount,this.CountWrappedLine);u.Text!=null&&(u.DelInclude&&(this.BuffText=this.GetText(),this.MultiLine||(this.DropDownEditData.BuffText=this.DropDownEditData.Text)),this.DirectSetText(u.Text,t),this.MultiLine||(this.DropDownEditData.Text=u.Text)),u.SelectionStart!=null&&(this.SelectionStart=u.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.SelectionStart,this.SelectionStart=this.GetSingleCurPosition(u.Text,u.SelectionStart))),u.SelectionEnd!=null&&(this.SelectionEnd=u.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.SelectionEnd,this.SelectionEnd=this.GetSingleCurPosition(u.Text,u.SelectionEnd))),u.SetSelection==1&&!t&&!n&&(this._isInnerKeyPressCall=!0,this.SetSelection(this.SelectionStart,this.SelectionEnd));if(u.EventInfo!=null)for(var a=0;a<u.EventInfo.length;a++)u.EventInfo[a]!=null&&this.UIProcess.FireEvent(this,u.EventInfo[a].Name,u.EventInfo[a].Args,u.EventInfo[a].Type);return u.SystemEdit==1?!0:!1},e.prototype._isSupportClipBoard=function(){if(!this.GetUseClipboard())return!0;if(t.Utility.IsIE())return!0;if(t.Utility.IsFireFox4OrLater())try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");var e=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!e)return;var n=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!n)return;n.addDataFlavor("text/unicode"),e.getData(n,e.kGlobalClipboard);var r=new Object,i=new Object;try{n.getTransferData("text/unicode",r,i)}catch(s){return null}r&&(Components.interfaces.nsISupportsWString?r=r.value.QueryInterface(Components.interfaces.nsISupportsWString):Components.interfaces.nsISupportsString?r=r.value.QueryInterface(Components.interfaces.nsISupportsString):r=null);if(r)return r.data.substring(0,i.value/2)}catch(o){return!1}return!1},e.prototype.MSPointerUp=function(e){e!=null&&(this.MouseUpPointerType=e.pointerType,this.MouseUpHasValue=(e.srcElement||e.target).value.length>0)},e.prototype.CompositionStart=function(e){this.ImeMode=!0,this._lastCompositionText="",this._lastCompositionOffset=0,this._convertedOnLastUpdate=!1,this._cachedReadingString="",this._readingString="",this._compositionUpdateFired=!1},e.prototype.CompositionUpdate=function(e){this._compositionUpdateFired=!0;if(e.originalEvent.data===undefined||e.originalEvent.data.length===0)return;var t=this.InputElement.selectionStart-e.originalEvent.data.length;if(t>this._lastCompositionOffset){if(!this._convertedOnLastUpdate){var n=this._lastCompositionText.substring(0,t-this._lastCompositionOffset);this.IsValidReadingString(n)?this._cachedReadingString+=n:this._cachedReadingString+=this._readingString,this._readingString="",this._convertedOnLastUpdate=!0}}else this._convertedOnLastUpdate&&(this._convertedOnLastUpdate=!1);if(!this.IsValidReadingString(e.originalEvent.data))return;this._readingString=e.originalEvent.data},e.prototype.CompositionEnd=function(e){var n=this.HasValidatedImeInput;this.ImeMode=!0,this.HasValidatedImeInput=!1;var r=this,i=function(){try{r.ImeInput("DirectInput",undefined,e)}finally{r.ImeMode=!1}};t.Utility.IsIE9OrLater()?i():setTimeout(i,0),this._compositionUpdateFired||this.CompositionUpdate(e),this._convertedOnLastUpdate=!1;var s=this._cachedReadingString+this._readingString;this._cachedReadingString="",this._readingString="";if(e.originalEvent.data.length===0||s.length===0)return;this.UpdateReadingIME(s);if(t.Utility.IPad&&t.Utility.safari||t.Utility.chrome&&t.Utility.GetClientOS()==="Android")this.HasValidatedImeInput=n,this.ImeMode=!1},e.prototype.SelectStart=function(e){if(this.ImeMode)return!1;if(this.isLeftMouseButtonPressed){var t=this.UIProcess.SelectStart(this.InputElement,e,this.MultiLine);t.SelectionStart!=null&&(this.SelectionStart=t.SelectionStart,this.MultiLine||(this.DropDownEditData.SelectionStart=this.GetMultiPosition(this.DropDownEditData.Text,t.SelectionStart))),t.SelectionEnd!=null&&(this.SelectionEnd=t.SelectionEnd,this.MultiLine||(this.DropDownEditData.SelectionEnd=this.GetMultiPosition(this.DropDownEditData.Text,t.SelectionEnd)))}},e.prototype.DragDrop=function(e){if(!p.Utility.IsIE()&&this.ReadOnly)return!1;this.FFDragFlag=!1,p.Utility.IsIE()||(this.FFDragFlag=!0),!p.Utility.IsIE()&&!p.Utility.safari&&this.SetInnerFocus();var t=p.Utility.GetSelectionStartPosition(this.InputElement),n=t,r=this.UIProcess.DragDrop(e,this.ExitOnLastChar,t,n,this.MaxLength,this.LengthAsByte,this.MaxLineCount,this.CountWrappedLine,this.MultiLine,this.GetText());if(r==null)return;if(r.DropText!=null){var i,s;if(this.PasswordMode){var o=this.UIProcess.GetPasswordText(r.DropText,this.PasswordChar,this.MultiLine);p.Utility.IsIE()?(window.event.dataTransfer.setData("Text",o),o!=window.event.dataTransfer.getData("Text")&&(i=this.GetText(),s=i+r.DropText,this.InternalSetText(s,!0),p.Utility.PreventDefault(window.event))):(i=this.GetText(),s=i+r.DropText,this.InternalSetText(s,!0,!0)),this.DropText=r.DropText}else if(p.Utility.IsIE()){event.dataTransfer.setData("Text",r.DropText);if(r.DropText!=event.dataTransfer.getData("Text"))i=this.GetText(),s=i+r.DropText,this.InternalSetText(s,!0),p.Utility.PreventDefault(event);else{var u=this;setTimeout(function(){var e=u.GetText();u.InternalSetText(e,!0)},0)}}else i=this.GetText(),s=i+r.DropText,this.InternalSetText(s,!0,!0);this.DropEdit=!0}if(r.EventInfo!=null)for(var a=0;a<r.EventInfo.length;a++)r.EventInfo[a]!=null&&r.EventInfo[a].Name!=null&&(this.UIProcess.FireEvent(this,r.EventInfo[a].Name,r.EventInfo[a].Args,r.EventInfo[a].Type),r.EventInfo[a].Name==this.KeyExitEvent&&(this.FocusExit=!0));this.FFDragFlag=!1;var f=this,l=this.MultiLine,c=this.Ellipsis,h=this.EllipsisString,p=this.InputElement;return setTimeout(function(){f.InternalSetText(f.GetText()),f.DealEllipsis(l,c,h,p)},0),!0},e.prototype.MSGestureTap=function(e){if(this.Focused&&!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&!this.ReadOnly){var t=this;setTimeout(function(){t.Focused&&t._autoComplete.ShowDropdown()},400)}},e.prototype.MSPointerDown=function(e){if(this.Focused&&(e.pointerType===e.MSPOINTER_TYPE_TOUCH||e.pointerType==="touch")&&!this.PasswordMode&&!this.MultiLine&&this.EnableAutoComplete&&!this.ReadOnly){var t=new MSGesture;t.target=e.target,t.addPointer(e.pointerId)}},e.prototype.GetShowLiterals=function(){return t.ShowLiterals.Always},e}();t.IMTextBox=l;var c=function(e){function r(n,r,i,s,o,u){e.call(this),this.isMulSelected=!1,this.isOverWrite=!1,this.ForwardSelection="None",this.isCtrlPress=!1,this.isCtrlClick=!1,this.isDblClick=!1,this.isTriClick=!1,this.isInputValid=!0,this.ctrlDelete=!1,this.ctrlBackspace=!1,this.IsDelInclude=!1,this.IsSerialDel=!1,this.StartPos=null,this.LastKey=null,this.keypressResponse=!1,this.systemEdit=!1,this.keyupResponse=!1,this.japInput=!1,this.inputJap=!1,this.IsKeyDown=!1,this.CurStart=0,this.CurEnd=0,this.control=u,this.Owner=u,this.Filter=new t.TextFilter(n,r),this.IsjQueryControl=o,this.PasswordMode=i,this.PasswordChar=s}return __extends(r,e),r.prototype.Reset=function(){this.Filter=new t.TextFilter(this.control.AutoConvert,this.control.Format),this.PasswordMode=this.control.PasswordMode,this.PasswordChar=this.control.GetPasswordChar()},r.prototype.TextBoxKeyDown=function(e,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T){n.Ctrl?this.isCtrlPress=!0:this.isCtrlPress=!1;var N=new Object;switch(r){case t.EditMode.Insert:this.isOverWrite=!1;break;case t.EditMode.Overwrite:this.isOverWrite=!0;break;case t.EditMode.FixedInsert:this.isOverWrite=!1;break;case t.EditMode.FixedOverwrite:this.isOverWrite=!0}s!=o?this.isMulSelected=!0:this.isMulSelected=!1;var C;switch(x){case"Clear":return u||(N.SelectionStart=0,N.SelectionEnd=0,N.Text="",N.DelInclude=!0,this.IsDelInclude=!0),N;case"NextControl":return C=this.MoveControl(this.control.InputElement,!0,!1,"NextControl"),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0),N;case"PreviousControl":return C=this.MoveControl(this.control.InputElement,!1,!1,"PreviousControl"),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0),N}if(u&&e!=131117&&e!=131139&&e!=9&&e!=65545&&e!=131081&&e!=196617&&e!=131137&&e!=37&&e!=39&&e!=38&&e!=40)return N;var k;switch(e){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 116:case 121:case 123:N.System=!0;break;case 45:var L;if(r===t.EditMode.FixedInsert)L=!1;else if(r===t.EditMode.FixedOverwrite)L=!0;else{L=!i;if(this.EditStatusChangedEvent!=""&&this.EditStatusChangedEvent!=null){var A=new Object;A.Name=this.EditStatusChangedEvent,A.Args=null,A.Type="EditStatusChanged",N.EventInfo=new Array,N.EventInfo[0]=A}}N.Overwrite=L;break;case 13:d&&y?(this.keypressResponse=!0,this.keyupResponse=!0,N.System=!0):d&&!y?(N.System=!1,N.IsDoPostBack=!0):(this.keypressResponse=!0,this.keyupResponse=!1,N.System=!0);break;case 131085:d&&(this.systemEdit=!0,this.keypressResponse=!0,this.keyupResponse=!0,N.System=!0);break;case 9:case 65545:d&&g&&!u?(this.keypressResponse=!0,N.InputTab=!0):(N.System=!0,C=new Object,this.Owner.KeyExitEvent!=""&&this.Owner.KeyExitEvent!=null&&(C.Name=this.Owner.KeyExitEvent,C.Args={Key:e==9?t.ExitKeys.Tab:t.ExitKeys.ShiftTab},C.Type="KeyExit"),N.EventInfo=new Array,N.EventInfo[0]=C,d&&(N.SelectionStart=m.GetLength(),N.SelectionEnd=m.GetLength()));break;case 131081:C=this.MoveControl(this.control.InputElement,!0,!1,"NextControl"),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0);break;case 196617:C=this.MoveControl(this.control.InputElement,!1,!1,"PreviousControl"),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0);break;case 8:case 65544:this.systemEdit=!0,this.keyupResponse=!0,this.DelOperation(e,s,o),N.DelInclude=!0,N.SerialDel=this.IsSerialDel,N.System=!0;break;case 46:this.systemEdit=!0,this.keyupResponse=!0,this.DelOperation(e,s,o),N.DelInclude=!0,N.SerialDel=this.IsSerialDel,N.System=!0;break;case 131080:case 196616:this.isMulSelected?(this.keyupResponse=!0,this.ctrlBackspace=!0):(this.systemEdit=!0,this.keyupResponse=!0,N.System=!0),this.DelOperation(e,s,o),N.SerialDel=this.IsSerialDel,N.DelInclude=!0;break;case 131118:this.keyupResponse=!0,N.System=!0,this.DelOperation(e,s,o),N.SerialDel=this.IsSerialDel,N.DelInclude=!0,N.KeyCode=39,this.ctrlDelete=!0;break;case 131139:case 131117:if(!v){var O;this.Owner===undefined?O=this.control:O=this.Owner,O._isSupportClipBoard()?this.Copy(m,s,o):N.System=!0}else N.System=!1;break;case 65581:case 131158:this.Owner===undefined?O=this.control:O=this.Owner,O._isSupportClipBoard()?N=this.TextBoxPaste(s,o,m,h,g,y,a,f,l,c,d):N.System=!0;break;case 131160:v?N.System=!1:(this.Owner===undefined?O=this.control:O=this.Owner,O._isSupportClipBoard()?N=this.Cut(m,s,o):N.System=!0);break;case 65582:s!=o?N=this.Cut(m,s,o):(this.systemEdit=!0,this.keyupResponse=!0,N.KeyCode=8),this.DelOperation(e,s,o),N.SerialDel=this.IsSerialDel,N.DelInclude=!0;break;case 131137:N=this.TextBoxSelectAll(m);break;case 131162:N=this.TextBoxUndo(m,b,w,E,S,s,o);break;case 65573:this.ForwardSelection="Left",N.System=!0,this.keyupResponse=!0;break;case 65575:this.ForwardSelection="Right",N.System=!0,this.keyupResponse=!0;break;case 65574:d?(this.ForwardSelection="Left",N.System=!0,this.keyupResponse=!0):(o>0&&(N.SelectionEnd=o-1),N.SetSelection=!0);break;case 65576:d?(this.ForwardSelection="Right",N.System=!0,this.keyupResponse=!0):(o<m.GetLength()&&(N.SelectionEnd=o+1),N.SetSelection=!0);break;case 65569:this.ForwardSelection="Left",N.System=!0,this.keyupResponse=!0;break;case 65570:this.ForwardSelection="Right",N.System=!0,this.keyupResponse=!0;break;case 196645:this.ForwardSelection="Left",N.System=!0,this.keyupResponse=!0;break;case 196647:this.ForwardSelection="Right",N.System=!0,this.keyupResponse=!0;break;case 65572:case 196644:this.ForwardSelection="Left",N.System=!0,this.keyupResponse=!0;break;case 65571:case 196643:this.ForwardSelection="Right",N.System=!0,this.keyupResponse=!0;break;case 37:case 131109:k=!1,this.IsKeyDown?k=!0:(this.IsKeyDown=!0,this.CurStart=s,this.CurEnd=o);if(k&&this.CurStart===0&&this.CurEnd==0&&(p===t.ExitOnLeftRightKey.Both||p===t.ExitOnLeftRightKey.Left)){var M=e===37?"Left":"CtrlLeft";C=this.MoveControl(this.control.InputElement,!1,!0,M),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0),this.IsKeyDown=!1;break}this.CurStart-=1,this.CurEnd=this.CurStart;if(s!==0||o!==0||p!==t.ExitOnLeftRightKey.Both&&p!==t.ExitOnLeftRightKey.Left)u||(this.keyupResponse=!0),N.System=!0;else{var M=e===37?"Left":"CtrlLeft";C=this.MoveControl(this.control.InputElement,!1,!0,M),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0)}break;case 39:case 131111:k=!1,this.IsKeyDown?k=!0:(this.IsKeyDown=!0,this.CurStart=s,this.CurEnd=o);if(k&&this.CurStart===m.GetLength()&&this.CurEnd===m.GetLength()&&(p===t.ExitOnLeftRightKey.Both||p===t.ExitOnLeftRightKey.Right)){var M=e==39?"Right":"CtrlRight";C=this.MoveControl(this.control.InputElement,!0,!0,M),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0),this.IsKeyDown=!1;break}this.CurStart+=1,this.CurEnd=this.CurStart;if(s!==m.GetLength()||o!==m.GetLength()||p!==t.ExitOnLeftRightKey.Both&&p!==t.ExitOnLeftRightKey.Right)u||(this.keyupResponse=!0),N.System=!0;else{var M=e==39?"Right":"CtrlRight";C=this.MoveControl(this.control.InputElement,!0,!0,M),C!=null&&(N.EventInfo=new Array,N.EventInfo[0]=C.EventInfo,N.FocusType=C.FocusType,N.FocusExit=!0)}break;case 33:case 131105:this.keyupResponse=!0,d?N.System=!0:N.System=!1;break;case 34:case 131106:this.keyupResponse=!0,d?N.System=!0:N.System=!1;break;case 38:u||(this.keyupResponse=!0),this.Owner.GetMultiLine()?N.System=!0:N.System=!1;break;case 40:u||(this.keyupResponse=!0),this.Owner.GetMultiLine()?N.System=!0:N.System=!1;break;case 131108:case 36:this.keyupResponse=!0,N.System=!0;break;case 131107:case 35:this.keyupResponse=!0,N.System=!0;break;case 131112:case 131110:this.keyupResponse=!0,N.System=!0;break;case 27:this.control.Clear();break;case 393266:case 393267:case 393268:case 393269:case 393271:case 393272:case 393273:case 393264:case 393403:case 393285:case 393442:case 393293:case 393402:this.keypressResponse=!0,N.System=!0;break;default:}if(e!==undefined&&e!==null){if(e>=48&&e<=57||e>=65&&e<=90||e>=96&&e<=105||e==229||e==0||e==231)return this.keypressResponse=!0,N==null&&(N={}),N.System=!0,N.inputChar=!0,N;if(e==32||e==106||e==107||e==109||e==173&&t.Utility.IsFireFox4OrLater()||e==110||e==111||e==219||e==220||e==221||e==222||e>=186&&e<=192||e==226||e==231)return this.keypressResponse=!0,N.System=!0,N;if(!t.Utility.IsIE()&&(e===61||e===59))return this.keypressResponse=!0,N.System=!0,N;if(T.shiftKey)var _=e-65536;if(_>=48&&_<=57||_>=65&&_<=90||_>=96&&_<=105||_==229)return this.keypressResponse=!0,N.System=!0,N;if(_==32||_==106||_==107||_==109||e==173&&t.Utility.IsFireFox4OrLater()||_==110||_==111||_==219||_==220||_==221||_==222||_>=186&&_<=192||_==226||_==231)return this.keypressResponse=!0,N.System=!0,N;if(!t.Utility.IsIE()&&(_==61||_==59))return this.keypressResponse=!0,N.System=!0,N}return N},r.prototype.TextBoxKeyPress=function(e,r,i,s,o,u,a,f,l,c,h){if(this.keypressResponse==1){this.keypressResponse=!1,this.isInputValid=!0;var p=new Object,d=new Object,v="\r\n";if(!t.Utility.IsIE()||parseInt(n.browser.version)>=9)v="\n";var m="";if(i=="	")m=i;else if(i=="\r"||i=="\n"){if(!l)return p.SystemEdit=!0,p;m=v}else if(i.GetLength()==1)m=this.Filter.Check(i);else{var g=this.Filter.CheckText(i);m=g.CheckedText,this.isInputValid=g.IsInputValid}if(e==r){if(o!=0){var y=o-this.GetLength(s,u);if(m==v)y<v.GetLength()&&o!=0&&(m="");else if(!f||f&&e==s.GetLength())o>this.GetLength(s,u)?m=this.MaxLengthCheck(m,y,u):m="";else if(f){var b=s.Substring(0,e),w=s.Substring(e,s.GetLength()),E=w.IndexOf(v);E!=-1&&(b+=w.Substring(E,w.GetLength())),y=o-this.GetLength(b,u),m=this.MaxLengthCheck(m,y,u)}}}else{var S=s.Substring(Math.min(e,r),Math.max(e,r));if(o!=0){var y=o-this.GetLength(s,u)+this.GetLength(S,u);m==v?y<v.GetLength()&&(m=""):m=this.MaxLengthCheck(m,y,u)}}if(c!=0&&l)if(c>=this.GetLinesCount(s,h)){var x=s.Substring(0,e),T=s.Substring(r,s.GetLength());if(this.PasswordMode){x=this.GetPasswordText(x,this.PasswordChar,l),T=this.GetPasswordText(T,this.PasswordChar,l);var N=this.GetPasswordText(m,this.PasswordChar,l);N=this.MaxLineCheck(x,T,N,c,h),m=m.Substring(0,N.GetLength())}else m=this.MaxLineCheck(x,T,m,c,h)}else m="";i!=""&&m==""&&(this.isInputValid=!1);var C=s;if(!f||m==v||e!=r){if(e>r){var k=e;e=r,r=k}e!=r&&(p.DelInclude=!0,this.IsDelInclude=!0),m!=""&&(C=s.Substring(0,e)+m+s.Substring(r,s.GetLength()))}else if(m!="")if(e==s.GetLength())C=s+m;else if(e+v.GetLength()<=s.GetLength()&&s.Substring(e,e+v.GetLength())==v)C=s.Substring(0,e)+m+s.Substring(e,s.GetLength());else{var L;if(o==0||!u)L=s.Substring(e,e+m.GetLength());else{var A=m.GetLength(),O=s.Substring(e,e+A),M=this.GetLength(O,u),_=this.GetLength(m,u);while(_>M&&A<=s.GetLength())A+=1,O=s.Substring(e,e+A),M=this.GetLength(O,u);L=s.Substring(e,e+A)}var E=L.IndexOf(v);E!=-1?C=s.Substring(0,e)+m+s.Substring(e+E,s.GetLength()):C=s.Substring(0,e)+m+s.Substring(e+L.GetLength(),s.GetLength())}p.Text=C,p.SetSelection=!0;if(this.isInputValid!=0||m.GetLength()>0)p.SelectionStart=e+m.GetLength(),p.SelectionEnd=p.SelectionStart;p.EventInfo=new Array;if(!this.isInputValid){this.isInputValid=!0;var g=new Object;g.Name=this.control.InvalidInputEvent,g.Args=i,g.Type="invalidInput",p.EventInfo[0]=g}if(p.Text!=null&&a&&o!=0){var D=this.GetLength(p.Text.Substring(0,p.SelectionStart),u);if(D==o&&m!=""){var g=this.MoveControl(this.control.InputElement,!0,!1,"CharInput");g!=null&&(p.EventInfo[1]=g.EventInfo,p.FocusType=g.FocusType,p.FocusExit=!0,p.SetSelection=!1)}}return p}return!1},r.prototype.TextBoxKeyUp=function(e,n,r,i,s){var o=new Object;this.IsKeyDown=!1,o.SelectionStart=t.Utility.GetSelectionStartPosition(e),o.SelectionEnd=o.SelectionStart+t.Utility.GetSelectionText(this.control.InputElement).GetLength(),this.systemEdit==1&&(this.systemEdit=!1,o.SystemEdit=!0);if(this.ctrlDelete||this.ctrlBackspace){var u;this.ctrlDelete?(u=o.SelectionStart,this.ctrlDelete=!1):this.ctrlBackspace&&(u=i,this.ctrlBackspace=!1),o.Text=s.Substring(0,r)+s.Substring(u,s.GetLength()),o.SelectionStart=o.SelectionEnd=r,o.SetSelection=!0}return o},r.prototype.TextBoxMouseDown=function(e,t){return this.isFocusing=!1,new Object},r.prototype.TextBoxMouseUp=function(e,n,r,i,s,o,u,a,f){var l=new Object;if(this.isFocusing){this.isFocusing=!1;if(a)return l}if(i==t.MouseButton.Left){if(this.isDblClick&&!t.Utility.GrapeCityTimeout){this.isDblClick=!1,this.isTriClick=!0;if(s){var c=t.Utility.GetSelectionStartPosition(e),h=this.GetLineEnds(c,o);h.start!=null&&(l.SelectionStart=h.start),h.end!=null&&(l.SelectionEnd=h.end)}else l.SelectionStart=0,l.SelectionEnd=o.GetLength()}else t.Utility.GetSelectionText(this.control.InputElement)!=""||!s?(l.SelectionStart=t.Utility.GetSelectionStartPosition(e),l.SelectionEnd=l.SelectionStart+t.Utility.GetSelectionText(this.control.InputElement).GetLength()):t.Utility.GetSelectionText(this.control.InputElement)==""?(l.SelectionStart=t.Utility.GetSelectionStartPosition(e),l.SelectionEnd=l.SelectionStart+t.Utility.GetSelectionText(this.control.InputElement).GetLength()):(l.SelectionStart=t.Utility.GetSelectionStartPosition(e),document.selection&&f.y<document.selection.createRange().offsetTop&&(l.SelectionStart-=2),l.SelectionEnd=l.SelectionStart);if(!t.Utility.IsIE()&&t.Utility.FuncKeysPressed.Ctrl)if(s){var c=t.Utility.GetSelectionStartPosition(e),h=this.GetLineEnds(c,o);h.start!=null&&(l.SelectionStart=h.start),h.end!=null&&(l.SelectionEnd=h.end)}else l.SelectionStart=0,l.SelectionEnd=o.GetLength();l.SelectionStart!=l.SelectionEnd&&(l.SetSelection=!0)}return l},r.prototype.GetLineEnds=function(e,r){var i=r,s=0,o="\r\n";if(!t.Utility.IsIE()||parseInt(n.browser.version)>=9)o="\n";var u=i.IndexOf(o),a=new Object;while(u!=-1){if(e>=s&&e<s+u+o.GetLength())return a.start=s,a.end=s+u,a;s=s+u+o.GetLength(),i=i.Substring(u+o.GetLength(),i.GetLength()),u=i.IndexOf(o)}return a.start=s,a.end=r.GetLength(),a},r.prototype.ShowContextMenu=function(e,n){var r=new Object;return r.SelectionStart=t.Utility.GetSelectionStartPosition(e),r.SelectionEnd=r.SelectionStart+t.Utility.GetSelectionText(this.control.InputElement).GetLength(),r},r.prototype.TextBoxDoubleClick=function(e,n,r){this.isDblClick=!0,t.Utility.GrapeCityTimeout=!1,window.setTimeout(function(){t.Utility.GrapeCityTimeout=!0},500);var i=new Object;return i.SelectionStart=t.Utility.GetSelectionStartPosition(e),i.SelectionEnd=i.SelectionStart+t.Utility.GetSelectionText(this.control.InputElement).GetLength(),i},r.prototype.SelectStart=function(e,n,r){this.isTriClick&&(this.isTriClick=!1);var i=new Object;return i.SelectionStart=t.Utility.GetSelectionStartPosition(e),i.SelectionEnd=i.SelectionStart,i},r.prototype.Copy=function(e,n,r){if(n!=r){if(n>r){var i=n;n=r,r=i}var s=e.Substring(n,r),o=!0;this.Owner&&(this.Owner.MultiLine===!1&&(s=t.BaseUIProcess.UpdateCrLfString(s,this.Owner.AcceptsCrLf)),o=this.Owner.UseClipboard),t.Utility.IsIE()?t.Utility.SetCopy(s,o):t.Utility.SetCopy(s,!1)}},r.prototype.TextBoxPaste=function(e,n,r,i,s,o,u,a,f,l,c,h,p){this.isInputValid=!0;var d=new Object,v=this.Owner?this.Owner.UseClipboard:!0;t.Utility.IsIE()||(v=!1);var m=h==null?t.Utility.GetPasteData(v):h;t.Utility.chrome&&(m=m.replace(/\r\n/g,"\n")),!p&&this.Owner&&this.Owner.MultiLine===!1&&(m=t.BaseUIProcess.UpdateCrLfString(m,this.Owner.AcceptsCrLf)),t.Utility.IsIE9OrLater()&&this.Owner&&this.Owner.MultiLine===!0&&(m=t.BaseUIProcess.FilterReturnChar(m));if(m==null)return d;this.FireClientEvent("OnBeforePaste");var g=this.FormatCheck(m,s,o),y=g,b;if(u!=0){var w=this.GetLength(r.Substring(Math.min(e,n),Math.max(e,n)),a);b=u-this.GetLength(r,a)+w,y=this.MaxLengthCheck(g,b,a)}if(f!=0&&c)if(f>=this.GetLinesCount(r,l)){var E=r.Substring(0,e),S=r.Substring(n,r.GetLength());if(this.PasswordMode){E=this.GetPasswordText(E,this.PasswordChar,c),S=this.GetPasswordText(S,this.PasswordChar,c);var x=this.GetPasswordText(y,this.PasswordChar,c);x=this.MaxLineCheck(E,S,x,f,l),y=y.Substring(0,x.GetLength())}else y=this.MaxLineCheck(E,S,y,f,l)}else y="";var T=Math.min(e,n),N=Math.max(e,n);if(y!=""||p===!0)d.Text=r.Substring(0,T)+y+r.Substring(N,r.GetLength()),d.SelectionStart=T+y.GetLength(),d.SelectionEnd=d.SelectionStart;d.SetSelection=!0,e!=n&&(d.DelInclude=!0,this.IsDelInclude=!0),d.EventInfo=new Array;if(!this.isInputValid){this.isInputValid=!0;var C=new Object;C.Name=this.control.InvalidInputEvent,C.Args=m,C.Type="invalidInput",d.EventInfo[0]=C}if(d.Text!=null)var k=this.GetLength(d.Text.Substring(0,d.SelectionStart),a);else var k=0;if(u!=0&&k==u&&i&&y!=""){var C=this.MoveControl(this.control.InputElement,!0,!1,"CharInput");C!=null&&(d.EventInfo[1]=C.EventInfo,d.FocusType=C.FocusType,d.FocusExit=!0,d.SetSelection=!1)}return this.FireClientEvent("OnPaste"),d},r.prototype.Cut=function(e,t,n){var r=new Object;return t!=n&&this.FireClientEvent("OnBeforeCut"),this.Copy(e,t,n),t<n?(r.SelectionStart=t,r.Text=e.Substring(0,t)+e.Substring(n,e.GetLength())):(r.SelectionStart=n,r.Text=e.Substring(0,n)+e.Substring(t,e.GetLength())),r.SelectionEnd=r.SelectionStart,r.SetSelection=!0,r.Text!=e&&(r.DelInclude=!0,this.IsDelInclude=!0),t!=n&&this.FireClientEvent("OnCut"),r},r.prototype.TextBoxUndo=function(e,t,n,r,i,s,o){var u=new Object;return this.IsDelInclude?e!=t&&(u.Text=t,u.SelectionStart=s,u.SelectionEnd=o,u.SetSelection=!0,u.DelInclude=!0,u.Undo=!0):e!=n&&(u.Text=n,u.SelectionStart=r,u.SelectionEnd=i,u.SetSelection=!0,u.Undo=!0),this.StartPos=null,this.LastKey=null,u},r.prototype.Delete=function(e,t,n,r){var i=new Object;return n<r?(i.SelectionStart=n,i.Text=t.Substring(0,n)+t.Substring(r,t.GetLength())):(i.SelectionStart=r,i.Text=t.Substring(0,r)+t.Substring(n,t.GetLength())),i.SelectionEnd=i.SelectionStart,i.SetSelection=!0,i.Text!=t&&(i.DelInclude=!0,this.IsDelInclude=!0),i},r.prototype.TextBoxSelectAll=function(e){var t=new Object;return t.SelectionStart=0,t.SelectionEnd=e.GetLength(),t.SetSelection=!0,t},r.prototype.DragDrop=function(e,t,n,r,i,s,o,u,a,f){this.isInputValid=!0;var l=new Object,c=this.FormatCheck(e),h=c,p=0;i!=0&&(p=i-this.GetLength(f,s),h=this.MaxLengthCheck(c,p,s));if(o!=0&&a)if(o>=this.GetLinesCount(f,u)){var d=f.Substring(0,n),v=f.Substring(r,f.GetLength());if(this.PasswordMode){d=this.GetPasswordText(d,this.PasswordChar,a),v=this.GetPasswordText(v,this.PasswordChar,a);var m=this.GetPasswordText(h,this.PasswordChar,a);m=this.MaxLineCheck(d,v,m,o,u),h=m.Substring(0,h.GetLength())}else h=this.MaxLineCheck(d,v,h,o,u)}else h="";l.DropText=h,l.EventInfo=new Array;if(!this.isInputValid){this.isInputValid=!0;var g=new Object;g.Name=this.control.InvalidInputEvent,g.Args=c,g.Type="invalidInput",l.EventInfo[0]=g}if(this.GetLength(c,s)>=p&&i!=0&&t&&h!=""){var g=new Object;this.Owner.KeyExitEvent!=""&&this.Owner.KeyExitEvent!=null&&(g.Name=this.Owner.KeyExitEvent,g.Args=new Object,g.Args.Key=9,g.Type="KeyExit"),l.EventInfo[1]=g}return l},r.prototype.TextBoxFocus=function(e,n,r,i,s,o){var u=new Object;this.isFocusing=!0,e===t.FocusType.Left?(u.SelectionStart=0,u.SelectionEnd=0):e===t.FocusType.Right&&(u.SelectionStart=r.GetLength(),u.SelectionEnd=r.GetLength());if(!s){if(e===t.FocusType.Click||e==t.FocusType.DragDrop)u.SelectionStart=t.Utility.GetSelectionStartPosition(n),u.SelectionEnd=u.SelectionStart+t.Utility.GetSelectionText(this.control.InputElement).GetLength()}else o||(u.SelectionStart=0,u.SelectionEnd=r.GetLength());if(e!==t.FocusType.Click||s)u.SetSelection=!0;return u},r.prototype.MaxLengthCheck=function(e,t,n){var r="",i=0;if(e=="\r\n")t>=2&&(r=e);else if(n)for(var s=0;s<e.GetLength();s++){var o=e.Substring(s,s+1);o.length>=2?i+=2*o.length:this.Filter.IsFullWidth(o)?i+=2:i++;if(!(i<=t))break;r+=e.Substring(s,s+1)}else e.GetLength()<=t?r=e:r=e.Substring(0,t);var u=r.GetLength();return u!=0&&r.Substring(u-1,u)=="\r"&&(r=r.Substring(0,u-1)),r!=e&&(this.isInputValid=!1),r},r.prototype.MaxLineCheck=function(e,t,n,r,i){var s="",o=e+n+t,u=this.GetLinesCount(o,i);if(u<=r)s=n;else{var a=0,f=n.GetLength();do{var l=Math.floor((a+f)/2),c=n.Substring(0,l);o=e+c+t,u=this.GetLinesCount(o,i);if(u>r)f=l;else if(u<r)a=l;else if(u==r&&f>a+1)a=l;else if(u==r&&f==a+1)break}while(a<f);s=n.Substring(0,a)}return s!=n&&(this.isInputValid=!1),s},r.prototype.GetLinesCount=function(e,t){var r=1,i=t;if(e=="")return r;var s=this._testTextArea;if(this._testTextArea===undefined||this._testTextArea===null)this._testTextArea=n("<textarea/>"),this._testTextArea.css("visibility","hidden"),this._testTextArea.css("position","absolute"),this._testTextArea.css("left","-100000000px"),this._testTextArea.css("top","-100000000px"),this._testTextArea.attr("rows",1),this._testTextArea.appendTo(n(document.body)),s=this._testTextArea,i=!1;if(!i){var o=e,u=o,a=o.IndexOf("\r\n");r=1;while(a!=-1)u=u.replace("\r\n",""),r+=1,o=o.Substring(a+2,o.GetLength()),a=o.IndexOf("\r\n");o=u,a=o.IndexOf("\r");while(a!=-1)u=u.replace("\r",""),r+=1,o=o.Substring(a+1,o.GetLength()),a=o.IndexOf("\r");o=u,a=o.IndexOf("\n");while(a!=-1)u=u.replace("\n",""),r+=1,o=o.Substring(a+1,o.GetLength()),a=o.IndexOf("\n");return r}var f=e;f=f.replace(/\r\n/g,"\r"),f=f.replace(/\n/g,"\r");var a=f.IndexOf("\r");if(a!=-1){r=0;var l=f.Substring(0,a);return r+=this.GetLinesCount(l,t),f=f.Substring(a+1,f.GetLength()),r+=this.GetLinesCount(f,t),r}var c=n(this.control.InputElement);s.css("fontSize",c.css("fontSize")),s.css("fontFamily",c.css("fontFamily")),s.css("width",c.css("width")),s.css("borderWidth",c.css("borderWidth")),s.css("padding",c.css("padding")),s.css("wordWrap",c.css("wordWrap")),s.css("overflowY",c.css("overflowY"));if(s!=null){s.val(e),s=s.get(0);while(s.scrollHeight-s.clientHeight>1)s.rows++;return s.scrollTop=0,r=s.rows,s.rows>1&&(s.rows=1),r}},r.prototype.FormatCheck=function(e,t,n){this.Owner&&!this.Owner.MultiLine&&e&&(typeof e!="string"&&(e=e.toString()),e=e.replace(/[\r\n]/g,""));var r=this.Filter.CheckText(e),i=r.CheckedText;return this.isInputValid=r.IsInputValid,i},r.prototype.ListValidateCheck=function(e){var t=this.Filter.autoConvert;this.Filter.autoConvert=!1;var n=this.Filter.CheckText(e);return this.Filter.autoConvert=t,n.IsInputValid},r.prototype.GetLength=function(e,t){var n=0;if(t)for(var r=0;r<e.GetLength();r++){var i=e.Substring(r,r+1);i.length>=2?n+=2*i.length:this.Filter.IsFullWidth(i)?n+=2:n++}else n=e.GetLength();return n},r.prototype.TextBoxProcessBackSpace=function(e,t,n,r){var i=new Object;return this.systemEdit=!0,this.keyupResponse=!0,i.System=!0,i},r.prototype.GetRightWordPosition=function(e,t){if(e<t.GetLength()){var n=e,r=t.Substring(e,e+1),i=r;while(!(this.Filter.IsFormatSpace(i)&&!this.Filter.IsFormatSpace(r)||(r=="\r"||i=="\n")&&e!=n||(r=="	"||i=="	")&&e!=n)){n+=1;if(!(n<t.GetLength()))break;i=r,r=t.Substring(n,n+1)}return n}return e},r.prototype.DelOperation=function(e,t,n){this.IsDelInclude=!0;var r=Math.abs(n-t);switch(e){case 8:var i=!1;this.IsKeyDown?i=!0:(this.IsKeyDown=!0,this.CurStart=t-1);if(i){this.IsSerialDel=!0;break}this.CurStart==this.StartPos&&(this.IsSerialDel=!0,this.CurStart-=1);if(t!=n){if(t<this.StartPos)this.StartPos-=r;else if(t==this.StartPos){this.IsSerialDel=!0,this.StartPos=t;break}}else if(t==this.StartPos){this.IsSerialDel=!0,this.StartPos=t-1;break}t-=1,this.StartPos==t?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=t-1;break;case 131080:case 196616:if(t==n)t-=1;else if(t<this.StartPos)this.StartPos-=r;else if(t==this.StartPos){this.IsSerialDel=!0,this.StartPos=t-1;break}this.StartPos==t?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=t-1;break;case 65544:t!=n&&t<this.StartPos&&(this.StartPos-=r),this.StartPos==t?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=t-1;break;case 65582:if(t==n)t-=1;else if(t<this.StartPos)this.StartPos-=r;else if(t==this.StartPos){this.IsSerialDel=!0,this.StartPos=t;break}this.StartPos==t||this.StartPos==n?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=t-1;break;case 46:var s=null;this.LastKey==8&&(s=t,t-=1);if(this.StartPos==t||this.StartPos!=null&&Math.abs(this.StartPos-t)==1||this.StartPos==n)this.IsSerialDel=!0;else{this.IsSerialDel=!1;if(s!=null){this.StartPos=s;break}}this.StartPos=t;break;case 131118:if(t!=n)if(t<this.StartPos)this.StartPos-=r;else if(t==this.StartPos){this.IsSerialDel=!0,this.StartPos=t;break}t-=1,this.StartPos==t||t-this.StartPos==1?this.IsSerialDel=!0:this.IsSerialDel=!1,this.StartPos=t}this.LastKey=e},r.prototype.GetPasswordText=function(e,t,n){var r="";for(var i=0;i<e.GetLength();i++){var s=e.Substring(i,i+1);s!="\r"&&s!="\n"?r+=t:n&&(r+=s)}return r},r}(t.BaseUIProcess);t.GcTextBoxUIProcess=c;var h=function(){function e(e){this._hightlightIndex=-1,this._dataList=[],this._isDeleteItem=!1,this._isFocusOnList=!1,this._isMouseOnList=!1,this._owner=e;var t=5;this._maxItems=t,this._firstItemShowing=0,this._lastItemShowing=t-1,this._refreshElement(),this._createDropdown()}return e.prototype._refreshElement=function(){this._controlContainer=this._owner.GetContainer(),this._inputElement=this._owner.GetJQueryInputElement(),this._maxItems=this._owner.GetMaxHistoryCount(),this._inputElement&&this._inputElement.attr("autocomplete","off")},e.prototype._createDropdown=function(){var e=n("<div>");e.css({position:"absolute",zIndex:"999999",display:"none",backgroundColor:"white",border:"solid 1px black",overflowX:"hidden",overflowY:"auto"});var r=this;e.bind("focus",function(){r._isFocusOnList=!0,e.blur(),r._owner.SetInnerFocus(t.FocusType.ContextMenu)}),e.bind("mouseover",function(){r._isMouseOnList=!0}),e.bind("mouseout",function(){r._isMouseOnList=!1}),e.bind("contextmenu",function(e){e.preventDefault()}),this._dropDownElement=e},e.prototype.GetIsDeleteItem=function(){return this._isDeleteItem},e.prototype.SetIsDeleteItem=function(e){this._isDeleteItem=e},e.prototype.GetIsFocusOnList=function(){return this._isFocusOnList},e.prototype.SetIsFocusOnList=function(e){this._isFocusOnList=e},e.prototype.GetIsMouseOnList=function(){return this._isMouseOnList},e.prototype.ShowDropdown=function(){this._refreshElement(),this.IsVisible()&&this.HideDropdown(),this._dropDownElement.empty();var e;e=this._addDisplayItems();if(e===0)return;var r=t.Utility.GetElementPosition(this._controlContainer.get(0)).Left,i=t.Utility.GetElementPosition(this._controlContainer.get(0)).Top+this._controlContainer.outerHeight(),s=this._controlContainer.outerWidth(),o="";if(e>this._maxItems){var u=t.Utility.MeasureText("WHQ",this._dropDownElement.get(0).firstChild).Height;o=this._maxItems*(u+2)+"px"}var a="";t.Utility.IsTouchMouseDown==1&&(a=this._owner.GetTouchDropDownScale()+""),s-=2,this._dropDownElement.css("left",r+"px"),this._dropDownElement.css("top",i+"px"),this._dropDownElement.css("width",s+"px"),this._dropDownElement.css("display",""),t.Utility.SetZoomStyle(this._dropDownElement,a),this._dropDownElement.css("height",o),n("body").append(this._dropDownElement);var f=this;this._docClickListerner=function(){f.HideDropdown()},n(document).bind("click",this._docClickListerner)},e.prototype._addDisplayItems=function(){var e=this._inputElement.val(),r=[];for(var i=0;i<this._dataList.length;++i)this._dataList[i].substr(0,e.GetLength())==e&&this._dataList[i].GetLength()>e.GetLength()&&r.push(this._dataList[i]);var s=this,o=r.length>this._maxItems?this._maxItems:r.length;for(i=0;i<o;++i){var u=n("<div>");u.attr("index",i),u.css({fontFamily:t.Utility.GetOSDefaultFontFamily(),fontSize:"10pt",whiteSpace:"nowrap",padding:"1px"}),u.bind("mouseover",function(e){var t=e.target||e.srcElement;s.HighlightItem(parseInt(t.getAttribute("index").toString()))}),u.bind("click",function(){s._isFocusOnList=!1,s.SetValue(),s.HideDropdown()}),u.html(t.Utility.EncodingToHTML(r[i])),this._dropDownElement.append(u)}return o},e.prototype.HideDropdown=function(){this.IsVisible()&&(this._dropDownElement.remove(),this._dropDownElement.css("display","none"),n("document").unbind("click",this._docClickListerner),this._dropDownElement.empty(),this._isMouseOnList=!1,this._hightlightIndex=-1)},e.prototype.SetDataList=function(e){if(e===null||e===undefined)e=[];this._dataList=e},e.prototype.IsDataListEmpty=function(){return this._dataList.length===0},e.prototype.HighlightItem=function(e){this.SetHighlighItem(e)},e.prototype.SetHighlighItem=function(e){this._hightlightIndex!==-1&&(this._dropDownElement.get(0).childNodes[this._hightlightIndex].style.backgroundColor="",this._dropDownElement.get(0).childNodes[this._hightlightIndex].style.color=""),this._hightlightIndex=e,this._hightlightIndex!==-1&&(this._dropDownElement.get(0).childNodes[this._hightlightIndex].style.color="white")},e.prototype.Highlight=function(e){var t=!1;e>0&&this._hightlightIndex==this._dropDownElement.get(0).childNodes.length-1?(this.SetHighlighItem(-1),t=!0):e<0&&this._hightlightIndex==0&&(this.SetHighlighItem(-1),t=!0);if(this._hightlightIndex===-1)t==0&&(e>0&&this.SetHighlighItem(0),e<0&&this.SetHighlighItem(this._dropDownElement.get(0).childNodes.length-1));else{var n;e>1&&this._firstItemShowing+this._maxItems-1!==this._hightlightIndex&&(e=this._firstItemShowing+this._maxItems-this._hightlightIndex),e<-1&&this._firstItemShowing!=this._hightlightIndex&&(e=this._firstItemShowing-this._hightlightIndex),e>0?n=this._hightlightIndex+e>=this._dropDownElement.get(0).childNodes.length?this._dropDownElement.get(0).childNodes.length-1:this._hightlightIndex+e:n=this._hightlightIndex+e<0?0:this._hightlightIndex+e,e>1&&(n-=1),this.SetHighlighItem(n)}},e.prototype.SetValue=function(){var e=this._dropDownElement.get(0).childNodes[this._hightlightIndex].innerHTML;e=t.Utility.DecodingFromHTML(e),this._owner.InternalSetText(e,!0),this._owner.SetInnerFocus(t.FocusType.ContextMenu);var n=this._inputElement.val().GetLength(),r=Math.abs(this._owner.SelectionEnd-this._owner.SelectionStart);r!=0?this._owner.InternalSetSelection(0,n):this._owner.InternalSetSelection(n,n)},e.prototype.ScrollCheck=function(){if(this._hightlightIndex!==-1){this._hightlightIndex>this._lastItemShowing&&(this._firstItemShowing=this._hightlightIndex-(this._maxItems-1),this._lastItemShowing=this._hightlightIndex),this._hightlightIndex<this._firstItemShowing&&(this._firstItemShowing=this._hightlightIndex,this._lastItemShowing=this._hightlightIndex+(this._maxItems-1));var e=t.Utility.MeasureText("WQH",this._dropDownElement.get(0).firstChild).Height+2;this._dropDownElement.get(0).scrollTop=this._firstItemShowing*e}},e.prototype.KeyDown=function(e){var n=e.keyCode,r={Shift:!1,Ctrl:!1,Alt:!1};e.shiftKey&&(r.Shift=!0),e.ctrlKey&&(r.Ctrl=!0),e.altKey&&(r.Alt=!0);var i=t.Key;switch(n){case i.Enter:if(this._hightlightIndex!==-1)return this.SetValue(),this.HideDropdown(),e.stopPropagation(),e.preventDefault(),!1;break;case i.Delete:if(this._hightlightIndex!==-1){var s=this._dropDownElement.get(0).childNodes[this._hightlightIndex].innerHTML;return this.HideDropdown(),this._owner.DeleteItem(s),this._isDeleteItem=!0,this._inputElement.focus(),this.IsVisible()||this.ShowDropdown(),e.stopPropagation(),e.preventDefault(),!1}break;case i.Escape:this.HideDropdown(),e.stopPropagation(),e.preventDefault();break;case i.Up:if(r.Alt)break;return this.IsVisible()?(this._hightlightIndex===-1&&this.ShowDropdown(),this.Highlight(-1),this.ScrollCheck()):this.ShowDropdown(),!1;case i.PageUp:return this.IsVisible()?(this._hightlightIndex===-1&&this.ShowDropdown(),this.Highlight(-1*this._maxItems),this.ScrollCheck()):this.ShowDropdown(),!1;case i.Tab:this.HideDropdown();break;case i.Down:if(r.Alt)break;return this.IsVisible()?(this.Highlight(1),this.ScrollCheck()):this.ShowDropdown(),!1;case i.PageDown:return this.IsVisible()?(this.Highlight(this._maxItems),this.ScrollCheck()):this.ShowDropdown(),!1}},e.prototype.KeyUp=function(e,n){if(n===!0){this.ShowDropdown();return}var r=e.keyCode,i=t.Key;switch(r){case i.Enter:break;case i.Escape:this.HideDropdown();break;case i.Up:case i.Down:break;default:this.ShowDropdown()}},e.prototype.IsVisible=function(){return this._dropDownElement.css("display")===""},e}();t.AutoComplete=h})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function r(e,t){var r=n.extend(!0,{},e,t);return delete r.constructor,r}var n=jQuery;t.extendWidgetOptions=r;var i=function(r){function i(){r.apply(this,arguments),this._dataOffset=0,this.rowOuterHeight=-1,this._windowResizeTimer=0,this.mEditSkechRowIndex=-1,this.mCurrentCellLocker=!1}return __extends(i,r),i.CSS={wijgrid:"wijmo-wijgrid",root:"wijmo-wijgrid-root",editedCellMarker:"wijmo-wijgrid-cell-edit",inputMarker:"wijgridinput",table:"wijmo-wijgrid-table",TH:"wijgridth",TD:"wijgridtd",cellContainer:"wijmo-wijgrid-innercell",aggregateContainer:"wijmo-wijgrid-aggregate",rowHeader:"wijmo-wijgrid-rowheader",currentRowHeaderCell:"wijmo-wijgrid-current-rowheadercell",currentHeaderCell:"wijmo-wijgrid-current-headercell",currentCell:"wijmo-wijgrid-current-cell",cellAlignLeft:"wijalign-left",cellAlignRight:"wijalign-right",cellAlignCenter:"wijalign-center",filterList:"wijmo-wijgrid-filterlist",filter:"wijmo-wijgrid-filter",filterInput:"wijmo-wijgrid-filter-input",filterTrigger:"wijmo-wijgrid-filter-trigger",filterNativeHtmlEditorWrapper:"wijgrid-input-wrapper",headerArea:"wijmo-wijgrid-header",footerArea:"wijmo-wijgrid-footer",headerRow:"wijmo-wijgrid-headerrow",row:"wijmo-wijgrid-row",dataRow:"wijmo-wijgrid-datarow",altRow:"wijmo-wijgrid-alternatingrow",emptyDataRow:"wijmo-wijgrid-emptydatarow",filterRow:"wijmo-wijgrid-filterrow",groupHeaderRow:"wijmo-wijgrid-groupheaderrow",groupFooterRow:"wijmo-wijgrid-groupfooterrow",groupHeaderRowCollapsed:"wijmo-wijgrid-groupheaderrow-collapsed",groupHeaderRowExpanded:"wijmo-wijgrid-groupheaderrow-expanded",footerRow:"wijmo-wijgrid-footerrow",loadingOverlay:"wijmo-wijgrid-overlay",loadingText:"wijmo-wijgrid-loadingtext",groupArea:"wijmo-wijgrid-group-area",groupAreaEmpty:"wijmo-wijgrid-group-area-empty",groupAreaButton:"wijmo-wijgrid-group-button",groupAreaButtonSort:"wijmo-wijgrid-group-button-sort",groupAreaButtonClose:"wijmo-wijgrid-group-button-close",groupToggleVisibilityButton:"wijmo-wijgrid-grouptogglebtn",fixedView:"wijmo-wijgrid-fixedview",scroller:"wijmo-wijgrid-scroller",dndHelper:"wijmo-wijgrid-dnd-helper",dndArrowTopContainer:"wijmo-wijgrid-dnd-arrow-top",dndArrowBottomContainer:"wijmo-wijgrid-dnd-arrow-bottom",freezingHandleV:"wijmo-wijgrid-freezing-handle-v",freezingHandleH:"wijmo-wijgrid-freezing-handle-h",freezingHandleContent:"wijmo-wijgrid-freezing-handle-content",resizingHandle:"wijmo-wijgrid-resizehandle",headerCellSortIcon:"wijmo-wijgrid-sort-icon",headerCellText:"wijmo-wijgrid-headertext",c1basefield:"wijmo-c1basefield",c1band:"wijmo-c1band",c1field:"wijmo-c1field"},i.prototype._createWidget=function(t,n){var i=t&&e.data.util.isClassInstance(t.data)&&!(typeof wijdatasource=="function"&&t.data instanceof wijdatasource)&&t.data;i&&(t._lateBindingFlag=!0,delete t.data),r.prototype._createWidget.apply(this,arguments),i&&(delete t._lateBindingFlag,t.data=i,this.option("data",i))},i.prototype._create=function(){var t=this;if(!this.element.is("table"))throw"invalid markup";this.mCurrentCellLocker=!1,this._windowResizeTimer=0,this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this.rowOuterHeight=-1,this._initialized=!1,this._destroyed=!1,this._rendered=!1,this._eventUID=undefined,this._dataViewWrapper=undefined,this._originalHtml=undefined,this._originalAttr=undefined,this._originalCssText=undefined,this._autoHeight=undefined,this._autoWidth=undefined,this._renderCounter=0,this.$superPanelHeader=undefined,this.$topPagerDiv=undefined,this.$bottomPagerDiv=undefined,this.$groupArea=undefined,this.__uid=undefined,this._wijDataView=undefined,this.outerDiv=undefined,this.sketchTable=undefined,this.cellFormatter=undefined,this.rowStyleFormatter=undefined,this.cellStyleFormatter=undefined,this._eventUID=e.grid.getUID(),this._spinnerIsActivated=!1,this.deficientFilters={};var r="data"in this.options,i=r&&this.options.data;r&&delete this.options.data,this.options=n.extend(!0,{},this.options),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options),r&&(this.options.data=i),window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._initialized=!1,this._destroyed=!1,this.mClosestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this._originalHtml=this.element.html(),this._originalAttr={},this._originalCssText=this.element[0].style.cssText,this.element.addClass(e.grid.wijgrid.CSS.root),this.element.wrap('<div class="'+this.options.wijCSS.widget+" "+e.grid.wijgrid.CSS.wijgrid+" "+this.options.wijCSS.wijgrid+" "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>'),this.outerDiv=this.element.parent();var s=this.element[0].style.height,o=this.element[0].style.width;s&&this.outerDiv.css("height",s),this._autoHeight=s==""||s=="auto",o&&this.outerDiv.css("width",this.element[0].style.width),this._autoWidth=o==""||o=="auto",this.element.css({height:"",width:""}),this.options.disabled&&this.disable(),this.cellFormatter=new e.grid.cellFormatterHelper,this.rowStyleFormatter=new e.grid.rowStyleFormatterHelper(this),this.cellStyleFormatter=new e.grid.cellStyleFormatterHelper(this),this._viewPortBounds({start:0,end:0}),this._allowVirtualScrolling()&&(this._viewPortBounds().start=this._scrollingState.index,this._serverSideVirtualScrolling()&&(this._dataOffset=this._scrollingState.index)),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(e){t._initialized&&!t._destroyed&&e.target!==t.outerDiv[0]&&t.setSize()},"wijgrid"),this._renderCounter=0},i.prototype._destroy=function(){var t,r=this;try{this._view().dispose(),this._detachEvents(!0),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._dragndropui&&(this._dragndropui.dispose(),this._dragndropui=null),this._dataViewWrapper.dispose(),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.wijRemoveVisibilityObserver&&this.element.wijRemoveVisibilityObserver(),this.element.insertBefore(this.outerDiv),this.outerDiv.remove(),this.element.html(this._originalHtml),n.each(this._originalAttr,function(e,t){t===undefined?r.element.removeAttr(e):r.element.attr(e,t)}),this.element.removeClass(e.grid.wijgrid.CSS.root),this.element[0].style.cssText=this._originalCssText}finally{this._destroyed=!0}},i.prototype._init=function(){this.$superPanelHeader=null,this.$topPagerDiv=null,this.$bottomPagerDiv=null,this.$groupArea=null,this._prevHoveredSketchRowIndex=-1,this.mClosestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this.options.data||(this._field("thead")||this._field("thead",e.grid.readTableSection(this.element,1)),this._field("tfoot")||this._field("tfoot",e.grid.readTableSection(this.element,3))),this._initialized=this._initialized||!1,this.ensureControl(!0)},i.prototype._setOption=function(e,t){var n=this["_preset_"+e],i=this.options[e],s,o;n!==undefined&&(t=n.apply(this,[t,i])),s=t!==i||e.toLowerCase()==="columns",r.prototype._setOption.apply(this,[e,t]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i]))},i.prototype.columns=function(){return this._field("columns")||[]},i.prototype.currentCell=function(n,r,i){var s,o=this._view(),u=this._rows();if(arguments.length===0)return s=this._field("currentCell"),s||this._field("currentCell",s=e.grid.cellInfo.outsideValue),s;s=typeof n!="number"?n._clone():new e.grid.cellInfo(n,r);if(!s.isEqual(e.grid.cellInfo.outsideValue)){if(!s._isValid())throw"invalid arguments";s._clip(this._getDataCellsRange(t.dataRowsRangeMode.sketch));if(s.rowIndex()>=0){var a=o._getRowInfoBySketchRowIndex(s.rowIndex());if(!a||!(a.type&e.grid.rowType.data))return}}return s._setGridView(this),this._changeCurrentCell(null,s,{changeSelection:i||!1,setFocus:!1}),this._field("currentCell")},i.prototype.data=function(){return this._dataViewWrapper.dataView().getSource()},i.prototype.dataView=function(){return this._dataViewWrapper.dataView()},i.prototype.doRefresh=function(r){var i=this;n.isPlainObject(r)||(r={});var s,o=this,u=e.grid.EXPANDO,a=r&&r.virtualScrollData;if(!this._initialized)try{this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.getFieldsInfo(),!0,!0)}catch(f){throw f}finally{this._ownerise(!0),this._initialized=!0}if(!a){this._rebuildLeaves();var l=t.lazy(this._dataViewWrapper.data,this._dataViewWrapper),c=this._dataViewWrapper.dataView(),h=this._prepareTotalsRequest(!0);h.length&&n.each(this._field("leaves"),function(e,t){t._totalsValue=l().totals?l().totals[t.dataKey]:undefined});if(c.count()){s=this._field("leaves");var p=new e.grid.LazySketchTable({count:function(){return c.count()},getRange:function(e,t,n,r){for(var o=0;o<t;o++){var u=e+o,a=c.item(u);n[r+o]=i._buildSketchRow({values:a,originalRowIndex:u},s)}}});(this._hasGrouping()||this._hasMerging())&&p.ensureNotLazy(),this.sketchTable=p}else{this.sketchTable=new e.grid.SketchTable;var d=l().emptyData;d&&(s=this._field("visibleLeaves"),n.each(d,function(e,t){o.sketchTable.add(o._buildSketchRowEmptyDataItem(t,s,e===d.length-1))}))}}this._onRendering(r),a?this._refreshVirtual(r):this._refresh(r),r&&n.isFunction(r.beforeOnRendered)&&r.beforeOnRendered.apply(this,[r]);var v=this._view();if(this.mEditSkechRowIndex>=0&&v._isRowRendered(this.mEditSkechRowIndex)>=0){var m=v._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex);m&&m.state&e.grid.renderState.editing&&v._makeRowEditable(m)}this._onRendered(r),r&&n.isFunction(r.afterRefresh)&&r.afterRefresh.apply(this,[r])},i.prototype.beginEdit=function(){if(!this._allowCellEditing())throw'Can be used only if the editingMode option is set to "cell".';return this._beginEditInternal(null)},i.prototype.endEdit=function(){return this._endEditInternal(null)},i.prototype.editRow=function(t){if(this.options.editingMode!=="row")throw'Can be used only if the editingMode option is set to "row".';this.mEditSkechRowIndex>=0&&this.cancelRowEditing();if(t>=0){var n=-1,r;for(var i=0;i<this.sketchTable.count()&&n<0;i++)r=this.sketchTable.row(i),r.isDataRow()&&r.dataItemIndex()===t&&(n=i);if(n>=0){var s=this._view();this.mEditSkechRowIndex=n,r.renderState|=e.grid.renderState.editing;if(s._isRowRendered(this.mEditSkechRowIndex)>=0){var o=s._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);o.state|=e.grid.renderState.editing,s._removeBodyRow(o.sectionRowIndex,!1),o=s._insertBodyRow(r,o.sectionRowIndex,o.dataItemIndex,-1),s._makeRowEditable(o),this.selection()._ensureSelectionInRow(this.mEditSkechRowIndex)}}}},i.prototype.updateRow=function(){if(this.mEditSkechRowIndex>=0){var n=e.grid.asEditableDataView(this._dataViewWrapper.dataView()),r=!1;if(!n)throw"The provided DataView doesn't supports the editing operation.";try{var i=this.sketchTable.row(this.mEditSkechRowIndex),s=this._view();if(!i||!i.isDataRow()||!(i.renderState&e.grid.renderState.editing))throw"Invalid row";if(this._view()._isRowRendered(this.mEditSkechRowIndex)>=0){var o=s._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1),u=this._field("visibleLeaves"),a=[],f=new e.grid.cellEditorHelper;for(var l=0;l<u.length;l++){var c=u[l];if(e.grid.validDataKey(c.dataKey)&&!c.readOnly){var h=o.$rows.children("td, th").eq(l);if(h.length){var p=s._changeCellRenderState(h,e.grid.renderState.none,!0);if(p&e.grid.renderState.editing){var d=s.getAbsoluteCellInfo(h[0],!0),v=f.updateCell(this,d,null);if(!(v&t.updateCellResult.success)){r=!0;return}v&t.updateCellResult.notEdited||a.push(d)}}}}for(var l=0;l<a.length;l++)f.cellEditEnd(this,a[l],null);i.renderState&=~e.grid.renderState.editing,o.state&=~e.grid.renderState.editing,s._removeBodyRow(o.sectionRowIndex,!1),o=s._insertBodyRow(i,o.sectionRowIndex,o.dataItemIndex,-1),this.selection()._ensureSelectionInRow(this.mEditSkechRowIndex)}else i.renderState&=~e.grid.renderState.editing}finally{r||(this.mEditSkechRowIndex=-1)}}},i.prototype.cancelRowEditing=function(){if(this.mEditSkechRowIndex>=0)try{var t=this.sketchTable.row(this.mEditSkechRowIndex),n=this._view();if(!t||!t.isDataRow()||!(t.renderState&e.grid.renderState.editing))throw"Invalid row.";t.renderState&=~e.grid.renderState.editing;if(this._view()._isRowRendered(this.mEditSkechRowIndex)>=0){var r=n._getRowInfoBySketchRowIndex(this.mEditSkechRowIndex,!1);r.state&=~e.grid.renderState.editing,n._removeBodyRow(r.sectionRowIndex,!1),r=n._insertBodyRow(t,r.sectionRowIndex,r.dataItemIndex,-1),this.selection()._ensureSelectionInRow(this.mEditSkechRowIndex)}}finally{this.mEditSkechRowIndex=-1}},i.prototype.deleteRow=function(t){if(t>=0){var n=e.grid.asEditableDataView(this._dataViewWrapper.dataView());if(!n||!n.canRemove())throw"The provided DataView doesn't supports the deleting operation.";this._dataViewWrapper.ignoreChangeEvent(!0),n.remove(t),this._dataViewWrapper.ignoreChangeEvent(!1),this.ensureControl(!0,{forceDataLoad:!0})}},i.prototype.ensureControl=function(t,r){this._loading(),n.isPlainObject(r)||(r={data:null,afterRefresh:null,beforeRefresh:null}),this._initialized?(!r||!r.virtualScrollData)&&this._convertWidgetsToOptions():(this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.isDataLoaded()&&this._dataViewWrapper.getFieldsInfo(),this._dataViewWrapper.isDataLoaded(),!1),this._dataViewWrapper.isOwnDataView()||(new e.grid.settingsManager(this)).MapDVToWG()),this._ownerise(!0),this._initialized&&r&&n.isFunction(r.beforeRefresh)&&r.beforeRefresh.apply(this);if(!r||!r.virtualScrollData)this.mAllowVirtualScrolling=undefined,this.mEditSkechRowIndex=-1;t===!0?this._dataViewWrapper.load(r):(this.doRefresh(r),this._loaded())},i.prototype.getCellInfo=function(e){var t=null;return e&&(e=this._findUntilOuterDiv(e,{td:!0,th:!0}))&&(t=this._view().getAbsoluteCellInfo(e,!1)),t},i.prototype.getFilterOperatorsByDataType=function(t){return(new e.grid.filterOperatorsCache(this)).getByDataType(t||"string")},i.prototype.pageCount=function(){return this._customPagingEnabled()?Math.ceil(this.options.totalRows/this.options.pageSize)||1:this.options.allowPaging?this._dataViewWrapper.dataView().pageCount():1},i.prototype._closestCulture=function(){return this.mClosestCulture},i.prototype._serverShaping=function(){return!1},i.prototype._pageIndexForDataView=function(){return this.options.pageIndex},i.prototype.setSize=function(e,t){var r=this._view(),i=null,s=this.outerDiv,o=this._field("visibleLeaves"),u=[];r&&r.getScrollValue&&(i=r.getScrollValue());if(e||e===0)this._autoWidth=!1,s.width(e);if(t||t===0)this._autoHeight=!1,s.height(t);n.each(o,function(e,t){var i=r.getHeaderCell(e),s=r.getJoinedCols(e);n(i).css("width",""),n.each(s,function(e,t){n(t).css("width","")})}),this._setSizeInternal(i);var a=this._UIFrozener();a&&a.refresh()},i.prototype._setSizeInternal=function(e){this._view().updateSplits(e)},i.prototype.selection=function(){var t=this._field("selection");return t||this._field("selection",t=new e.grid.selection(this)),t},i.prototype._onDataViewCurrentPositionChanged=function(e,t){var n=this._currentCellFromDataView(this.currentCell().cellIndex());n=this.currentCell(n,null,!0)},i.prototype._resetColumns=function(){this._ownerise(!1),e.grid.traverse(this.options.columns,function(e,t){if(e.dynamic){var r=n.inArray(e,t);r>=0&&t.splice(r,1)}else e.dataKey=e._originalDataKey,e.headerText=e._originalHeaderText}),this._initialized=!1},i.prototype._resetDataProperties=function(){this.options.pageIndex=0},i.prototype._resetVerticalBounds=function(){var e=this._viewPortBounds();e.start=0,this._scrollingState.index=0,this._scrollingState.y=0},i.prototype._onDataViewLoading=function(){this._activateSpinner(),this._trigger("dataLoading")},i.prototype._onDataViewReset=function(t,n){this.options._lateBindingFlag?delete this.options._lateBindingFlag:((new e.grid.settingsManager(this)).MapDVToWG(),this._trigger("dataLoaded"),n&&this._resetColumns(),this.doRefresh(t),this._loaded())},i.prototype._onDataViewLoaded=function(){},i.prototype._loading=function(){this._activateSpinner(),this._trigger("loading")},i.prototype._loaded=function(){this._deactivateSpinner(),this._trigger("loaded")},i.prototype._buildSketchRow=function(n,r){var i,s,o,u,a,f,l=e.data.Expando.getFrom(n.values,!1),c=l?l[e.grid.EXPANDO]:null,h=new t.SketchDataRow(n.originalRowIndex,e.grid.renderState.rendering,c&&c.rowAttributes),p=c&&c.cellsAttributes;for(i=0,s=r.length;i<s;i++)o=r[i],e.grid.validDataKey(o.dataKey)&&(u=p?p[o.dataKey]:null,a=this._dataViewWrapper.getValue(n.values,o.dataKey),h.add(new t.ValueCell(this.parse(o,a),u)));return h},i.prototype._buildSketchRowEmptyDataItem=function(n,r,i){var s,o,u=new t.SketchRow(e.grid.rowType.emptyDataRow,e.grid.renderState.rendering,null),a=r.length;for(s=0,o=n.length;s<o;s++)u.add(new t.HtmlCell(n[s],{colSpan:a>0&&i?a:1}));return u},i.prototype._prepareColumnOptions=function(r,i,s,o,u){e.grid.traverse(r,function(e){e.isBand=n.isArray(e.columns)||e.clientType==="c1band";if(t.c1commandbtnfield.test(e)||t.c1btnfield.test(e))e.dataKey=null;e._originalDataKey=e.dataKey,e._originalHeaderText=e.headerText}),(new e.grid.bandProcessor).getVisibleHeight(r,!0);var a=[],f=this._originalHeaderRowData(),l=this._originalFooterRowData(),c=(i||"").toLowerCase(),h=this;o&&e.grid.columnsGenerator.generate(c,s,r),e.grid.setTraverseIndex(r),e.grid.traverse(r,function(r){r.isBand=n.isArray(r.columns)||r.clientType==="c1band",e.grid.shallowMerge(r,t.c1basefield.prototype.options),r.isBand?r.clientType="c1band":t.c1commandbtnfield.test(r)?(r.clientType="c1commandbtnfield",e.grid.shallowMerge(r,t.c1btnfieldbase.prototype.options),e.grid.shallowMerge(r,t.c1commandbtnfield.prototype.options),r.editCommand=r.editCommand||{},e.grid.shallowMerge(r.editCommand,t.c1commandbtnfield.prototype.options.editCommand),r.cancelCommand=r.cancelCommand||{},e.grid.shallowMerge(r.cancelCommand,t.c1commandbtnfield.prototype.options.cancelCommand),r.deleteCommand=r.deleteCommand||{},e.grid.shallowMerge(r.deleteCommand,t.c1commandbtnfield.prototype.options.deleteCommand),r.updateCommand=r.updateCommand||{},e.grid.shallowMerge(r.updateCommand,t.c1commandbtnfield.prototype.options.updateCommand)):t.c1btnfield.test(r)?(r.clientType="c1btnfield",e.grid.shallowMerge(r,t.c1btnfieldbase.prototype.options),e.grid.shallowMerge(r,t.c1btnfield.prototype.options)):(e.grid.shallowMerge(r,t.c1field.prototype.options),r.groupInfo=r.groupInfo||{},e.grid.shallowMerge(r.groupInfo,t.c1field.prototype.options.groupInfo),r.clientType||(r.clientType="c1field")),r.isLeaf&&!r.isBand&&a.push(r)}),this._field("leaves",a),o&&n.each(a,n.proxy(function(t,r){var i=typeof r.dataKey=="number"?r.dataKey:t;(c==="merge"||r.dynamic===!0)&&r.headerText===undefined&&(h._dataViewWrapper&&h._dataViewWrapper.isBoundedToDOM()&&f&&i<f.length?r.headerText=n.trim(f[i]):e.grid.validDataKey(r.dataKey)&&(r.headerText=""+r.dataKey)),h._dataViewWrapper&&h._dataViewWrapper.isBoundedToDOM()&&l&&i<l.length&&(r._footerTextDOM=n.trim(l[i]))},this))},i.prototype._rebuildLeaves=function(){var t=[],r=[],i;this._showRowHeader()&&(i=e.grid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:!0,allowMoving:!1,allowSizing:!1,allowSort:!1,isRowHeader:!0}),i.owner=this,t.push(i)),n.each(this.options.columns,function(e,n){t.push(n)}),this._columnsHeadersTable((new e.grid.bandProcessor).generateSpanTable(t,r)),this._field("leaves",r),this._onLeavesCreated()},i.prototype._onLeavesCreated=function(){var t=this._field("leaves"),r=this._dataViewWrapper.getFieldsInfo(),i,s=0,o=0,u=this;this._field("visibleLeaves",n.grep(t,function(t,u){return t.leavesIdx=u,e.grid.validDataKey(t.dataKey)?t.dataIndex=s++:t.dataIndex=-1,t.isBand||(i=r[t.dataKey],i&&(t._underlyingDataType=i.type,t._underlyingDataFormatString=i.format),n.isFunction(t.dataParser)&&(t.dataParser=new t.dataParser)),t.parentVis?(t.visLeavesIdx=o++,!0):!1}))},i.prototype._allowEditing=function(){return this.options.allowEditing===!0||this.options.editingMode==="cell"||this.options.editingMode==="row"},i.prototype._allowCellEditing=function(){var e=this.options.editingMode;return e==="row"?!1:this.options.allowEditing===!0||e==="cell"},i.prototype._allowVirtualScrolling=function(){return this.mAllowVirtualScrolling===undefined&&(this.mAllowVirtualScrolling=!this.options.allowPaging&&this.options.allowVirtualScrolling&&this.options.staticRowIndex<0&&this.options.scrollMode!=="none"&&!this._hasMerging()),this.mAllowVirtualScrolling},i.prototype._headerRows=function(){return this._view().headerRows()},i.prototype._filterRow=function(){return this._view().filterRow()},i.prototype._rows=function(){return this._view().bodyRows()},i.prototype._localizeFilterOperators=function(t){var r=this,i=new e.grid.filterOperatorsCache(this);n.each(t,function(e,t){if(t.name){var n=i.getByName(t.name);n&&(n.displayName=t.displayName)}})},i.prototype._KeyDownEventListener=function(){if(!this.mKeyDownEventListener){var e=this._view(),n=e&&e.focusableElement();n&&(this.mKeyDownEventListener=new t.keyDownEventListener(this,n))}return this.mKeyDownEventListener},i.prototype._UIDragndrop=function(t){return!this._dragndropui&&t&&(this._dragndropui=new e.grid.uiDragndrop(this)),this._dragndropui},i.prototype._UIFrozener=function(t){return!this._frozenerui&&t&&(this._frozenerui=new e.grid.uiFrozener(this)),this._frozenerui},i.prototype._UIResizer=function(t){return!this._resizerui&&t&&(this._resizerui=new e.grid.uiResizer(this)),this._resizerui},i.prototype._UISelection=function(t){return!this._selectionui&&t&&(this._selectionui=new e.grid.uiSelection(this)),this._selectionui},i.prototype._postset_allowColMoving=function(e,t){var r=this;n.each(this.columns(),function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)});var i=this._field("groupedWidgets");i&&n.each(i,function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)})},i.prototype._postset_allowEditing=function(e,t){this._postset_editingMode(this.options.editingMode,undefined)},i.prototype._postset_allowSorting=function(e,t){this.ensureControl(!1)},i.prototype._postset_columns=function(e,t){this._initialized=!1,this.ensureControl(!0)},i.prototype._postset_allowPaging=function(e,t){this.ensureControl(!0)},i.prototype._postset_freezingMode=function(e,t){this._frozenerui&&this._frozenerui.refresh()},i.prototype._postset_culture=function(e,t){this.mClosestCulture=Globalize.findClosestCulture(e)||Globalize.findClosestCulture("default"),this.ensureControl(!1)},i.prototype._postset_customFilterOperators=function(e,t){var n=this._dataViewWrapper.dataView()},i.prototype._postset_data=function(t,n){this._resetColumns(),this._dataViewWrapper&&this._dataViewWrapper.dispose(),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this.ensureControl(!0)},i.prototype._postset_disabled=function(t,n){var r=this,i=this._view();e.grid.iterateChildrenWidgets(this.outerDiv,function(e,n){n!==r&&n.option("disabled",t)}),i&&i.ensureDisabledState()},i.prototype._postset_editingMode=function(e,t){this.mKeyDownEventListener&&(this.mKeyDownEventListener.dispose(),this.mKeyDownEventListener=null,this._KeyDownEventListener())},i.prototype._postset_groupIndent=function(e,t){this.ensureControl(!1)},i.prototype._postset_groupAreaCaption=function(e,t){var n=this._groupedColumns();this.$groupArea&&(!n||!n.length)&&this.$groupArea.html(e||"&nbsp;")},i.prototype._postset_highlightCurrentCell=function(e,t){var n=this.currentCell();n&&n._isValid()&&this._highlightCellPosition(n,e)},i.prototype._preset_pageIndex=function(e,t){if(isNaN(e))throw"out of range";var n=this.pageCount(),r=function(e){return e>n-1&&(e=n-1),e<0&&(e=0),e},i;return e=r(e),this.options.allowPaging&&e!==t&&(i={newPageIndex:e},this._onPageIndexChanging(i)?e=r(i.newPageIndex):e=t),e},i.prototype._postset_pageIndex=function(e,t){if(this.options.allowPaging){var n={newPageIndex:e};this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onPageIndexChanged(n)):this.ensureControl(!0,{afterRefresh:function(){this._onPageIndexChanged(n)}})}},i.prototype._preset_pageSize=function(e,t){if(isNaN(e))throw"out of range";return e<=0&&(e=1),e},i.prototype._postset_pageSize=function(e,t){this._resetDataProperties(),this.options.allowPaging&&!this._customPagingEnabled()&&this.ensureControl(!0)},i.prototype._postset_pagerSettings=function(e,t){this.ensureControl(!1)},i.prototype._postset_rowHeight=function(e,t){this.rowOuterHeight=-1,this.ensureControl(!1)},i.prototype._postset_scrollMode=function(e,t){this.ensureControl(!1)},i.prototype._postset_selectionMode=function(t,n){var r=this.selection(),i=this.currentCell(),s=this.selection().selectedCells().length();r.beginUpdate(),r.clear(),i&&i._isValid()&&s&&r._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,e.grid.cellRangeExtendMode.none,null),r.endUpdate(),this._view().toggleDOMSelection(t==="none")},i.prototype._postset_showFilter=function(e,t){this.ensureControl(!1)},i.prototype._postset_showGroupArea=function(e,t){this.ensureControl(!1)},i.prototype._postset_showRowHeader=function(e,t){this.ensureControl(!1)},i.prototype._postset_staticRowIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},i.prototype._postset_staticColumnIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},i.prototype._postset_allowVirtualScrolling=function(e,t){this.ensureControl(!1)},i.prototype._preset_allowVirtualScrolling=function(e,t){if(isNaN(e)||e<0)throw"out of range";return e},i.prototype._activateSpinner=function(){if(!this._spinnerIsActivated){var t=e.grid.wijgrid.CSS,n=this.options.wijCSS,r=this.outerDiv.append('<div class="'+t.loadingOverlay+" "+n.wijgridLoadingOverlay+" "+n.overlay+'"></div>'+'<span class="'+t.loadingText+" "+n.wijgridLoadingText+" "+n.content+" "+n.cornerAll+'">'+'<span class="'+n.icon+" "+n.iconClock+'"></span>'+this.options.loadingText+"</span>").find("> ."+t.loadingText);r.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"}),this._spinnerIsActivated=!0}},i.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0},i.prototype._deactivateSpinner=function(){if(this._spinnerIsActivated)try{var t=e.grid.wijgrid.CSS;this.outerDiv.find("> ."+t.loadingOverlay+", > ."+t.loadingText).remove()}finally{this._spinnerIsActivated=!1}},i.prototype._columnWidgetsFactory=function(e,t){var r,i=t.clientType;!i&&t.isBand&&(i="c1band"),t=n.extend({},t,{disabled:this.options.disabled});try{n.data(e[0],"wijgridowner",this);switch(i){case"c1basefield":r=e.c1basefield(t);break;case"c1band":r=e.c1band(t);break;case"c1btnfield":r=e.c1btnfield(t);break;case"c1commandbtnfield":r=e.c1commandbtnfield(t);break;default:r=e.c1field(t)}}finally{n.removeData(e[0],"wijgridowner")}return r},i.prototype._convertWidgetsToOptions=function(){this._initialized&&this._mergeWidgetsWithOptions&&(this._ownerise(!1),this._widgetsToOptions(),this._ownerise(!0))},i.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},i.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},i.prototype._prepareTotalsRequest=function(t){var r=this._field("leaves"),i,s;return!r||!this.options.showFooter?[]:(i=n.map(r,function(n,r){return!n.isBand&&e.grid.validDataKey(n.dataKey)&&n.aggregate&&n.aggregate!=="none"?t?[{column:n,aggregate:n.aggregate}]:[{dataKey:n.dataKey,aggregate:n.aggregate}]:null}),i)},i.prototype._widgetsToOptions=function(){var t=e.grid.flatten(this.options.columns);n.each(this.columns(),function(e,r){delete r.options.columns;var i=t[r.options.travIdx];n.extend(!0,i,r.options),i.filterValue=r.options.filterValue,i.filterOperator=r.options.filterOperator})},i.prototype._recreateColumnWidgets=function(){n.each(this.columns(),function(e,t){t.destroy()});var t=[],r=this._headerRows(),i,s,o,u,a,f,l;if(r&&r.length()){i=[],e.grid.traverse(this.options.columns,function(e){e.parentVis&&i.push(e)});for(s=0,o=i.length;s<o;s++)u=i[s],a=r.item(u.thY),f=e.grid.rowAccessor.getCell(a,u.thX),l=this._columnWidgetsFactory(n(f),u),t.push(l.data(e.grid.widgetName(l)))}this._field("columns",t)},i.prototype._groupedColumns=function(e){var t;e=!(t=this._field("groupedColumns"))||e;if(e){t=[];var r=this._field("leaves")||[],i=!1,s=function(e){return e.groupInfo&&e.groupInfo.position&&e.groupInfo.position!=="none"};n.each(r,function(e,n){s(n)?(i=i||n.groupedIndex===undefined,i||t.push(n)):delete n.groupedIndex}),i?n.each(r,function(e,n){s(n)&&(n.groupedIndex=t.length,t.push(n))}):(t.sort(function(e,t){return e.groupedIndex-t.groupedIndex}),n.each(t,function(e,t){t.groupedIndex=e})),this._field("groupedColumns",t)}return t||[]},i.prototype._ownerise=function(t){if(t){var n=this;e.grid.traverse(this.options.columns,function(e){e.owner=n;var t,r,i;if(t=e.groupInfo){t.owner=e;if(t.expandInfo)for(r=0,i=t.expandInfo.length;r<i;r++)t.expandInfo[r].owner=t}})}else e.grid.traverse(this.options.columns,function(e){delete e.owner;var t,n,r;if(t=e.groupInfo){delete t.owner;if(t.expandInfo)for(n=0,r=t.expandInfo.length;n<r;n++)delete t.expandInfo[n].owner}})},i.prototype._ensureRenderableBounds=function(t){return e.grid.ensureBounds(t,this._renderableRowsCount()-1)},i.prototype._ensureTotalRowsBounds=function(t){return e.grid.ensureBounds(t,this._totalRowsCount()-1)},i.prototype._ensureViewPortBoundsVisible=function(e){var t=this._renderableRowsCount();return e.end>=t&&(e.start-=e.end-(t-1),e.end=t-1,e.start=Math.max(0,e.start),e.end=Math.max(0,e.end)),e},i.prototype._renderableBoundsCollection=function(){return this.mRenderableBoundsCollection},i.prototype._rebuildRenderBoundsCollection=function(){var t=-1,n=-1,r=!1,i=this._totalRowsCount();this.mRenderableBoundsCollection=new e.grid.renderBoundsCollection(i-1);if(this._allowVirtualScrolling()&&this._serverSideVirtualScrolling())this.mRenderableBoundsCollection.add({start:0,end:i-1});else if(!this._allowVirtualScrolling()||!this._hasGrouping())this.mRenderableBoundsCollection.add({start:0,end:i-1});else{for(var s=0;s<this.sketchTable.count();s++){var o=this.sketchTable.row(s);o.extInfo.state&e.grid.renderStateEx.hidden?(t>=0&&(this.mRenderableBoundsCollection.add({start:t,end:n}),r=!1),t=n=-1):t<0?(r=!0,t=n=s):n++}r&&this.mRenderableBoundsCollection.add({start:t,end:n})}},i.prototype._refresh=function(t){(new e.grid.grouper).group(this,this.sketchTable,this._field("leaves")),(new e.grid.merger).merge(this.sketchTable,this._field("visibleLeaves")),this._rebuildRenderBoundsCollection(),this.options.scrollMode!=="none"?this.mView=new e.grid.fixedView(this,this._viewPortBounds()):this.mView=new e.grid.flatView(this,this._viewPortBounds()),this._render(),this._ownerise(!1),this._recreateColumnWidgets(),this._ownerise(!0),this.options.allowPaging&&(this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5),this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5))},i.prototype._refreshVirtual=function(e){var t=e.virtualScrollData,n={top:0,bottom:0};t.data&&(n=this._processVirtualData(t)),this._updateRowInfos(t,n),this._renderVirtualIntoView(t)},i.prototype._updateRowInfos=function(e,n){var r=this._viewPortBounds(),i=this._view(),s=e.newBounds,o=this._view().bodyRows(),u,a,f,l;switch(e.mode){case t.intersectionMode.reset:break;case t.intersectionMode.overlapBottom:u={start:s.start-r.start,end:r.end-r.start},f=s.start-r.start;for(a=u.start;a<=u.end;a++)l=i._getRowInfo(o.item(a),!1),l.sectionRowIndex-=f,n.top!==0&&(l.dataItemIndex+=n.top),i._setRowInfo(l.$rows,l);break;case t.intersectionMode.overlapTop:u={start:r.start-r.start,end:s.end-r.start},f=r.start-s.start;for(a=u.start;a<=u.end;a++)l=i._getRowInfo(o.item(a),!1),l.sectionRowIndex+=f,n.top!==0&&(l.dataItemIndex+=n.top),i._setRowInfo(l.$rows,l)}},i.prototype._renderVirtualIntoView=function(e){var n=this._viewPortBounds(),r=this,i,s=this._view(),o,u,a;switch(e.mode){case t.intersectionMode.reset:s._clearBody();var f=e.newBounds.end-e.newBounds.start+1;this._renderableBoundsCollection().forEachIndex(e.newBounds.start,f,function(e){i=r.sketchTable.row(e-r._dataOffset),s._insertBodyRow(i,-1,i.dataItemIndex(),e)}),s._rebuildOffsets();break;case t.intersectionMode.overlapBottom:o={start:e.newBounds.start,end:n.end};for(u=0;u<o.start-n.start;u++)s._removeBodyRow(0);var f=e.newBounds.end-o.end;this._renderableBoundsCollection().forEachIndex(o.end+1,f,function(e){i=r.sketchTable.row(e-r._dataOffset),s._insertBodyRow(i,-1,i.dataItemIndex(),e)});break;case t.intersectionMode.overlapTop:o={start:n.start,end:e.newBounds.end};for(u=0;u<n.end-e.newBounds.end;u++)s._removeBodyRow(o.end-o.start+1);a=0;var f=n.start-e.newBounds.start;this._renderableBoundsCollection().forEachIndex(e.newBounds.start,f,function(e){i=r.sketchTable.row(e-r._dataOffset),s._insertBodyRow(i,a++,i.dataItemIndex(),e)});break;default:}},i.prototype._processVirtualData=function(e){var n=this._dataViewWrapper,r=n.dataView().getSource(),i,s=this._field("leaves"),o,u,a,f=0,l={top:0,bottom:0},c,h=this._serverSideVirtualScrollingMargin();switch(e.mode){case t.intersectionMode.reset:this.sketchTable.clear(),n._unsafeSplice(0,r.length),this._dataOffset=e.request.index;for(o=0;o<e.data.length;o++)n._unsafePush(i=e.data[o]),this.sketchTable.add(this._buildSketchRow(n._wrapDataItem(i,o),s));break;case t.intersectionMode.overlapBottom:for(o=0;o<e.data.length;o++)n._unsafePush(i=e.data[o]),this.sketchTable.add(this._buildSketchRow(n._wrapDataItem(i,r.length-1),s));l.bottom=e.data.length;break;case t.intersectionMode.overlapTop:for(o=e.data.length-1;o>=0;o--)n._unsafeSplice(0,0,i=e.data[o]),this.sketchTable.insert(0,this._buildSketchRow(n._wrapDataItem(i,o),s));this._dataOffset=e.request.index,l.top=e.data.length}return u=this._ensureTotalRowsBounds({start:e.newBounds.start,end:e.newBounds.end}),a={start:this._dataOffset,end:this._dataOffset+r.length-1},f=a.end-u.end-h,f>0&&(l.bottom-=f,n._unsafeSplice(r.length-f,f),this.sketchTable.removeLast(f)),f=u.start-a.start-h,f>0&&(l.top-=f,n._unsafeSplice(0,f),this.sketchTable.removeFirst(f),this._dataOffset+=f),this.sketchTable.updateIndexes(),n._refreshSilent(),l},i.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===!0},i.prototype._isMobileEnv=function(){return this._isMobile},i.prototype._isTouchEnv=function(){return!!n.support.isTouchEnabled&&!!n.support.isTouchEnabled()},i.prototype._render=function(){var t=this._view(),r=this.options,i=e.grid.wijgrid.CSS,s=this.options.wijCSS,o;t.render(),o=this.outerDiv,r.scrollMode!=="none"&&(o=this.outerDiv.find("div."+i.scroller+":first")),this.$superPanelHeader=null,this.$topPagerDiv&&(this.$topPagerDiv.data("wijmo-wijpager")&&this.$topPagerDiv.wijpager("destroy"),this.$topPagerDiv.remove()),this.$topPagerDiv=null,this._needToCreatePagerItem()&&(r.pagerSettings.position==="top"||r.pagerSettings.position==="topAndBottom")&&(this.$topPagerDiv||(o.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$topPagerDiv=n('<div class="'+i.headerArea+" "+s.wijgridHeaderArea+" "+s.header+" "+s.cornerTop+'"></div>')))),r.showGroupArea?this._processGroupArea(o):this.$groupArea=null,this.$bottomPagerDiv&&(this.$bottomPagerDiv.data("wijmo-wijpager")&&this.$bottomPagerDiv.wijpager("destroy"),this.$bottomPagerDiv.remove()),this.$bottomPagerDiv=null,this._needToCreatePagerItem()&&(r.pagerSettings.position==="bottom"||r.pagerSettings.position==="topAndBottom")&&(this.$bottomPagerDiv||o.append(this.$bottomPagerDiv=n('<div class="'+i.footerArea+" "+s.wijgridFooterArea+" wijmo-wijsuperpanel-footer "+s.stateDefault+" "+s.cornerBottom+'"></div>')))},i.prototype._processGroupArea=function(t){var r=this,i=this._groupedColumns(),s=[],o=e.grid.wijgrid.CSS,u=this.options.wijCSS;this.$groupArea=n('<div class="'+u.content+" "+u.helperClearFix+" "+o.groupArea+" "+u.wijgridGroupArea+'"></div>'),i.length>0?n.each(i,function(e,t){var i=n('<a href="#"></a>').appendTo(r.$groupArea);try{n.data(i[0],"wijgridowner",r),i.c1groupedfield(n.extend({},{allowMoving:t.allowMoving,allowSort:t.allowSort,dataIndex:t.dataIndex,dataKey:t.dataKey,headerText:t.headerText,isBand:t.isBand,isLeaf:t.isLeaf,linearIdx:t.linearIdx,parentIdx:t.parentIdx,sortDirection:t.sortDirection,travIdx:t.travIdx,groupedIndex:t.groupedIndex},{disabled:r.options.disabled}))}finally{n.removeData(i[0],"wijgridowner")}s.push(i.data("wijmo-c1groupedfield"))}):this.$groupArea.addClass(o.groupAreaEmpty).css("padding",0).html(this.options.groupAreaCaption||"&nbsp;"),this._field("groupedWidgets",s),this.$superPanelHeader||t.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$groupArea),this._UIDragndrop(!0).attachGroupArea(this.$groupArea)},i.prototype._pagerSettings2PagerWidgetSettings=function(){return n.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:n.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:n.proxy(this._onPagerWidgetPageIndexChanged,this)})},i.prototype._showRowHeader=function(){return this.options.showRowHeader===!0&&this.options.staticColumnsAlignment!=="right"},i.prototype._attachEvents=function(){var e=this._view(),t=e.focusableElement(),r=this;t.bind("keydown."+this.widgetName,n.proxy(this._onKeyDown,this)),t.bind("focusin."+this.widgetName,n.proxy(this._onFocusIn,this)),this._KeyDownEventListener(),n.each(e.subTables(),function(e,t){var i=t.element();i&&(i.tHead&&n(i.tHead).bind("click."+r.widgetName,n.proxy(r._onClick,r)),i.tBodies.length&&n(i.tBodies[0]).bind("click."+r.widgetName,n.proxy(r._onClick,r)).bind("dblclick."+r.widgetName,n.proxy(r._onDblClick,r)).bind("mousemove."+r.widgetName,n.proxy(r._onMouseMove,r)).bind("mouseout."+r.widgetName,n.proxy(r._onMouseOut,r)))}),n(window).bind("resize."+this.widgetName+"."+this._eventUID,n.proxy(this._onWindowResize,this))},i.prototype._detachEvents=function(e){var t=this._view(),r=this,i;this._windowResizeTimer=0,n(window).unbind("resize."+this.widgetName+"."+this._eventUID),t&&(i=t.focusableElement(),i.unbind("."+this.widgetName),n.each(t.subTables(),function(){var e=this.element();e&&(e.tHead&&n(e.tHead).unbind("."+r.widgetName),e.tBodies.length&&n(e.tBodies[0]).unbind("."+r.widgetName))}))},i.prototype._handleSort=function(t,r){var i=this.options.columns,s=t.travIdx,o,u;t&&this.options.allowSorting&&(o=t.sortDirection==="none"?"ascending":t.sortDirection==="ascending"?"descending":"ascending",u={column:t,sortDirection:o,sortCommand:t.dataKey+" "+(o==="ascending"?"asc":"desc")},this._onColumnSorting(u)&&(t.sortDirection=u.sortDirection,r?t.sortOrder=this._customSortOrder++:(this._customSortOrder=1e3,n.each(this.columns(),function(e,t){t.options.sortOrder=0,t.options.travIdx!==s&&(!t.options.groupInfo||t.options.groupInfo.position==="none")&&(t.options.sortDirection="none")}),e.grid.traverse(i,function(e){e.sortOrder=0,e.travIdx!==s&&(!e.groupInfo||e.groupInfo.position==="none")&&(e.sortDirection="none")})),u={column:t,sortDirection:t.sortDirection,sortCommand:t.dataKey+" "+(t.sortDirection==="ascending"?"asc":"desc")},this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnSorted(u)):this.ensureControl(!0,{afterRefresh:function(){this._onColumnSorted(u)}})))},i.prototype._handleDragnDrop=function(t,r,i,s,o){var u=e.grid.getColumnByTravIdx(this.options.columns,t),a=e.grid.getColumnByTravIdx(this.options.columns,r),f=s?"groupArea":"columns",l=o?"groupArea":"columns";o?this._onColumnGrouping({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})&&this.ensureControl(!0,{beforeRefresh:function(){if(!a)u.found.groupedIndex=0;else switch(i){case"left":u.found.groupedIndex=a.found.groupedIndex-.5;break;case"right":u.found.groupedIndex=a.found.groupedIndex+.5}s||n.extend(!0,u.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})}}):this._onColumnDropping({drag:u.found,drop:a.found,at:i})&&this.ensureControl(!1,{beforeRefresh:function(){u.at.splice(u.found.linearIdx,1);switch(i){case"left":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx-1,0,u.found):a.at.splice(a.found.linearIdx,0,u.found);break;case"right":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx,0,u.found):a.at.splice(a.found.linearIdx+1,0,u.found);break;case"center":a.found.columns.push(u.found)}e.grid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:u.found,drop:a.found,at:i})}})},i.prototype._handleFilter=function(t,n,r){var i=(new e.grid.filterOperatorsCache(this)).getByName(n),s,o,u;i&&(i.arity>1?(s=this.parse(t.options,r),o=s!==null&&(e.grid.getDataType(t.options)==="string"||!isNaN(s))):o=!0,o&&(u={column:t.options,operator:i.name,value:s},this._onColumnFiltering(u)&&(t.options.filterValue=u.value,t.options.filterOperator=u.operator,this._resetDataProperties(),this._resetVerticalBounds(),this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnFiltered({column:t.options})):this.ensureControl(!0,{afterRefresh:function(){this._onColumnFiltered({column:t.options})}}))))},i.prototype._handleUngroup=function(t){var r=e.grid.getColumnByTravIdx(this.options.columns,t),i;r&&r.found&&(i=r.found,this._onColumnUngrouping({column:i})&&this.ensureControl(!0,{beforeRefresh:function(){delete i.groupedIndex,n.extend(!0,i,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:i})}}))},i.prototype._onVirtualScrolling=function(e,t,r,i,s,o){var u=this;this.ensureControl(this._serverSideVirtualScrolling(),{virtualScrollData:{newBounds:e,request:t,mode:r,data:o},beforeOnRendered:function(e){var t=u._viewPortBounds();n.extend(t,e.virtualScrollData.newBounds)},afterRefresh:function(e){u._view()._adjustRowsHeights(),s&&s(i)}})},i.prototype._handleVirtualScrolling=function(e,n,r){typeof n=="undefined"&&(n=null);var i=this._view(),s=this._viewPortBounds(),o=this._ensureRenderableBounds({start:e,end:e+i.getVirtualPageSize()-1}),u=this._ensureTotalRowsBounds({start:this._dataOffset,end:this._dataOffset+this._dataViewWrapper.dataView().count()-1}),a=null,f,l=this._view().getVirtualPageSize();n?f=n:o.start>s.end||o.end<s.start?f=t.intersectionMode.reset:o.start>s.start?f=t.intersectionMode.overlapBottom:o.start<s.start?f=t.intersectionMode.overlapTop:f=o.start!==s.start||o.end!==s.end?t.intersectionMode.reset:t.intersectionMode.none;if(this._serverSideVirtualScrolling())switch(f){case t.intersectionMode.reset:a={index:e,maxCount:l};break;case t.intersectionMode.overlapBottom:o.end>u.end&&(a={index:u.end+1,maxCount:l});break;case t.intersectionMode.overlapTop:o.start<u.start&&(a={index:Math.max(0,u.start-l),maxCount:0},a.maxCount=u.start-a.index)}f!==t.intersectionMode.none&&this._onVirtualScrolling(o,a,f,e,r)},i.prototype._serverSideVirtualScrolling=function(){return!1},i.prototype._serverSideVirtualScrollingMargin=function(){var e=this._view().getVirtualPageSize()*2;return e<20&&(e=20),e},i.prototype._onColumnDropping=function(e){return this._trigger("columnDropping",null,e)},i.prototype._onColumnDropped=function(e){this._trigger("columnDropped",null,e)},i.prototype._onColumnGrouping=function(e){return this._trigger("columnGrouping",null,e)},i.prototype._onColumnGrouped=function(e){this._trigger("columnGrouped",null,e)},i.prototype._onColumnUngrouping=function(e){return this._trigger("columnUngrouping",null,e)},i.prototype._onColumnUngrouped=function(e){this._trigger("columnUngrouped",null,e)},i.prototype._onColumnFiltering=function(e){return this._trigger("filtering",null,e)},i.prototype._onColumnFiltered=function(e){this._trigger("filtered",null,e)},i.prototype._onFilterOperatorsListShowing=function(e){this._trigger("filterOperatorsListShowing",null,e)},i.prototype._onColumnSorting=function(e){return this._trigger("sorting",null,e)},i.prototype._onColumnSorted=function(e){this._trigger("sorted",null,e)},i.prototype._onCurrentCellChanged=function(r,i){var s=this,o=this.options,u=this.currentCell(),a=u.row(),f=function(){var o=s.currentCell(),u=s._getDataCellsRange(t.dataRowsRangeMode.sketch);if(s.options.highlightCurrentCell){var a=new e.grid.cellInfo(i.changingEventArgs.oldCellIndex,i.changingEventArgs.oldRowIndex,s);a._isValid&&u._containsCellInfo(a)&&s._highlightCellPosition(a,!1),s._highlightCellPosition(o,!0)}var f;i.setFocus&&(f=o.tableCell())&&s._setFocusOnCell(i.hasFocusedChild?n(r.target):n(f),i.hasFocusedChild,o.column()),s._trigger("currentCellChanged");var l=r&&(r.type||"").toLowerCase()||"";if(i.changeSelection){var c=s.selection(),h=s.options.selectionMode.toLowerCase(),p=i.selectionExtendMode||e.grid.cellRangeExtendMode.none;c.beginUpdate();if(l){if(o._isValid())switch(l){case"focusin":case"click":(!r.shiftKey||!c._multipleRangesAllowed()&&h!=="singlerange")&&c._startNewTransaction(o),r.shiftKey&&r.ctrlKey?c._clearRange(new e.grid.cellInfoRange(o,o),p):c._selectRange(new e.grid.cellInfoRange(c._anchorCell(),o),r.ctrlKey,r.shiftKey,p,null);break;case"keydown":(!r.shiftKey||!c._multipleRangesAllowed()&&h!=="singlerange")&&c._startNewTransaction(o),c._selectRange(new e.grid.cellInfoRange(c._anchorCell(),o),!1,r.shiftKey,e.grid.cellRangeExtendMode.none,null)}}else c.clear(),o._isValid()&&(c._startNewTransaction(o),c._selectRange(new e.grid.cellInfoRange(o,o),!1,!1,e.grid.cellRangeExtendMode.none,null));c.endUpdate()}l==="click"&&s._editBySingleClick()&&s._beginEditInternal(r)};this.mCurrentCellLocker=!0,this._dataViewWrapper.currentPosition(a&&a.type&e.grid.rowType.data?a.dataItemIndex:-1);if(o.scrollMode!=="none"&&u&&!u.isEqual(e.grid.cellInfo.outsideValue)){var l=u,a=l.row();a&&!(a.type&e.grid.rowType.data)&&!l.tableCell()&&(l=u._clone(),l.cellIndex(0)),this._view().scrollTo(l,function(){try{f()}finally{s.mCurrentCellLocker=!1}},i)}else try{f()}finally{this.mCurrentCellLocker=!1}},i.prototype._onPageIndexChanging=function(e){return this._trigger("pageIndexChanging",null,e)},i.prototype._onPageIndexChanged=function(e){this._trigger("pageIndexChanged",null,e)},i.prototype._onPagerWidgetPageIndexChanging=function(e,t){t.handled=!0},i.prototype._onPagerWidgetPageIndexChanged=function(e,t){this._setOption("pageIndex",t.newPageIndex)},i.prototype._onRendering=function(e){var t=this._view();this._rendered=!1;if(!e.virtualScrollData){var n=this._field("currentCell");this._field("currentCellPrevCycle",n?{x:n.cellIndex(),y:n.rowIndex(),dataItemIndex:n.row()?n.row().dataItemIndex:-1}:{x:-1,y:-1,dataItemIndex:-1}),this._field("currentCell",null),t&&t.dispose(),this._detachEvents(!1),this.element.detach(),this.element.css({"table-layout":"",width:""}),this.element.empty(),this.outerDiv.empty(),this.outerDiv.append(this.element),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this.mKeyDownEventListener&&(this.mKeyDownEventListener.dispose(),this.mKeyDownEventListener=null)}this._trigger("rendering")},i.prototype._onRendered=function(t){var r=this._view(),i,s=this.selection().selectedCells().length()>0;this._rendered=!0,this._renderCounter++;if(!t.virtualScrollData){this._field("selection",null),this._attachEvents(),this._setAttr(r.focusableElement(),"tabIndex",0);var o=this._field("currentCellPrevCycle");i=this._currentCellFromDataView(o.x),!i._isValid()&&this.options.showSelectionOnRender&&(i=this._getFirstDataRowCell(0)),this.currentCell(i,null,!0),this._UISelection(!0);var u=new e.grid.uiResizer(this);n.each(this.columns(),function(e,t){var n=t.options;n.visible&&n.parentVis&&n.isLeaf&&u.addElement(t)}),this._resizerui=u,this._setSizeInternal(this._scrollingState),this.options.scrollMode!=="none"&&(this._frozenerui=new e.grid.uiFrozener(this))}else{var i=this.currentCell();this.currentCell(i,null,!1),i._isEdit()&&!i.row()&&i._isEdit(!1),this.selection()._ensureSelection()}this._trigger("rendered")},i.prototype._onClick=function(t){if(!this._canInteract()||!t.target)return;var r=this._view(),i=this._findUntilOuterDiv(t.target,{td:!0,th:!0}),s,o,u=e.grid.cellRangeExtendMode.none,a,f,l=!1,c=!!t&&t.type==="click";if(i){if(c&&n(t.target).hasClass(e.grid.wijgrid.CSS.groupToggleVisibilityButton))return this._onGroupBtnClick(t),t.stopPropagation(),!1;s=n(i).closest("tr");if(!s.length)return;o=r.getAbsoluteCellInfo(i,!1);if(s.hasClass(e.grid.wijgrid.CSS.dataRow)||s.hasClass(e.grid.wijgrid.CSS.headerRow)){if(o.cellIndex()<0||o.rowIndex()<0)o.rowIndex()>=0?(o=new e.grid.cellInfo(0,o.rowIndex()),u=e.grid.cellRangeExtendMode.row,l=!0):o.cellIndex()>=0&&(o=this._getFirstDataRowCell(o.cellIndex()),u=e.grid.cellRangeExtendMode.column,l=!0);l||(o=r.getAbsoluteCellInfo(i,!0)),this._changeCurrentCell(t,o,{changeSelection:!0,setFocus:c,selectionExtendMode:u})}if(c){var h={cell:o};this._trigger("cellClicked",null,h)}}},i.prototype._onDblClick=function(e){this._editBySingleClick()||this._beginEditInternal(e)},i.prototype._onGroupBtnClick=function(r){if(!this._canInteract())return;var i=n(r.target).closest("tr"),s=e.grid.groupHelper,o=s.getGroupInfo(i[0]),u,a,f=this;o&&(u=s.getColumnByGroupLevel(this._field("leaves"),o.level),u&&(a=u.groupInfo.expandInfo[o.index],a.isExpanded?a.collapse():a.expand(r.shiftKey),this._allowVirtualScrolling()&&(this._rebuildRenderBoundsCollection(),this._view().vsUI._changeVisibleRowsCount(this._renderableBoundsCollection().capacity()),this._ensureViewPortBoundsVisible(this._viewPortBounds()),this._handleVirtualScrolling(this._viewPortBounds().start,t.intersectionMode.reset)),this.setSize()))},i.prototype._onKeyDown=function(r){var i=this._KeyDownEventListener().isHiddenInput(n(r.target));if(!this._canInteract()||i&&this._KeyDownEventListener().canHandle(r))return!0;var s=r.target.tagName.toLowerCase(),o=n(r.target),u=this.currentCell(),a=e.getKeyCodeEnum();if(!!i||s!=="input"&&s!=="option"&&s!=="select"&&s!=="textarea"||o.closest("tr.wijmo-wijgrid-datarow").length!==0){if(this._allowCellEditing()){if((r.which===a.ESCAPE||r.which===113)&&u._isValid()&&u._isEdit())return this._endEditInternal(r),!1;if(r.which===113)return this._beginEditInternal(r),!1}if(!this.options.allowKeyboardNavigation)return!0;var f;switch(r.which){case a.DOWN:case a.PAGE_DOWN:case a.UP:case a.PAGE_UP:case a.LEFT:case a.RIGHT:case a.HOME:case a.END:case a.TAB:if(r.which===a.TAB){var l=this._field("visibleLeaves");if(!l||!l.length)return!0}if(i||this._canMoveToAnotherCell(r.target,r.which)){var c=this._getDataCellsRange(t.dataRowsRangeMode.renderable);f=this._getNextCurrentCell(c,u,r.keyCode,r.shiftKey)}}return f?(this._changeCurrentCell(r,f,{changeSelection:!0,setFocus:!0}),!1):!0}return!0},i.prototype._onFocusIn=function(e){this.options.allowKeyboardNavigation&&e&&e.target&&n(e.target).is(":input")&&!this._KeyDownEventListener().isHiddenInput(n(e.target))&&this._onClick(e)},i.prototype._onMouseMove=function(t){var r=this._view(),i=this._frozenerui,s,o,u,a,f,l=e.grid.renderState;if(!this.options.highlightOnHover||!this._canInteract()||i&&i.inProgress())return;s=this._findUntilOuterDiv(t.target,{td:!0,th:!0});if(s){o=n(s).closest("tr");if(!o.length||!o.hasClass(e.grid.wijgrid.CSS.dataRow)&&!o.hasClass(e.grid.wijgrid.CSS.headerRow))return;u=r.getAbsoluteCellInfo(s,!0);var c=u.rowIndex();c!==this._prevHoveredSketchRowIndex&&(this._prevHoveredSketchRowIndex!==undefined&&r._isRowRendered(this._prevHoveredSketchRowIndex)>=0&&(f=r._getRowInfoBySketchRowIndex(this._prevHoveredSketchRowIndex),f&&(r._changeRowRenderState(f,l.hovered,!1),this.rowStyleFormatter.format(f))),this._prevHoveredSketchRowIndex=c,c>=0&&(f=r._getRowInfoBySketchRowIndex(c),f&&(r._changeRowRenderState(f,l.hovered,!0),this.rowStyleFormatter.format(f))))}},i.prototype._onMouseOut=function(t){if(!this._canInteract())return;var r=this._findUntilOuterDiv(t.relatedTarget,{tr:!0});if(!r||!n(r).hasClass(e.grid.wijgrid.CSS.dataRow)){var i=this._prevHoveredSketchRowIndex,s=this._view();if(i>=0){var o=s._getRowInfoBySketchRowIndex(i);o&&o.$rows&&(s._changeRowRenderState(o,e.grid.renderState.hovered,!1),this.rowStyleFormatter.format(o)),this._prevHoveredSketchRowIndex=-1}}},i.prototype._onWindowResize=function(e){var t=this;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),this._windowResizeTimer!==-1&&(this._windowResizeTimer=window.setTimeout(function(){t._windowResizeTimer=-1;try{!t._destroyed&&t._initialized&&t.element.parent().length&&t.setSize()}finally{t._windowResizeTimer=0}},50))},i.prototype._fieldResized=function(e,t,n){t<0&&(t=0),n<=0&&(n=1);var r={column:e.options,oldWidth:t,newWidth:n};if(this._trigger("columnResizing",null,r)!==!1){if(isNaN(r.newWidth)||r.newWidth<0)r.newWidth=1;e.option("width",r.newWidth);var i={column:e.options};this._trigger("columnResized",null,i)}},i.prototype._setFocusOnCell=function(e,t,n){t||this._KeyDownEventListener().focus(e,n)},i.prototype._findFocusedChild=function(e){var t=e.find(":focus");return t.length?t:null},i.prototype._changeCurrentCell=function(r,i,s){if(this.mCurrentCellLocker===!0)return;var o=this.currentCell(),u=this._getDataCellsRange(t.dataRowsRangeMode.sketch);if(u._isValid()&&u._containsCellInfo(i)||i.isEqual(e.grid.cellInfo.outsideValue)){var a=r&&r.target&&n(r.target),f=i.tableCell(),l=i.container(),c=null;s.hasFocusedChild=!!(f&&a&&a[0]!==f&&a[0]!==l[0]&&!this._KeyDownEventListener().isHiddenInput(a)&&(c=this._findFocusedChild(l)));if(o.cellIndex()!==i.cellIndex()||o.rowIndex()!==i.rowIndex()){var h={cellIndex:i.cellIndex(),rowIndex:i.rowIndex(),oldCellIndex:o.cellIndex(),oldRowIndex:o.rowIndex()};if(!this._trigger("currentCellChanging",null,h))return!1;var p=!1;if(!this._allowCellEditing()||!o._isEdit()||(p=this._endEditInternal(null)))s.changingEventArgs=h,o=i._clone(),o._setGridView(this),this._field("currentCell",o),this._onCurrentCellChanged(r,s)}else this.options.highlightCurrentCell&&this._highlightCellPosition(o,!0),f&&!o._isEdit()&&(r&&this._editBySingleClick()?this._beginEditInternal(r):s.setFocus&&this._setFocusOnCell(s.hasFocusedChild?c:n(f),s.hasFocusedChild,o.column()))}return!0},i.prototype._highlightCellPosition=function(t,r){if(t&&t._isValid()){var i=t.cellIndexAbs(),s=t.rowIndexAbs(),o=e.grid.renderState,u=this._view(),a,f,l;f=u.getHeaderCell(i),f&&(a=u._getRowInfo(this._headerRows().item(t.column().thY)),f=n(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,t.column(),a,l)),t._isRendered()&&(f=u.getJoinedRows(s,0),f&&(a=u._getRowInfo(f),u._changeRowRenderState(a,o.current,r),this.rowStyleFormatter.format(a)),f=u.getCell(i,s),f&&(f=n(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,t.column(),a,l)))}},i.prototype._beginEditInternal=function(t){if(this._canInteract()&&this._allowCellEditing()){var n=this.currentCell(),r=n.column(),i;if(r&&!r.readOnly)return i=(new e.grid.cellEditorHelper).cellEditStart(this,n,t),i,i}return!1},i.prototype._endEditInternal=function(r){if(this._canInteract()&&this._allowCellEditing()){var i=this.currentCell(),s=new e.grid.cellEditorHelper,o=s.updateCell(this,i,r);if(o&t.updateCellResult.success){if(o&t.updateCellResult.notEdited)return!0;s.cellEditEnd(this,i,r),i=this.currentCell();var u=i.tableCell();return u?this._KeyDownEventListener().focus(n(u),i.column()):n(this._view().focusableElement()).focus(),this._allowVirtualScrolling()||this._view().ensureHeight(i.rowIndex()),!0}}return!1},i.prototype._onViewInsertEmptyRow=function(e,t,n,r,i,s,o){return null},i.prototype._onViewCreateEmptyCell=function(e,t,n){return null},i.prototype._onViewCellRendered=function(e,t,n,r){},i.prototype._onViewRowRendered=function(e,t,n){},i.prototype._getDataParser=function(t){return t.dataParser||e.data.defaultParsers[t.dataType]||e.data.defaultParsers.string},i.prototype.parse=function(t,r){var i=e.grid.getDataType(t),s=e.grid.getDataType(t);return n.isFunction(r)&&(r=r()),r=e.data.convert(r,i,s,{culture:this.mClosestCulture,format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),r},i.prototype.toStr=function(t,n){var r=this._dataViewWrapper.dataView(),i=e.grid.getDataType(t),s="string";return n=e.data.convert(n,i,s,{culture:this.mClosestCulture,format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),n},i.prototype.parseFailed=function(e,t,n,r){return t},i.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},i.prototype._canInteract=function(){return!this.options.disabled},i.prototype._canMoveToAnotherCell=function(t,r){var i=t.tagName.toLowerCase(),s,o,u,a;switch(i){case"input":if(n(t).hasClass(e.grid.wijgrid.CSS.inputMarker)){var f=t;return f.type==="text"?(s=f.value.length,o=(new e.grid.domSelection(f)).getSelection(),u=e.getKeyCodeEnum(),a=r===u.TAB||r===u.UP||r===u.DOWN||r===u.PAGE_DOWN||r===u.PAGE_UP||o.length===0&&(o.start===0&&(r===u.LEFT||r===u.HOME)||o.end>=s&&(r===u.RIGHT||r===u.END)),a):!0}return!1;case"textarea":case"select":return!1}return!0},i.prototype._editBySingleClick=function(){var e=(this.options.editingInitOption||"").toLowerCase();switch(e){case"click":case"doubleclick":break;case"auto":default:e=this._isMobileEnv()?"click":"doubleclick"}return e==="click"},i.prototype._getDataToAbsOffset=function(){var e=0,t=0,n=this._headerRows();return this._showRowHeader()&&e++,n&&(t+=n.length()),this._filterRow()&&t++,{x:e,y:t}},i.prototype._currentCellFromDataView=function(t){var n=this._dataViewWrapper.currentPosition(),r=new e.grid.cellInfo(t,this._dataViewDataRowIndexToGrid(n),null);return r.rowIndex()<0?r.cellIndex(-1):r.cellIndex()<0&&r.cellIndex(0),r},i.prototype._dataViewDataRowIndexToGrid=function(e){if(this.sketchTable)for(var t=0;t<this.sketchTable.count();t++){var n=this.sketchTable.row(t);if(n.isDataRow()&&n.dataItemIndex()===e)return t}return-1},i.prototype._getDataCellsRange=function(n,r){typeof r=="undefined"&&(r=!1);var i=0,s=0,o=this._field("visibleLeaves").length-1,u;switch(n){case t.dataRowsRangeMode.rendered:if(this._rendered){u=this._rows().length()-1;break};case t.dataRowsRangeMode.sketch:u=this._totalRowsCount()-1;break;case t.dataRowsRangeMode.renderable:u=this._renderableRowsCount()-1}this._showRowHeader()&&o--,r&&u>0&&u--;if(o<0||u<0)i=s=o=u=-1;return new e.grid.cellInfoRange(new e.grid.cellInfo(i,s,null),new e.grid.cellInfo(o,u,null))},i.prototype._getDataItem=function(e){return this.dataView().item(e)},i.prototype._getFirstDataRowCell=function(t){var n,r,i,s=this._view(),o=this._rows(),u=e.grid.rowType;for(n=0,r=o.length();n<r;n++){i=s._getRowInfo(o.item(n));if(i.type&u.data)return new e.grid.cellInfo(t,n)}return e.grid.cellInfo.outsideValue},i.prototype._getNextCurrentCell=function(t,n,r,i){var s=n.cellIndex(),o=n.rowIndex(),u=e.getKeyCodeEnum(),a=this.sketchTable,f=this._renderableBoundsCollection().getRenderedIndex(o),l=this._renderableBoundsCollection(),c,h=r===u.TAB,p=this,d=p._serverSideVirtualScrolling(),v=function(t,n,r,i){typeof i=="undefined"&&(i=!1);var s=t?l.forEachIndex:l.forEachIndexBackward,o=0,u=null;return s.call(l,n,-1,function(t){var n=t-p._dataOffset;if(d&&(n<0||n>=a.count()))return u=t,!1;var s=a.row(n),f=s.isDataRow();if((!i||f)&&!(s.extInfo.state&e.grid.renderStateEx.hidden)){u=t;if(++o>=r)return!1}}),u};switch(r){case u.ENTER:case u.DOWN:(c=v(true,f+1,1))!=null&&(o=c);break;case u.PAGE_DOWN:(c=v(true,f+1,this._pageSizeKey))!=null&&(o=c);break;case u.UP:(c=v(false,f-1,1))!=null&&(o=c);break;case u.PAGE_UP:(c=v(false,f-1,this._pageSizeKey))!=null&&(o=c);break;case u.TAB:i?(s--,s<t.topLeft().cellIndex()&&(s=t.bottomRight().cellIndex(),(c=v(false,f-1,1,true))!=null?o=c:(c=v(false,l.capacity()-1,1,true))!=null&&(o=c))):(s++,s>t.bottomRight().cellIndex()&&(s=t.topLeft().cellIndex(),(c=v(true,f+1,1,true))!=null?o=c:(c=v(true,0,1,true))!=null&&(o=c)));break;case u.END:s=t.bottomRight().cellIndex();break;case u.HOME:s=t.topLeft().cellIndex();break;case u.LEFT:s>t.topLeft().cellIndex()&&s--;break;case u.RIGHT:s<t.bottomRight().cellIndex()&&s++}return new e.grid.cellInfo(s,o,this)},i.prototype._findUntilOuterDiv=function(e,t){var n=e,r=this.outerDiv[0],i,s,o=null;for(;n;n=n.parentNode){s=n.nodeName&&n.nodeName.toLowerCase();if(s){if(n===r){i=n;break}t[s]&&(o=n)}}return i?o:null},i.prototype._getStaticIndex=function(e){var n,r=this._getDataCellsRange(t.dataRowsRangeMode.rendered);return this._hasSpannedCells()?-1:(e?n=Math.min(this.options.staticRowIndex,r.bottomRight().rowIndex()):n=Math.min(this.options.staticColumnIndex,r.bottomRight().cellIndex()),n<-1&&(n=-1),n)},i.prototype._getStaticOffsetIndex=function(e){var t=0;return e?this._showRowHeader()&&t++:(t=this._columnsHeadersTable().length,this.options.showFilter&&t++),t},i.prototype._getRealStaticColumnIndex=function(){var t=this._getStaticOffsetIndex(!0),n=this._getStaticIndex(!1),r=n+t;if(n>=0){var i=this._field("visibleLeaves"),s=e.grid.flatten(this.options.columns),o=i.length;if(r<o-1){var u=e.grid.getTompostParent(i[r],s);if(u)for(r++;r<o;r++){var a=e.grid.getTompostParent(i[r],s);if(a!==u){r--;break}}}r>=o&&(r=o-1)}return r},i.prototype._getRealStaticRowIndex=function(){var e=this._getStaticOffsetIndex(!1);return this._getStaticIndex(!0)+e},i.prototype._hasMerging=function(){var e=this._field("leaves"),t,n,r,i=!1;if(e)for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=i||r.parentVis&&r.rowMerge&&r.rowMerge!=="none";return i},i.prototype._hasGrouping=function(){var e=this._field("leaves"),t,n,r,i=!1;for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=r.groupInfo&&r.groupInfo.position!=="none";return i},i.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()},i.prototype._columnsHeadersTable=function(e){return arguments.length&&this._field("columnsHeadersTable",e),this._field("columnsHeadersTable")},i.prototype._view=function(){return this.mView},i.prototype._originalFooterRowData=function(){var e=this._field("tfoot");return e&&e.length?e[0]:null},i.prototype._originalHeaderRowData=function(){var e=this._field("thead");return e&&e.length?e[0]:null},i.prototype._setAttr=function(e,t,r){var i=this;return e===this.element?arguments.length===2?(n.each(t,function(t,n){t in i._originalAttr||(i._originalAttr[t]=e.attr(t))}),e.attr(t)):(t in this._originalAttr||(this._originalAttr[t]=e.attr(t)),e.attr(t,r)):arguments.length===3?e.attr(t,r):e.attr(t)},i.prototype._totalRowsCount=function(){return this.sketchTable.count()},i.prototype._renderableRowsCount=function(){return this._renderableBoundsCollection().capacity()},i.prototype._trackScrollingPosition=function(e,t){this._scrollingState.x=e,this._scrollingState.y=t},i.prototype._trackScrollingIndex=function(e){this._scrollingState.index=e},i.prototype._uid=function(){return this.__uid===undefined&&(this.__uid=e.grid.getUID()),"wijgrid"+this.__uid},i.prototype._viewPortBounds=function(e){return arguments.length&&(this.mViewPortBounds=e),this.mViewPortBounds},i.prototype._viewPortBoundsOfEntirelyShownRows=function(){var e=this._viewPortBounds(),t=!1,r=e.end-e.start+1;if(this._allowVirtualScrolling()){var i=this._view();r<i.getVirtualPageSize()&&(t=!0)}return t||(e=n.extend({},e),e.end--),e},i}(e.wijmoWidget);t.wijgrid=i,i.prototype.widgetEventPrefix="wijgrid",i.prototype._data$prefix="wijgrid",i.prototype._customSortOrder=1e3,i.prototype._pageSizeKey=10,i.prototype._mergeWidgetsWithOptions=!0;var s=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c",stateHighlight:"ui-btn-down-e"},this.wijCSS={wijgrid:"",wijgridTable:"",wijgridTH:"",wijgridTD:"",wijgridCellContainer:"",wijgridRowHeader:"",wijgridCurrentRowHeaderCell:"",wijgridCurrentHeaderCell:"",wijgridCurrentCell:"",wijgridCellAlignLeft:"",wijgridCellAlignRight:"",wijgridCellAlignCenter:"",wijgridFilterList:"",wijgridFilter:"",wijgridFilterInput:"",wijgridFilterTrigger:"",wijgridFilterNativeHtmlEditorWrapper:"",wijgridHeaderArea:"",wijgridFooterArea:"",wijgridHeaderRow:"",wijgridRow:"",wijgridDataRow:"",wijgridAltRow:"",wijgridEmptyDataRow:"",wijgridFilterRow:"",wijgridGroupHeaderRow:"",wijgridGroupFooterRow:"",wijgridGroupHeaderRowCollapsed:"",wijgridGroupHeaderRowExpanded:"",wijgridFooterRow:"",wijgridLoadingOverlay:"",wijgridLoadingText:"",wijgridGroupArea:"",wijgridGroupAreaButton:"",wijgridGroupAreaButtonSort:"",wijgridGroupAreaButtonClose:"",wijgridGroupToggleVisibilityButton:"",wijgridFixedView:"",wijgridScroller:"",wijgridDndHelper:"",wijgridDndArrowTopContainer:"",wijgridDndArrowBottomContainer:"",wijgridFreezingHandleV:"",wijgridFreezingHandleH:"",wijgridResizingHandle:"",wijgridHeaderCellSortIcon:"",wijgridHeaderCellText:""},this.allowColMoving=!1,this.allowColSizing=!1,this.allowEditing=!1,this.allowKeyboardNavigation=!0,this.allowPaging=!1,this.allowSorting=!1,this.allowVirtualScrolling=!1,this.cellStyleFormatter=undefined,this.columns=[],this.columnsAutogenerationMode="merge",this.culture="",this.customFilterOperators=[],this.data=null,this.editingInitOption="auto",this.editingMode="none",this.ensureColumnsPxWidth=!1,this.filterOperatorsSortMode="alphabeticalCustomFirst",this.freezingMode="none",this.groupAreaCaption="Drag a column here to group by that column.",this.groupIndent=10,this.highlightCurrentCell=!1,this.highlightOnHover=!0,this.loadingText="Loading...",this.nullString="",this.pageIndex=0,this.pageSize=10,this.pagerSettings={mode:"numeric",pageButtonCount:10,position:"bottom"},this.readAttributesFromData=!1,this.rowHeight=-1,this.rowStyleFormatter=undefined,this.scrollMode="none",this.selectionMode="singleRow",this.showFilter=!1,this.showFooter=!1,this.showGroupArea=!1,this.showSelectionOnRender=!0,this.showRowHeader=!1,this.staticColumnIndex=-1,this.staticColumnsAlignment="left",this.staticRowIndex=-1,this.totalRows=-1,this.afterCellEdit=null,this.afterCellUpdate=null,this.beforeCellEdit=null,this.beforeCellUpdate=null,this.cellClicked=null,this.columnDragging=null,this.columnDragged=null,this.columnDropping=null,this.columnDropped=null,this.columnGrouping=null,this.columnGrouped=null,this.columnResizing=null,this.columnResized=null,this.columnUngrouping=null,this.columnUngrouped=null,this.currentCellChanging=null,this.currentCellChanged=null,this.filterOperatorsListShowing=null,this.filtering=null,this.filtered=null,this.groupAggregate=null,this.groupText=null,this.invalidCellValue=null,this.pageIndexChanging=null,this.pageIndexChanged=null,this.selectionChanged=null,this.sorting=null,this.sorted=null,this.dataLoading=null,this.dataLoaded=null,this.loading=null,this.loaded=null,this.rendering=null,this.rendered=null}return e}();i.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijgrid",i.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(e){e&&(this.__attr=e)}return e.prototype.attrs=function(){return this.__attr},e.prototype.ensureAttr=function(){return this.__attr=this.__attr||{},this.__attr},e.prototype.attr=function(e,t){if(arguments.length==0)return this.__attr;if(arguments.length==1)return this.__attr?this.__attr[e]:null;this.ensureAttr()[e]=t},e.prototype.style=function(e,t){if(arguments.length==0)return this.__style;if(arguments.length==1)return this.__style&&this.__style[e];this.ensureStyle()[e]=t},e.prototype.deleteAttr=function(e){this.__attr&&delete this.__attr[e]},e.prototype.deleteStyle=function(e){this.__style&&delete this.__style[e]},e.prototype.ensureStyle=function(){return this.__style=this.__style||{},this.__style},e}();t.SketchObject=r;var i=function(e){function t(t){e.call(this,t)}return __extends(t,e),t.prototype.visible=function(e){if(arguments.length==0)return this._visible!==!1;this._visible=e},t}(r);t.SketchCell=i;var s=function(e){function t(t,n){e.call(this,n),this.value=t}return __extends(t,e),t}(i);t.ValueCell=s;var o=function(e){function t(t,n){e.call(this,n),this.html=t||""}return __extends(t,e),t.nbsp=function(){return new t("&nbsp;",null)},t}(i);t.HtmlCell=o;var u=function(n){function r(e,r,i){n.call(this,i),this.rowType=e,this.renderState=r,this.extInfo={state:t.renderStateEx.none}}return __extends(r,n),r.prototype.isDataRow=function(){return(this.rowType&e.grid.rowType.data)==e.grid.rowType.data},r.prototype.dataItemIndex=function(e){return typeof e=="undefined"&&(e=0),-1},r.prototype.cellCount=function(){return this._cells?this._cells.length:0},r.prototype._ensureCells=function(){this._cells=this._cells||[]},r.prototype.add=function(e){this._ensureCells(),this._cells.push(e)},r.prototype.insert=function(e,t){this._ensureCells(),this._cells.splice(e,0,t)},r.prototype.cell=function(e){return this._cells[e]},r.prototype.valueCell=function(e){return this.cell(e)},r.prototype.removeAt=function(e){if(!this._cells)throw"Wrong index";this._cells.splice(e,1)},r.prototype.clear=function(){},r.prototype.getRowInfo=function(){return{type:this.rowType,state:this.renderState,sectionRowIndex:null,dataRowIndex:null,virtualDataItemIndex:null,dataItemIndex:this.dataItemIndex(),$rows:null,_extInfo:this.extInfo}},r}(r);t.SketchRow=u;var a=function(t){function n(n,r,i){t.call(this,e.grid.rowType.data|(n%2==1?e.grid.rowType.dataAlt:0),r,i),this.originalRowIndex=n}return __extends(n,t),n.prototype.dataItemIndex=function(e){return typeof e=="undefined"&&(e=0),e+this.originalRowIndex},n.prototype.isDataRow=function(){return!0},n}(u);t.SketchDataRow=a;var f=function(t){function n(n,r){var i=n?e.grid.rowType.groupHeader:e.grid.rowType.groupFooter;t.call(this,i,e.grid.renderState.rendering,r)}return __extends(n,t),n.prototype.getRowInfo=function(){var e=t.prototype.getRowInfo.call(this);return this.groupByValue!==undefined&&(e.groupByValue=this.groupByValue),e},n}(u);t.SketchGroupRow=f;var l=function(){function e(){this._table=[]}return e.prototype.getRawTable=function(){return this._table},e.prototype.row=function(e){return this._table[e]},e.prototype.valueAt=function(e,t){return this.row(e).valueCell(t).value},e.prototype.count=function(e){return typeof e=="number"&&(this._table.length=e),this._table.length},e.prototype.add=function(e){this._table.push(e)},e.prototype.insert=function(e,t){this._table.splice(e,0,t)},e.prototype.clear=function(){this._table.length=0},e.prototype.removeFirst=function(e){typeof e=="undefined"&&(e=1),this._table.splice(0,e)},e.prototype.removeLast=function(e){typeof e=="undefined"&&(e=1),this._table.splice(this._table.length-e,e)},e.prototype.replace=function(e,t){var n=this._table.splice(e,1,t);n&&n.length&&t&&(t.extInfo=n[0].extInfo)},e.prototype.updateIndexes=function(){for(var e=0;e<this._table.length;e++){var t=this._table[e];this._table[e].isDataRow()&&(t.originalRowIndex=e)}},e.prototype.isLazy=function(){return!1},e.prototype.ensureNotLazy=function(){},e}();t.SketchTable=l;var c=function(e){function t(t){e.call(this),this.mIsLazy=!0,this.pageSize=30;if(t==null)throw"Row source is null";this.mSource=t,this._table.length=t.count()}return __extends(t,e),t.prototype.isLazy=function(){return this.mIsLazy},t.prototype.ensureNotLazy=function(){if(!this.isLazy())return;this.ensureRange(),this.mIsLazy=!1},t.prototype.invalidate=function(){this._table=new Array(this.mSource.count()),this.isLazy()||this.updateRange()},t.prototype.row=function(t){return e.prototype.row.call(this,t)||this.ensureRange(Math.max(0,t-this.pageSize/2),this.pageSize),e.prototype.row.call(this,t)},t.prototype.ensureRange=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this._table.length-e);if(!this.isLazy())return;if(e<0)throw"Wrong range start";this._table.length=this.mSource.count();if(this._table.length==0){if(t>0)throw"Wrong range length";return}while(e<this._table.length&&this._table[e])e++;if(e>=this._table.length)return;var n=Math.min(e+t-1,this._table.length-1);while(n>=e&&this._table[n])n--;t=n-e+1,t>0&&this.updateRange(e,t)},t.prototype.updateRange=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this._table.length-e);if(this.mSource==null)throw"Cannot create sketch row because source is null";this.mSource.getRange(e,t,this._table,e)},t}(l);t.LazySketchTable=c})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var t=n.data(this.element[0],"wijgridowner");this._field("owner",t),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(t.options.wijCSS.widget+" "+e.grid.wijgrid.CSS.c1basefield+" "+t.options.wijCSS.stateDefault),this.options.disabled&&this.disable(),t.options.allowColMoving&&t._UIDragndrop(!0).attach(this)},r.prototype._init=function(){this.element.wrapInner("<div class='"+e.grid.wijgrid.CSS.cellContainer+" "+this._owner().options.wijCSS.wijgridCellContainer+"'></div>"),this._refreshHeaderCell()},r.prototype.destroy=function(){try{t.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;var t=this._owner();t&&t._UIDragndrop()&&t._UIDragndrop().detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix);var n=e.grid.wijgrid.CSS,r=t.options.wijCSS;this.element.removeClass(r.widget+" "+n.c1basefield+" "+r.c1basefield+" "+r.stateDefault).html(this.element.find("."+n.headerCellText).html())},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,n){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(n=r.apply(this,[n,i])),s=n!==i,t.prototype._setOption.apply(this,[e,n]);if(s){if(this.options.groupedIndex!==undefined){var u=this._owner()._field("groupedWidgets")[this.options.groupedIndex];u&&e in u.options&&u._setOption(e,n)}o=this["_postset_"+e],o!==undefined&&o.apply(this,[n,i])}},r.prototype._postset_allowMoving=function(e,t){},r.prototype._preset_clientType=function(e,t){throw"read-only"},r.prototype._postset_headerText=function(e,t){this._refreshHeaderCell()},r.prototype._postset_visible=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_width=function(t,n){var r=this._owner();if(r){this.options.ensurePxWidth=!0;var i=e.grid.getColumnByTravIdx(r.options.columns,this.options.travIdx);i&&(i.found.width=t,i.found.ensurePxWidth=!0),r.setSize()}},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0},r.prototype._createHeaderContent=function(e){return e.html(this.options.headerText||"&nbsp;")},r.prototype._decorateHeaderContent=function(t){return t.wrapInner('<span class="'+e.grid.wijgrid.CSS.headerCellText+" "+this._owner().options.wijCSS.wijgridHeaderCellText+'" />')},r.prototype._refreshHeaderCell=function(){var t=this.element.children("."+e.grid.wijgrid.CSS.cellContainer).empty();this._createHeaderContent(t),this._decorateHeaderContent(t)},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);t.c1basefield=r,r.prototype._data$prefix="c1basefield";var i=function(){function e(){this.allowMoving=!0,this.allowSizing=!0,this.cellFormatter=undefined,this.dataKey=undefined,this.ensurePxWidth=undefined,this.footerText=undefined,this.headerText=undefined,this.textAlignment=undefined,this.visible=!0,this.width=undefined}return e}();t.c1basefield_options=i,r.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("c1basefield",r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){t.prototype._create.apply(this,arguments);var n=this._owner();this.element.addClass(n.options.wijCSS.widget+" "+e.grid.wijgrid.CSS.c1field)},r.prototype._destroy=function(){if(this._isDestroyed())return;var n=this._owner();this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.data("wijmo-wijinputdate")&&this.$filterEditor.wijinputdate("destroy");break;case"text":this.$filterEditor.data("wijmo-wijinputtext")&&this.$filterEditor.wijinputtext("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.data("wijmo-wijinputnumber")&&this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this.element.removeClass(n.options.wijCSS.widget+" "+e.grid.wijgrid.CSS.c1field),this._removeDropDownFilterList(),t.prototype._destroy.apply(this,arguments)},r.prototype._init=function(){t.prototype._init.apply(this,arguments),this.$filterEditor=null;var e=this._owner();this.filterRow=e._filterRow(),e.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},r.prototype._postset_aggregate=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_allowSort=function(e,t){this._refreshHeaderCell()},r.prototype._postset_dataType=function(e,t){throw"read-only"},r.prototype._postset_dataParser=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_disabled=function(e,t){this.$filterEditor&&n.each(this.$filterEditor.data(),function(t,n){n&&n.widgetName&&n.option&&n.option("disabled",e)})},r.prototype._postset_dataFormatString=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_filterOperator=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_filterValue=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_groupInfo=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_rowMerge=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_showFilter=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_sortDirection=function(e,t){this.options.sortOrder=0,this._owner().ensureControl(!0)},r.prototype._postset_width=function(e,n){t.prototype._postset_width.apply(this,arguments)},r.prototype._canDropTo=function(e){return t.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&e instanceof n.wijmo.c1groupedfield?!1:!0:!1},r.prototype._isSortable=function(){return e.grid.validDataKey(this.options.dataKey)},r.prototype._isSortableUI=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this._isSortable()},r.prototype._decorateHeaderContent=function(r){var i=this._owner(),s=e.grid.wijgrid.CSS,o=i.options.wijCSS;if(!this._isSortable())t.prototype._decorateHeaderContent.apply(this,arguments);else{this._isSortableUI()?r.wrapInner('<a class="'+s.headerCellText+" "+o.wijgridHeaderCellText+'" href="#" role="button" />').children("a").bind("click."+this.widgetName,this,n.proxy(this._onHrefClick,this)):t.prototype._decorateHeaderContent.apply(this,arguments);var u=s.headerCellSortIcon+" "+o.wijgridHeaderCellSortIcon+" "+o.icon;switch(this.options.sortDirection){case"ascending":r.append(n('<span class="'+u+" "+o.iconArrowUp+'"></span>'));break;case"descending":r.append(n('<span class="'+u+" "+o.iconArrowDown+'"></span>'))}}},r.prototype._prepareFilterCell=function(){var t=this.options.visLeavesIdx,r=this._owner(),i=null,s,o,u=this,a,f=e.grid.HTML5InputSupport.getDefaultInputType(r._isMobileEnv(),this.options),l=r.options.wijCSS,c=e.grid.wijgrid.CSS;if(t>=0){r=this._owner();if(!this.filterRow)throw"exception";i=n(e.grid.rowAccessor.getCell(this.filterRow,t)),this.$filterEditor=i.find("input"),i.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()}),s=r.parse(this.options,e.grid.filterHelper.getSingleValue(this.options.filterValue));if(s===null||s==="undefined")switch(e.grid.getDataType(this.options)){case"boolean":s=!1;break;case"number":case"currency":s=0;break;case"datetime":s=new Date;break;default:s=""}o={culture:r.options.culture,disabled:r.options.disabled,decimalPlaces:function(e){var t=/^(n|p|c){1}(\d*)$/.exec(e);return t&&t[2]?parseInt(t[2],10):(t=/^(d){1}(\d*)$/.exec(e),t?0:2)}(this.options.dataFormatString),imeMode:this.options.imeMode,triggerMouseUp:function(e){r&&n.each(r.columns(),function(e,t){t.$dropDownFilterList&&t._removeDropDownFilterList()})}},this.$filterEditor.bind("keypress."+this.widgetName,n.proxy(this._onFilterEditorKeyPress,this));switch(a=this._getInputEditorType(this.options)){case"date":f==="text"?this.$filterEditor.wijinputdate(n.extend(o,{date:s,dateFormat:this.options.dataFormatString||undefined,showTrigger:!0})):this._createHtmlEditor(this.$filterEditor,f,e.grid.HTML5InputSupport.toStr(s,f));break;case"text":this.$filterEditor.wijinputtext(n.extend(o,{text:s+""}));break;case"numberCurrency":this.$filterEditor.wijinputnumber(n.extend(o,{type:"currency",value:s}));break;case"numberNumber":f==="text"?this.$filterEditor.wijinputnumber(n.extend(o,{value:s})):this._createHtmlEditor(this.$filterEditor,f,e.grid.HTML5InputSupport.toStr(s,f));break;case"numberPercent":this.$filterEditor.wijinputnumber(n.extend(o,{type:"percent",value:s*100}));break;default:throw e.grid.stringFormat('Unsupported editor type: "{0}"',a)}i.find("."+c.filterTrigger).attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(e){u.options.disabled||n(this).addClass(l.stateDefault+" "+l.stateHover)}).bind("mouseleave."+this.widgetName,function(e){u.options.disabled||n(this).removeClass(l.stateDefault+" "+l.stateHover+" "+l.stateActive)}).bind("mouseup."+this.widgetName,this,function(e){u.options.disabled||n(this).removeClass(l.stateDefault+" "+l.stateActive)}).bind("mousedown."+this.widgetName,{column:this},n.proxy(this._onFilterBtnClick,this)).bind("click."+this.widgetName,function(e){e.preventDefault()})}},r.prototype._createHtmlEditor=function(t,n,r){var i=e.grid.wijgrid.CSS,s=this._owner().options.wijCSS;return t[0].type=n,t.addClass(s.stateDefault).wrap('<span class="'+i.filterNativeHtmlEditorWrapper+" "+s.wijgridFilterNativeHtmlEditorWrapper+'"></span').val(r)},r.prototype._onFilterBtnClick=function(t){var r=this,i=t.data.column,s=8,o=i._owner(),u,a,f,l,c,h;if(i.options.disabled)return!1;if(i.$dropDownFilterList)return i._removeDropDownFilterList(),!1;t.target.focus(),u=e.grid.filterHelper.getSingleOperatorName(i.options.filterOperator).toLowerCase(),a=o.getFilterOperatorsByDataType(e.grid.getDataType(i.options)),f={operators:n.extend(!0,[],a),column:i.options},o._onFilterOperatorsListShowing(f),l=[],f.operators&&n.each(f.operators,function(e,t){l.push({label:t.displayName||t.name,value:t.name,selected:t.name.toLowerCase()===u})}),i.$dropDownFilterList=n("<div />").addClass(e.grid.wijgrid.CSS.filterList+" "+o.options.wijCSS.wijgridFilterList).appendTo(document.body).wijlist({autoSize:!0,maxItemsCount:s,selected:function(e,t){var n=r._getFilterValueFromEditor(i);i._removeDropDownFilterList(),o._handleFilter(i,t.item.value,n)}}),i.$dropDownFilterList.css("z-index",e.grid.getZIndex(o.outerDiv,9999)),i.$dropDownFilterList.wijlist("setItems",l).wijlist("renderList"),c=i.$dropDownFilterList.width()|150,i.$dropDownFilterList.width(l.length>s?c+20:c).wijlist("refreshSuperPanel").position({of:n(t.currentTarget),my:"left top",at:"left bottom"}),i.$dropDownFilterList.$button=n(t.currentTarget),h=i.$dropDownFilterList.eventUID=e.grid.getUID(),n(document).bind("mousedown."+i.widgetName+"."+h,{column:i},i._onDocMouseDown)},r.prototype._onFilterEditorKeyPress=function(t){if(t&&t.which===13){var n=this._owner(),r=this._getFilterValueFromEditor(this),i=(this.options.filterOperator||"").toLowerCase();if(!r)r=undefined,i="nofilter";else if(!i||i==="nofilter")i=e.grid.getDataType(this.options)==="string"?"contains":"equals";this._removeDropDownFilterList(),n._handleFilter(this,i,r)}},r.prototype._onDocMouseDown=function(t){var r=n(t.target),i=e.grid.wijgrid.CSS,s=r.parents("."+i.filterList+":first"),o=r.is("."+i.filterTrigger)?r:r.parents("."+i.filterTrigger+":first");o.length&&o[0]===t.data.column.$dropDownFilterList.$button[0]||s.length&&s[0]===t.data.column.$dropDownFilterList[0]||t.data.column._removeDropDownFilterList()},r.prototype._onHrefClick=function(e){if(e.data.options.disabled)return!1;if(e.data.options.allowSort){var t=e.data._owner();t._handleSort(e.data.options,e.ctrlKey)}return!1},r.prototype._removeDropDownFilterList=function(){if(this.$dropDownFilterList){var e=this.$dropDownFilterList.eventUID;this.$dropDownFilterList.remove(),this.$dropDownFilterList=null,n(document).unbind("mousedown."+this.widgetName+"."+e,this._onDocMouseDown)}},r.prototype._getInputEditorType=function(t){switch(e.grid.getDataType(t)){case"number":return t.dataFormatString&&t.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"text"}},r.prototype._getFilterValueFromEditor=function(t){var n=t._owner(),r=e.grid.HTML5InputSupport.getDefaultInputType(n._isMobileEnv(),t.options),i;switch(t._getInputEditorType(t.options)){case"date":r==="text"?i=t.$filterEditor.wijinputdate("option","date")||new Date:i=e.grid.HTML5InputSupport.parse(t.$filterEditor.val(),r)||new Date;break;case"text":i=t.$filterEditor.wijinputtext("option","text");break;case"numberNumber":if(r!=="text"){i=e.grid.HTML5InputSupport.parse(t.$filterEditor.val(),r)||0;break};case"numberCurrency":i=t.$filterEditor.wijinputnumber("option","value");break;case"numberPercent":i=t.$filterEditor.wijinputnumber("option","value")/100}return i},r}(t.c1basefield);t.c1field=r;var i=function(e){function t(){e.apply(this,arguments),this.aggregate="none",this.allowSort=!0,this.dataType=undefined,this.dataParser=undefined,this.dataFormatString=undefined,this.encodeHtml=!1,this.filterOperator="nofilter",this.filterValue=undefined,this.groupInfo={expandInfo:[],level:undefined,groupSingleRow:!0,collapsedImageClass:undefined,expandedImageClass:undefined,position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},this.imeMode="auto",this.inputType=undefined,this.readOnly=!1,this.rowMerge="none",this.showFilter=!0,this.sortDirection="none",this.valueRequired=!1}return __extends(t,e),t}(t.c1basefield_options);t.c1field_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),n.wijmo.registerWidget("c1field",n.wijmo.c1basefield,r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){t.prototype._create.apply(this,arguments);var n=this._owner();this.element.addClass(n.options.wijCSS.widget+" "+e.grid.wijgrid.CSS.c1band)},r.prototype._canDropTo=function(e){return t.prototype._canDropTo.apply(this,arguments)?!(e instanceof n.wijmo.c1groupedfield):!1},r}(t.c1basefield);t.c1band=r;var i=function(e){function t(){e.apply(this,arguments),this.columns=[]}return __extends(t,e),t}(t.c1field_options);r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),n.wijmo.registerWidget("c1band",n.wijmo.c1basefield,r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var t=n.data(this.element[0],"wijgridowner"),r=e.grid.wijgrid.CSS,i=t.options.wijCSS;this._field("owner",t),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(r.groupAreaButton+" "+i.wijgridGroupAreaButton+" "+i.stateDefault+" "+i.cornerAll),this.options.disabled&&this.disable(),t.options.allowColMoving&&t._UIDragndrop(!0).attach(this)},r.prototype._init=function(){this._refreshHeaderCell()},r.prototype.destroy=function(){try{t.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;this.element.find("*").unbind("."+this.widgetName);var t=this._owner();t&&t._dragndrop(!1)&&t._dragndrop(!1).detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix)},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,n){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(n=r.apply(this,[n,i])),s=n!==i,t.prototype._setOption.apply(this,[e,n]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[n,i]))},r.prototype._postset_headerText=function(e,t,n){this._refreshHeaderCell()},r.prototype._postset_allowSort=function(e,t,n){this._refreshHeaderCell()},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return t instanceof n.wijmo.c1groupedfield?e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0:!1},r.prototype._isSortable=function(){return e.grid.validDataKey(this.options.dataKey)},r.prototype._isSortableUI=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this._isSortable()},r.prototype._refreshHeaderCell=function(){var t=e.grid.wijgrid.CSS,r=this._owner().options.wijCSS,i=n('<span class="'+t.groupAreaButtonClose+" "+r.wijgridGroupAreaButtonClose+" "+r.stateDefault+" "+r.cornerAll+'"><span class="'+r.icon+" "+r.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(i),this._isSortableUI()&&this.element.bind("click."+this.widgetName,this,n.proxy(this._onHrefClick,this));if(this._isSortable()){var s=t.groupAreaButtonSort+" "+r.wijgridGroupAreaButtonSort+" "+r.icon;switch(this.options.sortDirection){case"ascending":this.element.append(n('<span class="'+s+" "+r.iconArrowUp+'"></span>'));break;case"descending":this.element.append(n('<span class="'+s+" "+r.iconArrowDown+'"></span>'))}}},r.prototype._onCloseClick=function(e){var t=e.data.options;return t.disabled||e.data._owner()._handleUngroup(e.data.options.travIdx),!1},r.prototype._onHrefClick=function(t){var n=t.data._owner(),r=t.data.options,i;return!r.disabled&&r.allowSort&&(i=e.grid.search(n.columns(),function(e){return e.options.travIdx===r.travIdx}),i=i.found?i.found.options:e.grid.getColumnByTravIdx(n.options.columns,r.travIdx).found,i&&n._handleSort(i,t.ctrlKey)),!1},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);t.c1groupedfield=r,r.prototype._data$prefix="c1groupedfield",r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowMoving:!0,allowSort:!0,headerText:undefined,sortDirection:"none"}),n.wijmo.registerWidget("c1groupedfield",r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){e.grid.widgetName(this.element[0],this.widgetFullName),this.element.css("display","inline").addClass(this.options.wijCSS.widget)},r.prototype._destroy=function(){this.mBtnElement=null},r.prototype._init=function(){var e=this;this.mBtnElement=this._createElement(this.options).addClass("wijmo-wijgrid-commandbutton").click(function(t){!e.options.disabled&&n.isFunction(e.options.click)&&e.options.click.call(self,t)}),this.element.append(this.mBtnElement),this._attachWidget(this.mBtnElement,this.options)},r.prototype._setOption=function(e,n){var r=this.options[e];t.prototype._setOption.apply(this,[e,n]),r!==n&&e==="disabled"&&this._onDisabledChanged(n===!0)},r.prototype._createElement=function(e){throw"not implemented"},r.prototype._attachWidget=function(e,t){throw"not implemented"},r.prototype._btnElement=function(){return this.mBtnElement},r.prototype._onDisabledChanged=function(e){},r}(e.wijmoWidget);t.wijgridcommandbuttonbase=r;var i=function(){function e(){this.text=undefined,this.click=undefined,this.iconClass=undefined,this.disabled=!1}return e}();t.wijgridcommandbuttonbase_options=i,r.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("wijgridcommandbuttonbase",r.prototype);var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){var t=n('<a href="#" />').text(e.text||"");return e.disabled&&t.prop("disabled","disabled"),t},t.prototype._attachWidget=function(e,t){},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.prop("disabled",e)},t}(r);t.wijgridcommandlink=s,n.wijmo.registerWidget("wijgridcommandlink",n.wijmo.wijgridcommandbuttonbase,s.prototype);var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){return n('<input type="button" />').val(e.text)},t.prototype._attachWidget=function(e,t){e.button({disabled:t.disabled})},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.button({disabled:e})},t}(r);t.wijgridcommandbutton=o,n.wijmo.registerWidget("wijgridcommandbutton",n.wijmo.wijgridcommandbuttonbase,o.prototype);var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){var t=n("<button />"),r=!!e.text;return r?t.text(e.text):t.html("&nbsp;"),t},t.prototype._attachWidget=function(e,t){var n=!!t.text;e.button({disabled:t.disabled,icons:{primary:t.iconClass},text:n})},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.button({disabled:e})},t}(r);t.wijgridcommandimagebutton=u,n.wijmo.registerWidget("wijgridcommandimagebutton",n.wijmo.wijgridcommandbuttonbase,u.prototype);var a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createElement=function(e){var t=n("<button />").html("&nbsp;");return t},t.prototype._attachWidget=function(e,t){e.button({disabled:t.disabled,icons:{primary:t.iconClass},text:!1})},t.prototype._onDisabledChanged=function(e){var t=this._btnElement();t&&t.button({disabled:e})},t}(r);t.wijgridcommandimage=a,n.wijmo.registerWidget("wijgridcommandimage",n.wijmo.wijgridcommandbuttonbase,a.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.testC1GridViewCommandField=function(t){return t&&t.innerState&&(t.innerState.clientType||"").toLowerCase()==="c1commandfield"},t.testC1GridViewButtonField=function(t){return t&&t.innerState&&(t.innerState.clientType||"").toLowerCase()==="c1buttonfield"},t.test=function(n){return n&&n.buttonType&&!t.testC1GridViewCommandField(n)&&!t.testC1GridViewButtonField(n)},t}(t.c1basefield);t.c1btnfieldbase=r;var i=function(e){function t(){e.apply(this,arguments),this.buttonType="button"}return __extends(t,e),t}(t.c1basefield_options);t.c1btnfieldbase_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i);var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.test=function(t){return r.test(t)||t.command},t}(r);t.c1btnfield=s;var o=function(e){function t(){e.apply(this,arguments),this.command=undefined}return __extends(t,e),t}(i);t.c1btnfield_options=o,s.prototype.options=e.grid.extendWidgetOptions(r.prototype.options,new o),n.wijmo.registerWidget("c1btnfield",s.prototype);var u=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.test=function(t){return r.testC1GridViewCommandField(t)||r.testC1GridViewButtonField(t)?!1:t.showDeleteButton&&t.showDeleteButton!==!1||t.showEditButton&&t.showEditButton!==!1||t.cancelCommand||t.deleteCommand||t.editCommand||t.updateCommand},t}(r);t.c1commandbtnfield=u;var a=function(e){function t(){e.apply(this,arguments),this.showDeleteButton=!1,this.showEditButton=!1,this.cancelCommand={text:"Cancel",iconClass:"ui-icon-close",click:undefined},this.deleteCommand={text:"Delete",iconClass:"ui-icon-trash",click:undefined},this.editCommand={text:"Edit",iconClass:"ui-icon-pencil",click:undefined},this.updateCommand={text:"Update",iconClass:"ui-icon-disk",click:undefined}}return __extends(t,e),t}(i);t.c1commandbtnfield_options=a,u.prototype.options=e.grid.extendWidgetOptions(r.prototype.options,new a),n.wijmo.registerWidget("c1commandbtnfield",u.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(t){var n=[];return e.grid.traverse(t,function(e){n.push(e)}),n}function s(e){var t=[];return o(e,t),t}function o(e,t){var n,r,i,s;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.options&&(i=i.options),s=i.columns,s&&s.length?o(s,t):t.push(i)}function u(e,t){var n,r,i,s=null;if(e&&t>=0)for(n=0,r=e.length;n<r&&!s;n++){i=e[n],i.options&&(i=i.options);if(i.travIdx===t)return{found:i,at:e};i.columns&&(s=this.getColumnByTravIdx(i.columns,t))}return s}function a(e){var t=[];return f(e,t),t}function f(e,t){var n,r,i;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.isLeaf&&t.push(i),i.columns&&f(i.columns,t)}function l(t,n){if(!t||!n||t.parentIdx===-1)return null;var r=n[t.parentIdx];return r.parentIdx===-1?r:e.grid.getTompostParent(r,n)}function c(e,t,n){t.options&&(t=t.options),n.options&&(n=n.options);if(n.isBand&&t.parentIdx>=0){if(t.parentIdx===n.travIdx)return!0;if(t.parentIdx>n.travIdx){var r=this.flatten(e);for(;;){t=r[t.parentIdx];if(t.travIdx===n.travIdx)return!0;if(t.parentIdx===-1)break}}}return!1}function h(e){return p(e,0,-1)}function p(e,t,n){var r,i,s;if(e)for(r=0,i=e.length;r<i;r++)s=e[r],s.options&&(s=s.options),s.linearIdx=r,s.travIdx=t++,s.parentIdx=n,s.columns&&(t=p(s.columns,t,t-1));return t}function d(t,r){var i,s,o;if(t&&n.isFunction(r))for(i=0;i<t.length;i++){o=t[i],o.options&&(o=o.options),s=t.length,r(o,t);if(t.length!==s){i--;continue}o.columns&&e.grid.traverse(o.columns,r)}}var n=jQuery,r=function(){function t(){}return t.prototype.generateSpanTable=function(e,t){this._height=this._width=this._inc=this._shift=0,this._table=[],this._traverseList=[],this._savedXPos=[];var n=this._generateSpanTable(e,t,!0);return n},t.prototype._generateSpanTable=function(t,n,r){var i,s,o=this;this._height=this.getVisibleHeight(t,r),n=n||[],e.grid.traverse(t,function(e){e.isLeaf&&n.push(e),o._traverseList.push(e)}),this._width=n.length;for(i=0;i<this._height;i++){this._table[i]=[];for(s=0;s<this._width;s++)this._table[i][s]={column:null,colSpan:0,rowSpan:0}}return this._setTableValues(t,0,0),this._table},t.prototype.getVisibleHeight=function(e,t){var r,i,s,o,u=0;if(n.isArray(e))for(r=0,i=e.length;r<i;r++)o=this.getVisibleHeight(e[r],t),u=Math.max(u,o);else{s=e.visible===undefined?!0:e.visible,e.parentVis=s&&t;if(e.isBand){for(r=0,i=e.columns.length;r<i;r++)o=this.getVisibleHeight(e.columns[r],e.parentVis),u=Math.max(u,o);if(!e.parentVis)return u;e.isLeaf=u===0,u++}else e.isLeaf=!0,e.parentVis&&(u=1)}return u},t.prototype._getVisibleParent=function(e){while(e){e=this._traverseList[e.parentIdx];if(e&&(e.parentVis||e.parentVis===undefined))return e}return null},t.prototype._setTableValues=function(e,t,r){var i,s,o,u,a,f;if(n.isArray(e))for(i=0,s=e.length;i<s;i++)this._setTableValues(e[i],t,r);else{if(e.travIdx===undefined)throw"undefined travIdx";o=r+this._shift,e.parentVis&&(u=o+this._inc,this._table[t][u].column=e,this._savedXPos[e.travIdx]=u);if(e.isBand)for(i=0,s=e.columns.length;i<s;i++)this._setTableValues(e.columns[i],t+1,r);e.parentVis?this._shift-o===0?(this._table[t][this._savedXPos[e.travIdx]].rowSpan=this._height-t,this._shift++):this._table[t][this._savedXPos[e.travIdx]].colSpan=this._shift-o:!e.isBand&&this._height>0&&(f=this._getVisibleParent(e),a=f?f.isLeaf:!1,a&&this._inc++,t>=this._height&&(t=this._height-1),u=r+this._shift+this._inc,this._table[t][u].column=e,a||(f&&this._savedXPos[f.travIdx]===u&&this._shiftTableElements(u,t),this._inc++))}},t.prototype._shiftTableElements=function(e,t){var n;for(n=0;n<t;n++)this._table[n][e+1]=this._table[n][e],this._table[n][e]={column:null,colSpan:0,rowSpan:0},this._table[n][e+1].column&&this._savedXPos[this._table[n][e+1].column.travIdx]++},t}();t.bandProcessor=r,t.flatten=i,t.getAllLeaves=s,t.getColumnByTravIdx=u,t.getLeaves=a,t.getTompostParent=l,t.isChildOf=c,t.setTraverseIndex=h,t.traverse=d})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._dvFilteringSettings=undefined,this._dvPagingSettings=undefined,this._dvSortingSettings=undefined,this._wgFilteringSettings=undefined,this._wgPagingSettings=undefined,this._wgSortingSettings=undefined;if(!t)throw"exception";this._wijgrid=t,this._dataView=t._dataViewWrapper.dataView(),this._filterCache=new e.grid.filterOperatorsCache(t)}return t.prototype.compareSettings=function(){var t=!0,n,r,i,s;t=(n=this.DVPagingSettings())===(r=this.WGPagingSettings()),!t&&n&&r&&(t=n.pageSize===r.pageSize&&n.pageIndex===r.pageIndex);if(t){t=(n=this.DVSortingSettings())===(r=this.WGSortingSettings());if(!t&&n&&r&&(s=n.length)===r.length){t=!0;for(i=0;i<s&&t;i++)t=n[i].dataKey===r[i].dataKey&&n[i].sortDirection===r[i].sortDirection}}return t&&(n=this.DVFilteringSettings(),r=this.WGFilteringSettings(),t=e.grid.compareObj(n,r)),t},t.prototype.DVFilteringSettings=function(){function e(t,r){var i;n.each(t,function(t,s){typeof s=="string"?i=s:n.isArray(s)?e(s,r):(r.filterValue.push(s.value),r.filterOperator.push({name:s.originalOperator||s.operator,condition:i}))})}if(this._dvFilteringSettings===undefined){var t=[],r=this._dataView.filter();r&&n.each(r,function(r,i){var s={dataKey:r};n.isArray(i)?(s.filterValue=[],s.filterOperator=[],e(i,s)):n.isPlainObject(i)?(s.filterValue=i.value,s.filterOperator=i.originalOperator||i.operator||"Equals"):(s.filterValue=i,s.filterOperator="Equals"),t.push(s)}),this._dvFilteringSettings=t.length?t:null}return this._dvFilteringSettings},t.prototype.DVPagingSettings=function(){if(this._dvPagingSettings===undefined){var t=e.grid.asPagedDataView(this._dataView);if(t){var n=t.pageSize();this._dvPagingSettings=n>0?{pageSize:t.pageSize(),pageIndex:t.pageIndex()}:null}}return this._dvPagingSettings},t.prototype.DVSortingSettings=function(){if(this._dvSortingSettings===undefined){var t=[],r=e.data.sorting.compile(this._dataView.sort()).normalized;r&&n.each(r,function(e,n){n!==null&&t.push({dataKey:typeof n=="string"?n:n.property,sortDirection:n.asc||n.asc===undefined?"ascending":"descending"})}),this._dvSortingSettings=t.length?t:null}return this._dvSortingSettings},t.prototype.WGFilteringSettings=function(){if(this._wgFilteringSettings===undefined){var t=[],r=this._wijgrid._field("leaves"),i=this;r&&n.each(r,function(n,r){if(e.grid.validDataKey(r.dataKey)&&r.filterOperator){var s=e.grid.deepExtend({},{foo:r.filterValue}).foo,o=e.grid.deepExtend({},{foo:r.filterOperator}).foo,u=e.grid.filterHelper.verify(o,s,r.dataType,i._filterCache);u&&t.push({owner:r,dataKey:r.dataKey,filterValue:u.filterValue,filterOperator:u.filterOperator})}}),this._wgFilteringSettings=t.length?t:null}return this._wgFilteringSettings},t.prototype.WGPagingSettings=function(){return this._wgPagingSettings===undefined&&(this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null),this._wgPagingSettings},t.prototype.WGSortingSettings=function(){if(this._wgSortingSettings===undefined){var t={},r=[],i=this._wijgrid._groupedColumns(!0),s=this._wijgrid._field("leaves")||[],o=function(t){return!t.isBand&&e.grid.validDataKey(t.dataKey)},u=0;n.each(i,function(e,n){o(n)&&(n.sortDirection==="none"&&(n.sortDirection="ascending"),t[n.dataKey]={dataKey:n.dataKey,sortDirection:n.sortDirection,sortOrder:u++})}),u++,n.each(s,function(e,n){o(n)&&(n.sortDirection==="ascending"||n.sortDirection==="descending")&&(t[n.dataKey]||(t[n.dataKey]={dataKey:n.dataKey,sortDirection:n.sortDirection,sortOrder:(n.sortOrder||0)+u}))}),n.each(t,function(e,t){r.push(t)}),r.sort(function(e,t){return e.sortOrder-t.sortOrder}),n.each(r,function(e,t){delete t.sortOrder}),this._wgSortingSettings=r.length?r:null}return this._wgSortingSettings},t.prototype.MapWGToDV=function(){var t=this,r={},i,s;this._mapPagingParams()&&(i=this.WGPagingSettings())?(r.pageIndex=i.pageIndex,r.pageSize=i.pageSize):r.pageSize=-1;if(this._mapSortingParams()){r.sort=[];if(i=this.WGSortingSettings())r.sort=[],n.each(i,function(e,t){r.sort.push({property:t.dataKey,asc:t.sortDirection==="ascending"})})}this._wijgrid.deficientFilters={};if(this._mapFilteringParams()){n.each(this._wijgrid._field("leaves"),function(n,r){e.grid.validDataKey(r.dataKey)&&r.filterOperator===undefined^r.filterValue===undefined&&(t._wijgrid.deficientFilters[r.dataKey]={filterOperator:r.filterOperator,filterValue:r.filterValue})}),r.filter={};if(i=this.WGFilteringSettings())r.filter=this._convertFilterToDV(i);n.isEmptyObject(r.filter)&&(r.filter=null)}return r},t.prototype.MapDVToWG=function(){var t,r={},i=this._mapSortingParams(),s=this._mapPagingParams(),o=this._mapFilteringParams(),u=e.grid.asPagedDataView(this._dataView),a=this;n.each(this._wijgrid._field("leaves"),function(e,t){i&&(t.sortOrder=0,t.sortDirection="none"),o&&(t.filterOperator="nofilter",t.filterValue=undefined),r[t.dataKey]=t}),s&&u&&(this._wijgrid.options.pageSize=u.pageSize(),this._wijgrid.options.pageIndex=u.pageIndex()),i&&(t=this.DVSortingSettings())&&n.each(t,function(e,t){var n;if(n=r[t.dataKey])n.sortDirection=t.sortDirection,n.sortOrder=e}),o&&((t=this.DVFilteringSettings())&&n.each(t,function(e,t){var i;if(i=r[t.dataKey])i.filterValue=t.filterValue,i.filterOperator=t.filterOperator,n.isPlainObject(i.filterOperator)&&(i.filterOperator=i.filterOperator.name),delete a._wijgrid.deficientFilters[i.dataKey]}),n.each(this._wijgrid.deficientFilters,function(e,t){r[e].filterOperator=t.filterOperator,r[e].filterValue=t.filterValue}))},t.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()},t.prototype._mapSortingParams=function(){return!this._wijgrid._serverShaping()},t.prototype._mapFilteringParams=function(){return!this._wijgrid._serverShaping()},t.prototype.makeProxyFilter=function(t,r,i,s){i=i.toLowerCase();var o=this,u=t.dataType==="datetime",a={originalOperator:undefined,property:r,operator:i,value:s},f=this._filterCache.getByNameInt(i),l=e.data.filtering.ops[i];if(i!=="nofilter"&&(f.isCustom||u)){a.originalOperator=a.operator;if(f.isCustom)a.operator=n.extend(!0,{},f.op),a.operator.apply=a.operator.operator;else{a.operator=n.extend(!0,{},l);var c=t.inputType?e.grid.TimeUnitConverter.convertInputType(t.inputType):e.grid.TimeUnitConverter.convertFormatString(t.dataFormatString||"d");a.operator.apply=function(n,r){return n instanceof Date||(n=o._wijgrid.parse(t,n)),r instanceof Date||(r=o._wijgrid.parse(t,r)),e.grid.TimeUnitConverter.cutDate(n,c),e.grid.TimeUnitConverter.cutDate(r,c),l.apply(n,r)}}}return a},t.prototype._convertFilterToDV=function(e){var t={},r=this;return n.each(e,function(e,i){var s=i.dataKey,o=[],u="and",a,f,l,c;if(!n.isPlainObject(i))return;f=i.filterOperator,l=i.filterValue;if(f==null)return;n.isArray(f)||(f=[f]),n.isArray(l)||(l=[l]);if(f.length!=l.length)throw"The number of filter operators must match the number of filter values";if(f.length==0)return;n.each(f,function(e,t){function h(){c.length>1?c.splice(0,0,"or"):c=c[0]}function p(){u==null&&(u=a,o.splice(0,0,a))}var f;typeof t=="string"&&(t={name:t});if(!n.isPlainObject(t)||!t.name)throw"Invalid filter operator";f=l[e],n.isArray(f)||(f=[f]),c=n.map(f,function(e){return r.makeProxyFilter(i.owner,s,t.name,e)}),u=null,a=t.condition||"or",o.length<=1||u==a?c.length==1||o.length<=1||u=="or"?(o=o.concat(c),p()):(h(),o.push(c),p()):(h(),o=[o,c],p())}),n.each(o,function(e,t){n.isArray(t)&&t.length==2&&(o[e]=t[1])}),o.length==2&&typeof (o[0]==="string")&&o.shift(),o.length==1&&(o=o[0]),t[s]=o}),t},t}();t.settingsManager=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){return e&&"pageCount"in e?e:null}function s(e){return e&&"commitEdit"in e?e:null}var n=jQuery,r=function(){function t(e){this._domSource=null,this._ignoreAllEvents=!1,this._ignoreChangeEvent=!1,this._ignoreCurrentChangedEvent=!1,this._sharedDataItems=null,this._userData=null,this._totals=null,this._changeTimer=0,this._toDispose=[],this._isOwnDataView=!1,this._isWijdatasource=!1,this._isKODataView=!1,this._isDynamicWijdatasource=!1,this._wijgrid=e,this._createDataViewWrapper()}return t.prototype.data=function(){var t=this._getDataViewInst(),n=e.grid.asPagedDataView(t);return{data:this._getSharedDataItems(),totalRows:n!=null?n.totalItemCount():(t.getSource()||[]).length,totals:this._getTotals(),emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}},t.prototype.dataView=function(){return this._getDataViewInst()},t.prototype.dispose=function(){var e=this._getDataViewInst();this._propChangeListener.dispose(),n.each(this._toDispose,function(e,t){t.dispose()}),e&&this._isOwnDataView&&e.dispose(),this._wijgrid._wijDataView=null},t.prototype.ignoreChangeEvent=function(e){if(!arguments.length)return this._ignoreChangeEvent;this._ignoreChangeEvent=e===!0},t.prototype.ignoreCurrentChangedEvent=function(e){if(!arguments.length)return this._ignoreCurrentChangedEvent;this._ignoreCurrentChangedEvent=e===!0},t.prototype.isDataLoaded=function(){var e=this._getDataViewInst();return e.isLoaded()},t.prototype.isOwnDataView=function(){return this._isOwnDataView},t.prototype.getFieldsInfo=function(){var e=this._getDataViewInst();return this._propDescriptorsToFieldsInfo(e.getProperties())},t.prototype._propDescriptorsToFieldsInfo=function(e){var t={};return e&&n.each(e,function(e,n){if(n.name==="$$hash"||n.name==="$$hashKey")return;t[n.name]={name:n.name,type:n.type||"string"}}),t},t.prototype.isBoundedToDOM=function(){return this._domSource!==null},t.prototype.load=function(t){this._userData=t;var n=this._getDataViewInst();n||(this._createDataViewWrapper(),n=this._getDataViewInst()),this._onDataViewLoading();var r=new e.grid.settingsManager(this._wijgrid);if(t&&t.forceDataLoad||this._needToLoad(r)){var i=r.MapWGToDV(),s=!1;this._isWijdatasource&&!this._isDynamicWijdatasource&&n.isLoaded()&&(s=!0);var o=e.grid.asPagedDataView(n),u=-1;if(o&&i.pageSize>=0&&(u=o.totalItemCount())>=0){if(this._isOwnDataView&&!this._isKODataView&&o.pageSize()>0){var a=o.getSource();a&&a.length<u&&(u=a.length)}var f=Math.ceil(u/i.pageSize)||1,l=i.pageIndex;l>=f&&(l=Math.max(0,f-1)),i.pageIndex=l}this.ignoreCurrentChangedEvent(!0),n.refresh(i,s)}else this.isDataLoaded()&&(this._onDataViewLoaded(),this._onDataViewReset())},t.prototype.currentPosition=function(e){var t=this._getDataViewInst();if(!arguments.length)return t.currentPosition();this.ignoreCurrentChangedEvent(!0);try{t.currentPosition(e)}finally{this.ignoreCurrentChangedEvent(!1)}},t.prototype.getValue=function(e,t){var n=this._getDataViewInst();return typeof t=="number"&&(t+=""),n.getProperty(e,t)},t.prototype.setValue=function(e,t,n){var r=this._getDataViewInst();this.ignoreChangeEvent(!0);try{typeof t=="number"&&(t+=""),r.setProperty(e,t,n)}finally{this.ignoreChangeEvent(!1)}},t.prototype.makeDirty=function(){this._propChangeListener.removeAll(),this._totals=null,this._sharedDataItems=null},t.prototype._createDataViewWrapper=function(){var t,r=this._wijgrid.options.data,i=this._getDataViewInst(),s=!1;if(i)return;r||(this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData),r=this._domSource.items),s=typeof wijdatasource!="undefined"&&r instanceof wijdatasource,this._isKODataView=r instanceof e.grid.koDataView,this._isOwnDataView=n.isArray(r)||s||this._isKODataView,this._isWijdatasource=!!this._isOwnDataView&&!!s,this._isDynamicWijdatasource=!!(this._isOwnDataView&&s&&r.dynamic);if(this._isOwnDataView&&!this._isKODataView){!this._domSource&&this._wijgrid.options.readAttributesFromData&&this._moveAttributesToExpando(r);var o=this.isBoundedToDOM()&&e.grid.getTableSection(this._wijgrid.element,e.grid.rowScope.body);i=e.grid.GridDataView.create(e.data.asDataView(this._parseOwnData(r,o)))}else i=r;this._wijgrid._wijDataView=i,this._toDispose.push(i.isLoading.subscribe(n.proxy(this._onDataViewLoadingInternal,this))),this._toDispose.push(i.isLoaded.subscribe(n.proxy(this._onDataViewLoadedInternal,this))),this._toDispose.push(i.subscribe(n.proxy(this._onDataViewChangeInternal,this))),this._toDispose.push(i.currentPosition.subscribe(n.proxy(this._onDataViewCurrentChangedInternal,this))),this._propChangeListener=new e.grid.propChangeListener(n.proxy(this._onPropertyChanged,this))},t.prototype._parseOwnData=function(t,r){var i=this;if(t&&t.length){var s=n.extend(!0,[],this._wijgrid.options.columns),o=e.data.ArrayDataViewBase._getProps(t[0])||[],u=this._propDescriptorsToFieldsInfo(o),a=[];this._wijgrid._prepareColumnOptions(s,"merge",u,!0,!0),e.grid.traverse(s,function(t){e.grid.getDataType(t)!=="string"&&e.grid.validDataKey(t.dataKey)&&a.push(t)}),a.length&&r&&n.each(t,function(t,n){e.grid.dataViewWrapper._parseDataItem(i._wijgrid,n,r&&r.rows[t],a)})}return t},t._parseDataItem=function(t,r,i,s){return n.each(s,function(e,n){var s=r[n.dataKey],o=t.parse(n,s);if(isNaN(o)){var u=null;i&&(u=i.cells[n.dataKey]),o=t.parseFailed(n,s,r,u)}r[n.dataKey]=o}),r},t.prototype._getDataViewInst=function(){return this._wijgrid._wijDataView},t.prototype._needToLoad=function(e){var t=this._getDataViewInst();return this._isDynamicWijdatasource||this._isWijdatasource&&!t.isLoaded()?!0:this._isOwnDataView&&!this._isWijdatasource&&this.isDataLoaded()?!0:this.isDataLoaded()||t.isLoading()?!e.compareSettings():!0},t.prototype._validateSettings=function(e){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&(e.DVPagingSettings()||{}).pageSize!==(e.WGPagingSettings()||{}).pageSize)throw"The pageSize option of the external dataView can't be changed."},t.prototype._onDataViewLoadingInternal=function(e){if(this._ignoreAllEvents)return;e&&(this._userData||this._onDataViewLoading())},t.prototype._onDataViewLoadedInternal=function(e){if(this._ignoreAllEvents)return;e&&this._onDataViewLoaded()},t.prototype._onDataViewChangeInternal=function(e){var t=this;if(this._ignoreAllEvents||this._ignoreChangeEvent)return;if(e.changes){if(e.length&&e[0].entityState()==="detached")return;n.each(e.changes,function(e,n){switch(n.changeType){case"remove":t._propChangeListener.remove(n.index);break;case"add":t._propChangeListener.insert(n.index,n.element)}})}this._onDataViewChange.apply(this,arguments)},t.prototype._onDataViewCurrentChangedInternal=function(){if(this._ignoreAllEvents||this._ignoreCurrentChangedEvent)return;this._onDataViewCurrentChanged.apply(this,arguments)},t.prototype._onDataViewReset=function(){try{this.ignoreCurrentChangedEvent(!1),this.makeDirty(),this._wijgrid._onDataViewReset(this._userData,this._isKODataView)}finally{this._userData=null}},t.prototype._onPropertyChanged=function(e){var t=this;this._changeTimer>0&&(window.clearTimeout(this._changeTimer),this._changeTimer=0),this._changeTimer!=-1&&(this._changeTimer=window.setTimeout(function(){t._changeTimer=-1,t._wijgrid._destroyed||t._onDataViewChange(),t._changeTimer=0},100))},t.prototype._onDataViewChange=function(e){this._onDataViewReset()},t.prototype._onDataViewCurrentChanged=function(e,t){this._wijgrid._onDataViewCurrentPositionChanged(e,t)},t.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()},t.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()},t.prototype._getSharedDataItems=function(){if(!this._sharedDataItems){var e=this._getDataViewInst(),t=e.count();this._sharedDataItems=[];var n=!0;for(var r=0;r<t;r++){var i=e.item(r);n&&!this._propChangeListener.insert(r,i)&&r===0&&(n=!1),this._sharedDataItems.push(this._wrapDataItem(i,r))}}return this._sharedDataItems||(this._sharedDataItems=[]),this._sharedDataItems},t.prototype._getTotals=function(){if(!this._totals){var e=this._getDataViewInst();this._totals=this._prepareTotals(e,this._wijgrid._prepareTotalsRequest(!0))}return this._totals||(this._totals={}),this._totals},t.prototype._prepareTotals=function(t,n){if(!n||n.length===0)return{};var r,i,s,o,u=[],a={};for(r=0,i=n.length;r<i;r++)u.push(new e.grid.tally);for(r=0,i=t.count();r<i;r++)for(s=0,o=u.length;s<o;s++)u[s].add(this._wijgrid.parse(n[s].column,this.getValue(r,n[s].column.dataKey)));for(r=0,i=u.length;r<i;r++)a[n[r].column.dataKey]=u[r].getValueString(n[r].column);return a},t.prototype._processDOM=function(t,r){var i={items:[],emptyData:[],header:e.grid.readTableSection(t,e.grid.rowScope.head)};return e.grid.getTableSectionLength(t,2)===1&&n(e.grid.getTableSectionRow(t,2,0)).hasClass(e.grid.wijgrid.CSS.emptyDataRow)?i.emptyData=e.grid.readTableSection(t,e.grid.rowScope.body):i.items=e.grid.readTableSection(t,e.grid.rowScope.body,r),i},t.prototype._moveAttributesToExpando=function(t){n.each(t,function(t,r){var i=e.data.Expando.getFrom(r,!0),s;s=i[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}},r.rowAttributes&&(s.rowAttributes=r.rowAttributes,delete r.rowAttributes),n.each(r,function(e,t){n.isArray(t)&&(s.cellsAttributes[e]=t[1],r[e]=t[0])})})},t.prototype._wrapDataItem=function(e,t){return{values:e,originalRowIndex:t}},t.prototype._refreshSilent=function(){var e=this._getDataViewInst();if(e)try{this._ignoreAllEvents=!0,e.refresh()}finally{this._ignoreAllEvents=!1}},t.prototype._unsafeReplace=function(t,n){var r=this._getDataViewInst();r instanceof e.grid.GridDataView||"operation is not supported",r._unsafeReplace(t,n)},t.prototype._unsafeSplice=function(t,n,r){var i=this._getDataViewInst();i instanceof e.grid.GridDataView||"operation is not supported",arguments.length===2?i._unsafeSplice(t,n):i._unsafeSplice(t,n,r)},t.prototype._unsafePush=function(t){var n=this._getDataViewInst();n instanceof e.grid.GridDataView||"operation is not supported",n._unsafePush(t)},t}();t.dataViewWrapper=r,t.asPagedDataView=i,t.asEditableDataView=s;var o=function(){function e(e){this._subscriptions=[],this._callback=e}return e.prototype.insert=function(e,t){var r=null,i=this;return n.each(t,function(e,t){i._isValidPropName(e)&&t&&n.isFunction(t.subscribe)&&(r=r||[],r.push(t.subscribe(i._callback)))}),r?(this._subscriptions.length<e&&(this._subscriptions.length=e),this._subscriptions.splice(e,0,r),!0):!1},e.prototype.remove=function(e){var t=this._subscriptions[e];t&&n.each(t,function(e,n){n.dispose(),t[e]=null}),this._subscriptions[e]=null,this._subscriptions.splice(e,1)},e.prototype.removeAll=function(){var e,t;while(e=this._subscriptions.length)this.remove(e-1);this._subscriptions=[]},e.prototype.dispose=function(){this.removeAll()},e.prototype._isValidPropName=function(e){return e&&typeof e=="string"?e.match(/^entityState|jQuery/)===null:!0},e}();t.propChangeListener=o})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t,n,r,i,s){this.cr=new e.grid.cellRange(-1,-1),this.isExpanded=!1,this.position="none",this._sum=-1,this._hasHeaderOrFooter=!0,t!==undefined&&(this.isExpanded=t),n!==undefined&&(this.cr=n),r!==undefined&&(this._sum=r),i!==undefined&&(this.position=i),s!==undefined&&(this._hasHeaderOrFooter=s)}return t.prototype.isSubRange=function(e){return this.cr.r1>=e.cr.r1&&this.cr.r2<=e.cr.r2},t.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2},t.prototype.collapse=function(){var t,n,r,i,s;(t=this.owner)&&(n=t.owner)&&(r=n.owner)&&(i=r._field("leaves"),e.grid.groupHelper.isParentExpanded(i,this.cr,t.level)&&t.position!=="footer"&&t.outlineMode!=="none"&&(s=e.grid.groupHelper.getGroupedColumnsCount(i),this._collapse(r,r._rows(),i,this,s,r._allowVirtualScrolling())))},t.prototype.expand=function(t){var n,r,i,s,o;(n=this.owner)&&(r=n.owner)&&(i=r.owner)&&(s=i._field("leaves"),e.grid.groupHelper.isParentExpanded(s,this.cr,n.level)&&(o=e.grid.groupHelper.getGroupedColumnsCount(s),this._expand(i,i._rows(),s,this,o,t,!0,i._allowVirtualScrolling())))},t.prototype._collapse=function(t,n,r,i,s,o){var u=i.owner,a=i.cr.r1,f=i.cr.r2,l,c,h,p,d;switch(u.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(t.sketchTable.row(i.cr.r1),undefined,!1),o||this._toggleRowVisibility(t,n.item(i.cr.r1),undefined,!1),a++}for(l=a;l<=f;l++)this._toggleSketchRowVisibility(t.sketchTable.row(l),!1,undefined),o||this._toggleRowVisibility(t,n.item(l),!1,undefined);i.isExpanded=!1;for(l=u.level+1;l<=s;l++){h=e.grid.groupHelper.getChildGroupRanges(r,i.cr,l-1);for(d=0,c=h.length;d<c;d++){p=h[d],p.isExpanded=!1;switch(p.owner.position){case"header":case"headerAndFooter":this._toggleSketchRowVisibility(t.sketchTable.row(p.cr.r1),!1,!1),o||this._toggleRowVisibility(t,n.item(p.cr.r1),!1,!1)}}}},t.prototype._expand=function(t,n,r,i,s,o,u,a){var f=i.owner,l=i.cr.r1,c=i.cr.r2,h,p,d,v,m;switch(f.position){case"header":this._toggleSketchRowVisibility(t.sketchTable.row(l),!0,u||o),a||this._toggleRowVisibility(t,n.item(l),!0,u||o),l++;break;case"footer":this._toggleSketchRowVisibility(t.sketchTable.row(c),!0,undefined),a||this._toggleRowVisibility(t,n.item(c),!0,undefined),c--;break;case"headerAndFooter":this._toggleSketchRowVisibility(t.sketchTable.row(l),!0,u||o),a||this._toggleRowVisibility(t,n.item(l),!0,u||o),u&&(this._toggleSketchRowVisibility(t.sketchTable.row(c),!0,undefined),a||this._toggleRowVisibility(t,n.item(c),!0,undefined)),l++,c--}if(!u)return;i.isExpanded=!0;if(i.owner.level===s)for(h=l;h<=c;h++)this._toggleSketchRowVisibility(t.sketchTable.row(h),!0,undefined),a||this._toggleRowVisibility(t,n.item(h),!0,undefined);else{d=e.grid.groupHelper.getChildGroupRanges(r,i.cr,i.owner.level);if(d.length&&l!==d[0].cr.r1)for(h=l;h<d[0].cr.r1;h++)this._toggleSketchRowVisibility(t.sketchTable.row(h),!0,undefined),a||this._toggleRowVisibility(t,n.item(h),!0,undefined);if(o)for(h=0,p=d.length;h<p;h++)v=d[h],this._expand(t,n,r,v,s,o,!0,a);else for(h=0,p=d.length;h<p;h++)v=d[h],m=v.owner.position==="footer"||v.owner.outlineMode==="none"?!0:!1,this._expand(t,n,r,v,s,!1,m,a)}},t.prototype._toggleRowVisibility=function(t,n,r,i){if(n){var s=e.grid.renderStateEx,o=t._view(),u=o._getRowInfo(n,!1);r!==undefined&&(r?u._extInfo.state&=~s.hidden:u._extInfo.state|=s.hidden),i!==undefined&&(i?u._extInfo.state&=~s.collapsed:u._extInfo.state|=s.collapsed),o._setRowInfo(u.$rows,u),t.rowStyleFormatter._groupFormatter(u)}},t.prototype._toggleSketchRowVisibility=function(t,n,r){if(t){var i=e.grid.renderStateEx;n!==undefined&&(n?t.extInfo.state&=~i.hidden:t.extInfo.state|=i.hidden),r!==undefined&&(r?t.extInfo.state&=~i.collapsed:t.extInfo.state|=i.collapsed)}},t}();t.groupRange=r;var i=function(){function r(){this._groupRowIdx=0}return r.prototype.group=function(e,t,n){this._grid=e,this._sketchTable=t,this._leaves=n,this._groupRowIdx=0;try{this._group()}finally{delete this._grid,delete this._sketchTable,delete this._leaves}},r.prototype._group=function(){var e=this;n.each(this._leaves,function(e,t){t.groupInfo&&(delete t.groupInfo.level,delete t.groupInfo.expandInfo)});var t=this._grid._groupedColumns(!0),r=1;if(t.length==0)return;this._sketchTable.ensureNotLazy(),n.each(t,function(t,n){e._groupRowIdx=0,n.groupInfo&&n.groupInfo.position&&n.groupInfo.position!=="none"&&n.dataIndex>=0&&(n.groupInfo.level=r,n.groupInfo.expandInfo=[],e._processRowGroup(n,r++))})},r.prototype._processRowGroup=function(t,r){var i=0,s=!0,o=e.grid.renderStateEx;n.each(this._leaves,function(e,t){if(t.parentVis)return i=e,!1});for(var u=0;u<this._sketchTable.count();u++){var a=this._sketchTable.row(u);if(!a.isDataRow())continue;var f=this._getGroupCellRange(u,t,r),l=!0,c=t.groupInfo.outlineMode==="startCollapsed",h,p,d,v;if(c||e.grid.groupHelper.isParentCollapsed(this._leaves,f,r)){if(t.groupInfo.groupSingleRow===!1&&f.r1===f.r2)continue;l=!1}if(r&&this._grid.options.groupIndent)for(var m=f.r1;m<=f.r2;m++)this._addIndent(this._sketchTable.row(m).cell(i),r);s=t.groupInfo.groupSingleRow!==!1||f.r1!==f.r2;switch(t.groupInfo.position){case"header":d=this._addGroupRange(t.groupInfo,f,l,s);for(var g=f.r1;g<=f.r2;g++)a=this._sketchTable.row(g),a.extInfo.groupLevel=r+1,l||(a.extInfo.state|=o.hidden);if(!s)break;this._updateByGroupRange(d,r),v=e.grid.groupHelper.isParentCollapsed(this._leaves,d.cr,r),h=this._buildGroupRow(d,f,!0,v),this._sketchTable.insert(f.r1,h),h.extInfo.groupLevel=r,l||(h.extInfo.state|=o.collapsed),v&&(h.extInfo.state|=o.hidden),u=f.r2+1;break;case"footer":d=this._addGroupRange(t.groupInfo,f,!0,s);if(!s)break;this._updateByGroupRange(d,r),p=this._buildGroupRow(d,f,!1,!1),p.extInfo.groupLevel=r,this._sketchTable.insert(f.r2+1,p),u=f.r2+1,v=e.grid.groupHelper.isParentCollapsed(this._leaves,d.cr,r),v&&(p.extInfo.state|=o.hidden);break;case"headerAndFooter":d=this._addGroupRange(t.groupInfo,f,l,s);for(g=f.r1;g<=f.r2;g++)a=this._sketchTable.row(g),a.extInfo.groupLevel=r+1,l||(a.extInfo.state|=o.hidden);if(!s)break;this._updateByGroupRange(d,r),v=e.grid.groupHelper.isParentCollapsed(this._leaves,d.cr,r),h=this._buildGroupRow(d,f,!0,v),p=this._buildGroupRow(d,f,!1,!1),this._sketchTable.insert(f.r2+1,p),p.extInfo.groupLevel=r;if(v||!l)p.extInfo.state|=o.hidden;this._sketchTable.insert(f.r1,h),h.extInfo.groupLevel=r,l||(h.extInfo.state|=o.collapsed),v&&(h.extInfo.state|=o.hidden),u=f.r2+2;break;default:throw e.grid.stringFormat('Unknown Position value: "{0}"',t.groupInfo.position)}this._groupRowIdx++}},r.prototype._buildGroupRow=function(n,r,i,s){var o=n.owner,u=o.owner,a=u.owner,f=new t.SketchGroupRow(i,null),l=undefined,c="",h="",p,d,p,v,m,g,y,b,w,E=e.grid.wijgrid.CSS;f.extInfo.groupIndex=this._groupRowIdx,u.dataIndex>=0&&(l=this._sketchTable.valueAt(r.r1,u.dataIndex))!==null&&(c=a.toStr(u,l)),f.groupByValue=l,this._grid._showRowHeader()&&f.add(t.HtmlCell.nbsp()),p=new t.HtmlCell("",null),f.add(p),u.aggregate&&u.aggregate!=="none"&&(h=this._getAggregate(r,u,u,i,c)),v=i?o.headerText:o.footerText;if(v==="custom")m={data:this._sketchTable.getRawTable(),column:u,groupByColumn:o.owner,groupText:c,text:"",groupingStart:r.r1,groupingEnd:r.r2,isGroupHeader:i,aggregate:h},this._grid._trigger("groupText",null,m)&&(v=m.text);else{if(v===undefined||v===null){i&&(v="{1}: {0}");if(h||h===0)v=v?v+" {2}":"{2}"}v=e.grid.stringFormat(v,u&&u.encodeHtml?e.htmlEncode(c):c,u&&u.headerText?u.headerText:"",this._wrapAggregateValue(h))}v||(v="&nbsp;"),p.html+="<span>"+v+"</span>",this._addIndent(p,o.level-1),g=1,y=this._grid._showRowHeader()?1:0,b=!0;for(;y<this._leaves.length;y++){d=this._leaves[y];if(d.parentVis){if(b){b=!1;continue}if(d.dynamic!==!0&&d.aggregate&&d.aggregate!=="none")break;g++}}for(;y<this._leaves.length;y++)d=this._leaves[y],d.parentVis&&(w=this._getAggregate(r,d,o.owner,i,c),!w&&w!==0&&(w="&nbsp;"),f.add(new t.HtmlCell(this._wrapAggregateValue(w),{groupInfo:{leafIndex:d.leavesIdx,purpose:e.grid.groupRowCellPurpose.aggregateCell}})));return p.ensureAttr().colSpan=g,p.ensureAttr().groupInfo={leafIndex:u.leavesIdx,purpose:e.grid.groupRowCellPurpose.groupCell},f},r.prototype._getAggregate=function(t,n,r,i,s){var o="",u,a,f;if(!n.aggregate||n.aggregate==="none")return o;if(n.aggregate==="custom")u={data:this._sketchTable.getRawTable(),column:n,groupByColumn:r,groupText:s,text:"",groupingStart:t.r1,groupingEnd:t.r2,isGroupHeader:i},this._grid._trigger("groupAggregate",null,u)&&(o=u.text);else{a=new e.grid.tally;for(f=t.r1;f<=t.r2;f++)a.add(this._sketchTable.valueAt(f,n.dataIndex));o=a.getValueString(n)}return o},r.prototype._getGroupCellRange=function(t,n,r){var i=n.leavesIdx,s,o=new e.grid.cellRange(t,i),u=e.grid.groupHelper.getParentGroupRange(this._leaves,o,r),a,f,l;s=this._sketchTable.row(t);if(s.isDataRow()){a=s.valueCell(n.dataIndex).value,a instanceof Date&&(a=a.getTime());for(o.r2=t,l=this._sketchTable.count()-1;o.r2<l;o.r2++){if(!this._sketchTable.row(o.r2+1).isDataRow()||u&&o.r2+1>u.cr.r2)break;f=this._sketchTable.valueAt(o.r2+1,n.dataIndex),f instanceof Date&&(f=f.getTime());if(a!==f)break}}return o},r.prototype._addGroupRange=function(t,n,r,i){var s=null,o=e.grid.groupHelper.getChildGroupIndex(n,t.expandInfo),u,a,f,l;return o>=0&&o<t.expandInfo.length?s=t.expandInfo[o]:(u=new e.grid.cellRange(n.r1,n.r1,n.r2,n.r2),a=t.position==="footer"||!i?!0:r&&t.outlineMode!=="startCollapsed",s=new e.grid.groupRange(a,u,-1,t.position,i),s.owner=t,t.expandInfo.push(s)),s&&i&&(f=n.r1,l=n.r2,t.position==="headerAndFooter"&&(l+=2),t.position!=="headerAndFooter"&&l++,s.cr.r2=l),s},r.prototype._updateByGroupRange=function(e,t){var n,r,i,s,o,u,a;for(n=0,r=this._leaves.length;n<r;n++){i=this._leaves[n].groupInfo;if(i&&i.level<t){s=i.expandInfo?i.expandInfo.length:0;for(o=0;o<s;o++)u=i.expandInfo[o],a=e.position==="headerAndFooter"?2:1,u.cr.r1>=e.cr.r1&&(u.cr.r1!==e.cr.r1||u.position!=="footer")&&(u.cr.r1+=a),u.cr.r2>=e.cr.r1&&(u.cr.r2+=a)}}},r.prototype._addIndent=function(e,t){var n;t>0&&(n=this._grid.options.groupIndent)&&(e.ensureStyle().paddingLeft=n*t+"px")},r.prototype._wrapAggregateValue=function(t){return"<span class='"+e.grid.wijgrid.CSS.aggregateContainer+"'>"+t.toString()+"</span>"},r}();t.grouper=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),t.getGroupInfo=function(n){if(n){var r=e.grid.groupHelper._getGroupInfoRegExp.exec(n.id),i,s,o;if(r)return i=parseInt(r[3],10),s=parseInt(r[2],10),o=r[1]==="H",{level:i,index:s,isHeader:o,toString:function(){return(o?"GH":"GF")+s+"-"+i}}}return null},t.getColumnByGroupLevel=function(t,n){var r,i,s;for(r=0,i=t.length;r<i;r++){s=t[r];if(s.groupInfo&&s.groupInfo.level===n)return s}return null},t.getGroupedColumnsCount=function(t){var n=0,r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r].groupInfo,s&&(s.position==="header"||s.position==="headerAndFooter"||s.position==="footer")&&n++;return n},t.getChildGroupIndex=function(t,n){var r=0,i=n.length-1,s,o;while(r<=i){s=(i-r>>1)+r,o=n[s].cr.r1-t.r1;if(o===0)return s;o<0?r=s+1:i=s-1}return r},t.getParentGroupIndex=function(n,r){var i=e.grid.groupHelper.getChildGroupIndex(n,r);return i>0&&i--,i<r.length?i:-1},t.getChildGroupRanges=function(n,r,i){var s=[],o=e.grid.groupHelper.getColumnByGroupLevel(n,i+1);if(o){var u=o.groupInfo.expandInfo,a=e.grid.groupHelper.getChildGroupIndex(r,u);for(var f=a,l=u.length;f<l;f++){var c=u[f];if(!(c.cr.r2<=r.r2))break;s.push(c)}}return s},t.getParentGroupRange=function(n,r,i){i===undefined&&(i=65535);if(r&&i-2>=0)for(var s=n.length-1;s>=0;s--){var o=n[s].groupInfo;if(!o||!o.expandInfo||o.level<0||o.level!==i-1)continue;var u=e.grid.groupHelper.getParentGroupIndex(r,o.expandInfo);if(u>=0)return o.expandInfo[u]}return null},t.isParentCollapsed=function(n,r,i){if(i===1)return!1;for(var s=i;s>1;s--){var o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(!o)return!1;if(!o.isExpanded)return!0;r=o.cr}return!1},t.isParentExpanded=function(n,r,i){if(i===1)return!0;for(var s=i;s>1;s--){var o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(!o||o&&o.isExpanded)return!0;r=o.cr}return!1},t}();t.groupHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(e,t,n,r){switch(arguments.length){case 2:this.r1=this.r2=e,this.c1=this.c2=t;break;case 4:this.r1=e,this.r2=n,this.c1=t,this.c2=r;break;default:this.r1=0,this.r2=0,this.c1=0,this.c2=0}}return e.prototype.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2},e}();t.cellRange=r;var i=function(){function t(){}return t.prototype.merge=function(e,t){this._leaves=t,this._data=e;try{this._merge()}finally{delete this._data,delete this._leaves}},t.prototype._merge=function(){var e,t,n,r=!0;for(e=0,t=this._leaves.length;e<t;e++)n=this._leaves[e],n.dataIndex>=0&&!n.isBand&&(n.rowMerge==="free"||n.rowMerge==="restricted")&&(r&&(this._data.ensureNotLazy(),r=!1),this._mergeColumn(n))},t.prototype._mergeColumn=function(e){var t=e.dataIndex,n,r,i,s,o,u;for(r=0,i=this._data.count();r<i;r++){n=this._data.row(r);if(!n.isDataRow())continue;s=this._getCellRange(r,e);if(s.r1!==s.r2){o=s.r2-s.r1+1,this._data.row(s.r1).cell(t).ensureAttr().rowSpan=o;for(u=s.r1+1;u<=s.r2;u++)this._data.row(u).cell(t).visible(!1)}r=s.r2}},t.prototype._getCellRange=function(t,n){var r=n.dataIndex,i,s=new e.grid.cellRange(t,r),o=(this._data.valueAt(t,r)||"").toString(),u=this._data.count(),a,f,l;for(s.r2=t;s.r2<u-1;s.r2++){i=this._data.row(s.r2+1);if(!i.isDataRow()||(i.valueCell(r).value||"").toString()!==o)break}return a=n.leavesIdx,a>0&&n.rowMerge==="restricted"&&(f=this._leaves[a-1],f.dataIndex>=0&&(l=this._getCellRange(t,f),s.r1=Math.max(s.r1,l.r1),s.r2=Math.min(s.r2,l.r2))),s},t}();t.merger=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function h(t,r){var i,s,o;if(n.isArray(t)&&n.isArray(r)){if(t.length===r.length){o=!0;for(i=0,s=t.length;i<s&&o;i++)o=e.grid.compareObj(t[i],r[i]);return o}}else{if(n.isPlainObject(t)&&n.isPlainObject(r)){for(i in t)if(t.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;for(i in r)if(r.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;return!0}t instanceof Date&&(t=t.getTime()),r instanceof Date&&(r=r.getTime())}return t===r}function p(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];var r,i;if(!e)return"";for(r=0,i=t.length;r<i;r++)e=e.replace(new RegExp("\\{"+r+"\\}","gm"),t[r]);return e}function d(e){return e&&!(e<0)||e===0}function v(e){return e&&e instanceof Date?!isNaN(e.getTime()):!1}function m(e){return e.dataType||e._underlyingDataType||"string"}function g(e,t){e&&t&&e.find(".ui-widget").each(function(e,r){return n.each(n(r).data(),function(n,r){r.widgetName&&t(e,r)}),!0})}function y(e,t){var r=[];n.each(e.data(),function(e){e.indexOf(t)===0&&r.push(e)}),n.each(r,function(t,n){e.removeData(n)})}function w(e){return n.extend(!0,{},t.c1basefield.prototype.options,t.c1field.prototype.options,{dynamic:!0,isLeaf:!0,isBand:!1,parentIdx:-1},e)}function E(e,t){if(e){var r=e.nodeType?n(e):e,i=r.offset();if(i)return t?{top:i.top,left:i.left,width:r[0].clientWidth||0,height:r[0].clientHeight||0}:{top:i.top,left:i.left,width:r.outerWidth(),height:r.outerHeight()}}return null}function S(e,t){return e&&(e.start<0&&(e.start=0),e.end<0&&(e.end=0),e.start=Math.min(e.start,t),e.end=Math.min(e.end,t)),e}function x(t,n,r){n===undefined&&(n=3);if(t&&n!==0){if(!r&&t.nodeType===3)return t.nodeValue;if(t.nodeType===1){switch(t.type){case"button":case"text":case"textarea":case"select-one":return t.value;case"checkbox":return t.checked.toString()}var i="",s=0,o;while(o=t.childNodes[s++])i+=e.grid._getDOMText(o,n-1);return i}}return""}function T(e,t,r,i){var s=e.jquery||n.isArray(e),o,u,a,f=t+r;if(arguments.length===3)return s?n.data(e[0],f):n.data(e,f);if(s){for(o=0,u=e.length;o<u;o++)a=n.data(e[o],f,i);return a}return n.data(e,f,i)}function N(e,t){if(t&&e){var n,r,i;for(n in t)t.hasOwnProperty(n)&&(r=t[n],i=typeof r,(i==="string"||i==="boolean"||i==="number")&&e[n]===undefined&&(e[n]=r))}}function C(e){return e&&typeof e=="object"&&!(e instanceof Date)}function k(e,t){var r,i,s=n.isFunction(t);for(r in e)if(e.hasOwnProperty(r)){i=s?t(e[r]):e[r]===t;if(i===!0)return{at:r,found:e[r]}}return{at:null,found:null}}function L(e,t){if(e){var n,r,i=0,s={},o,u;for(n=0,r=e.attributes.length;n<r;n++)u=e.attributes[n].name,u&&(!t||!t(u))&&(o=e.getAttribute(u),u==="style"&&(o=typeof o=="object"?o.cssText:o),!o&&u==="class"&&(o=e.getAttribute("className")),o&&typeof o!="function"&&(s[u]=o,i++));if(i)return s}return null}function A(t,r){var i,s,o,u,a;if(t){typeof r!="object"&&!n.isFunction(r)&&(r={});for(i in t){s=t[i],o=r[o];if(s===r)continue;s&&(n.isPlainObject(s)||(u=n.isArray(s)))?(u?(u=!1,a=o&&n.isArray(o)?o:[]):a=o&&n.isPlainObject(o)?o:{},r[i]=e.grid.deepExtend(s,a)):r[i]=s}}return r}function O(e,t){return e&&e.jquery&&(e=e[0]),e?arguments.length===1?n.data(e,"wijgridwidgetName"):n.data(e,"wijgridwidgetName",t):undefined}function _(e,t){typeof t=="undefined"&&(t=99);var r=0;return e&&n.ui&&n.fn.zIndex&&(r=e.zIndex(),r&&r++),Math.max(r,t)}function D(e,t,n){return e>t&&e<t+n}function P(t,n,r,i,s,o){return e.grid.isOverAxis(t,r,s)&&e.grid.isOverAxis(n,i,o)}function B(){return"uid"+H++}function j(){return!!navigator&&!!navigator.userAgent&&navigator.userAgent.match(/Mobile.*Safari/)!==null}function I(){if(!(F>0)){if(document&&document.body&&n.support.isTouchEnabled&&n.support.isTouchEnabled()){var e;try{e=n("<div></div>").css({overflow:"scroll",width:30,height:30,position:"absolute",visibility:"hidden"}).append(n("<div></div>").css({width:100,height:100})).appendTo(document.body),F=e[0].offsetWidth-e[0].clientWidth}catch(t){}finally{e&&e.remove()}}F>0||(F=18)}return F}var n=jQuery;t.EXPANDO="__wijgrid",function(e){e._map=[],e.header=1,e.data=2,e.dataAlt=4,e.filter=8,e.groupHeader=16,e.groupFooter=32,e.footer=64,e.emptyDataRow=128}(t.rowType||(t.rowType={}));var r=t.rowType;(function(e){e._map=[],e.none=0,e.rendering=1,e.current=2,e.hovered=4,e.selected=8,e.editing=16})(t.renderState||(t.renderState={}));var i=t.renderState;(function(e){e._map=[],e.none=0,e.hidden=1,e.collapsed=2})(t.renderStateEx||(t.renderStateEx={}));var s=t.renderStateEx;(function(e){e._map=[],e.table=0,e.head=1,e.body=2,e.foot=3})(t.rowScope||(t.rowScope={}));var o=t.rowScope;(function(e){e._map=[],e.none=0,e.column=1,e.row=2})(t.cellRangeExtendMode||(t.cellRangeExtendMode={}));var u=t.cellRangeExtendMode;(function(e){e._map=[],e.createIfNull=0,e.createAlways=1,e.dispose=2})(t.objectMode||(t.objectMode={}));var a=t.objectMode;(function(e){e._map=[],e.groupCell=0,e.aggregateCell=1})(t.groupRowCellPurpose||(t.groupRowCellPurpose={}));var f=t.groupRowCellPurpose;(function(e){e._map=[],e.sketch=0,e.rendered=1,e.renderable=2})(t.dataRowsRangeMode||(t.dataRowsRangeMode={}));var l=t.dataRowsRangeMode;(function(e){e._map=[],e.none=0,e.overlapTop=1,e.overlapBottom=2,e.reset=3})(t.intersectionMode||(t.intersectionMode={}));var c=t.intersectionMode;t.compareObj=h,t.stringFormat=p,t.validDataKey=d,t.validDate=v,t.getDataType=m,t.iterateChildrenWidgets=g,t.remove$dataByPrefix=y;var b=function(){function e(e){this._dom=e}return e.prototype.getSelection=function(){var e=0,t=0,n;return this._dom.selectionStart!==undefined?(e=this._dom.selectionStart,t=this._dom.selectionEnd):document.selection&&(n=document.selection.createRange().duplicate(),t=n.text.length,e=Math.abs(n.moveStart("character",-this._dom.value.length)),t+=e),{start:e,end:t,length:t-e}},e.prototype.setSelection=function(e){if(this._dom.selectionStart!==undefined)this._dom.setSelectionRange(e.start,e.end);else{var t=this._dom.createTextRange();t.collapse(!0),t.moveStart("character",e.start),t.moveEnd("character",e.end),t.select()}},e.prototype.toggleSelection=function(e){var t=n(this._dom),r="onselectstart"in this._dom;e?r?t.unbind(".wijgrid-disableSelection"):t.css({MozUserSelect:"",WebkitUserSelect:""}):r?t.bind("selectstart.wijgrid-disableSelection",function(e){e.preventDefault()}):t.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})},e}();t.domSelection=b,t.createDynamicField=w,t.bounds=E,t.ensureBounds=S,t._getDOMText=x,t.dataPrefix=T,t.shallowMerge=N,t.isCustomObject=C,t.search=k,t.getAttributes=L,t.deepExtend=A,t.widgetName=O;var M=function(){function t(){}return t._requiresExtendedSupport={date:"",datetime:"","datetime-local":"",month:"",time:""},t._supportedInputTypesCache={},t.isExtendSupportRequired=function(n){return n=(n||"").toLowerCase(),n in e.grid.HTML5InputSupport._requiresExtendedSupport},t.getDefaultInputType=function(r,i){var s=(i.inputType||"").toLowerCase();if(!s&&r)switch(e.grid.getDataType(i)){case"number":case"currency":s="number";break;case"datetime":s="datetime"}if(!s||s!=="text"&&!t._isSupportedByBrowser(s))s="text";return s},t.toStr=function(n,r){var i=n;r=(r||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(r))switch(r){case"datetime":i=n?i=Globalize.format(n,"yyyy-MM-ddTHH:mm:ssZ"):"";break;case"datetime-local":i=n?i=Globalize.format(n,"yyyy-MM-ddTHH:mm:ss"):"";break;case"date":i=n?i=Globalize.format(n,"yyyy-MM-dd"):"";break;case"month":i=n?i=Globalize.format(n,"yyyy-MM"):"";break;case"time":i=n?i=Globalize.format(n,"HH:mm:ss"):""}else i=n+"";return i},t.parse=function(n,r){var i,s=function(t){return t=new Date(t),e.grid.validDate(t)||(t=null),t};r=(r||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(r))switch(r){case"datetime":i=Globalize.parseDate(n,"yyyy-MM-ddTHH:mm:ssZ")||Globalize.parseDate(n,"yyyy-MM-ddTHH:mmZ")||s(n);break;case"datetime-local":i=Globalize.parseDate(n,"yyyy-MM-ddTHH:mm:ss")||Globalize.parseDate(n,"yyyy-MM-ddTHH:mm")||s(n);break;case"date":i=Globalize.parseDate(n,"yyyy-MM-dd")||s(n);break;case"month":i=Globalize.parseDate(n,"yyyy-MM");break;case"time":i=Globalize.parseDate(n,"HH:mm:ss")||Globalize.parseDate(n,"HH:mm");break;case"number":i=parseFloat(n)}else i=n;return i},t.extend=function(t,n,r){if(!t)t=n;else{r=(r||"").toLowerCase();switch(r){case"date":t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate());break;case"month":t.setFullYear(n.getFullYear(),n.getMonth());break;case"time":t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds());break;default:t=n}}return t},t._isSupportedByBrowser=function(t){if(t){if(this._supportedInputTypesCache[t]===undefined){var r;try{var i=n("<input type='"+t+"' style='display:none' />");r=!0}catch(s){r=!1}this._supportedInputTypesCache[t]=r&&i[0].type===t}return this._supportedInputTypesCache[t]}return!1},t}();t.HTML5InputSupport=M,t.getZIndex=_,t.isOverAxis=D,t.isOver=P;var H=0;t.getUID=B,t.isMobileSafari=j;var F=0;t.getSuperPanelScrollBarSize=I,n.extend(n.wijmo.wijgrid,{rowType:e.grid.rowType,renderState:e.grid.renderState,bounds:e.grid.bounds})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){function i(e,t){var n=!1,r;return function(){return n||(r=t?e.call(t):e(),n=!0),r}}(function(e){e._map=[],e.Millisecond=1,e.Second=2,e.Minute=4,e.Hour=8,e.Day=16,e.Month=32,e.Year=64,e.DATE=e.Year|e.Month|e.Day,e.TIME=e.Hour|e.Minute|e.Second|e.Millisecond,e.ALL=e.DATE|e.TIME})(t.TimeUnit||(t.TimeUnit={}));var n=t.TimeUnit,r=function(){function t(){}return t.convertInputType=function(n){var r=e.grid.TimeUnitConverter.convertInputTypeToFormatString(n),i=e.grid.TimeUnitConverter.convertFormatString(r);return i},t.convertInputTypeToFormatString=function(t){switch((t||"").toLowerCase()){case"datetime":case"datetime-local":return"f";case"date":return"d";case"month":return"Y";case"time":return"t"}return""},t.convertFormatString=function(t){var r=0;if(t){if(t.length===1)switch(t[0]){case"t":return n.Hour|n.Minute;case"T":return n.TIME;case"d":case"D":return n.DATE;case"Y":return n.Month|n.Year;case"M":return n.Month|n.Day;case"f","F","S":return n.ALL}var i,s;(i=t.indexOf("'"))>=0&&(s=t.lastIndexOf("'"))>=0&&i!==s&&(t=t.substr(0,i)+t.substring(s+1,t.length-1));for(var o=0,u=t.length;o<u;o++)switch(t[o]){case"d":r|=n.Day;break;case"M":r|=n.Month;break;case"y":r|=n.Year;break;case"m":r|=n.Minute;break;case"h":case"H":r|=n.Hour;break;case"s":r|=n.Second;break;case"f":r|=n.Millisecond}}return r||n.ALL},t.cutDate=function(t,r){return t&&(r=~r,r&n.Millisecond&&t.setMilliseconds(0),r&n.Second&&t.setSeconds(0),r&n.Minute&&t.setMinutes(0),r&n.Hour&&t.setHours(0),r&n.Day&&t.setDate(1),r&n.Month&&t.setMonth(0),r&n.Year&&t.setFullYear(0)),t},t}();t.TimeUnitConverter=r,t.lazy=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(){}return e.NoFilterOp={applicableTo:null,name:"NoFilter",displayName:"No filter",arity:1,operator:function(){return!0}},e}(),i=function(){function t(t){this._cache={};var i=this;this._wijgrid=t,this._addOperator(null,r.NoFilterOp),n.each(e.data.filtering.ops,function(e,t){i._addOperator(e,t)}),n.each(t.options.customFilterOperators,function(e,t){i._addOperator(null,t,!0)})}return t.prototype.getByName=function(e){var t=this.getByNameInt(e);return t?t.op:null},t.prototype.getByNameInt=function(e){return this._cache[(e||"").toLowerCase()]},t.prototype.getByDataType=function(e){var t=[],r;n.each(this._cache,function(r,i){var s=i.op;(!s.applicableTo||n.inArray(e,s.applicableTo)>=0)&&t.push(i)});switch(this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":t.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":t.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":t.sort(this._sortAlphaEmbeddedFirst);break;case"none":break;default:}return r=n.map(t,function(e,t){return e.op}),r},t.prototype._addOperator=function(e,t,n){typeof n=="undefined"&&(n=!1),e&&!t.name&&(t.name=e),e=(e||t.name).toLowerCase(),this._cache[e]||(this._cache[e]={op:t,isCustom:n===!0})},t.prototype._sortAlpha=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaEmbeddedFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return 1;if(t.isCustom)return-1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaCustomFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return-1;if(t.isCustom)return 1}return n===r?0:n<r?-1:1},t}();t.filterOperatorsCache=i;var s=function(){function t(){}return t.marker="_wijgrid",t.getSingleValue=function(t){return n.isArray(t)&&(t=t[0],n.isArray(t)&&(t=t[0])),t},t.getSingleOperatorName=function(t){return n.isArray(t)&&(t=t[0]),t.name||t||""},t.verify=function(r,i,s,o){if(r)if(n.isArray(r)){var u,a,f=[],l=[];n.isArray(i)||(i=[i]);for(u=0,a=r.length;u<a;u++)e.grid.filterHelper._verifySingleOp(r[u],i[u],s,o)&&(f.push({name:r[u].name||r[u],condition:r[u].condition||"or"}),l.push(i?i[u]:undefined));if(f.length)return{filterOperator:f,filterValue:l}}else if(e.grid.filterHelper._verifySingleOp(r,i,s,o))return{filterOperator:r,filterValue:i};return null},t._verifySingleOp=function(r,i,s,o){if(r&&(r=r.name||r)){var u;r=(r||"").toLowerCase();if((r!=="nofilter"||i!==undefined)&&(u=o.getByName(r)))if(u.applicableTo===null||n.inArray(s||"string",u.applicableTo)>=0)if(u.arity===1||u.arity>1&&e.grid.filterHelper.getSingleValue(i)!==undefined)return!0}return!1},t}();t.filterHelper=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function r(t,n){t&&!t.nodeType&&(t=t[0]);if(t)switch(n){case e.grid.rowScope.head:return t.tHead;case e.grid.rowScope.body:if(t.tBodies)return t.tBodies[0]||null;break;case e.grid.rowScope.foot:return t.tFoot;default:return t}return null}function i(e,t){var n;return e&&!e.nodeType&&(e=e[0]),e&&(n=this.getTableSection(e,t))?n.rows.length:0}function s(e,t,n){var r;return e&&!e.nodeType&&(e=e[0]),e&&(r=this.getTableSection(e,t))?r.rows[n]||null:null}function o(t,r,i){var s,o,u,a,f,l,c,h,p=[],d=function(e){return e=e.toLowerCase(),e==="rowspan"||e==="colspan"},v;t&&!t.nodeType&&(t=t[0]);if(t&&(v=this.getTableSection(t,r)))for(s=0,o=v.rows.length;s<o;s++){f=v.rows[s],l=[],i&&(c=e.data.Expando.getFrom(l,!0),h=c[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:e.grid.getAttributes(f)||{}});for(u=0,a=f.cells.length;u<a;u++){var m=n.trim(f.cells[u].innerHTML);m=="&nbsp;"&&(m=""),l[u]=m,i&&(h.cellsAttributes[u]=e.grid.getAttributes(f.cells[u],d)||{})}p[s]=l}return p}function u(t){var n=t.parentNode.parentNode;switch(n.tagName.toLowerCase()){case"thead":return e.grid.rowScope.head;case"tbody":return e.grid.rowScope.body;case"tfoot":return e.grid.rowScope.foot}return null}var n=jQuery;t.getTableSection=r,t.getTableSectionLength=i,t.getTableSectionRow=s,t.readTableSection=o,t.determineSection=u;var a=function(){function t(e,t,n,r){this._width=0,this._table=e,this._offsets=[],r&&this.ensureColGroup(),n&&this.ensureTBody(),t||this._buildOffsets()}return t.prototype.element=function(){return this._table},t.prototype.width=function(){return this._width},t.prototype.getCellIdx=function(e,t){return e<this._width&&t>=0&&t<this._offsets.length?this._offsets[t][e].cellIdx:-1},t.prototype.getColumnIdx=function(e,t){if(typeof e!="number"){var n=e;e=n.cellIndex,t=n.parentNode.rowIndex}return e<this._width?this._offsets[t][e].colIdx:-1},t.prototype.clearSection=function(t){var n,r,i=e.grid.getTableSection(this._table,t);switch(t){case e.grid.rowScope.body:n=this.getSectionLength(e.grid.rowScope.table),r=n+this.getSectionLength(t)-1;break;case e.grid.rowScope.foot:n=this.getSectionLength(e.grid.rowScope.table)+this.getSectionLength(e.grid.rowScope.head),r=n+this.getSectionLength(t)-1;break;default:n=0,r=this.getSectionLength(t)-1}while(i.rows.length)i.deleteRow(0);this._offsets.splice(n,r-n+1)},t.prototype.getSectionLength=function(t){return e.grid.getTableSectionLength(this._table,t)},t.prototype.getSectionRow=function(t,n){return e.grid.getTableSectionRow(this._table,n,t)},t.prototype.forEachColumnCellNatural=function(e,t,n){var r,i,s,o;for(r=0,i=this._table.rows.length;r<i;r++){s=this._table.rows[r];if(e<s.cells.length){o=t(s.cells[e],r,n);if(o!==!0)return o}}return!0},t.prototype.forEachColumnCell=function(e,t,n){var r,i,s,o,u;for(r=0,i=this._offsets.length;r<i;r++){s=this._table.rows[r],o=this.getCellIdx(e,r);if(o>=0){u=t(s.cells[o],r,n);if(u!==!0)return u}}return!0},t.prototype.forEachRowCell=function(e,t,n){var r=this._table.rows[e],i,s,o;for(i=0,s=r.cells.length;i<s;i++){o=t(r.cells[i],i,n);if(o!==!0)return o}return!0},t.prototype.colGroupTag=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||null},t.prototype.colTags=function(){var e=this.colGroupTag();return e&&e.getElementsByTagName("col")||[]},t.prototype.ensureTBody=function(){return this._table.tBodies&&this._table.tBodies[0]||this._table.appendChild(document.createElement("tbody"))},t.prototype.ensureTHead=function(){return this._table.tHead&&this._table.tHead[0]||this._table.createTHead()},t.prototype.ensureTFoot=function(){return this._table.tFoot&&this._table.tFoot[0]||this._table.createTFoot()},t.prototype.ensureColGroup=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||this._table.appendChild(document.createElement("colgroup"))},t.prototype.appendCol=function(e){var t=this.ensureColGroup();return e&&t.appendChild(e)||t.appendChild(document.createElement("col"))},t.prototype.removeOffset=function(e){if(e>=0&&e<this._offsets.length){if(e<0||!e&&e!==0)e=this._offsets.length-1;this._offsets.splice(e,1)}},t.prototype.insertOffset=function(e){var t,n;if(this._width>0){t=[];for(n=0;n<this._width;n++)t.push({cellIdx:n,colIdx:n});if(e<0||!e&&e!==0)e=this._offsets.length;this._offsets.splice(e,0,t)}},t.prototype.rebuildOffsets=function(){this._offsets=[],this._width=0,this._buildOffsets()},t.prototype._buildOffsets=function(){var e=[],t,n,r,i,s,o,u,a,f,l;for(n=0,r=this._table.rows.length;n<r;n++){t=[],this._offsets[n]=t,i=this._table.rows[n];for(s=0,o=0,u=i.cells.length;s<u;s++,o++){a=i.cells[s];for(;e[o]>1;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};e[o]>1||(e[o]=a.rowSpan),t[o]={cellIdx:s,colIdx:-1},t[s].colIdx=o,f=a.colSpan;for(;f>1;f--)t[++o]={cellIdx:-1,colIdx:-1}}l=e.length;for(;o<l;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};this._width=Math.max(this._width,l)}},t}();t.htmlTableAccessor=a})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e,t,n,r,i){typeof n=="undefined"&&(n=null),typeof r=="undefined"&&(r=!1),typeof i=="undefined"&&(i=!0),this.__isEdit=!1,this._wijgrid=n,this._virtualize=i,r?(this._ci=e-this._wijgrid._getDataToAbsOffset().x,this._ri=t-this._wijgrid._getDataToAbsOffset().y,this._virtualize&&(this._ri=this._wijgrid._renderableBoundsCollection().getAbsIndex(this._ri+this._wijgrid._viewPortBounds().start))):(this._ci=e,this._ri=t)}return t.outsideValue=new t(-1,-1,null),t.prototype.cellIndexAbs=function(){return this._ci+this._wijgrid._getDataToAbsOffset().x},t.prototype.rowIndexAbs=function(){var e=this._virtualize?this._wijgrid._renderableBoundsCollection().getRenderedIndex(this._ri)-this._wijgrid._viewPortBounds().start:this._ri;return e+=this._wijgrid._getDataToAbsOffset().y,e},t.prototype.cellIndex=function(e){if(!arguments.length)return this._ci;this._ci=e},t.prototype.column=function(){return this._wijgrid&&this._isValid()?this._wijgrid._field("visibleLeaves")[this.cellIndexAbs()]:null},t.prototype.container=function(){var t=this.tableCell(),r;if(t){r=n(t).children("div."+e.grid.wijgrid.CSS.cellContainer);if(r)return r}return null},t.prototype.isEqual=function(e){return e&&e.rowIndex()===this.rowIndex()&&e.cellIndex()===this.cellIndex()},t.prototype.row=function(){var e=null,t=null;return this._wijgrid&&(this._virtualize?t=this._wijgrid._view()._getRowInfoBySketchRowIndex(this.rowIndex()):(e=this._wijgrid._view().rows().item(this.rowIndexAbs()),e&&e.length&&(t=this._wijgrid._view()._getRowInfo(e)))),t},t.prototype.rowIndex=function(e){if(!arguments.length)return this._ri;this._ri=e},t.prototype.tableCell=function(){if(this._wijgrid&&this._isValid())if(!this._virtualize||this._isRendered())return this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs());return null},t.prototype.value=function(t){var n,r,i;if(this._wijgrid&&this._isValid()){r=this.row();if(r.type&e.grid.rowType.data){n=this.column();if(arguments.length===0)return i=this._wijgrid._dataViewWrapper.getValue(r.data,n.dataKey),this._wijgrid.parse(n,i);t=this._wijgrid.parse(n,t);if(t===null&&n.valueRequired||e.grid.getDataType(n)!=="string"&&isNaN(t))throw"invalid value";this._wijgrid._dataViewWrapper.setValue(r.dataItemIndex,n.dataKey,t);var s=this._wijgrid.sketchTable.row(this.rowIndex()),o=s.cell(n.dataIndex);o.value=t}}},t.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=!1,r;return t?(this.cellIndexAbs()<(r=e.topLeft().cellIndexAbs())&&(n=!0,this._ci=e.topLeft().cellIndex()),this.cellIndexAbs()>(r=e.bottomRight().cellIndexAbs())&&(n=!0,this._ci=e.bottomRight().cellIndex()),this.rowIndexAbs()<(r=e.topLeft().rowIndexAbs())&&(n=!0,this._ri=e.topLeft().rowIndex()),this.rowIndexAbs()>(r=e.bottomRight().rowIndexAbs())&&(n=!0,this._ri=e.bottomRight().rowIndex())):(this.cellIndex()<(r=e.topLeft().cellIndex())&&(n=!0,this._ci=r),this.cellIndex()>(r=e.bottomRight().cellIndex())&&(n=!0,this._ci=r),this.rowIndex()<(r=e.topLeft().rowIndex())&&(n=!0,this._ri=r),this.rowIndex()>(r=e.bottomRight().rowIndex())&&(n=!0,this._ri=r)),n},t.prototype._clone=function(){return new e.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid,!1,this._virtualize)},t.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0},t.prototype._isRendered=function(){var e;if(this._wijgrid&&(e=this._wijgrid._view())&&this._isValid()){var t=e._isRowRendered(this.rowIndex());return t>=0}return!1},t.prototype._isEdit=function(t){var r=null,i=e.grid.wijgrid.CSS.editedCellMarker;if(this._isValid())try{r=this.tableCell()}catch(s){}if(!arguments.length)return r?n(r).hasClass(i):this.__isEdit;r&&n(r)[t?"addClass":"removeClass"](i),this.__isEdit=t},t.prototype._setGridView=function(e){this._wijgrid=e},t}();t.cellInfo=r;var i=function(){function t(e,t){if(!e||!t)throw"invalid arguments";this._topLeft=e._clone(),this._bottomRight=t._clone()}return t.prototype.bottomRight=function(){return this._bottomRight},t.prototype.isEqual=function(e){return e&&this._topLeft.isEqual(e.topLeft())&&this._bottomRight.isEqual(e.bottomRight())},t.prototype.topLeft=function(){return this._topLeft},t.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()},t.prototype._isIntersect=function(e){var t,n,r,i;if(e){t=e.bottomRight().rowIndex()-e.topLeft().rowIndex()+1,n=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1;if(e.topLeft().rowIndex()+t-this._topLeft.rowIndex()<t+n)return r=e.bottomRight().cellIndex()-e.topLeft().cellIndex()+1,i=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1,e.topLeft().cellIndex()+r-this._topLeft.cellIndex()<r+i}return!1},t.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=this._topLeft._clip(e,t),r=this._bottomRight._clip(e,t);return n||r},t.prototype._clone=function(){return new t(this._topLeft._clone(),this._bottomRight._clone())},t.prototype._containsCellInfo=function(e){return e&&e.cellIndex()>=this._topLeft.cellIndex()&&e.cellIndex()<=this._bottomRight.cellIndex()&&e.rowIndex()>=this._topLeft.rowIndex()&&e.rowIndex()<=this._bottomRight.rowIndex()},t.prototype._containsCellRange=function(e){return e&&this._containsCellInfo(e.topLeft())&&this._containsCellInfo(e.bottomRight())},t.prototype._extend=function(t,n){return t===e.grid.cellRangeExtendMode.column?(this._topLeft.rowIndex(n.topLeft().rowIndex()),this._bottomRight.rowIndex(n.bottomRight().rowIndex())):t===e.grid.cellRangeExtendMode.row&&(this._topLeft.cellIndex(n.topLeft().cellIndex()),this._bottomRight.cellIndex(n.bottomRight().cellIndex())),this},t.prototype._normalize=function(){var e=this._topLeft.cellIndex(),t=this._topLeft.rowIndex(),n=this._bottomRight.cellIndex(),r=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(e,n)),this._topLeft.rowIndex(Math.min(t,r)),this._bottomRight.cellIndex(Math.max(e,n)),this._bottomRight.rowIndex(Math.max(t,r))},t.prototype._height=function(){return this._bottomRight.rowIndex()-this._topLeft.rowIndex()},t.prototype._width=function(){return this._bottomRight.cellIndex()-this._topLeft.cellIndex()},t}();t.cellInfoRange=i,n.extend(n.wijmo.wijgrid,{cellInfo:e.grid.cellInfo,cellInfoRange:e.grid.cellInfoRange})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(t,n){this._rowHeaderSize=22,this.mIsRendered=!1,this._sizesAdjCache={th:0,col:0,subTable:0};if(!t)throw"'wijgrid' must be specified";this._wijgrid=t,this._bounds=n,this._wijgrid.element.addClass(e.grid.wijgrid.CSS.table).addClass(this._wijgrid.options.wijCSS.wijgridTable)}return r.prototype.dispose=function(){this.toggleDOMSelection(!0),this._wijgrid.element.removeClass(e.grid.wijgrid.CSS.table).removeClass(this._wijgrid.options.wijCSS.wijgridTable)},r.prototype.ensureDisabledState=function(){var e="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,t=this._wijgrid.options.disabled,r=this;n.each(this.subTables(),function(i,s){if(s){var o=n(s.element());t?(o.addClass(e),r._wijgrid._setAttr(o,"aria-disabled",!0)):(o.removeClass(e),r._wijgrid._setAttr(o,"aria-disabled",!1))}})},r.prototype.ensureWidth=function(e,t,n){this._setColumnWidth(e,t)},r.prototype.ensureHeight=function(e){},r.prototype.getScrollValue=function(){return null},r.prototype.getVisibleAreaBounds=function(e){throw"not implemented"},r.prototype.getVisibleContentAreaBounds=function(){throw"not implemented"},r.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"},r.prototype.isRendered=function(){return this.mIsRendered},r.prototype.render=function(){this._ensureRenderBounds(),this._preRender(),this._renderContent(),this._postRender()},r.prototype.toggleDOMSelection=function(t){n.each(this.subTables(),function(n,r){(new e.grid.domSelection(r.element())).toggleSelection(t)}),(new e.grid.domSelection(this._wijgrid.outerDiv)).toggleSelection(t)},r.prototype.updateSplits=function(e){throw"not implemented"},r.prototype.getInlineTotalWidth=function(){throw"not implemented"},r.prototype.bodyRows=function(){if(!this._bodyRowsAccessor){if(!this.isRendered())throw"not rendered yet";this._bodyRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.body,0,0)}return this._bodyRowsAccessor},r.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){if(!this.isRendered())throw"not rendered yet";var t=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,0);return t.item(t.length()-1)}return null},r.prototype.footerRow=function(){if(this._wijgrid.options.showFooter){if(!this.isRendered())throw"not rendered yet";var t=new e.grid.rowAccessor(this,e.grid.rowScope.foot,0,0);return t.item(0)}},r.prototype.headerRows=function(){var t;if(!this._headerRowsAccessor){if(!this.isRendered())throw"not rendered yet";t=this._wijgrid.options.showFilter?1:0,this._headerRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,t)}return this._headerRowsAccessor},r.prototype.rows=function(){if(!this._rowsAccessor){if(!this.isRendered())throw"not rendered yet";this._rowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.table,0,0)}return this._rowsAccessor},r.prototype.focusableElement=function(){return this._wijgrid.outerDiv},r.prototype.forEachColumnCell=function(e,t,n){throw"not implemented"},r.prototype.forEachRowCell=function(e,t,n){throw"not implemented"},r.prototype.getAbsoluteCellInfo=function(e,t){throw"not implemented"},r.prototype.getAbsoluteRowIndex=function(e){throw"not implemented"},r.prototype.getCell=function(e,t){throw"not implemented"},r.prototype.getColumnIndex=function(e){throw"not implemented"},r.prototype.getHeaderCell=function(e){throw"not implemented"},r.prototype.getJoinedCols=function(e){throw"not implemented"},r.prototype.getJoinedRows=function(e,t){throw"not implemented"},r.prototype.getJoinedTables=function(e,t){throw"not implemented"},r.prototype.subTables=function(){throw"not implemented"},r.prototype._getMappedScrollMode=function(){var e=this._wijgrid.options.scrollMode,t="auto",n="auto";switch(e){case"horizontal":t="hidden",n="visible";break;case"vertical":t="visible",n="hidden";break;case"both":t="visible",n="visible"}return{vScrollBarVisibility:t,hScrollBarVisibility:n}},r.prototype._postRender=function(){this.mIsRendered=!0,this.ensureDisabledState(),this._sizesAdjCache.col=0,this._sizesAdjCache.th=0,this._sizesAdjCache.subTable=0;var e=this._wijgrid._field("visibleLeaves");if(e.length>0){var t=this.getHeaderCell(0),r=this.getJoinedCols(0);t&&(this._sizesAdjCache.th=n(t).leftBorderWidth()+n(t).rightBorderWidth()),r&&r.length&&(this._sizesAdjCache.col=n(r[0]).leftBorderWidth()+n(r[0]).rightBorderWidth())}var i=this.subTables()[0];this._sizesAdjCache.subTable=n(i.element()).leftBorderWidth()+n(i.element()).rightBorderWidth()},r.prototype._preRender=function(){this.mIsRendered=!1},r.prototype._ensureRenderBounds=function(){var e=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);this._bounds.start=0,this._bounds.end=e.bottomRight().rowIndex()},r.prototype._renderContent=function(){this._renderCOLS(),this._renderHeader(),this._wijgrid.options.showFilter&&this._renderFilter(),this._renderBody(),this._wijgrid.options.showFooter&&this._renderFooter()},r.prototype._renderCOLS=function(){var e=this._wijgrid._field("visibleLeaves"),t,n,r,i;for(r=0,i=e.length;r<i;r++)t=e[r],n=this._createCol(t,r),this._appendCol(n,t,r)},r.prototype._renderHeader=function(){var t=e.grid.rowType,n=e.grid.renderState,r=this._wijgrid._columnsHeadersTable(),i,s,o;if(r&&(s=r.length))for(i=0;i<s;i++)o=this._insertEmptyRow(t.header,n.rendering,i,-1,-1,-1,undefined,{}),this._renderRow(o,null,r[i])},r.prototype._renderFilter=function(){var t=this._insertEmptyRow(e.grid.rowType.filter,e.grid.renderState.rendering,-1,-1,-1,-1,undefined,{});this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},r.prototype._renderBody=function(){var t=e.grid.renderState,n=this._wijgrid._field("visibleLeaves"),r=this._wijgrid.sketchTable,i=-1,s=0,o=0,u=this._wijgrid._dataOffset,a=this;this._bounds.start>=0&&this._bounds.end>=0&&this._wijgrid._renderableBoundsCollection().forEachIndex(this._bounds.start,this._bounds.end-this._bounds.start+1,function(e){var f=r.row(e-u),l=f.isDataRow(),c=f.groupByValue,h=a._insertEmptyRow(f.rowType,t.rendering,o++,l?++i:-1,f.dataItemIndex(),f.dataItemIndex(s),c,f.extInfo);a._renderRow(h,n,f)})},r.prototype._renderFooter=function(){var t=this._insertEmptyRow(e.grid.rowType.footer,e.grid.renderState.rendering,-1,-1,-1,-1,undefined,{});this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},r.prototype._insertEmptyRow=function(t,n,r,i,s,o,u,a){var f=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),l=this._insertRow(t,r,f);return n===undefined&&(n=e.grid.renderState.rendering),this._createRowInfo(l,t,n,r,i,s,o,u,a)},r.prototype._createEmptyCell=function(t,n,r){var i=e.grid.rowType,s=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(t.type,s)},r.prototype._insertRow=function(e,t,n){throw"not implemented"},r.prototype._createCell=function(t,r){var i=e.grid.rowType,s;r||(t===i.header?r=document.createElement("th"):r=document.createElement("td"));if(t!==i.filter){s=document.createElement("div"),s.className=e.grid.wijgrid.CSS.cellContainer+" "+this._wijgrid.options.wijCSS.wijgridCellContainer;if(r.firstChild)while(r.firstChild)s.appendChild(r.firstChild);r.appendChild(s)}return n(r)},r.prototype._appendCell=function(e,t,n){throw"not implemented"},r.prototype._createCol=function(e,t){throw"not implemented"},r.prototype._appendCol=function(e,t,n){throw"not implemented"},r.prototype._renderRow=function(t,n,r){var i=e.grid.rowType,s,o;switch(t.type){case i.filter:this._renderFilterRow(t,n);break;case i.footer:this._renderFooterRow(t,n);break;case i.header:this._renderHeaderRow(t,r);break;case i.data:case i.data|i.dataAlt:this._renderDataRow(t,n,r),s=r.attr(),o=r.style();break;case i.emptyDataRow:case i.groupHeader:case i.groupFooter:this._renderSpannedRow(t,n,r),s=r.attr(),o=r.style();break;default:throw"unknown rowType"}this._rowRendered(t,s,o)},r.prototype._renderCell=function(t,r,i,s,o,u,a,f){var l=this._createEmptyCell(t,o.dataIndex,o),c=t.type===e.grid.rowType.filter?l:n(l[0].firstChild);this._appendCell(t,r,l),s?c.html(i):this._wijgrid.cellFormatter.format(l,c,o,i,t),this._cellRendered(t,l,r,o,u,a,f)},r.prototype._renderDataRow=function(t,n,r){var i,s,o,u,a,f,l,c;for(i=0,s=n.length;i<s;i++){o=n[i],u=o.dataIndex;if(u<0)f=null,l=null,a=null;else{var h=r.cell(u);if(!h||!h.visible())continue;a=this._wijgrid.toStr(o,h.value),f=h.attr(),l=h.style()}c=t.state,o.readOnly&&(c&=~e.grid.renderState.editing),this._renderCell(t,i,a,!1,o,c,f,l)}},r.prototype._renderFilterRow=function(t,n){var r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r],this._renderCell(t,r,e.grid.filterHelper.getSingleValue(s.filterValue),!1,s,t.state)},r.prototype._renderFooterRow=function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)this._renderCell(e,n,"",!1,t[n],e.state)},r.prototype._renderHeaderRow=function(e,t){var n,r,i=0,s;for(n=0,r=t.length;n<r;n++)s=t[n],s.column&&s.column.parentVis&&(s.column.thX=i++,s.column.thY=e.sectionRowIndex,this._renderCell(e,n,s.column.headerText,!1,s.column,e.state,{colSpan:s.colSpan,rowSpan:s.rowSpan}))},r.prototype._renderSpannedRow=function(t,n,r){var i,s,o=Math.min(n.length,r.cellCount());for(i=0;i<o;i++){var u=t.type===e.grid.rowType.emptyDataRow,a=r.cell(i);this._renderCell(t,i,a.html,u,n[i],t.state,a.attr(),a.style())}},r.prototype._cellRendered=function(e,t,n,r,i,s,o){this._wijgrid.cellStyleFormatter.format(t,n,r,e,i,s,o),this._changeCellRenderState(t,i,!1),this._wijgrid._onViewCellRendered(e,t,n,r)},r.prototype._rowRendered=function(t,n,r){this._wijgrid.rowStyleFormatter.format(t,n,r),t.state&=~e.grid.renderState.rendering,this._setRowInfo(t.$rows,t),this._wijgrid._onViewRowRendered(t,n,r)},r.prototype._makeRowEditable=function(t){var n=this._wijgrid._field("visibleLeaves"),r=new e.grid.cellEditorHelper;if(n)for(var i=0;i<n.length;i++){var s=n[i];if(!s.readOnly&&e.grid.validDataKey(s.dataKey)){var o=t.$rows.children("td, th").eq(i);if(o.length){var u=this.getAbsoluteCellInfo(o[0],!0);this._changeCellRenderState(o,e.grid.renderState.editing,r.cellEditStart(this._wijgrid,u,null))}}}},r.prototype._isBodyRow=function(t){var n=e.grid.rowType,r=t.type;return r&n.data||r===n.groupHeader||r===n.groupFooter||r===n.emptyDataRow},r.prototype._changeRowRenderState=function(e,t,n){n?e.state|=t:e.state&=~t,this._setRowInfo(e.$rows,e)},r.prototype._changeCellRenderState=function(t,n,r){var i=e.grid.dataPrefix,s=this._wijgrid._data$prefix,o=i(t,s,"renderState");return r?(n=o|n,i(t,s,"renderState",n)):(n=o&~n,i(t,s,"renderState",n)),n},r.prototype._adjustWidthArray=function(e,t,r,i){var s=this._sumWidthArray(e),o=this._sumWidthArray(t),u=[],a,f=0,l,c,h=!0;if(s<=r){n.extend(!0,u,e);if(s===r||i)return u;a=r-s}else{n.extend(!0,u,t);if(o>=r)return u;a=r-o}return n.each(u,function(e,t){t.real||f++}),f!==0&&(l=Math.floor(a/f),c=a-l*f,n.each(u,function(e,t){t.real||(t.width+=l,h&&(t.width+=c,h=!1))})),u},r.prototype._getColumnWidth=function(e){var t,r=this._wijgrid._field("visibleLeaves")[e];if(r._realWidth!==undefined)t={width:r._realWidth,real:!0};else if(r.isRowHeader)t={width:this._rowHeaderSize,real:!0};else{var i=0,s=this.getJoinedTables(!0,e),o=s[2];for(var u=0;u<2;u++){var a=s[u];if(a!==null){var f=a.element().rows,l,c=f.length;if(c>0){for(var h=c-1,l=null;h>=0;h--)if(f[h].cells.length===a.width()){l=f[h];if(l.style.display!=="none")break}if(l){var p=l.cells[o];i=Math.max(i,n(p).outerWidth())}}}}t={width:i,real:!1}}return t},r.prototype._setColumnWidth=function(e,t){var r=this.getHeaderCell(e),i=this.getJoinedCols(e),s;if(t){var o=this;r&&(s=t-this._sizesAdjCache.th,s<0&&(s=0),r.style.width=s+"px"),n.each(i,function(e,n){n&&(s=t-o._sizesAdjCache.col,s<0&&(s=0),n.style.width=s+"px")})}},r.prototype._setTableWidth=function(e,t,r,i){var s,o,u=this;n.each(e,function(e,n){n[0].style.tableLayout="fixed",n[0].style.width=t-u._sizesAdjCache.subTable+"px"}),s=e[0].outerWidth(),o=s-t,o!==0&&this._setColumnWidth(i,r-o)},r.prototype._sumWidthArray=function(e,t,r){var i=0;return n.each(e,function(e,n){if(t!==undefined&&r!==undefined&&(e<t||e>r))return!0;i+=n.width}),i},r.prototype._clearBody=function(){n.each(this.subTables(),function(e,t){t.clearSection(2)})},r.prototype._rebuildOffsets=function(){n.each(this.subTables(),function(e,t){t.rebuildOffsets()})},r.prototype._removeBodyRow=function(t,n){typeof n=="undefined"&&(n=!0);var r=e.grid.rowType,i=this._wijgrid._rows(),s,o,u,a;if(t>=0&&t<(o=i.length())){u=this._getRowInfo(i.item(t),!1),a=this.getAbsoluteRowIndex(u.$rows[0]),u.$rows.remove();if(n){var f=this.getJoinedTables(!1,a),l;(l=f[0])&&l.removeOffset(f[2]),(l=f[1])&&l.removeOffset(f[2])}}},r.prototype._insertBodyRow=function(t,n,r,i){var s=this._wijgrid._field("visibleLeaves"),o=e.grid.rowType,u=this._wijgrid._view(),a=this._wijgrid._rows(),f=a.length(),l=t.isDataRow(),c,h;if(n<0||n>=f||!n&&n!==0)n=f;c=this._insertEmptyRow(t.rowType,t.renderState,n,-1,r,i,t.groupByValue,t.extInfo),this._renderRow(c,s,t),h=this.getAbsoluteRowIndex(c.$rows[0]);var p=this.getJoinedTables(!1,h),d;return(d=p[0])&&d.insertOffset(h),(d=p[1])&&d.insertOffset(h),c},r.prototype._findRowInfo=function(e){var t=this.bodyRows(),r=0,i=t.length(),s;if(n.isFunction(e))for(r=0;r<i;r++){s=this._getRowInfo(t.item(r));if(e(s)===!0)return s}return null},r.prototype._setRowInfo=function(t,n){var r="$rows"in n,i="data"in n,s,o;r&&(s=n.$rows,delete n.$rows),i&&(o=n.data,delete n.data),e.grid.dataPrefix(t,this._wijgrid._data$prefix,"rowInfo",n),r&&(n.$rows=s),i&&(n.data=o)},r.prototype._getRowInfo=function(t,r){typeof r=="undefined"&&(r=!0);var i=this._wijgrid,s=t[1]?n(t):n(t[0]),o=e.grid.dataPrefix(s,i._data$prefix,"rowInfo"),u;o.$rows=s;if(r&&o.dataItemIndex>=0&&o.type&e.grid.rowType.data)try{o.data=i._getDataItem(o.dataItemIndex)}catch(a){o.data=null}return o},r.prototype._getRowInfoBySketchRowIndex=function(e,t){typeof t=="undefined"&&(t=!0);if(e>=0){var n=this._isRowRendered(e);if(!(n>=0)){var i=this._wijgrid.sketchTable.row(e),s=null;if(i){s=i.getRowInfo();if(t&&s.dataItemIndex>=0&&i.isDataRow())try{s.data=this._wijgrid._getDataItem(s.dataItemIndex)}catch(o){s.data=null}}return s}var r=this.bodyRows().item(n);if(r)return this._getRowInfo(r,t)}return null},r.prototype._createRowInfo=function(t,r,i,s,o,u,a,f,l){var c,h={type:r,state:i,sectionRowIndex:s,dataRowIndex:o,dataItemIndex:u,virtualDataItemIndex:a,$rows:t?n(t):null,_extInfo:l};return f!==undefined&&(h.groupByValue=f),u>=0&&r&e.grid.rowType.data&&(h.data=this._wijgrid._getDataItem(u)),h},r.prototype._isRowRendered=function(e){var t=this._wijgrid._renderableBoundsCollection().getRenderedIndex(e);return t>=0&&t>=this._bounds.start&&t<=this._bounds.end?t-this._bounds.start:-1},r}();t.baseView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,n){t.call(this,e,n),this._dataTable=null,this._contentArea=null}return __extends(r,t),r.prototype.ensureWidth=function(e,r,i){var s=n(this._dataTable.element()),o=s.width()+r-i;t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth([s],o,r,e)},r.prototype.getVisibleAreaBounds=function(t){var n=e.grid.bounds(this._dataTable.element(),t);return n},r.prototype.getVisibleContentAreaBounds=function(){return this.getVisibleAreaBounds()},r.prototype.updateSplits=function(e){var t=this,r=this._wijgrid,i=r.options,s=r.element,o=[],u=[],a=[],f=r._field("visibleLeaves"),l=r.outerDiv,c,h;s.css({"table-layout":"",width:"auto"}),n.each(f,function(e,n){var r,s=n.width;if(s||s===0){r=typeof s=="string"&&s.length>1&&s[s.length-1]==="%",r?s=l.width()*parseFloat(s)/100:s=parseFloat(s);if(n.ensurePxWidth||n.ensurePxWidth===undefined&&i.ensureColumnsPxWidth)n._realWidth=s;t._setColumnWidth(e,s)}}),n.each(f,function(e,n){o.push(t._getColumnWidth(e))}),s.css("width","1px"),n.each(f,function(e,n){u.push(t._getColumnWidth(e))}),c=l.width(),a=this._adjustWidthArray(o,u,c,i.ensureColumnsPxWidth),n.each(a,function(e,n){var r=f[e];if(r._realWidth!==undefined){delete r._realWidth;return}t._setColumnWidth(e,n.width)}),s.css("table-layout","fixed"),h=a.length-1;if(h!==-1){var p=l.width()-c;a[h].width+=p,this._setTableWidth([s],this._sumWidthArray(a,0,h),a[h].width,h)}},r.prototype.getInlineTotalWidth=function(){var e=this._dataTable.element(),t=e.style.width;return t&&t!=="auto"?t:""},r.prototype.forEachColumnCell=function(e,t,n){return this._dataTable.forEachColumnCell(e,t,n)},r.prototype.forEachRowCell=function(e,t,n){return this._dataTable.forEachRowCell(e,t,n)},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),t.parentNode.rowIndex,this._wijgrid,!0,n)},r.prototype.getAbsoluteRowIndex=function(e){return e.rowIndex},r.prototype.getCell=function(e,t){var n=this._dataTable.getCellIdx(e,t),r;if(n>=0){r=this.getJoinedRows(t,0);if(r[0])return r[0].cells[n]}return null},r.prototype.getColumnIndex=function(e){return this._dataTable.getColumnIdx(e)},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=n(this._dataTable.element()).find("> colgroup");return t.length&&e<t[0].childNodes.length?[t[0].childNodes[e],null]:[null,null]},r.prototype.getJoinedRows=function(e,t){return[this._dataTable.getSectionRow(e,t),null]},r.prototype.getJoinedTables=function(e,t){return[this._dataTable,null,t]},r.prototype.subTables=function(){return[this._dataTable]},r.prototype._preRender=function(){t.prototype._preRender.call(this),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0],!0,!0,!0)},r.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0]),this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}),this._wijgrid.element.css("border-collapse","separate"),t.prototype._postRender.call(this)},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s;switch(t){case i.header:case i.filter:s=this._dataTable.ensureTHead();break;case i.footer:s=this._dataTable.ensureTFoot();break;default:s=this._dataTable.ensureTBody()}return r?[s.appendChild(r)]:(n>s.rows.length&&(n=-1),[s.insertRow(n)])},r.prototype._rowRendered=function(e,n,r){var i=e.$rows[0];!i.cells.length&&this._isBodyRow(e)?i.parentNode.removeChild(i):t.prototype._rowRendered.call(this,e,n,r)},r.prototype._appendCell=function(e,t,n){e.$rows[0].appendChild(n[0])},r.prototype._createCol=function(e,t){return[document.createElement("col")]},r.prototype._appendCol=function(e,t,n){this._dataTable.appendCol(e[0])},r}(t.baseView);t.flatView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(r,i){t.call(this,r,i),this._verScrollBarSize=e.grid.getSuperPanelScrollBarSize(),this._viewTables={},this._splitAreas={},this._superPanelElementsCache={},this.element=r.element,this._staticDataRowIndex=r._getStaticIndex(!0),this._staticRowIndex=r._getRealStaticRowIndex(),this._staticColumnIndex=r._getRealStaticColumnIndex(),this._staticAllColumnIndex=this._staticColumnIndex===-1?-1:r._field("visibleLeaves")[this._staticColumnIndex].leavesIdx,this._mouseWheelHandler=n.proxy(this._onMouseWheel,this)}return __extends(r,t),r.DEFAULT_ROW_HEIGHT_VIRTUAL=19,r.prototype.dispose=function(){t.prototype.dispose.call(this),this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},r.prototype.ensureWidth=function(e,r,i){var s=this._wijgrid,o=s.options,u=this._staticColumnIndex,a=e<=u,f=n(this._viewTables.nw.element()),l=n(this._viewTables.ne.element()),c=n(this._viewTables.sw.element()),h=n(this._viewTables.se.element()),p=a?[f,c]:[l,h],d=(a?f.width():l.width())+r-i,v=this.getScrollValue();this._destroySuperPanel(),t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth(p,d,r,e);try{u>=0?o.splitDistanceX=f[0].offsetWidth:o.splitDistanceX=0}catch(m){}this._updateSplitAreaBounds(0),this._adjustRowsHeights();try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(f[0].offsetHeight,l[0].offsetHeight):o.splitDistanceY=0}catch(m){}this._updateSplitAreaBounds(1),this.refreshPanel(v);var g=s._UIFrozener();g&&g.refresh()},r.prototype.ensureHeight=function(e){var t,r=this._wijgrid,i=r.options,s=n(this._viewTables.nw.element()),o=n(this._viewTables.ne.element()),u=n(this._viewTables.sw.element()),a=n(this._viewTables.se.element()),f=this.getScrollValue(),l;this._destroySuperPanel(),arguments.length>0&&(t=this.getJoinedRows(e,2),this._setRowHeight(t,this._getRowHeight(t))),a.css("height",""),u.css("height",""),l=Math.max(a.height(),u.height()),a.height(l),u.height(l);try{this._staticRowIndex>=0?i.splitDistanceY=Math.max(s[0].offsetHeight,o[0].offsetHeight):i.splitDistanceY=0}catch(c){}this._updateSplitAreaBounds(1),this.refreshPanel(f);var h=r._UIFrozener();h&&h.refresh()},r.prototype.getScrollValue=function(){var e=this._getSuperPanel();return e?{x:e.options.hScroller.scrollValue,y:e.options.vScroller.scrollValue}:null},r.prototype.getVisibleAreaBounds=function(t){var n=this._isNativeSuperPanel()?e.grid.bounds(this._getSuperPanelStateContainer(),t):e.grid.bounds(this._getSuperPanelContentWrapper(),t);return n||(n=e.grid.bounds(this._wijgrid.outerDiv,t)),n},r.prototype.getVisibleContentAreaBounds=function(){var t=this.getVisibleAreaBounds(!0),n=e.grid.bounds(this._viewTables.nw.element())||{},r=e.grid.bounds(this._viewTables.ne.element())||{},i=e.grid.bounds(this._viewTables.sw.element())||{},s=e.grid.bounds(this._viewTables.se.element())||{},o={top:t.top,left:t.left,width:Math.max(n.width+r.width,i.width+s.width),height:Math.max(n.height+i.height,r.height+s.height)};return o.width=Math.min(t.width,o.width),o.height=Math.min(t.height,o.height),o},r.prototype.getRowAreaHeight=function(){var e=this._getSuperPanelContentWrapper();e.length==0&&(e=this._wijgrid.outerDiv);var t=e.height(),r=this._wijgrid.options.splitDistanceY;r&&(t-=r);if(this._wijgrid.options.showFooter){var i,s=this.isRendered()&&(i=this.footerRow())?n(i).height():this.getDefaultRowHeight();t-=s}return t},r.prototype.getVirtualPageSize=function(e){typeof e=="undefined"&&(e=!0);var t=this._wijgrid.rowOuterHeight&&this._wijgrid.rowOuterHeight>0?this._wijgrid.rowOuterHeight:this.getDefaultRowHeight(),n=this.getRowAreaHeight()/t;return e?Math.ceil(n):Math.floor(n)},r.prototype.getFixedAreaVisibleBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._splitAreas.ne),r=e.grid.bounds(this._splitAreas.nw),i=null,s=null;if(n.height||r.height)i={left:t.left,top:t.top,width:t.width,height:Math.min(n.height||r.height,t.height)};return r.width&&(s={left:r.left,top:t.top,width:Math.min(r.width,t.width),height:t.height}),[i,s]},r.prototype.getDefaultRowHeight=function(){return this._wijgrid.options.rowHeight>=0?this._wijgrid.options.rowHeight:r.DEFAULT_ROW_HEIGHT_VIRTUAL},r.prototype.refreshPanel=function(t){var r=this,i=this._wijgrid,s=i.options,o=this._getMappedScrollMode(),u=t?t.x:null,a=t?t.y:null,f=i._rows().item(0),l=!1;i.rowOuterHeight=f&&f[0]?n(f[0]).outerHeight():this.getDefaultRowHeight();if(!this._scroller.data("wijmo-wijsuperpanel")){l=!0,this._wijgrid._allowVirtualScrolling()&&(this.vsUI=new e.grid.uiVirtualScroller(i,this._splitAreas.se,s.splitDistanceY,i.rowOuterHeight)),this._scroller.wijsuperpanel({disabled:i.options.disabled,scroll:n.proxy(this._onScroll,this),bubbleScrollingEvent:!0,customScrolling:this._wijgrid._allowVirtualScrolling(),vScroller:{scrollBarVisibility:o.vScrollBarVisibility,scrollValue:t?t.y:null},hScroller:{scrollBarVisibility:o.hScrollBarVisibility,scrollValue:t?t.x:null},hScrollerActivating:n.proxy(this._onHScrollerActivating,this)});if(this._isNativeSuperPanel()){var c=this._getSuperPanelStateContainer();c.length&&c[0].offsetHeight!==c[0].clientHeight&&this._onHScrollerActivating(null,{contentLength:c[0].clientHeight})}this._isNativeSuperPanel()||this._getSuperPanelContentWrapper().bind("scroll",function(e){e.target.scrollLeft=0,e.target.scrollTop=0,e.preventDefault()}),this._wijgrid._allowVirtualScrolling()&&this.vsUI.attach(this._scroller)}else this._scroller.wijsuperpanel("paintPanel");var h=this._testNeedVBar(i.outerDiv,i.element,n(this._viewTables.ne.element()),s.scrollMode,i._autoHeight),p=h&&!this._testAutohiddenScrollbars(),d=this.getVisibleContentAreaBounds().width;this._splitAreas.ne.width(d-s.splitDistanceX);if(l&&t&&t.x){var v=this._scroller.wijsuperpanel("scrollValueToPx",t.x,"h");this._setFixedAreaPosition(this._splitAreas.ne,"h",v,null,!0)}s.staticColumnsAlignment==="right"&&(this._splitAreas.nw.css({left:"",right:p?this._verScrollBarSize:0}),this._splitAreas.sw.css({left:"",right:p?this._verScrollBarSize:0})),this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5),this._wijgrid._allowVirtualScrolling()&&this._wijgrid._handleVirtualScrolling(this._bounds.start)},r.prototype.scrollTo=function(e,t,r){var i=this._wijgrid,s=null;if(i._allowVirtualScrolling()){var o=i._renderableBoundsCollection().getRenderedIndex(e.rowIndex()),u,a=i._rows().length(),f,l=o-i._viewPortBounds().start>=a-1;if(!e._isRendered()||l&&(u=this.getVisibleAreaBounds(!0))&&(f=e.row().$rows)&&f.offset().top+f.outerHeight()>u.top+u.height)s=o,e.rowIndex()>r.changingEventArgs.oldRowIndex&&(s-=a-1,s+=1)}var c=this._getSuperPanel();if(s!==null)r.setFocus=!0,r.hasFocusedChild=!1,c?this.vsUI.scrollTo(s,function(){t()}):t();else{var h=i.options,p=n(e.tableCell()),d=null,v=null;if(c&&p.is(":visible")){var m=c.getContentElement(),g=m.parent(),y=parseInt((m.css("left")+"").replace("px",""),10)*-1,b=parseInt((m.css("top")+"").replace("px",""),10)*-1,w=g.outerWidth()-h.splitDistanceX,E=g.outerHeight()-h.splitDistanceY,S=p.position(),x=S.left,T=S.top,N=p.outerWidth(),C=p.outerHeight(),k=i._getStaticIndex(!0),L=i._getStaticIndex(!1),A=e.rowIndex(),O=e.cellIndex();A<=k?O<=L?(d=0,v=0):(x+=y,x+N>y+w&&(y=d=x+N-w),x<y&&(d=x),v=0):O<=L?(T+=this._splitAreas.sw.scrollTop(),T+C>b+E&&(b=v=T+C-E),T<b&&(v=T),d=0):(x-=h.splitDistanceX,T+C>b+E&&(b=v=T+C-E),x+N>y+w&&(y=d=x+N-w),T<b&&(v=T),x<y&&(d=x)),d!==null&&c.hScrollTo(d),v!==null&&c.vScrollTo(v)}t()}},r.prototype.updateSplits=function(t){var r=this._wijgrid,i=r.options,s,o=this,u=[],a=[],f=[],l=this._staticColumnIndex,c,h=i.scrollMode,p=r._field("visibleLeaves"),d=n(this._viewTables.se.element()),v=n(this._viewTables.ne.element()),m=n(this._viewTables.sw.element()),g=n(this._viewTables.nw.element()),y=r.outerDiv,b,w,E;this._destroySuperPanel(),y.unbind("mousewheel",this._mouseWheelHandler);if((b=o._viewTables.se.element().tBodies)&&(b=b[0])){E=!1;for(w=0;w<b.rows.length;w++)if(!n(b.rows[w]).hasClass(e.grid.wijgrid.CSS.groupHeaderRow)){E=!0;break}E||r.element.css("width","100%")}n.each([d,v,m,g],function(e,t){t.css({"table-layout":"",width:""})}),n.each(p,function(e,t){var n,r=t.width;if(r||r===0){n=typeof r=="string"&&r.length>1&&r[r.length-1]==="%",n?r=y.width()*parseFloat(r)/100:r=parseFloat(r);if(t.ensurePxWidth||t.ensurePxWidth===undefined&&i.ensureColumnsPxWidth)t._realWidth=r;o._setColumnWidth(e,r)}}),n.each(p,function(e,t){f.push(o._getColumnWidth(e))}),n.each([g,v,m,d],function(e,t){t.css({width:"1px"})}),n.each(p,function(e,t){a.push(o._getColumnWidth(e))}),s=y.width(),u=this._adjustWidthArray(f,a,s,i.ensureColumnsPxWidth),n.each(u,function(e,t){var n=p[e];if(n._realWidth!==undefined){delete n._realWidth;return}o._setColumnWidth(e,t.width)}),l>=0&&(c=l,this._setTableWidth([g,m],this._sumWidthArray(u,0,c),u[c].width,c));try{l>=0?i.splitDistanceX=g[0].offsetWidth:i.splitDistanceX=0}catch(S){}this._updateSplitAreaBounds(0),i.ensureColumnsPxWidth||v.parent().width(s-i.splitDistanceX),c=u.length-1,c!==-1&&this._setTableWidth([v,d],this._sumWidthArray(u,l+1,c),u[c].width,c),this._adjustRowsHeights();try{this._staticRowIndex>=0?i.splitDistanceY=Math.max(g[0].offsetHeight,v[0].offsetHeight):i.splitDistanceY=0}catch(S){}this._updateSplitAreaBounds(1);if(!i.ensureColumnsPxWidth&&this._testNeedVBar(r.outerDiv,d,v,h,r._autoHeight)){s-=this._verScrollBarSize,u=this._adjustWidthArray(f,a,s,i.ensureColumnsPxWidth),n.each(u,function(e,t){t.real||o._setColumnWidth(e,t.width)}),l>=0&&(c=l,this._setTableWidth([g,m],this._sumWidthArray(u,0,c),u[c].width,c));try{l>=0?i.splitDistanceX=g[0].offsetWidth:i.splitDistanceX=0}catch(S){}this._updateSplitAreaBounds(0),v.parent().width(s-i.splitDistanceX),c=u.length-1,c!==-1&&this._setTableWidth([v,d],this._sumWidthArray(u,l+1,c),u[c].width,c),this._adjustRowsHeights();try{this._staticRowIndex>=0?i.splitDistanceY=Math.max(g[0].offsetHeight,v[0].offsetHeight):i.splitDistanceY=0}catch(S){}this._updateSplitAreaBounds(1)}this.refreshPanel(t),y.bind("mousewheel",n.proxy(this._mouseWheelHandler,this))},r.prototype.getInlineTotalWidth=function(){if(this._scroller){var e=this._getSuperPanelStateContainer();if(e.length){var t=e[0].style.width;if(t&&t!=="auto")return t}}return""},r.prototype._clearBody=function(){t.prototype._clearBody.call(this)},r.prototype.bodyRows=function(){var e=t.prototype.bodyRows.call(this);return e},r.prototype.forEachColumnCell=function(e,t,n){var r=this.getJoinedTables(!0,e),i,s;if(r[0]!==null){i=r[2],s=r[0].forEachColumnCell(i,t,n);if(s!==!0)return s;if(r[1]!==null){s=r[1].forEachColumnCell(i,t,n);if(s!==!0)return s}}return!0},r.prototype.forEachRowCell=function(e,t,n){var r=this.getJoinedTables(!1,e),i=r[0],s=r[1],o,u;if(i!==null){o=r[2];if(o<i.element().rows.length){u=i.forEachRowCell(o,t,n);if(u!==!0)return u}if(s!==null&&o<s.element().rows.length){u=s.forEachRowCell(o,t,n);if(u!==!0)return u}}return!0},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),this.getAbsoluteRowIndex(t.parentNode),this._wijgrid,!0,n)},r.prototype.getAbsoluteRowIndex=function(e){var t=e.rowIndex,n=e.parentNode;while(n&&n.tagName&&n.tagName.toLowerCase()!=="table")n=n.parentNode;return n===this._viewTables.nw.element()||n===this._viewTables.ne.element()?t:t+this._staticRowIndex+1},r.prototype.getCell=function(e,t){var n=this.getJoinedTables(!1,t),r,i,s,o,u;if(n[0]!==null){r=this.getJoinedTables(!0,e);if(r[0]!==null){i=n[2],s=r[2],o=null,n[1]!==null?o=e===s?n[0]:n[1]:o=n[0],u=o.getCellIdx(s,i);if(u>=0)return o.element().rows[i].cells[u]}}return null},r.prototype.getColumnIndex=function(e){var t=null,n=null,r=!1,i;for(t=e.parentNode;t.tagName.toLowerCase()!=="table";t=t.parentNode);if(t!==null){t===this._viewTables.nw.element()?n=this._viewTables.nw:t===this._viewTables.ne.element()?(n=this._viewTables.ne,r=!0):t===this._viewTables.sw.element()?n=this._viewTables.sw:t===this._viewTables.se.element()&&(n=this._viewTables.se,r=!0);if(n!==null)return i=n.getColumnIdx(e),r&&(i+=this._staticColumnIndex+1),i}return-1},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=[],r=this.getJoinedTables(!0,e),i=r[2];return r.splice(r.length-1,1),n.each(r,function(e,r){t.push(r?n(r.element()).find("col")[i]:null)}),t},r.prototype.getJoinedRows=function(e,t){var n=null,r=null,i=null,s=null,o=this._staticRowIndex,u=this._staticColumnIndex,a=this._wijgrid._field("visibleLeaves").length-1,f=this._rowsCountRaw()-1,l=o===f,c=o<0,h=!l&&!c,p=0;if(l||h)u>=0&&u<a?(i=this._viewTables.nw,s=this._viewTables.ne):i=u<0?this._viewTables.ne:this._viewTables.nw,p=i.getSectionLength(t),e<p&&(n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t)));if(c||h&&n===null)c||(e-=p),u>=0&&u<a?(i=this._viewTables.sw,s=this._viewTables.se):i=u<0?this._viewTables.se:this._viewTables.sw,n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t));return n===null&&r===null?null:[n,r]},r.prototype.getJoinedTables=function(e,t){var n=null,r=null,i=t,s=this._wijgrid,o=this._staticRowIndex,u=this._staticColumnIndex;return e?(t<=u?(n=this._viewTables.nw,r=this._viewTables.sw):(n=this._viewTables.ne,r=this._viewTables.se,i-=u+1),o<0&&(n=null),o===this._rowsCountRaw()-1&&(r=null)):(t<=o?(n=this._viewTables.nw,r=this._viewTables.ne):(n=this._viewTables.sw,r=this._viewTables.se,i-=o+1),u<0&&(n=null),u===s._field("leaves").length-1&&(r=null)),n===null&&(n=r,r=null),[n,r,i]},r.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},r.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null},r.prototype._ensureRenderBounds=function(){if(this._wijgrid._allowVirtualScrolling()){var e=this.getVirtualPageSize();this._wijgrid._ensureRenderableBounds(this._bounds),this._bounds.end=this._bounds.start+e-1;if(this._wijgrid._serverSideVirtualScrolling()){var n=this._bounds.end-this._bounds.start+1-this._wijgrid.sketchTable.count();n>0&&(this._bounds.end-=n)}this._wijgrid._ensureRenderableBounds(this._bounds);if(this._bounds.start>0&&this._bounds.end===this._wijgrid.sketchTable.count()-1){e=this.getVirtualPageSize(!1);var r=this._bounds.end-this._bounds.start+1;r<e&&(this._bounds.start=this._bounds.end-e+1),this._wijgrid._ensureRenderableBounds(this._bounds),this._bounds.start!==this._wijgrid._scrollingState.index&&(this._wijgrid._scrollingState.index=this._wijgrid._scrollingState.y=this._bounds.start)}}else t.prototype._ensureRenderBounds.call(this)},r.prototype._renderContent=function(){t.prototype._renderContent.call(this)},r.prototype._preRender=function(){t.prototype._preRender.call(this);var r=document.createDocumentFragment(),i=e.grid.htmlTableAccessor,s=e.grid.wijgrid.CSS,o=this._wijgrid.options.wijCSS;this._wijgrid.outerDiv.wrapInner('<div class="'+s.fixedView+" "+o.wijgridFixedView+'"><div class="'+s.scroller+" "+o.wijgridScroller+'"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>'),this._scroller=this._wijgrid.outerDiv.find("."+s.scroller),this._scroller.css("padding",0),this._scroller.after(this._splitAreas.nw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.ne=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.sw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first"),this._viewTables={nw:new i(r.appendChild(document.createElement("table")),!0,!0,!0),ne:new i(r.appendChild(document.createElement("table")),!0,!0,!0),sw:new i(r.appendChild(document.createElement("table")),!0,!0,!0),se:new i(r.appendChild(this._wijgrid.element[0]),!0,!0,!0)}},r.prototype._postRender=function(){var r,i,s,o,u=e.grid.htmlTableAccessor,a=this;this._viewTables={nw:new u(r=this._viewTables.nw.element()),ne:new u(i=this._viewTables.ne.element()),sw:new u(s=this._viewTables.sw.element()),se:new u(o=this._viewTables.se.element())},this._splitAreas.nw.empty().append(r),this._splitAreas.ne.empty().append(i),this._splitAreas.sw.empty().append(s),this._splitAreas.se.empty().append(o),n.each(this._viewTables,function(t,r){var i=n(r.element());a._wijgrid._setAttr(i,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}),i.addClass(e.grid.wijgrid.CSS.table).addClass(a._wijgrid.options.wijCSS.wijgridTable).css("border-collapse","separate").find("> tbody").addClass(a._wijgrid.options.wijCSS.content)}),t.prototype._postRender.call(this)},r.prototype._rowsCountRaw=function(){var e=this._viewTables.nw.element(),t=this._viewTables.ne.element(),n=this._viewTables.sw.element(),r=this._viewTables.se.element(),i;return i=Math.max(e.rows.length,t.rows.length)+Math.max(n.rows.length,r.rows.length),i},r.prototype._createCol=function(e,t){return[document.createElement("col"),document.createElement("col")]},r.prototype._appendCol=function(e,t,n){n<=this._staticColumnIndex?(this._viewTables.nw.appendCol(e[0]),this._viewTables.sw.appendCol(e[1])):(this._viewTables.ne.appendCol(e[0]),this._viewTables.se.appendCol(e[1]))},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s,o,u=this._viewTables;switch(t){case i.header:case i.filter:s=u.nw.ensureTHead(),o=u.ne.ensureTHead();break;case i.footer:s=u.sw.ensureTFoot(),o=u.se.ensureTFoot();break;default:n<=this._staticDataRowIndex?(s=u.nw.ensureTBody(),o=u.ne.ensureTBody()):(n-=this._staticDataRowIndex+1,s=u.sw.ensureTBody(),o=u.se.ensureTBody())}return r?[s.appendChild(r),o.appendChild(r.cloneNode(!1))]:[s.insertRow(n>s.rows.length?-1:n),o.insertRow(n>o.rows.length?-1:n)]},r.prototype._rowRendered=function(e,r,i){var s=e.$rows[0],o=e.$rows[1];!s.cells.length&&this._isBodyRow(e)&&(s.parentNode.removeChild(s),s=null),!o.cells.length&&this._isBodyRow(e)&&(o.parentNode.removeChild(o),o=null);if(s||o){if(!s||!o)e.$rows=s?n(s):n(o);t.prototype._rowRendered.call(this,e,r,i)}},r.prototype._appendCell=function(t,n,r){var i=t.type!==e.grid.rowType.header?this._staticColumnIndex:this._staticAllColumnIndex;n<=i?t.$rows[0].appendChild(r[0]):t.$rows[1].appendChild(r[0])},r.prototype._getRowHeight=function(e,t){if(e[0]&&e[1]){var r=e[0],i=e[1],s=n(r),o=n(i),u,a,f,l=function(e){var t,r=e[0],i;for(t=0;t<r.cells.length;t++){i=r.cells[t];if(!i.rowSpan||i.rowSpan===1)return n(i).outerHeight()}return e.height()};return(f=n.data(r,"customHeight"))?u=a=parseInt(f):(s.css("height",""),o.css("height",""),t?(u=l(s),a=l(o)):(u=s.height(),a=o.height())),Math.max(u,a)}return null},r.prototype._setRowHeight=function(e,t){if(e[0]&&e[1]){var r=[n(e[0]),n(e[1])],i;if(t===null)return;t+=1,n.each(r,function(e,n){n.height(t),i=t-n.height(),i&&n.height(t+i)})}},r.prototype._adjustRowHeight=function(){var e=this._wijgrid,t=this._staticColumnIndex,n=e._field("visibleLeaves").length-1,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=[];if(t>-1&&t<n){r=this._staticRowIndex,i=this._rowsCountRaw()-1,s=this._viewTables;if(r>-1&&r<=i){o=s.ne.element(),u=o.parentNode,a=s.nw.element(),f=a.parentNode,g=a.rows,y=o.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]],!0))}if(r>=-1&&r<i){l=s.se.element(),c=l.parentNode,h=s.sw.element(),p=h.parentNode,g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]]))}r>-1&&r<=i&&(f.removeChild(a),u.removeChild(o)),r>=-1&&r<i&&(p.removeChild(h),c.removeChild(l));if(r>-1&&r<=i){g=a.rows,y=o.rows,d=g.length;for(v=0,m=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}if(r>=-1&&r<i){g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}r>-1&&r<=i&&(f.appendChild(a),u.appendChild(o)),r>=-1&&r<i&&(p.appendChild(h),c.appendChild(l))}},r.prototype._adjustRowsHeights=function(){var e=n(this._viewTables.sw.element()),t=n(this._viewTables.se.element()),r;t.css("height",""),e.css("height",""),this._adjustRowHeight(),r=Math.max(t.height(),e.height()),e.height(r),t.height(r)},r.prototype._destroySuperPanel=function(){this._scroller.data("wijmo-wijsuperpanel")&&(this.vsUI&&this.vsUI.dispose(),this._superPanelElementsCache={},this._scroller.wijsuperpanel("destroy"))},r.prototype._onScroll=function(e,t){var n=this._getSuperPanel();this._wijgrid._allowVirtualScrolling()?t.dir==="h"&&(this._setFixedAreaPosition(n.getContentElement(),t.dir,t.position,t.animationOptions,!1),this._setFixedAreaPosition(this._splitAreas.ne,t.dir,t.position,t.animationOptions,!0)):this._setFixedAreaPosition(t.dir==="h"?this._splitAreas.ne:this._splitAreas.sw,t.dir,t.position,t.animationOptions,!0),this._wijgrid._trackScrollingPosition(n.options.hScroller.scrollValue,n.options.vScroller.scrollValue)},r.prototype._onHScrollerActivating=function(e,t){if(this._wijgrid._autoHeight){var n=this._wijgrid.element.height()+this._wijgrid.options.splitDistanceY-t.contentLength;if(n>0)return this._scroller.height(this._scroller.height()+n),this._scroller.wijsuperpanel("paintPanel"),!1}this._splitAreas.sw.height(t.contentLength-this._wijgrid.options.splitDistanceY)},r.prototype._onMouseWheel=function(t,r){var i,s=r>0?"top":"bottom",o=!1,u;this._wijgrid._canInteract()&&(i=this.getFixedAreaVisibleBounds(),n.each(i,function(n,r){if(r&&e.grid.isOver(t.pageY,t.pageX,r.top,r.left,r.height,r.width))return o=!0,!1}),o&&this._scroller.data("wijmo-wijsuperpanel")&&(u=this._scroller.wijsuperpanel("option","vScroller").scrollValue,this._scroller.wijsuperpanel("doScrolling",s),u!==this._scroller.wijsuperpanel("option","vScroller").scrollValue&&(t.stopPropagation(),t.preventDefault())))},r.prototype._setFixedAreaPosition=function(e,t,n,r,i){var s={},o;t==="h"?o=i?"scrollLeft":"left":o=i?"scrollTop":"top",i||(n=-n),r?(s[o]=n,e.animate(s,r)):i?e[0][o]=n:e.css(o,n)},r.prototype._testNeedVBar=function(e,t,n,r,i){var s=!1,o=this._wijgrid,u=n.width()+o.options.splitDistanceX,a=t.height()+o.options.splitDistanceY,f=e.width(),l=e.height(),c,h=0,p=0;o.$superPanelHeader!==null&&(h=o.$superPanelHeader.outerHeight(!0)),o.$bottomPagerDiv!==null&&(p=o.$bottomPagerDiv.outerHeight(!0)),c=l-h-p;switch(r){case"both":case"vertical":s=!0;break;case"auto":s=a>c||!i&&u>f&&a>c-this._verScrollBarSize;if(!s&&this._wijgrid._allowVirtualScrolling()){var d=o._view().getVirtualPageSize();s=d>0&&d<o._totalRowsCount()}}return s},r.prototype._updateSplitAreaBounds=function(e){var t=this._wijgrid,n=t.options,r,i,s=0,o=0;if(e===0||e===2)this._splitAreas.nw.width(n.splitDistanceX),this._splitAreas.sw.width(n.splitDistanceX),t.options.staticColumnsAlignment==="right"?(this._splitAreas.se.css("marginRight",n.splitDistanceX),this._splitAreas.ne.css("marginRight",n.splitDistanceX)):(this._splitAreas.se.css("marginLeft",n.splitDistanceX),this._splitAreas.ne.css("marginLeft",n.splitDistanceX));if(e===1||e===2)this._scroller.css("height",""),this._splitAreas.se.css("marginTop",0),r=t.outerDiv.height(),t._autoHeight?this._scroller.height(r+n.splitDistanceY):this._scroller.height(r),this._splitAreas.nw.height(n.splitDistanceY),this._splitAreas.ne.height(n.splitDistanceY),t.$superPanelHeader!==null&&(s=t.$superPanelHeader.outerHeight(!0)),t.$bottomPagerDiv!==null&&(o=t.$bottomPagerDiv.outerHeight(!0)),i=r-s-o,t.$superPanelHeader!==null&&(this._splitAreas.nw.css("top",s+"px"),this._splitAreas.ne.css("top",s+"px")),t._autoHeight?this._splitAreas.sw.height(i):this._splitAreas.sw.height(i-n.splitDistanceY),this._splitAreas.sw.css("top",n.splitDistanceY+s),this._splitAreas.se.css("marginTop",n.splitDistanceY)},r.prototype._getSuperPanelContentWrapper=function(){if(!this._superPanelElementsCache.contentWrapper||!this._superPanelElementsCache.contentWrapper.length)this._superPanelElementsCache.contentWrapper=this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first");return this._superPanelElementsCache.contentWrapper},r.prototype._getSuperPanelStateContainer=function(){if(!this._superPanelElementsCache.stateContainer||!this._superPanelElementsCache.stateContainer.length)this._superPanelElementsCache.stateContainer=this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-statecontainer:first");return this._superPanelElementsCache.stateContainer},r.prototype._isNativeSuperPanel=function(){return this._wijgrid._isTouchEnv()},r.prototype._testAutohiddenScrollbars=function(){if(this._isNativeSuperPanel()){var e=this._getSuperPanelStateContainer();if(e.length)return e[0].offsetWidth===e[0].clientWidth}return!1},r}(t.baseView);t.fixedView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(e){this._updates=0,this._selectedColumns=null,this._selectedRows=null,this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};if(!e)throw"invalid arguments";this._wijgrid=e,this._addedCells=new i(e),this._removedCells=new i(e),this._selectedCells=new i(e),this._addedDuringCurTransactionCells=new i(e)}return r.prototype.selectedCells=function(){return this._selectedCells},r.prototype.addColumns=function(e,t){!t&&t!==0&&(t=e),this.addRange(e,0,t,16777215)},r.prototype.addRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._selectRange(s,!1,!0,e.grid.cellRangeExtendMode.none,null),this.endUpdate()},r.prototype.addRows=function(e,t){!t&&t!==0&&(t=e),this.addRange(0,e,16777215,t)},r.prototype.removeRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._clearRange(s,e.grid.cellRangeExtendMode.none),this.endUpdate()},r.prototype.removeColumns=function(e,t){!t&&t!==0&&(t=e),this.removeRange(e,0,t,16777215)},r.prototype.removeRows=function(e,t){!t&&t!==0&&(t=e),this.removeRange(0,e,16777215,t)},r.prototype.clear=function(){this.beginUpdate(),this._removedCells._clear(),this._removedCells._addFrom(this._selectedCells),this.endUpdate()},r.prototype.selectAll=function(){this.beginUpdate(),this._selectRange(this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch),!1,!1,e.grid.cellRangeExtendMode.none,null),this.endUpdate()},r.prototype.beginUpdate=function(){this._updates++},r.prototype.endUpdate=function(){if(this._updates>0){this._updates--;if(this._updates===0){this.doSelection();if(this._addedCells.length()||this._removedCells.length())this._selectedColumns!==null&&this._selectedColumns.UnderlyingDataChanged(),this._selectedRows!==null&&this._selectedRows.UnderlyingDataChanged(),this._wijgrid._trigger("selectionChanged",null,{addedCells:this._addedCells,removedCells:this._removedCells});this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._removedCells._clear()}}},r.prototype._multipleRangesAllowed=function(){var e=this._wijgrid.options.selectionMode;return e&&((e=e.toLowerCase())==="multicolumn"||e==="multirow"||e==="multirange")},r.prototype._anchorCell=function(){return this.__anchorCell},r.prototype._startNewTransaction=function(t){t&&(this.__anchorCell=t._clone(),this._addedDuringCurTransactionCells=new e.grid.cellInfoOrderedCollection(this._wijgrid))},r.prototype._clearRange=function(e,n){var r=this._wijgrid.options.selectionMode.toLowerCase(),i,s,o,u,a,f,l,c,h,p=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);if(e._isValid()&&r!=="none"&&this._selectedCells.length()>0){i=e._clone(),i._normalize(),i._clip(p);if(!e._isValid())return;i._extend(this._extend_rules[r][n],p),this.beginUpdate();for(l=0,c=this._selectedCells.length();l<c;l++)h=this._selectedCells.item(l),i._containsCellInfo(h)&&this._removedCells._add(h);this.endUpdate()}},r.prototype._selectRange=function(n,r,i,s,o){var u=this._wijgrid.options.selectionMode.toLowerCase(),a,f=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);if(u!=="none"&&n._isValid()){a=n._clone(),a._normalize(),a._clip(f);if(!a._isValid())return;this.beginUpdate(),this._multipleRangesAllowed()?r||i?i&&(this._removedCells._clear(),this._removedCells._addFrom(this._addedDuringCurTransactionCells)):this.clear():this.clear();switch(u){case"singlecell":case"singlecolumn":case"singlerow":a=o===null?new e.grid.cellInfoRange(a.topLeft(),a.topLeft()):new e.grid.cellInfoRange(o,o)}a._extend(this._extend_rules[u][s],f),this.doRange(a,!0),this.endUpdate()}},r.prototype._ensureSelection=function(){var e=this._wijgrid._view(),t=-2,n;for(var r=0;r<this._selectedCells.length();r++){var i=this._selectedCells.item(r);i._isRendered()&&(t!==i.rowIndex()&&(n=i.row(),t=i.rowIndex()),this.selectCell(i,n,e,!0))}},r.prototype._ensureSelectionInRow=function(e){var t=this,n=this._wijgrid._view();if(n._isRowRendered(e)>=0){var r=n._getRowInfoBySketchRowIndex(e,!1),i=this.selectedCells();r&&i&&i.length()>0&&r.$rows.children("td, th").each(function(s,o){var u=i.indexOf(s,e);u>=0&&t.selectCell(i.item(u),r,n,!0)})}},r.prototype.doSelection=function(){var t=this._wijgrid._view(),n,r,i,s,o,u,a=e.grid.renderState,f,l,c=-1;for(n=0,r=this._removedCells.length();n<r;n++)i=this._removedCells.item(n),this._addedCells.indexOf(i)<0?(c!==i.rowIndex()&&(f=i.row(),c=i.rowIndex()),this.selectCell(i,f,t,!1),this._selectedCells._remove(i),this._addedDuringCurTransactionCells._remove(i)):(this._removedCells._removeAt(n),n--,r--);c=-1;for(n=0,r=this._addedCells.length();n<r;n++)i=this._addedCells.item(n),u=this._selectedCells.indexOf(i),u<0?(c!==i.rowIndex()&&(f=i.row(),c=i.rowIndex()),this.selectCell(i,f,t,!0),this._selectedCells._insertUnsafe(i,~u),this._addedDuringCurTransactionCells._add(i)):(this._addedCells._removeAt(n),n--,r--)},r.prototype.selectCell=function(t,r,i,s){if(t._isRendered()){var o=this._wijgrid._viewPortBounds(),u=i.getCell(t.cellIndexAbs(),t.rowIndexAbs());if(u){var a=n(u),f=i._changeCellRenderState(a,e.grid.renderState.selected,s===!0);this._wijgrid.cellStyleFormatter.format(a,t.cellIndex(),t.column(),r,f)}}},r.prototype.doRange=function(t,n){var r=t.topLeft().cellIndex(),i=t.topLeft().rowIndex(),s=t.bottomRight().cellIndex(),o=t.bottomRight().rowIndex(),u,a,f,l,c=this._wijgrid._view(),h,p,d=this._wijgrid._viewPortBounds();if(n){u=this._addedCells.length(),p=this._wijgrid._rows();for(a=i;a<=o;a++){h=c._getRowInfoBySketchRowIndex(a);if(h.type&e.grid.rowType.data)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._addedCells._appendUnsafe(l):this._addedCells._add(l)}}else{u=this._removedCells.length();for(a=i;a<=o;a++)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._removedCells._appendUnsafe(l):this._removedCells._add(l)}},r}();t.selection=r;var i=function(){function t(e){this._clear=function(){this._list.length=0};if(!e)throw"invalid arguments";this._wijgrid=e,this._list=[]}return t.prototype.item=function(e){return this._list[e]},t.prototype.length=function(){return this._list.length},t.prototype.indexOf=function(e,t){arguments.length===1&&(t=e.rowIndex(),e=e.cellIndex());var n=0,r=this._list.length-1,i,s,o;while(n<=r){i=n+(r-n>>1),s=this._list[i],o=s.rowIndex()-t,o===0&&(o=s.cellIndex()-e);if(o<0)n=i+1;else{if(!(o>0))return i;r=i-1}}return~n},t.prototype.toString=function(){var e="",t,n;for(t=0,n=this._list.length;t<n;t++)e+=this._list[t].toString()+"\n";return e},t.prototype._add=function(e){var t=this.indexOf(e);return t<0?(this._list.splice(~t,0,e),e._setGridView(this._wijgrid),!0):!1},t.prototype._addFrom=function(e){if(e){var t=e.length(),n=this._list.length,r;if(n===0){this._list.length=t;for(r=0;r<t;r++)this._list[r]=e.item(r),this._list[r]._setGridView(this._wijgrid)}else for(r=0;r<t;r++)this._add(e.item(r))}},t.prototype._appendUnsafe=function(e){this._list[this._list.length]=e,e._setGridView(this._wijgrid)},t.prototype._insertUnsafe=function(e,t){this._list.splice(t,0,e)},t.prototype._remove=function(e){var t=this.indexOf(e);return t>=0?(this._list.splice(t,1),!0):!1},t.prototype._removeAt=function(e){this._list.splice(e,1)},t.prototype._getColumnsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].cellIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._getSelectedRowsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].rowIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._rectangulate=function(){var t=this._list.length,n=4294967295,r=4294967295,i=0,s=0,o,u;if(t){for(o=0;o<t;o++)u=this._list[o],n=Math.min(n,u.cellIndex()),r=Math.min(r,u.rowIndex()),i=Math.max(i,u.cellIndex()),s=Math.max(s,u.rowIndex());return new e.grid.cellInfoRange(new e.grid.cellInfo(n,r),new e.grid.cellInfo(i,s))}return null},t}();t.cellInfoOrderedCollection=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(t){this._gap_to_start=10,this._inProgress=!1,this._additionalEventsAttached=!1,this._wijgrid=t,this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui",this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._view=this._wijgrid._view(),this._rootElement=this._view.focusableElement(),this._visLeavesLen=this._wijgrid._field("visibleLeaves").length,this._rootElement.bind(this._eventKey("mousedown"),n.proxy(this._onGridMouseDown,this))}return r.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown),this._detachAdditionalEvents()},r.prototype._onGridMouseDown=function(t){if(!this._wijgrid._canInteract()||this._wijgrid.options.selectionMode.toLowerCase()==="none")return;var r=this._view.getVisibleContentAreaBounds(),i={x:t.pageX,y:t.pageY},s=t.target&&t.target.tagName!==undefined?t.target.tagName.toLowerCase():undefined,o=n(t.target),u=e.grid.wijgrid.CSS;(!s||o.is("td."+u.TD+", th."+u.TD+", div."+u.cellContainer))&&i.x>r.left&&i.x<r.left+r.width&&i.y>r.top&&i.y<r.top+r.height&&(this._attachAdditionalEvents(),this._startPos=i,this._startCellInfo=this._coordToDataCellInfo(this._startPos))},r.prototype._onDocumentMouseMove=function(r){if(!this._startCellInfo||!this._startCellInfo._isValid())return;var i={x:r.pageX,y:r.pageY},s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=this._wijgrid._view(),w=this._wijgrid._rows(),E=e.grid.renderState;this._inProgress||(this._inProgress=Math.abs(this._startPos.x-i.x)>this._gap_to_start||Math.abs(this._startPos.y-i.y)>this._gap_to_start);if(this._inProgress){s=this._coordToDataCellInfo(i);if(!s._isValid())return;this._endCellInfo=s,u=new e.grid.cellInfoRange(this._startCellInfo,this._endCellInfo),u._normalize(),u._clip(this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch));if(u._isValid()&&!u.isEqual(this._prevMouseMoveRange)){this._prevMouseMoveRange=u,a=new e.grid.cellInfoOrderedCollection(this._wijgrid),f=u.bottomRight().rowIndex(),l=u.bottomRight().cellIndex();for(c=u.topLeft().rowIndex();c<=f;c++){m=b._getRowInfoBySketchRowIndex(c);if(m.type&e.grid.rowType.data)for(h=u.topLeft().cellIndex();h<=l;h++)a._appendUnsafe(new e.grid.cellInfo(h,c))}g=-1;for(p=0,d=this._addedCells.length();p<d;p++)o=this._addedCells.item(p),a.indexOf(o)<0&&(this._wijgrid.selection().selectedCells().indexOf(o)<0&&(h=this._view.getCell(o.cellIndexAbs(),o.rowIndexAbs()),h&&(g!==o.rowIndex()&&(m=o.row(),g=o.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!1),this._wijgrid.cellStyleFormatter.format(v,o.cellIndex(),o.column(),m,y))),this._addedCells._removeAt(p),p--,d--);g=-1;for(p=0,d=a.length();p<d;p++)o=a.item(p),this._addedCells.indexOf(o)<0&&this._wijgrid.selection().selectedCells().indexOf(o)<0&&this._addedCells._add(o)&&(h=this._view.getCell(o.cellIndexAbs(),o.rowIndexAbs()),h&&(g!==o.rowIndex()&&(m=o.row(),g=o.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!0),this._wijgrid.cellStyleFormatter.format(v,o.cellIndex(),o.column(),m,y)))}}},r.prototype._onDocumentMouseUp=function(t){this._detachAdditionalEvents();if(this._inProgress){this._inProgress=!1;if(this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid()){this._wijgrid._changeCurrentCell(t,this._endCellInfo,{changeSelection:!1,setFocus:!1}),(!t.shiftKey||!this._wijgrid.selection()._multipleRangesAllowed()&&this._wijgrid.options.selectionMode.toLowerCase()!=="singleRange")&&this._wijgrid.selection()._startNewTransaction(this._startCellInfo),this._wijgrid.selection().beginUpdate(),this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,t.shiftKey,t.ctrlKey,e.grid.cellRangeExtendMode.none,this._endCellInfo),this._wijgrid.selection().endUpdate();var r=this._wijgrid._view(),i=-1,s,o=e.grid.renderState;for(var u=0,a=this._addedCells.length();u<a;u++){var f=this._addedCells.item(u);if(this._wijgrid.selection().selectedCells().indexOf(f)<0){var l=r.getCell(f.cellIndexAbs(),f.rowIndexAbs());if(l!==null){i!==f.rowIndex()&&(s=f.row(),i=f.rowIndex());var c=n(l),h=r._changeCellRenderState(c,o.selected,!1);this._wijgrid.cellStyleFormatter.format(c,f.cellIndex(),f.column(),s,h)}}}return this._addedCells._clear(),this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null,!1}}},r.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached)try{this._view.toggleDOMSelection(!1),n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=!0}},r.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached)try{this._view.toggleDOMSelection(!0),n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=!1}},r.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},r.prototype._coordToDataCellInfo=function(t){var n=0,r=this._visLeavesLen-1,i=0,s=-1,o,u=new e.grid.rowAccessor(this._view,2,0,0),a,f,l,c;while(n<=r){i=(r-n>>1)+n,o=e.grid.bounds(this._view.getHeaderCell(i)),o||(f=u.item(0),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,i)));if(!o)break;if(t.x<o.left)r=i-1;else{if(!(t.x>o.left+o.width)){s=i;break}n=i+1}}if(s===-1)return e.grid.cellInfo.outsideValue;u=new e.grid.rowAccessor(this._view,0,0,0),a=-1,n=0,r=u.length()-1,i=0;while(n<=r){i=(r-n>>1)+n,f=u.item(i),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,0));if(t.y<o.top)r=i-1;else{if(!(t.y>o.top+o.height)){a=i;break}n=i+1}}return a===-1?e.grid.cellInfo.outsideValue:(c=new e.grid.cellInfo(s,a,this._wijgrid,!0),c)},r}();t.uiSelection=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e,t,n,r){this._view=e,this._scope=t,this._offsetBottom=r,this._offsetTop=n}return t.prototype.item=function(e){var t=this.length();return e>=0&&e<t?this._view.getJoinedRows(e+this._offsetTop,this._scope):null},t.prototype.length=function(){var e=this._view.getJoinedTables(!0,0),t=0,n;if(n=e[0])t=n.getSectionLength(this._scope);if(n=e[1])t+=n.getSectionLength(this._scope);return t-=this._offsetTop+this._offsetBottom,t<0&&(t=0),t},t.iterateCells=function(t,n,r){if(t&&n){var i=0,s,o,u,a,f,l;for(s=0,o=t.length;s<o;s++){u=t[s];if(u)for(a=0,f=u.cells.length;a<f;a++){l=n(u.cells[a],i++,r);if(l!==!0)return}}}},t.getCell=function(t,n){var r,i;if(t&&(r=t[0])){i=r.cells.length;if(n<i)return r.cells[n];n-=i;if(r=t[1]){i=r.cells.length;if(n<i)return r.cells[n]}}return null},t.getCell$=function(r,i){var s=e.grid.rowAccessor.getCell(r,i);return s?n(s):n([])},t.cellsCount=function(t){var n=0,r;if(t&&(r=t[0])){n=r.cells.length;if(r=t[1])n+=r.cells.length}return n},t}();t.rowAccessor=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery;(function(e){e._map=[],e.error=0,e.continueEditing=1,e.success=2,e.cancel=4,e.notEdited=8})(t.updateCellResult||(t.updateCellResult={}));var r=t.updateCellResult,i=function(){function t(){this._timeout=25}return t.prototype.cellEditStart=function(t,r,i){var s=!1,o=t._view(),u,a,f,l;if(r._isValid()&&!r._isEdit()&&r.column().dataIndex>=0){u=r.row();if(u){l=u.type;if(l&e.grid.rowType.data){a={cell:r,event:i,handled:!1};if(s=t._trigger("beforeCellEdit",null,a)||t.options.editingMode==="row")a.handled||(s=this._defaultBeforeCellEdit(t,a));s&&(r._isEdit(!0),t._showRowHeader()&&(f=n(u.$rows[0].cells[0]).children("div."+e.grid.wijgrid.CSS.cellContainer),f.length&&(f.empty(),f.append(n("<div>&nbsp;</div>").addClass(t.options.wijCSS.icon+" "+t.options.wijCSS.iconPencil)))))}}}return s},t.prototype.updateCell=function(t,n,i){var s;if(n&&!n._isEdit())return r.success|r.notEdited;if(!n||!n._isValid()||!(s=n.row())||!(s.type&e.grid.rowType.data))return r.error;if(i&&i.which===e.getKeyCodeEnum().ESCAPE||!n._isRendered())return r.success|r.cancel;var o=r.success,u=n.column(),a={cell:n,value:undefined};if(!t._trigger("beforeCellUpdate",null,a)&&t.options.editingMode!=="row")return r.continueEditing;a.value===undefined&&(a.value=this._getCellValue(t,n));var f=a.value,l=n.value();try{var c=this._getHTMLInputElementType(n);e.grid.HTML5InputSupport.isExtendSupportRequired(c)?(a.value=e.grid.HTML5InputSupport.parse(a.value,c),a.value=e.grid.HTML5InputSupport.extend(l,a.value,c)):a.value=t.parse(n.column(),a.value),f=a.value}catch(h){a.value=f}e.grid.getDataType(u)==="datetime"&&(f instanceof Date&&(f=f.getTime()),l instanceof Date&&(l=l.getTime()));if(f!==l){try{n.value(a.value)}catch(h){var p={cell:n,value:a.value};o=r.error,t._trigger("invalidCellValue",null,p)}if(o&r.success){var d={cell:n};t._trigger("afterCellUpdate",null,d)}}return o},t.prototype.cellEditEnd=function(t,r,i){var s=r.row(),o={cell:r,event:i,handled:!1};r._isEdit(!1),r._isRendered()&&(t._trigger("afterCellEdit",null,o),o.handled||this._defaultAfterCellEdit(t,o),t._showRowHeader()&&n(s.$rows[0].cells[0]).children("div."+e.grid.wijgrid.CSS.cellContainer).html("&nbsp;"))},t.prototype._defaultBeforeCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u;if(i.dataIndex>=0){var a=r.cell.value(),f=e.getKeyCodeEnum(),l=e.grid.HTML5InputSupport.getDefaultInputType(t._isMobileEnv(),i),c=t._allowCellEditing(),h=!1;s=!0;try{o=r.cell.container();if(e.grid.getDataType(i)==="boolean"){var p=o.children("span");if(h=!!p.length&&!!p.prop("disabled"))n.data(p[0],"serverSideCheckbox",!0),p.prop("disabled",!1);u=o.find(":checkbox"),(h||!c)&&u.prop("disabled",!1),r.event&&r.event.type==="keypress"&&u.one("keyup",function(e){e.which===f.SPACE&&(e.preventDefault(),u[0].checked=!a)})}else{u=n("<input type='"+l+"' />").css("ime-mode",i.imeMode||"auto").addClass(e.grid.wijgrid.CSS.inputMarker).addClass("wijmo-wijinput "+t.options.wijCSS.stateFocus).bind("keydown",t,n.proxy(this._checkBoxOrInputKeyDown,this)),u.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()});if(!r.event||r.event.type!=="keydown"||r.event.which===113)switch(e.grid.getDataType(i)){case"currency":case"number":if(a!==null){u.val(a);break};case"datetime":if(e.grid.HTML5InputSupport.isExtendSupportRequired(l)){u.val(e.grid.HTML5InputSupport.toStr(a,l));break};default:u.val(t.toStr(i,a))}o.empty().append(u);if(c){var d=u.val().length;l==="text"&&(new e.grid.domSelection(u[0])).setSelection({start:d,end:d})}}c&&(u.focus(),setTimeout(function(){u.focus()},this._timeout*2))}catch(v){alert(v.message),s=!1}}return s},t.prototype._defaultAfterCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u,a,f,l;if(i.dataIndex>=0){s=!0,l=t._view();try{o=r.cell.container(),u=t.toStr(i,r.cell.value()),f=l._getRowInfoBySketchRowIndex(r.cell.rowIndex());if(e.grid.getDataType(i)==="boolean"){var c=o.children("span"),h=c.length&&n.data(c[0],"serverSideCheckbox");a=o.find(":checkbox"),a.prop("checked",u==="true"),h&&(c.prop("disabled",!0),a.prop("disabled",!0))}else t.cellFormatter.format(n(r.cell.tableCell()),o,i,u,f)}catch(p){alert("defaultAfterCellEdit: "+p.message),s=!1}}return s},t.prototype._checkBoxOrInputKeyDown=function(t){var n=e.getKeyCodeEnum();if(t.which===n.ENTER){var r=t.data;if(r)return r._endEditInternal(t),!1}},t.prototype._getCellValue=function(e,t){var n=t.container().find(":input:first"),r=null;return n.length&&(r=n.attr("type")==="checkbox"?n[0].checked:n.val()),r},t.prototype._getHTMLInputElementType=function(e){return e.container().find(":input:first").attr("type")},t}();t.cellEditorHelper=i;var s=function(){function t(t,r){this.mGrid=t,this.mWrapper=n("<div />"),this.mGrid._allowCellEditing()?this.mHiddenElement=n('<input type="text" />').keydown(n.proxy(this._onKeyDown,this)):this.mHiddenElement=n('<input type="button" />'),this.mHiddenElement.css({position:"relative",border:0,padding:0,margin:0,width:1,height:1,"font-size":e.grid.isMobileSafari()?"0em":"1px"}),this.mFakeFocusable=n('<input type="button" />').css({position:"relative",width:1,height:1,border:0,padding:0,margin:0}),this.mWrapper.append(this.mHiddenElement).append(this.mFakeFocusable).css({position:"absolute",width:"0px",height:"0px",overflow:"hidden","z-index":999999}),r.append(this.mWrapper)}return t.prototype.dispose=function(){if(this.mWrapper)try{this.mWrapper.remove()}catch(e){}finally{this.mWrapper=null,this.mHiddenElement=null,this.mGrid=null}},t.prototype.focus=function(e,t){if(e&&e.length){var n=e.offset();this.mWrapper.offset({top:n.top,left:n.left}),this.mFakeFocusable.focus(),this.mHiddenElement.css("ime-mode",t&&t.imeMode||"auto").focus()}},t.prototype.isHiddenInput=function(e){return e&&(e[0]===this.mHiddenElement[0]||e[0]===this.mFakeFocusable[0])},t.prototype.canHandle=function(e){return this.mGrid._allowCellEditing()&&this.isPrintableKeyCode(e)},t.prototype.isPrintableKeyCode=function(e){var t=e.keyCode;return!e.ctrlKey&&!e.altKey&&(t>=65&&t<=90||t>=48&&t<=57||t>=96&&t<=105||t>=186&&t<=192||t>=220&&t<=222||t===219||t>=106&&t<=111||t===32||t===61||t===173||t===229||e.keyCode===0)},t.prototype._onKeyDown=function(t){if(this.canHandle(t))this.mGrid._beginEditInternal(t);else{var n=e.getKeyCodeEnum();t.keyCode===n.ESCAPE&&t.preventDefault()}},t}();t.keyDownEventListener=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._div=document.createElement("div"),t.prototype.format=function(t,r,i,s,o){var u=i.owner,a=e.grid.rowType,f=e.grid.renderStateEx;o.type&a.footer&&(i.aggregate&&i.aggregate!=="none"?s=e.grid.stringFormat(i.footerText||"{0}",i._totalsValue||""):s=i.footerText||i._footerTextDOM||"");if(o.type&a.groupHeader&&i.visLeavesIdx==(u.options.showRowHeader?1:0)){var l=u._groupedColumns()[o._extInfo.groupLevel-1],c;if(l&&(c=l.groupInfo)&&c.outlineMode!=="none"){var h=e.grid.wijgrid.CSS,p=u.options.wijCSS,d=o._extInfo.state&f.collapsed?c.collapsedImageClass||p.iconArrowRight:c.expandedImageClass||p.iconArrowRightDown;s='<div class="'+p.icon+" "+d+" "+h.groupToggleVisibilityButton+" "+p.wijgridGroupToggleVisibilityButton+'">&nbsp;</div>'+s}}var v=!0,m=null,g={$cell:t,$container:r,column:i,formattedValue:s,row:o,afterDefaultCallback:null},y=!0;if((o.type&a.data||o.type===a.groupFooter||o.type===a.groupHeader)&&u._allowVirtualScrolling()){var b=u._view().getDefaultRowHeight();r.css({overflow:"hidden",height:b})}n.isFunction(i.cellFormatter)&&(v=!i.cellFormatter(g));if(v){switch(o.type&~a.dataAlt){case a.filter:m=this._formatFilterRowCell;break;case a.data:m=this._formatDataRowCell;break;default:m=this._formatDefRowCell}m&&(y=m.call(this,g),n.isFunction(g.afterDefaultCallback)&&g.afterDefaultCallback(g))}return y===!1?!1:!0},t.prototype._formatFilterRowCell=function(t){var n=t.column.owner,r=e.grid.wijgrid.CSS,i=n.options.wijCSS;t.$container.addClass(i.widget+" "+i.stateDefault),t.column.dataIndex>=0&&!t.column.isBand&&t.column.showFilter?t.$container.html('<table cellPadding="0" cellSpacing="0" class="'+r.filter+" "+i.wijgridFilter+" "+i.cornerAll+'">'+"<tr>"+'<td style="width:100%">'+'<input type="text" class="'+r.filterInput+" "+i.wijgridFilterInput+'" style="width:100%" />'+"</td>"+'<td class="'+r.filterTrigger+" "+i.wijgridFilterTrigger+" "+i.cornerRight+" "+i.stateDefault+'">'+'<span class="'+i.icon+" "+i.iconArrowDown+'"></span>'+"</td>"+"</tr>"+"</table>"):t.$container.html("&nbsp;")},t.prototype._formatDataRowCell=function(t){var n=t.column,r=n.owner,i=e.grid.getDataType(n),s=!0;return n.clientType==="c1btnfield"?this._c1btnFieldCellFormatter(t):n.clientType==="c1commandbtnfield"?this._c1commandBtnFieldCellFormatter(t):this._defFieldCellFormatter(t),s},t.prototype._formatDefRowCell=function(e){this._updateHTML(e)},t.prototype._defFieldCellFormatter=function(t){e.grid.getDataType(t.column)==="boolean"?this._boolCellFormatter(t):this._dataCellFormatter(t)},t.prototype._boolCellFormatter=function(t){var r=t.column.owner,i=r._allowCellEditing()&&t.column.readOnly!==!0,s,o,u=e.grid.rowType,a=e.getKeyCodeEnum(),f=n('<input class="'+e.grid.wijgrid.CSS.inputMarker+'" type="checkbox" />');i||f.prop("disabled",!0),r.parse(t.column,r._dataViewWrapper.getValue(t.row.data,t.column.dataKey))===!0&&f.prop("checked","checked"),t.$container.empty().append(f),i&&t.$container.children("input").bind("mousedown",function(e){s=t.$container.parent()[0],o=r.currentCell(),o.tableCell()!==s&&r._onClick({target:s}),o._isEdit()||r.beginEdit()}).bind("keydown",function(e){if(e.which===a.ENTER)return r._endEditInternal(e),!1})},t.prototype._dataCellFormatter=function(e){this._updateHTML(e)},t.prototype._c1btnFieldCellFormatter=function(e){var t=e.column,n={column:e.column,row:e.row};this._buttonFactory(e.$container,t.command,n,null)},t.prototype._c1commandBtnFieldCellFormatter=function(t){var n=t.column,r=n.owner,i={column:t.column,row:t.row},s=this;t.row.state&e.grid.renderState.editing?n.showEditButton&&(this._buttonFactory(t.$container,n.updateCommand,i,function(e,t){r.updateRow()}),t.$container.append(document.createTextNode("\u00a0")),this._buttonFactory(t.$container,n.cancelCommand,i,function(e,t){r.cancelRowEditing()})):(n.showEditButton&&this._buttonFactory(t.$container,n.editCommand,i,function(e,t){r.editRow(i.row.dataItemIndex)}),n.showDeleteButton&&(n.showEditButton&&t.$container.append(document.createTextNode("\u00a0")),this._buttonFactory(t.$container,n.deleteCommand,i,function(e,t){r.deleteRow(i.row.dataItemIndex)}))),t.$container.addClass("wijmo-wijgrid-innercell-command")},t.prototype._updateHTML=function(t){var n=t.$container[0];if(n.firstChild)while(n.firstChild)n.removeChild(n.firstChild);t.column.encodeHtml?e.grid.cellFormatterHelper._div.textContent!=undefined?e.grid.cellFormatterHelper._div.textContent=t.formattedValue||"":e.grid.cellFormatterHelper._div.innerText=t.formattedValue||"":e.grid.cellFormatterHelper._div.innerHTML=t.formattedValue||"&nbsp;";while(e.grid.cellFormatterHelper._div.firstChild)n.appendChild(e.grid.cellFormatterHelper._div.firstChild)},t.prototype._buttonFactory=function(e,t,r,i){var s=n.extend({},{text:t.text,iconClass:t.iconClass,disabled:r.column.owner.options.disabled,click:function(e){var s=!0;if(n.isFunction(t.click)){var o=t.click.apply(this,[e,r]);s=o!==!1&&!e.isDefaultPrevented()}s&&i&&i.apply(this,[e,r]),e.preventDefault()}}),o=n("<div />");e.append(o);switch(r.column.buttonType){case"link":o.wijgridcommandlink(s);break;case"imageButton":o.wijgridcommandimagebutton(s);break;case"button":o.wijgridcommandbutton(s);break;case"image":o.wijgridcommandimage(s);break;default:throw"Unknown buttonType"}},t}();t.cellFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){this.MIN_WIDTH=5,this._elements=[],this._gap=10,this._step=1,this._inProgress=!1,this._hoveredField=null,this._startLocation=null,this._lastLocation=null,this._proxy=null,this._wijgrid=e,this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}return t.prototype.addElement=function(e){e&&e.element&&(e.element.bind(this._eventKey("mousemove"),n.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),n.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),n.proxy(this._onMouseOut,this)),this._elements.push(e))},t.prototype.dispose=function(){var e=this;n.each(this._elements,function(t,n){n.element.unbind(e._eventKey("mousemove"),e._onMouseMove).unbind(e._eventKey("mousedown"),e._onMouseDown).unbind(e._eventKey("mouseout"),e._onMouseOut)}),this._detachDocEvents()},t.prototype.inProgress=function(){return this._inProgress},t.prototype._onMouseMove=function(e){if(!this._inProgress){var t=this._getFieldByPos({x:e.pageX,y:e.pageY});t&&t._canSize()&&this._wijgrid._canInteract()?(t.element.css("cursor","e-resize"),this._hoveredField=t,e.stopPropagation()):this._onMouseOut(e)}},t.prototype._onMouseOut=function(e){this._inProgress||this._hoveredField&&(this._hoveredField.element.css("cursor",""),this._hoveredField=null)},t.prototype._onMouseDown=function(t){this._hoveredField=this._getFieldByPos({x:t.pageX,y:t.pageY});if(this._hoveredField&&this._hoveredField._canSize()&&this._wijgrid._canInteract())try{var r=this._wijgrid.options.wijCSS,i=e.grid.wijgrid.CSS;this._hoveredField.element.css("cursor",""),this._docCursor=document.body.style.cursor,document.body.style.cursor="e-resize",this._startLocation=this._lastLocation=e.grid.bounds(this._hoveredField.element),this._proxy=n('<div class="'+i.resizingHandle+" "+r.wijgridResizingHandle+" "+r.stateHighlight+'">&nbsp;</div>');var s=this._wijgrid._view().getVisibleAreaBounds(!0);this._proxy.css({left:t.pageX,top:this._startLocation.top,height:s.height+s.top-this._startLocation.top}),n(document.body).append(this._proxy)}finally{this._attachDocEvents(),this._inProgress=!0,t.stopPropagation()}},t.prototype._onDocumentMouseMove=function(e){var t=this._step*Math.round((e.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+t,top:e.pageY,width:undefined,height:undefined},this._proxy.css("left",this._lastLocation.left)},t.prototype._onDocumentMouseUp=function(e){try{document.body.style.cursor=this._docCursor,this._proxy.remove(),this._startLocation!==this._lastLocation&&this._wijgrid._fieldResized(this._hoveredField,this._startLocation.width,Math.max(this._lastLocation.left-this._startLocation.left,this.MIN_WIDTH))}finally{this._hoveredField=null,this._proxy=null,this._detachDocEvents(),this._inProgress=!1}},t.prototype._onSelectStart=function(e){e.preventDefault()},t.prototype._attachDocEvents=function(){this._inProgress||(n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this)),n.fn.disableSelection&&n(document.body).disableSelection(),"onselectstart"in document&&n(document.body).bind("selectstart",this._onSelectStart))},t.prototype._detachDocEvents=function(){this._inProgress&&(n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp),n.fn.enableSelection&&n(document.body).enableSelection(),"onselectstart"in document&&n(document.body).unbind("selectstart",this._onSelectStart))},t.prototype._getFieldByPos=function(t){var n,r,i,s,o;for(n=0,r=this._elements.length;n<r;n++){i=this._elements[n],s=e.grid.bounds(i.element),o=e.grid.isOver(t.y,t.x,s.top,s.left+s.width-this._gap,s.height,this._gap);if(o)return i}return null},t.prototype._eventKey=function(t){var n=this._wijgrid._isTouchEnv()?"wij":"";return n+e.grid.stringFormat(this._evntFormat,t)},t}();t.uiResizer=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._scope_guid="scope_"+e.grid.getUID(),this._dragEnd=!1,this.mZIndex=1e3;var n=e.grid.wijgrid.CSS;this._wijgrid=t,this._wijCSS=this._wijgrid.options.wijCSS,this._wrapHtml='<div class="'+this._wijCSS.widget+" "+n.wijgrid+" "+this._wijCSS.wijgrid+" "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'">'+'<table class="'+n.root+" "+n.table+" "+this._wijCSS.wijgridTable+'">'+'<tr class="'+n.headerRow+" "+this._wijCSS.wijgridHeaderRow+'">'+"</tr>"+"</table>"+"</div>"}return t.prototype.attachGroupArea=function(e){var t,r=this;if(!n.ui||!n.ui.droppable||!n.ui.draggable)return;e.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(r._wijgrid.options.allowColMoving){t=r._getWijFieldInstance(e);if(t)return t instanceof n.wijmo.c1groupedfield&&t.options.groupedIndex===r._wijgrid._groupedColumns().length-1?!1:!t.options.isBand&&(t.options.groupedIndex===undefined||t instanceof n.wijmo.c1groupedfield)}return!1},drop:function(e,n){!r._isInElement(e,n.draggable)&&(t=r._getWijFieldInstance(n.draggable))&&(r._dragEnd=!0)},over:function(t,n){var i=r._wijgrid._field("groupedWidgets").length;r._dropTargetRedirected=i>0,r._droppableWijField=i>0?r._wijgrid._field("groupedWidgets")[i-1]:e,e.data("thisDroppableWijField",r._droppableWijField)},out:function(t,n){r._droppableWijField===e.data("thisDroppableWijField")&&(r._droppableWijField=null)}})},t.prototype.attach=function(t){var r,i,s=e.grid.wijgrid.CSS,o=this;if(!n.ui.droppable||!n.ui.draggable)return;if(!t||!(r=t.element))return;r.draggable({helper:function(i){var u;return t instanceof n.wijmo.c1groupedfield?u=r.clone():u=r.clone().wrap(o._wrapHtml).width(r.width()).height(r.height()).closest("."+s.wijgrid),u.addClass(s.dndHelper+" "+o._wijCSS.wijgridDndHelper).css("z-index",o.mZIndex=e.grid.getZIndex(o._wijgrid.outerDiv,1e3)),u},appendTo:"body",scope:o._scope_guid,drag:function(e,n){o._hideArrows();if(o._droppableWijField&&!o._isInElement(e,r)){var i=o._droppableWijField.element;i||(i=o._droppableWijField),o._showArrows(i,o._getPosition(t,o._droppableWijField,e,n))}},start:function(r,i){if(o._wijgrid._canInteract()&&o._wijgrid.options.allowColMoving&&(o._wijgrid._UIResizer()==null||!o._wijgrid._UIResizer().inProgress())){var s=t.options,u=t.options.travIdx,a=t instanceof n.wijmo.c1groupedfield,f=a?"groupArea":"columns";a&&(s=e.grid.search(o._wijgrid.columns(),function(e){return e.options.travIdx===u}),s=s.found?s.found.options:e.grid.getColumnByTravIdx(o._wijgrid.options.columns,u).found);if(t._canDrag()&&o._wijgrid._trigger("columnDragging",null,{drag:s,dragSource:f}))return o._wijgrid._trigger("columnDragged",null,{drag:s,dragSource:f}),!0}return!1},stop:function(e,r){o._hideArrows();try{o._dragEnd&&(o._droppableWijField.element?o._wijgrid._handleDragnDrop(t.options.travIdx,o._droppableWijField.options.travIdx,o._getPosition(t,o._droppableWijField,e,r),t instanceof n.wijmo.c1groupedfield,o._droppableWijField instanceof n.wijmo.c1groupedfield):o._wijgrid._handleDragnDrop(t.options.travIdx,-1,"left",t instanceof n.wijmo.c1groupedfield,!0))}finally{o._droppableWijField=null,o._dragEnd=!1}}}).droppable({hoverClass:o._wijCSS.stateHover,scope:o._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(o._wijgrid.options.allowColMoving&&r[0]!==e[0]){i=o._getWijFieldInstance(e);if(i)return i._canDropTo(t)}return!1},drop:function(e,t){if(i=o._getWijFieldInstance(t.draggable))o._dragEnd=!0},over:function(e,n){o._dropTargetRedirected=!1,o._droppableWijField=t,r.data("thisDroppableWijField",o._droppableWijField)},out:function(e,n){o._droppableWijField===t.element.data("thisDroppableWijField")&&(o._droppableWijField=null)}})},t.prototype.detach=function(e){var t;e&&(t=e.element)&&(t.data("ui-draggable")&&t.draggable("destroy"),t.data("ui-droppable")&&t.droppable("destroy"))},t.prototype.dispose=function(){this._$topArrow&&(this._$topArrow.remove(),this._$topArrow=null),this._$bottomArrow&&(this._$bottomArrow.remove(),this._$bottomArrow=null)},t.prototype._getWijFieldInstance=function(t){var n=e.grid.widgetName(t);if(!n)throw"widgetName is undedined";return t.data(n)},t.prototype._showArrows=function(e,t){this._topArrow().css("z-index",this.mZIndex).show().position({my:"center",at:t+" top",of:e,collision:"none"}),this._bottomArrow().css("z-index",this.mZIndex).show().position({my:"center",at:t+" bottom",of:e,collision:"none"})},t.prototype._hideArrows=function(){this._topArrow().hide(),this._bottomArrow().hide()},t.prototype._topArrow=function(){return this._$topArrow||(this._$topArrow=n("<div />").addClass(e.grid.wijgrid.CSS.dndArrowTopContainer+" "+this._wijCSS.wijgridDndArrowTopContainer).append(n("<span />").addClass(this._wijCSS.icon+" "+this._wijCSS.iconArrowThickDown)).hide().appendTo(document.body)),this._$topArrow},t.prototype._bottomArrow=function(){return this._$bottomArrow||(this._$bottomArrow=n("<div />").addClass(e.grid.wijgrid.CSS.dndArrowBottomContainer+" "+this._wijCSS.wijgridDndArrowBottomContainer).append(n("<span />").addClass(this._wijCSS.icon+" "+this._wijCSS.iconArrowThickUp)).hide().appendTo(document.body)),this._$bottomArrow},t.prototype._isInElement=function(t,n){var r=e.grid.bounds(n,!1);return t.pageX>r.left&&t.pageX<r.left+r.width&&t.pageY>r.top&&t.pageY<r.top+r.height},t.prototype._getPosition=function(t,r,i,s){if(!r.element)return"left";if(this._dropTargetRedirected)return"right";var o=e.grid.bounds(r.element,!1),u=o.width/6,a=o.left+o.width/2,f="right",l;return i.pageX<a&&(f="left"),r instanceof n.wijmo.c1groupedfield?(t instanceof n.wijmo.c1groupedfield&&(l=r.options.groupedIndex-t.options.groupedIndex,Math.abs(l)===1&&(f=l<0?"left":"right")),f):(l=r.options.linearIdx-t.options.linearIdx,r.options.isBand&&t.options.parentIdx!==r.options.travIdx&&Math.abs(i.pageX-a)<u?"center":(t.options.parentIdx===r.options.parentIdx&&Math.abs(l)===1&&(f=l<0?"left":"right"),f))},t}();t.uiDragndrop=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i,s,o,u,a){var f=e.grid.renderState,l=e.grid.rowType,c=s.type,h,p=null;r===0&&this._wijgrid._showRowHeader()&&(i=null);if(c===l.groupHeader||c===l.groupFooter)i=null,u&&(p=u.groupInfo)&&(i=this._wijgrid._field("leaves")[p.leafIndex]);h={$cell:t,state:o,row:s,column:i,_cellIndex:r,_purpose:p?p.purpose:undefined},o&f.rendering?this._renderingStateFormatter(h,u,a):(this._currentStateFormatter(h,o&f.current),this._selectedStateFormatter(h,o&f.selected),c!==l.header&&(o&f.current||o&f.selected?h.$cell.addClass(this._wijgrid.options.wijCSS.stateDefault):h.$cell.removeClass(this._wijgrid.options.wijCSS.stateDefault))),n.isFunction(this._wijgrid.options.cellStyleFormatter)&&this._wijgrid.options.cellStyleFormatter(h)},t.prototype._renderingStateFormatter=function(t,n,r){var i=e.grid.rowType,s,o,u=t.column,a=t.row.type,f=e.grid.wijgrid.CSS,l=this._wijgrid.options.wijCSS;switch(a){case i.header:t.$cell.addClass(f.TH+" "+l.wijgridTH);break;default:t.$cell.addClass(f.TD+" "+l.wijgridTD)}if(a&i.data&&u&&u.textAlignment)switch(u.textAlignment.toLowerCase()){case"left":t.$cell.addClass(f.cellAlignLeft+" "+l.wijgridCellAlignLeft);break;case"right":t.$cell.addClass(f.cellAlignRight+" "+l.wijgridCellAlignRight);break;case"center":t.$cell.addClass(f.cellAlignCenter+" "+l.wijgridCellAlignCenter)}if(n)for(s in n)if(n.hasOwnProperty(s)){o=n[s];if(!(s!=="groupInfo"&&s!=="colSpan"&&s!=="rowSpan"||o>1))continue;s==="class"?t.$cell.addClass(o):t.$cell.attr(s,o)}if(r)for(s in r)if(r.hasOwnProperty(s)){if(s==="paddingLeft"){t.$cell.children("."+f.cellContainer).css(s,r[s]);continue}t.$cell.css(s,r[s])}if(t._cellIndex===0&&this._wijgrid._showRowHeader())t.$cell.attr({role:"rowheader",scope:"row"}).addClass(l.stateDefault+" "+l.content+" "+f.rowHeader+" "+l.wijgridRowHeader);else switch(a){case i.header:t.$cell.attr({role:"columnheader",scope:"col"});break;case i.footer:t.$cell.attr({role:"columnfooter",scope:"col"});break;default:t.$cell.attr("role","gridcell")}a&i.data&&t._cellIndex>=0&&u&&(t.$cell.attr("headers",window.escape(u.headerText)),u.readOnly&&t.$cell.attr("aria-readonly",!0),u.dataIndex>=0&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))),(a===i.groupHeader||a===i.groupFooter)&&u&&t._purpose===e.grid.groupRowCellPurpose.aggregateCell&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))},t.prototype._currentStateFormatter=function(t,n){var r=e.grid.rowType,i=e.grid.wijgrid.CSS,s=this._wijgrid.options.wijCSS;n?(t.$cell.addClass(s.stateActive),t.row.type===r.header?t.$cell.addClass(i.currentHeaderCell+" "+s.wijgridCurrentHeaderCell):t.$cell.addClass(i.currentCell+" "+s.wijgridCurrentCell)):(t.$cell.removeClass(s.stateActive),t.row.type===r.header?t.$cell.removeClass(i.currentHeaderCell+" "+s.wijgridCurrentHeaderCell):t.$cell.removeClass(i.currentCell+" "+s.wijgridCurrentCell))},t.prototype._hoveredStateFormatter=function(e,t){t},t.prototype._selectedStateFormatter=function(e,t){var n=this._wijgrid.options.wijCSS;t?e.$cell.addClass(n.stateHighlight).attr("aria-selected","true"):e.$cell.removeClass(n.stateHighlight).removeAttr("aria-selected")},t}();t.cellStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i){var s=e.grid.renderState,o=e.grid.rowType,u=t.state,a=t;u&s.rendering?this._renderingStateFormatter(a,r,i):(this._currentStateFormatter(a,(u&s.current)!==0),this._hoveredStateFormatter(a,(u&s.hovered)!==0),this._selectedStateFormatter(a,(u&s.selected)!==0)),n.isFunction(this._wijgrid.options.rowStyleFormatter)&&this._wijgrid.options.rowStyleFormatter(a)},t.prototype._groupFormatter=function(t){var n=e.grid.renderStateEx,r=t._extInfo,i=e.grid.wijgrid.CSS,s=this._wijgrid.options.wijCSS;r.state&n.hidden?t.$rows.css("display","none"):t.$rows.css("display","");if(t.type&e.grid.rowType.groupHeader){var o=this._wijgrid._groupedColumns()[t._extInfo.groupLevel-1].groupInfo,u=o.expandedImageClass||s.iconArrowRightDown,a=o.collapsedImageClass||s.iconArrowRight,f=e.grid.rowAccessor.getCell$(t.$rows,this._wijgrid.options.showRowHeader?1:0).find("."+i.groupToggleVisibilityButton);r.state&n.collapsed?(t.$rows.attr("aria-expanded",!1),t.$rows.removeClass(i.groupHeaderRowExpanded+" "+s.wijgridGroupHeaderRowExpanded).addClass(i.groupHeaderRowCollapsed+" "+s.wijgridGroupHeaderRowCollapsed),f.removeClass(u).addClass(a)):(t.$rows.attr("aria-expanded",!0),t.$rows.removeClass(i.groupHeaderRowCollapsed+" "+s.wijgridGroupHeaderRowCollapsed).addClass(i.groupHeaderRowExpanded+" "+s.wijgridGroupHeaderRowExpanded),f.removeClass(a).addClass(u))}},t.prototype._renderingStateFormatter=function(t,r,i){var s=e.grid.wijgrid.CSS,o=this._wijgrid.options.wijCSS,u,a=s.row+" "+o.wijgridRow+" "+o.content,f=e.grid.rowType,l=e.grid.renderStateEx,c;t.$rows.attr("role","row");if(r)for(c in r)r.hasOwnProperty(c)&&(c==="class"?t.$rows.addClass(r[c]):(t.$rows.attr(c,r[c]),t.$rows[0].style.height&&t.$rows.each(function(){return n.data(this,"customHeight",this.style.height),!0})));if(i)for(c in i)i.hasOwnProperty(c)&&t.$rows.css(c,i[c]);t._extInfo.groupLevel&&t.$rows.attr("aria-level",t._extInfo.groupLevel),t._extInfo.state&l.hidden&&t.$rows.css("display","none");switch(t.type&~f.dataAlt){case f.header:u=s.headerRow+" "+o.wijgridHeaderRow;break;case f.data:u=a+" "+s.dataRow+" "+o.wijgridDataRow,t.type&f.dataAlt&&(u+=" "+s.altRow+" "+o.wijgridAltRow);break;case f.emptyDataRow:u=a+" "+s.emptyDataRow+" "+o.wijgridEmptyDataRow;break;case f.filter:u=s.filterRow+" "+o.wijgridFilterRow;break;case f.groupHeader:t.$rows.attr({id:"GH"+t._extInfo.groupIndex+"-"+t._extInfo.groupLevel,"aria-expanded":(t._extInfo.state&l.collapsed)===0}),u=a+" "+s.groupHeaderRow+" "+o.wijgridGroupHeaderRow+" ",u+=t._extInfo.state&l.collapsed?s.groupHeaderRowCollapsed+" "+o.wijgridGroupHeaderRowCollapsed:s.groupHeaderRowExpanded+" "+o.wijgridGroupHeaderRowExpanded;break;case f.groupFooter:t.$rows.attr("id","GF"+t._extInfo.groupIndex+"-"+t._extInfo.groupLevel),u=a+" "+s.groupFooterRow+" "+o.wijgridGroupFooterRow;break;case f.footer:u=s.footerRow+" "+o.wijgridFooterRow+" "+o.stateDefault+" "+o.stateHighlight;break;default:throw e.grid.stringFormat("unknown rowType: {0}",t.type)}t.$rows.addClass(u)},t.prototype._currentStateFormatter=function(t,r){if(this._wijgrid._showRowHeader()){var i=this._wijgrid.options.wijCSS,s=e.grid.wijgrid.CSS;r?n(t.$rows[0].cells[0]).addClass(i.stateActive+" "+s.currentRowHeaderCell+" "+i.wijgridCurrentRowHeaderCell):n(t.$rows[0].cells[0]).removeClass(i.stateActive+" "+s.currentRowHeaderCell+" "+i.wijgridCurrentRowHeaderCell)}},t.prototype._hoveredStateFormatter=function(e,t){var n=this._wijgrid.options.wijCSS;t?e.$rows.addClass(n.stateDefault+" "+n.stateHover):e.$rows.removeClass(n.stateDefault+" "+n.stateHover)},t.prototype._selectedStateFormatter=function(e,t){t},t}();t.rowStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(){this._sum=0,this._sum2=0,this._cntNumbers=0,this._cntStrings=0,this._cntDates=0,this._max=0,this._min=0,this._minDate=0,this._maxDate=0}return e.prototype.add=function(e){if(e===null||e==="")return;var t,n=e instanceof Date?"datetime":typeof e;t=e.toString(),this._cntStrings++===0&&(this._minString=this._maxString=t),t<this._minString&&(this._minString=t),t>this._maxString&&(this._maxString=t),n==="number"?(this._cntNumbers++===0&&(this._min=this._max=e),this._sum+=e,this._sum2+=e*e,e<this._min&&(this._min=e),e>this._max&&(this._max=e)):n==="datetime"&&(t=e.getTime(),this._cntDates++===0&&(this._minDate=this._maxDate=t),t<this._minDate&&(this._minDate=t),t>this._maxDate&&(this._maxDate=t))},e.prototype.getValueString=function(e){var t=e.owner;if(!this._cntNumbers||e.dataType!=="number"&&e.dataType!=="currency"){if(this._cntDates&&e.dataType==="datetime")switch(e.aggregate){case"max":return t.toStr(e,new Date(this._maxDate));case"min":return t.toStr(e,new Date(this._minDate));case"count":return this._cntStrings+""}if(this._cntStrings)switch(e.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings+""}return""}var n=this._getValue(e.aggregate);return t.toStr(e,n)},e.prototype._getValue=function(e){switch(e){case"average":return this._cntNumbers===0?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("var"));case"stdPop":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("varPop"));case"var":if(this._cntNumbers<=1)return 0;return this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var t=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-t*t}return 0},e}();e.tally=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._docEventsUID="wijgridfrozener"+e.grid.getUID(),this._docEventsAttached=!1,this._newStaticIndex=-1,this._staticColumnIndex=-1,this._staticRowIndex=-1,this._staticOffsetH=0,this._staticOffsetV=0,this._inProgress=!1,this._wijgrid=t,this.refresh()}return t.prototype.inProgress=function(){return this._inProgress},t.prototype.refresh=function(){this.dispose();var t=this._wijgrid.options.freezingMode;if(t!=="none"){this._$outerDiv=this._wijgrid.outerDiv.find("."+e.grid.wijgrid.CSS.fixedView),this._superPanel=this._wijgrid._view()._getSuperPanel(),this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(!1),this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(!0),this._staticColumnIndex=this._wijgrid._getStaticIndex(!1),this._staticRowIndex=this._wijgrid._getStaticIndex(!0),this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds();var n=e.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),r=e.grid.bounds(this._$outerDiv);(t==="both"||t==="columns")&&(this._wijgrid.options.staticColumnsAlignment!=="right"||this._staticColumnIndex>=0)&&this._createVBar(this._visibleBounds,n,r),(t==="both"||t==="rows")&&!this._wijgrid._serverSideVirtualScrolling()&&this._createHBar(this._visibleBounds,n,r)}},t.prototype.dispose=function(){this._$hBar&&(this._$hBar.remove(),this._$hBar=null),this._$vBar&&(this._$vBar.remove(),this._$vBar=null),this._$proxy&&(this._$proxy.remove(),this._$proxy=null),this._$outerDiv=null,this._superPanel=null,this._detachDocEvents()},t.prototype._createVBar=function(t,r,i){var s=this._wijgrid.options.staticColumnsAlignment!=="right",o=s?r.width+r.left:r.left-2,u=this,a=e.grid.wijgrid.CSS,f=this._wijgrid.options.wijCSS;o<=t.left+t.width&&(this._$vBar=n("<div><div></div></div>").addClass(a.freezingHandleV+" "+f.wijgridFreezingHandleV).addClass(s?"":"not-allowed").css({left:o-i.left,top:r.top-i.top,height:t.height+t.top-r.top}).bind("mousedown",function(e){e.data=!0,u._onBarMouseDown.apply(u,arguments)}).appendTo(this._$outerDiv),this._$vBar.find("div").addClass(a.freezingHandleContent+" "+f.header))},t.prototype._createHBar=function(t,r,i){var s=r.top+r.height,o=this._wijgrid.options.staticColumnsAlignment!=="right",u=this,a=e.grid.wijgrid.CSS,f=this._wijgrid.options.wijCSS;s<=t.top+t.height&&(this._$hBar=n("<div><div></div></div>").addClass(a.freezingHandleH+" "+f.wijgridFreezingHandleH).css({left:o?r.left-i.left:0,top:s-i.top,width:o?t.width+t.left-r.left:t.width}).bind("mousedown",function(e){e.data=!1,u._onBarMouseDown.apply(u,arguments)}).appendTo(this._$outerDiv),this._$hBar.find("div").addClass(a.freezingHandleContent+" "+f.header))},t.prototype._onBarMouseDown=function(t){if(this._wijgrid.options.disabled||this._wijgrid.options.staticColumnsAlignment==="right"&&t.data)return!1;var r=e.grid.wijgrid.CSS,i=this._wijgrid.options.wijCSS;this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds(),this._newStaticIndex=t.data?this._staticColumnIndex:this._staticRowIndex,this._$proxy=n('<div class="'+r.resizingHandle+" "+i.wijgridResizingHandle+" "+i.header+'"></div>').appendTo(document.body),this._attachDocEvents(t.data),this._inProgress=!0,t.stopPropagation()},t.prototype._onDocumentMouseMove=function(e){e.data&&this._superPanel.options.hScroller.scrollValue?this._superPanel.hScrollTo(0):!e.data&&this._superPanel.options.vScroller.scrollValue&&this._superPanel.vScrollTo(0),this._showPosition(e)},t.prototype._onDocumentMouseUp=function(e){try{this._$proxy&&this._$proxy.remove(),this._detachDocEvents(),e.data?this._newStaticIndex!==this._staticColumnIndex&&this._wijgrid.option("staticColumnIndex",this._newStaticIndex):this._newStaticIndex!==this._staticRowIndex&&this._wijgrid.option("staticRowIndex",this._newStaticIndex)}finally{this._$proxy=null,this._inProgress=!1}},t.prototype._attachDocEvents=function(e){if(!this._docEventsAttached)try{n.fn.disableSelection&&n(document.body).disableSelection(),this._wijgrid._view().toggleDOMSelection(!1),n(document).bind(this._docEventKey("mousemove"),e,n.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),e,n.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=!0}},t.prototype._detachDocEvents=function(){if(this._docEventsAttached)try{n.fn.enableSelection&&n(document.body).enableSelection(),this._wijgrid._view().toggleDOMSelection(!0),n(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=!1}},t.prototype._docEventKey=function(t){return e.grid.stringFormat("{0}.{1}",t,this._docEventsUID)},t.prototype._showPosition=function(t){var n,r,i,s,o,u,a,f,l=this._wijgrid.options.staticColumnsAlignment!=="right";if(t.data){f=e.grid.bounds(this._$vBar);if(Math.abs(t.pageX-(f.left+f.width/2))<f.width){this._$proxy.hide();return}if(n=this._getFieldByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n.element),i=r.left+r.width/2,s=n.options.visLeavesIdx-this._staticOffsetV,o=Math.max(s-1,-1),u=t.pageX<i?o!==this._staticColumnIndex:s===this._staticColumnIndex,a=u?r.left:r.left+r.width;if(!e.grid.isOverAxis(a,this._visibleBounds.left-1,this._visibleBounds.width+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:a,top:r.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-r.top})}}else{f=e.grid.bounds(this._$hBar);if(Math.abs(t.pageY-(f.top+f.height/2))<f.height){this._$proxy.hide();return}if(n=this._getRowByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n),i=r.top+r.height/2,s=this._wijgrid._view().getAbsoluteRowIndex(n)-this._staticOffsetH,o=Math.max(s-1,-1),u=t.pageY<i?o!==this._staticRowIndex:s===this._staticRowIndex,a=u?r.top:r.top+r.height;if(!e.grid.isOverAxis(a,this._visibleBounds.top-1,this._visibleBounds.height+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:l?r.left:this._visibleBounds.left,top:a,width:l?this._visibleBounds.width+this._visibleBounds.left-r.left:this._visibleBounds.width,height:3})}}},t.prototype._getFieldByPos=function(t){var n=this._wijgrid.columns(),r,i,s,o,u;for(r=0,i=n.length;r<i;r++){s=n[r],o=s.options;if(o.isLeaf){u=e.grid.bounds(s.element);if(e.grid.isOverAxis(t.x,u.left,u.width))return s}}return null},t.prototype._getRowByPos=function(t){var r=this._wijgrid._rows(),i,s,o,u;for(i=0,s=r.length();i<s;i++){o=r.item(i)[0],u=e.grid.bounds(n(o));if(e.grid.isOverAxis(t.y,u.top,u.height))return o}return null},t}();t.uiFrozener=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t.generate=function(r,i,s){switch(r){case"append":t._processAppendMode(i,s);break;case"merge":t._processMergeMode(i,s);break;case"none":break;default:throw e.grid.stringFormat('Unsupported value: "{0}"',r)}},t._processAppendMode=function(i,s){var o={};e.grid.traverse(s,function(t){t.dynamic&&e.grid.validDataKey(t.dataKey)&&(o[t.dataKey]=!0)}),n.each(i,function(e,n){if("name"in n&&!o[n.name]){var r=t._createAutoField(n);s.push(r)}})},t._processMergeMode=function(i,s){var o=[],u;e.grid.traverse(s,function(t){if(t.isLeaf&&!t.isBand){var n=t.dataKey;e.grid.validDataKey(n)?i[n]!==undefined&&delete i[n]:n!==null&&o.push(t)}}),o.length&&(u=0,n.each(i,function(e,t){var n=o[u++];n&&(n.dataKey=t.name,delete i[e])})),n.each(i,function(e,n){var r=t._createAutoField(n);s.push(r)})},t._createAutoField=function(n){return e.grid.createDynamicField({dataKey:n.name})},t}();t.columnsGenerator=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n,r){this._timer=0,this._timeout=50,this._ignoreScrollEvents=!1,this._debounceScrolledEvent=!0,this._wijgrid=e,this._$content=t,this._view=this._wijgrid._view(),this._N=this._wijgrid._renderableRowsCount(),this._rowOuterHeight=r,this._updateContentHeight();var i=this._wijgrid.outerDiv.height()+this._N*this._rowOuterHeight;this._view._splitAreas.sw.height(i)}return e.prototype.scrollTo=function(e,t){this._debounceScrolledEvent=!1,this._completeListener=t,this._panelInst.vScrollTo(e*this._panelInst.options.vScroller.scrollSmallChange,!0)},e.prototype._updateContentHeight=function(){this._$content.height(this._rowOuterHeight*this._N)},e.prototype.attach=function(e){this._$scroller=e,this._panelInst=e.data("wijmo-wijsuperpanel"),this._updateContentHeight(),this._updateVerticalScroller(),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelScrolled,this)),e.bind("wijsuperpanelscrolling.wijgrid",t.proxy(this._onSuperpanelScrolling,this)),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelPostScrolled,this))},e.prototype._updateVerticalScroller=function(){var e=Math.max(0,this._N-(this._view.getVirtualPageSize()-1));this._setVerticalScrollerOptions(1,e)},e.prototype._setVerticalScrollerOptions=function(e,t){var n=this._panelInst.options.vScroller;n.scrollSmallChange=e,n.scrollLargeChange=e*4,t+=n.scrollLargeChange-1,n.scrollMax=t,this._panelInst.option("vScroller",n);if(!this._view._isNativeSuperPanel()&&this._panelInst._scrollDrag!=undefined){var r=this._panelInst._fields(),i=r.vbarContainer,s=r.vbarDrag;this._panelInst._scrollDrag("v",i,s,!1)}},e.prototype._changeVisibleRowsCount=function(e){this._N=e,this._updateContentHeight(),this._updateVerticalScroller()},e.prototype.dispose=function(){this._$scroller.unbind(".wijgrid"),this._clearTimer()},e.prototype._clearTimer=function(){window.clearTimeout(this._timer),this._timer=0},e.prototype._onSuperpanelScrolling=function(e,t){if(this._ignoreScrollEvents||t.dir!=="v")return;if(this._timer===-1)return!1},e.prototype._onSuperpanelScrolled=function(e,n){var r=this;if(this._ignoreScrollEvents||n.dir!=="v")return;this._timer>0&&this._clearTimer(),this._timer!==-1&&(this._timer=window.setTimeout(function(){r._timer=-1;var e=Math.floor(n.newValue/r._panelInst.options.vScroller.scrollSmallChange),i=r._view._bounds.start;e<0&&(e=0),e>=r._N&&(e=r._N-1),e!==i?(r._debounceScrolledEvent=!0,r._wijgrid._handleVirtualScrolling(e,null,t.proxy(r._scrollingCompleted,r))):(r._debounceScrolledEvent=!0,r._log(),r._clearTimer())},this._debounceScrolledEvent?this._timeout:0))},e.prototype._scrollingCompleted=function(e){this._wijgrid._trackScrollingIndex(e),this._log(),this._completeListener&&(this._completeListener(),this._completeListener=null),this._clearTimer()},e.prototype._onSuperpanelPostScrolled=function(){t.isFunction(this._postScrolled)&&this._postScrolled.apply(this,arguments)},e.prototype._log=function(){},e}();e.uiVirtualScroller=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function e(e){this._items=[],this._capacity=null,this._maxRowIndex=e}return e.prototype.add=function(e){this._capacity=null;var t=this._items.length,n;if(!t||(n=this._items[t-1]).end<e.start)t&&e.start-n.end===1?n.end=e.end:this._items.push(e);else{var r=this._binSearchByStartVal(e.start),i=this._binSearchByEndVal(e.end),s=r<0?~r:r,o=i<0?~i:i,u=r>=0||s>0&&e.start<=this._items[s-1].end,a=i>=0||o<t&&e.end<=this._items[o].end&&e.end>=this._items[o].start,f;u?a?r>=0?(this._items[o].start=this._items[s].start,(f=o-s)&&this._items.splice(s,f)):(this._items[o].start=this._items[s-1].start,(f=o-s+1)&&this._items.splice(s-1,f)):r>=0?(this._items[s].end=e.end,(f=o-s-1)&&this._items.splice(s,f)):(this._items[s-1].end=e.end,(f=o-s)&&this._items.splice(s,f)):a?(this._items[o].start=e.start,(f=o-s)&&this._items.splice(s,f)):this._items.splice(s,o-s,e)}},e.prototype.remove=function(e){this._capacity=null;var t=this._items.length;if(t){var n=this._binSearchByStartVal(e.start),r=this._binSearchByEndVal(e.end),i=n<0?~n:n,s=r<0?~r:r,o=n>=0||i>0&&e.start<=this._items[i-1].end,u=r>=0||s<t&&e.end<=this._items[s].end&&e.end>=this._items[s].start;if(o)if(u){var a=n>=0?n:i-1,f=r>=0?r:s;if(n>=0&&r>=0)this._items.splice(i,s-i+1);else if(n>=0)this._items[s].start=e.end+1,this._items.splice(i,s-i);else if(r>=0)a===f?this._items[i-1].end=e.start-1:(this._items[i].end=e.start-1,this._items.splice(i,s-i+1));else if(a===f){var l=this._items[i-1].end;this._items[i-1].end=e.start-1,this._items.splice(i,0,{start:e.end+1,end:l})}else this._items[i-1].end=e.start-1,this._items[s].start=e.end+1,this._items.splice(i,s-i)}else n>=0?this._items.splice(i,s-i):(this._items[i].end=e.start-1,this._items.splice(i,s-i-1));else u?r>=0?this._items.splice(i,s-i+1):(this._items[s].start=e.end+1,this._items.splice(i,s-i)):this._items.splice(i,s-i)}},e.prototype.clear=function(){this._capacity=0,this._items=[]},e.prototype.item=function(e){return this._items[e]},e.prototype.forEachIndex=function(e,t,n){if(e<0)return;var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0,u=!1;if(i){var a=i.j;for(var f=i.i;f<r&&!u;f++){var l=this._items[f];o||(a=l.start);for(a;a<=l.end&&!u;a++){if(++s>t&&t!==-1)return;u=n(a)===!1}o=!1}}},e.prototype.forEachIndexBackward=function(e,t,n){if(e<0)return;var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0,u=!1;if(i){var a=i.j;for(var f=i.i;f>=0&&!u;f--){var l=this._items[f];o||(a=l.end);for(a;a>=l.start&&!u;a--){if(++s>t&&t!==-1)return;u=n(a)===!1}o=!1}}},e.prototype._getIteratorStateFor=function(e){var t=this._items.length,n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1;var s=n-e;if(s>=0)return{i:r,j:i.end-s+1}}return null},e.prototype.getAbsIndex=function(e){for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t],i=r.end-r.start;if(e<=i)return r.start+e;e-=i+1}return-1},e.prototype.getRenderedIndex=function(e){var t=this.hasAbsIndex(e);if(t>=0){var n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1}return n+(e-this._items[t].start)}return-1},e.prototype.hasAbsIndex=function(e){if(this._items.length){var t=this._binSearchByStartVal(e);if(t>=0)return t;t=~t;if(t>0&&e<=this._items[t-1].end)return t-1}return-1},e.prototype.length=function(){return this._items.length},e.prototype.capacity=function(){if(this._capacity===null){var e=0;for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t];e+=r.end-r.start+1}this._capacity=e}return this._capacity},e.prototype.truncate=function(e,t){this.truncateByStart(e),this.truncateByStart(t)},e.prototype.truncateByCount=function(e){var t=0;if(e===0)this._items=[];else for(var n=0,r=this._items.length;n<r;n++){var i=this._items[n];t+=i.end-i.start+1;if(t>=e){t>e&&(i.end-=t-e),this._items.splice(n+1,this._items.length-(n+1));break}}},e.prototype.truncateByStart=function(e,t){var n=this._binSearchByStartVal(e),r=this._items.length;n<0?(n=~n,n<r?n>0&&this._items[n-1].end>=e?(this._items[n-1].start=e,this._items.splice(0,n-1)):(t&&(this._items[n].start=e),this._items.splice(0,n)):this._items=[]):this._items.splice(0,n)},e.prototype.truncateByEnd=function(e,t){var n=this._binSearchByEndVal(e),r=this._items.length;n<0?(n=~n,n<r?(this._items[n].end=e,this._items.splice(n+1,this._items.length-n+1)):this._items=[]):this._items.splice(n+1,this._items.length-n+1)},e.prototype.deleteFromTop=function(e){var t=0,n=0;for(t=0;t<this._items.length;t++){var r=this._items[t];n+=r.end-r.start+1;if(n>=e)break}n>=e&&(this._items[t].start=n-e+1),this._items.splice(0,t)},e.prototype.deleteFromBottom=function(e){var t=0,n=0;for(t=this._items.length-1;t>=0;t--){var r=this._items[t];n+=r.end-r.start+1;if(n>=e)break}n>=e&&(this._items[t].start=n-e+1),this._items.splice(t,this._items.length-t)},e.prototype._binSearchByStartVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].start-e;if(i===0)return r;i<0?t=r+1:n=r-1}return~t},e.prototype._binSearchByEndVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].end-e;if(i<0)t=r+1;else{if(!i)return r;n=r-1}}return~t},e}();e.renderBoundsCollection=t})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(n,r,i,s){function u(t){return s.parser=s.parser||e.defaultParsers[t],!s.parser&&n!=null&&e.errors.noParser(t),s.parser}var o=n;s=t.extend({nullString:"",format:""},s),r=r||n!=null&&typeof n,i=i||r;if(!i)return n;if(i=="string")return u(r),s.parser?s.parser.toStr(n,s.culture,s.format,s.nullString,!0):n;u(i);if(!s.parser)return n;n=s.parser.parse(n,s.culture,s.format,s.nullString,!0);if(isNaN(n)&&n!=null&&e.util.isNumeric(n)){if(s.ignoreError)return o;e.errors.cantConvert(i,o)}return n}function i(t){return function(){return n||e.util.logError(e.errors.noGlobalize.create().message),t.apply(this,arguments)}}var t=jQuery,n=Globalize;e.convert=r,e.defaultParsers={string:{parse:function(e,t,n,r,i){switch(e){case null:return null;case r:if(i)return null;case undefined:case"&nbsp":return"";default:return""+e}},toStr:function(e,t,n,r,i){return e===null&&i?r:""+e}},number:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:n.parseFloat(e,10,t.name)},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"n",t.name)}},currency:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:(o==="string"&&(e=e.replace(t.numberFormat.currency.symbol,"")),n.parseFloat(e,10,t.name))},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"c",t.name)}},datetime:{parse:function(e,t,r,i,s){var o;if(e instanceof Date)return e;if(!e||e==="&nbsp;"||e===i&&s)return null;o=/^\/Date\((\d+)\)\/$/.exec(e);if(o)return new Date(parseInt(o[1],10));var u=n.parseDate(e,r,t.name);if(u==null||isNaN(u))u=Date.parse(e),u=isNaN(u)?NaN:new Date(u);return u},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"d",t.name)}},"boolean":{parse:function(e,n,r,i,s){var o=typeof e;if(o==="number")return e!=0;if(o==="boolean")return e;o==="string"&&(e=t.trim(e));if(!e||e==="&nbsp;"||e===i&&s)return null;switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return NaN},toStr:function(e,t,n,r,i){return e===null&&i?r:e?"true":"false"}}},t.each(e.defaultParsers,function(e,t){t.parse=t.parse&&i(t.parse),t.toStr=t.toStr&&i(t.toStr)})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){(function(n){function r(r){function i(r){var s=[];if(r.length===0)return s;var o=n.Connective.AND;return e.util.each(r,function(r,u){if(r==0&&e.util.isString(u)){var a=u.toLowerCase();if(a==n.Connective.AND||a==n.Connective.OR){o=a;return}}if($.isArray(u)){u=i(u);if(!u)return;if(u[0]===o||u.length==2){u.shift(),s=s.concat(u);return}}else{var f=t.normalizeCondition(u);if(!f)return;f.property=u.property,u=f}s.push(u)}),s.length==0?null:(s.unshift(o),s)}return i(r)}function i(t){if(!$.isArray(t))return null;var i={isEmpty:!0,original:t,normalized:r(t),func:null};return i.normalized==null?i.func=function(e){return!0}:(i.isEmpty=!1,i.func=function(t){function r(i){var s=i[0]===n.Connective.AND,o=s?e.util.every:e.util.some;return o(i,function(n,i){if(i===0)return s;if($.isArray(n))return r(n);var o=e.util.getProperty(t,n.property);return n.op.apply(o,n.value)})}return r(i.normalized)}),i}function s(t){return i(t)||e.filtering.compile(t)}n.Connective={AND:"and",OR:"or"},n.compile=s})(t.extended||(t.extended={}));var n=t.extended})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=e.data,i=r.filtering.extended,s=function(){function e(e){this.real=e,this._updatingFilter=!1,this._overrideFilter(),this._makeMemberProxies()}return e.prototype._overrideFilter=function(){var e=this;this.filter=r.observable(this.real.filter()),this.filter.subscribe(function(t){e.real.filter()!==t&&!e._updatingFilter&&e.refresh({filter:t})}),this.real.filter.subscribe(function(t){t!==e._lastSetFilter&&e.filter(t)})},e.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1),e=n.extend({},e);var r=e.filter;e.filter=this._coerceFilter(e.filter),this._lastSetFilter=e.filter,this._updatingFilter=!0;try{n.isFunction(e.filter)&&!n.isFunction(r)?this.filter(r):this.filter(e.filter)}finally{this._updatingFilter=!1}return this.real.refresh(e,t)},e.prototype._makeMemberProxies=function(){var e=this;r.util.each(this.real,function(t,r){if(!n.isFunction(r)||e[t]||t.charAt(0)==="_")return;e[t]=n.isFunction(r.subscribe)?r:function(){return r.apply(e.real,arguments)}})},e.create=function(n){return new e(n)},e.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(e){var t=[];return n.each(e,function(e,s){if(!n.isArray(s))s=[s];else{var o=r.util.isString(s[0])&&s[0].toLowerCase();if(o===i.Connective.AND||o===i.Connective.OR){t.push(s);return}}var u=[];n.each(s,function(t,n){var i=r.filtering.normalizeCondition(n);i&&(i.property=e,u.push(i))}),u.length>0&&t.push(u)}),t.length>0?t:null},e.prototype._coerceFilter=function(e){if(n.isArray(e))return i.compile(e).func;if(!n.isPlainObject(e))return e;e=n.extend(!0,{},e);var t={};n.each(e,function(i,s){n.isArray(s)||(s=[s]);if(t){var o=r.util.isString(s[0])&&s[0].toLowerCase();if(s.length==1||s.length==2&&(o==="and"||o==="or")){t[i]=s[s.length-1];return}}e[i]=s,t=null});if(t)return t;var s=this._convertComplexPropertyFilterToExtendedFilterFormat(e);return i.compile(s).func},e.prototype._unsafeReplace=function(e,t){this.real.sourceArray[e]=t,this.real.local[e]=t},e.prototype._unsafeSplice=function(e,t,n){arguments.length===2?(this.real.sourceArray.splice(e,t),this.real.local.splice(e,t)):(this.real.sourceArray.splice(e,t,n),this.real.local.splice(e,t,n))},e.prototype._unsafePush=function(e){this.real.sourceArray.push(e),this.real.local.push(e)},e}();t.GridDataView=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=function(t){function n(e){this.mObservableArray=e;var n=ko.utils.unwrapObservable(this.mObservableArray);t.call(this,n,null)}return __extends(n,t),n.validSource=function(t){return!!(ko&&ko.isObservable(t)&&$.isFunction(t.slice))},n.prototype.refresh=function(n,r){typeof r=="undefined"&&(r=!1),this.sourceArray=ko.utils.unwrapObservable(this.mObservableArray),this.mPlainArray=ko.toJS(this.sourceArray);var i=n&&n.pageSize!==undefined?n.pageSize:this.pageSize(),s=n&&n.pageIndex!==undefined?n.pageIndex:this.pageIndex();if(i>0&&s>0){var o=e.data.util.pageCount(this.sourceArray.length,i);s>=o&&(s=Math.max(0,o-1),n||(n={}),n.pageIndex=s)}return t.prototype.refresh.apply(this,[n,r])},n.prototype.getPlainSource=function(){return this.mPlainArray},n.prototype.dispose=function(){this.mObservableArray=null,this.mPlainArray=null,t.prototype.dispose.apply(this,arguments)},n}(e.data.ArrayDataView);t.koDataView=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));;
var wijmo;(function(e){var t=jQuery,n=function(){function e(){}return e.prototype.round=function(e,t){if(!e)return 0;var n=Math.pow(10,t||2);return Math.round(e*n)/n},e.prototype.toOADate=function(e){var t=864e5,n=e-new Date(1900,0,1)+2*t;return n},e.prototype.fromOADate=function(e){var t=864e5,n=new Date(e-2*t+(new Date(1900,0,1)).getTime());return n},e.prototype.arrayClone=function(e){var n=[];return t.each(e,function(e,r){n.push(t.extend(!0,{},r))}),n},e}(),r=function(){function e(){}return e.prototype.isSVGElem=function(e){var t="http://www.w3.org/2000/svg";return e.nodeType===1&&e.namespaceURI===t},e.prototype.addClass=function(e,n){n=n||"";var r=this;t.each(e,function(){if(r.isSVGElem(this)){var e=this;t.each(n.split(/\s+/),function(n,r){var i=e.className?e.className.baseVal:e.getAttribute("class");t.inArray(r,i.split(/\s+/))===-1&&(i+=(i?" ":"")+r,e.className?e.className.baseVal=i:e.setAttribute("class",i))})}else t(this).addClass(n)})},e.prototype.clearRaphaelCache=function(){},e.prototype.getPositionByAngle=function(e,t,n,r){var i={x:0,y:0},s=Raphael.rad(r);return i.x=e+n*Math.cos(-1*s),i.y=t+n*Math.sin(-1*s),i},e.prototype.hasClass=function(e,n){if(!n||n.length===0)return!1;if(this.isSVGElem(e)){var r=e.className?e.className.baseVal:e.getAttribute("class"),i=!1;return t.each(r.split(/\s+/),function(e,t){if(t===n)return i=!0,!1}),i}return t(e).hasClass(n)},e.prototype.sector=function(e,t,n,r,i){var s=this.getPositionByAngle(e,t,n,r),o=this.getPositionByAngle(e,t,n,i);return["M",e,t,"L",s.x,s.y,"A",n,n,0,+(i-r>180),0,o.x,o.y,"z"]},e}();t.extend(n.prototype),t.extend({wijraphael:r.prototype});var i="[\\x20\\t\\r\\n\\f]",s=t.expr.filter.CLASS,o=function(e,t){var n=e.split("."),r=t.split("."),i=Math.max(n.length,r.length),s=0,o,u,a;for(o=0;o<i;o++){u=n[o]?parseInt(n[o]):0,a=r[o]?parseInt(r[o]):0;if(u>a){s=1;break}if(u<a){s=-1;break}}return s};t.expr.filter.CLASS=function(e,n){if(o(t.fn.jquery,"1.8")<0){var r=!t.wijraphael||!t.wijraphael.isSVGElem(e)?e.className:e.className?e.className.baseVal:e.getAttribute("class");return(" "+r+" ").indexOf(n)>-1}var s=new RegExp("(^|"+i+")"+e+"("+i+"|$)");return function(e){var n=!t.wijraphael||!t.wijraphael.isSVGElem(e)?e.className:e.className?e.className.baseVal:e.getAttribute("class");return s.test(n)}},o(t.fn.jquery,"1.8")<0&&(t.expr.preFilter.CLASS=function(e,n,r,i,s,o){var u=0,a=null,f=null;e=" "+e[1].replace(/\\/g,"")+" ";if(o)return e;for(u=0,a={};a;u++){a=n[u];if(!a)try{a=n.item(u)}catch(l){}a&&(f=!t.wijraphael||!t.wijraphael.isSVGElem(a)?a.className:(a.className?a.className.baseVal:"")||a.getAttribute("class"),s^(f&&(" "+f+" ").indexOf(e)>-1)?r||i.push(a):r&&(n[u]=!1))}return!1}),Raphael.fn.tri=function(e,t,n){var r=e,i=t-n,s=Math.cos(30*Math.PI/180)*n,o=Math.tan(60*Math.PI/180)*s,u=e+s,a=t+o,f=e-s,l=t+o,c=["M",r.toString(),i.toString(),"L",u.toString(),a.toString(),"L",f.toString(),l.toString(),"z"];return this.path(c.join(" "))},Raphael.fn.invertedTri=function(e,t,n){var r=e,i=t+n,s=Math.cos(30*Math.PI/180)*n,o=Math.tan(60*Math.PI/180)*s,u=e+s,a=t-o,f=e-s,l=t-o,c=["M",r.toString(),i.toString(),"L",u.toString(),a.toString(),"L",f.toString(),l.toString(),"z"];return this.path(c.join(" "))},Raphael.fn.box=function(e,t,n){var r=Math.cos(45*Math.PI/180)*n,i=["M",e-r,t-r,"L",e+r,t-r,"L",e+r,t+r,"L",e-r,t+r,"z"];return this.path(i.join(" "))},Raphael.fn.diamond=function(e,t,n){var r=["M",e,t-n,"L",e+n,t,"L",e,t+n,"L",e-n,t,"z"];return this.path(r.join(" "))},Raphael.fn.cross=function(e,t,n){var r=Math.cos(45*Math.PI/180)*n,i=["M",e-r,t-r,"L",e+r,t+r,"M",e-r,t+r,"L",e+r,t-r];return this.path(i.join(" "))},Raphael.fn.paintMarker=function(e,t,n,r){var i=this,s=null;e||(e="circle");switch(e){case"circle":s=i.circle(t,n,r);break;case"tri":s=i.tri(t,n,r);break;case"invertedTri":s=i.invertedTri(t,n,r);break;case"box":s=i.box(t,n,r);break;case"diamond":s=i.diamond(t,n,r);break;case"cross":s=i.cross(t,n,r)}return s},Raphael.fn.htmlText=function(e,n,r,i,s,o){var u=function(e,t,n){var r=/<(b|strong)>/,i=/<(i|em)>/,s=/href=[\"\']([^\"\']+)[\"\']/,o=/<a/;n&&e.attr(n),r.test(t)&&e.attr("font-weight","bold"),i.test(t)&&e.attr("font-style","italic"),o.test(t)&&t.match(s)[1]&&e.attr("href",t.match(s)[1])},a=r.toString().split(/<br\s?\/>|\\r/i),f=this,l=f.set(),c=0,h=0;return s=s||3,o=o||5,t.each(a,function(e,n){var r=0,a=n.split("|||");n=n.replace(/<([A-Za-z]+(.|\n)*?)>/g,"|||<$1>").replace(/<\/([A-Za-z]*)>/g,"</$1>|||"),t.each(a,function(e,n){var o=null,a=null,p=0,d,v=0;n!==""&&(o=n,o=t.trim(o.replace(/<(.|\n)*?>/g,"")),d=f.text(0,0,o),u(d,n,i),a=d.wijGetBBox(),p=a.width/2+c,v=-a.height/2+h,c=c+a.width+s,d.translate(p,v),l.push(d),r<a.height&&(r=a.height))}),h+=r+o,c=r=0}),h=0,l.transform(Raphael.format("...t{0},{1}",e-l.getBBox().x,n-l.getBBox().y)),l},Raphael.fn.line=function(e,t,n,r){return this.path(["M",e.toString(),t.toString(),"L",n.toString(),r.toString()])},Raphael.fn.roundRect=function(e,n,r,i,s,o,u,a){var f=[],l=[-1,1,1,1,1,-1,-1,-1],c=["v","h","v","h"],h=null,p=null;return t.each([s,o,u,a],function(e,t){typeof t=="number"?f=f.concat([{x:t,y:t}]):typeof t=="object"?f=f.concat(t):f=f.concat([{x:0,y:0}])}),h=["M",e+f[0].x,n],p=[i-f[0].y-f[1].y,r-f[1].x-f[2].x,f[2].y+f[3].y-i,f[3].x+f[0].x-r],t.each(f,function(e,t){t.x&&t.y&&(h=h.concat("a",t.x,t.y,0,0,0,l[2*e]*t.x,l[2*e+1]*t.y)),h=h.concat(c[e],p[e])}),h.push("z"),this.path(h)},Raphael.fn.wrapText=function(e,n,r,i,s,o){function v(e,t,n){var r=null,i=null,s=e.toString().split(" "),o=[],a=[],f="";while(s.length)f+=" "+s[0],r=u.text(-1e3,-1e3,f),r.attr(n),i=r.wijGetBBox(),i.width>t?(a.length&&(o.push(a),f=s[0]),a=[s.shift()]):a.push(s.shift()),s.length===0&&o.push(a),r.wijRemove(),r=null;return o}var u=this,a=o.rotation,f=a?t.extend(!0,{},o,{rotation:0}):o,l=n,c=u.set(),h=null,p=null,d=[];return typeof r=="undefined"&&(r=""),t.each(v(r,i,f),function(t,n){var r=n.join(" "),o=s||"near",p=u.text(e,l,r),v=0,m=0;p.wijAttr(f,null),h=p.wijGetBBox();switch(o){case"near":v=i-h.width/2;break;case"center":v+=i/2;break;case"far":v+=h.width/2}a?(m+=h.height/2/Math.abs(Math.sin(a)),l+=h.height/Math.abs(Math.sin(a))):(m+=h.height/2,l+=h.height),h.x+=v,h.y+=m,a?p.attr({x:p.attr("x")+v,y:p.attr("y")+m}):p.transform(Raphael.format("...T{0},{1}",v,m)),c.push(p),d.push(h)}),a&&(h=c.wijGetBBox(),c.length>1?(t.each(c,function(e,t){t.attr({y:t.attr("y")-h.height/2}),d[e].y-=h.height/2}),p={x:h.x+h.width/2,y:h.y+h.height/2},t.each(c,function(e,n){var r=Math,i=d[e],s={x:i.x+i.width/2,y:i.y+i.height/2},o=r.sqrt(r.pow(s.x-p.x,2)+r.pow(s.y-p.y,2)),u=0,f=null,l=null;n.attr({rotation:a});if(o===0)return!0;f=n.wijGetBBox(),u=Raphael.deg(r.asin(r.abs(s.y-p.y)/o)),s.y>p.y?s.x>p.x?u-=360:u=-1*(u+180):s.x>p.x?u*=-1:u=-1*(180-u),l=t.wijraphael.getPositionByAngle(p.x,p.y,o,-1*(a+u)),n.attr({y:n.attr("y")+l.y-f.y-f.height/2})})):c[0].transform(Raphael.format("...R{0}",a))),c},Raphael.fn.getSVG=function(){function e(e,n){var r="<"+e+" ",i=null,s=!1;return t.each(n,function(e,t){if(e==="text"||e==="opacity"||e==="transform"||e==="path"||e==="w"||e==="h"||e==="translation")return!0;t&&(e==="stroke"&&t===0&&(t="none"),r+=e+"='"+t+"' ")}),n.opacity&&(i=n.opacity,r+="opacity='"+i+"' style='opacity:"+i+";",s=!0),n.transform&&n.transform.length>0&&(i=n.transform,s?r+="transform:"+i:(r+="style='transform:"+i,s=!0)),s&&(r+="'"),n.text?(i=n.text,r+="><tspan>"+i+"</tspan>"):r+=">",r+="</"+e+">",r}var n=this,r='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+n.canvas.offsetWidth+'" height="'+n.canvas.offsetHeight+'"><desc>Created with Raphael</desc><defs></defs>',i,s="",o,u,a,f=0,l=0,c=0,h=0;for(i=n.bottom;i;i=i.next)if(i&&i.type)switch(i.type){case"path":for(f=0,l=i.attrs.path.length;f<l;f++){u=i.attrs.path[f];for(c=0,h=u.length;c<h;c++)a=u[c],c<1?s+=a:c===h-1?s+=a:s+=a+","}s&&s.length>0&&(i.attrs.d=s.replace(/,/g," "));break;case"text":i.attrs["text-anchor"]||(i.attrs["text-anchor"]="middle");break;case"image":o=i.transformations,i.attrs.transform=o?o.join(" "):"";break;case"ellipse":case"rect":r+=e(i.type,i.attrs)}return r+="</svg>",r},Raphael.fn.group=function(){function n(){var n,r=e.set(),i=e.raphael.vml?document.createElement("group"):document.createElementNS("http://www.w3.org/2000/svg","g");return e.canvas.appendChild(i),n={type:"group",node:i,paper:e,attrs:{},_:{},id:Raphael.createUUID(),push:function(e){function n(e){var t;if(e.type==="set")for(t=0;t<e.length;t++)n(e[t]);else i.appendChild(e.node),r.push(e)}return arguments.length>1?t.each(arguments,function(e,t){n(t)}):n(e),this},getBBox:function(){return r.getBBox()}},t.each(["attr","stop","animate","wijAnimate","remove","wijRemove"],function(e,t){n[t]=function(){if(Raphael.el[t])return Raphael.el[t].apply(this,arguments)}}),n}var e=this;return n()},Raphael.el.wijRemove=function(){var e=this,n;if(e.removed)return;e.node.parentNode&&(n=t(e.node),e.stop().remove(),n.remove())},Raphael.el.wijGetBBox=function(){return this.getBBox()},Raphael.el.wijAnimate=function(e,n,r,i){if(!e||t.isEmptyObject(e))return;var s=this.shadow,o=0,u={easeInCubic:">",easeOutCubic:"<",easeInOutCubic:"<>",easeInBack:"backIn",easeOutBack:"backOut",easeOutElastic:"elastic",easeOutBounce:"bounce"};u[r]&&(r=u[r]),this.animate(e,n,r,i),u=null,s&&s.offset&&(o=s.offset,e.x&&(e.x+=o),e.y&&(e.y+=o),this.shadow.animate(e,n,r,i))},Raphael.el.wijAttr=function(e,n){t.isPlainObject(e)?t.each(e,function(t,n){f(t,n,e)}):typeof e=="string"&&(e=f(e,n)),this.attr(e,n);if(this.shadow)if(typeof e=="object"){var r=t.extend(!0,{},e);r.fill&&delete r.fill,r.stroke&&delete r.stroke,r["stroke-width"]&&delete r["stroke-width"],this.shadow.attr(r,n)}else if(typeof e=="string")switch(e){case"clip-rect":case"cx":case"cy":case"fill-opacity":case"font":case"font-family":case"font-size":case"font-weight":case"height":case"opacity":case"path":case"r":case"rotation":case"rx":case"ry":case"scale":case"stroke-dasharray":case"stroke-linecap":case"stroke-linejoin":case"stroke-miterlimit":case"stroke-opacity":case"stroke-width":case"translation":case"width":this.shadow.attr(e,n);break;case"x":this.shadow.attr(e,n),this.shadow.attr("transform","...t1,0");break;case"y":this.shadow.attr(e,n),this.shadow.attr("transform","...t0,1");break;default:}},Raphael.st.wijRemove=function(){t.each(this,function(e,t){t.wijRemove&&!t.removed&&t.wijRemove()})},Raphael.st.wijAttr=function(e,n){return t.each(this.items,function(t,r){r.wijAttr(e,n)}),this},Raphael.st.wijAnimate=function(e,t,n,r){var i=0,s=0,o=null;for(i=0,s=this.items.length;i<s;i++)o=this.items[i],o.removed||o.wijAnimate(e,t,n,r);return this},Raphael.st.wijGetBBox=function(){var e=[],t=[],n=[],r=[],i,s,o=Math.max,u=Math.min,a="push",f="apply",l=null,c=0;for(c=this.items.length-1;c>=0;c--)l=this.items[c].wijGetBBox(),e[a](l.x),t[a](l.y),n[a](l.x+l.width),r[a](l.y+l.height);return i=u[f](0,e),s=u[f](0,t),{x:i,y:s,x2:undefined,y2:undefined,width:o[f](0,n)-i,height:o[f](0,r)-s}};var u=Raphael.el.attr,a=function(e,n){if(e==="width"||e==="height"||e==="r"){if(!isNaN(n)&&n<0)return 0}else e==="clip-rect"&&t.isArray(n)&&t.each(n,function(e,t){!isNaN(t)&&t<0&&(n[e]=0)});return n},f=function(e,t,n){var r=e.toLowerCase().replace(/^(font|stroke|clip|arrow|text|fill)(\w+)$/,"$1-$2");return n&&r!==e&&(delete n[e],n[r]=t),r};Raphael.el.attr=function(e,n){return t.isPlainObject(e)?t.each(e,function(t,n){e[t]=a(t,n)}):n=a(e,n),u.apply(this,arguments)}})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=jQuery,r=function(){function e(){}return e.getDiffAttrs=function(t,r){var i={};return n.each(r,function(e,n){if(typeof t=="undefined")return!0;typeof t[e]=="undefined"?i[e]=r[e]:t[e]!==r[e]&&(i[e]=r[e])}),i},e.paintShadow=function(t,r,i){if(t.removed||n(t.node).parent().length===0)return;var s=t.clone(),o=r||1,u=i||"#cccccc";s.insertBefore(t),s.attr({transform:Raphael.format("...T{0},{1}",o,o),stroke:u,fill:"none","stroke-width":o}),s.toBack(),s.offset=o,t.shadow=s},e.getScaling=function(t,n,r,i){var s=n-r;return s===0&&(s=1),t&&(s=-s),i/s},e.getTranslation=function(t,n,r,i,s){var o=0;return t?(o=n.y,o-=s*r):(o=n.x,o-=s*i),o},e.getXSortedPoints=function(t){function a(e,t){return e-t}var r=t.data.x,i=[].concat(r),s=[].concat(t.data.y),o=[],u=r;if(r===undefined||r.length===0)return;return typeof r[0]=="number"&&(u=[].concat(r).sort(a)),n.each(u,function(e,t){n.each(i,function(n,r){if(t===r)return typeof r!="number"&&(r=e),o.push({x:r,y:s[n]}),i.splice(n,1),s.splice(n,1),!1})}),o},e.sector=function(t,r,i,s,o){var u=n.wijraphael.getPositionByAngle(t,r,i,s),a=n.wijraphael.getPositionByAngle(t,r,i,o),f,l,c,h;return o>s?(c=o-s,h=c>180,h?(f=1,l=0):(f=+h,l=+h)):(c=s-o,h=c>180,h?(f=1,l=1):(f=+h,l=+!h)),["M",t,r,"L",u.x,u.y,"A",i,i,0,f,l,a.x,a.y,"z"]},e.donut=function(t,r,i,s,o,u){var a=n.wijraphael.getPositionByAngle(t,r,i,o),f=n.wijraphael.getPositionByAngle(t,r,i,u),l=n.wijraphael.getPositionByAngle(t,r,s,o),c=n.wijraphael.getPositionByAngle(t,r,s,u),h=u-o>180,p,d,v,m,g,y;return u>o?(g=u-o,y=g>180,y?(p=1,d=0,v=1,m=1):(p=0,d=0,v=0,m=1)):(g=o-u,y=g>180,y?(p=1,d=1,v=1,m=0):(p=0,d=1,v=0,m=0)),["M",a.x,a.y,"A",i,i,0,p,d,f.x,f.y,"L",c.x,c.y,"A",s,s,0,v,m,l.x,l.y,"L",a.x,a.y,"z"]},e.getFirstValidListValue=function(t){var r;return n.each(t,function(e,t){return t===null?!0:typeof t=="undefined"?!0:typeof t=="number"&&isNaN(t)?!0:(r=t,!1)}),r},e.getLastValidListValue=function(n){var r=[].concat(n).reverse();return e.getFirstValidListValue(r)},e.isHolefunction=function(t,n){return t===null?!0:typeof t=="undefined"?!0:typeof t=="number"&&isNaN(t)?!0:n===null?!1:typeof t!="undefined"?t-n===0?!0:!1:!1},e}();t.ChartUtil=r;var i=function(){function e(){}return e.roundTime=function(t,r,i){var s=this,o=r,u=n.fromOADate(t),a,f,l,c;return o>0?(a={year:u.getFullYear(),month:u.getMonth(),day:u.getDate(),hour:u.getHours(),minute:u.getMinutes(),second:u.getSeconds()},o<s.tmInc.minute?(a.second=s.tround(a.second,o,i),s.getTimeAsDouble(a)):(a.second=0,o<s.tmInc.hour?(o/=s.tmInc.minute,a.minute=s.tround(a.minute,o,i),s.getTimeAsDouble(a)):(a.minute=0,o<s.tmInc.day?(o/=s.tmInc.hour,a.hour=s.tround(a.hour,o,i),s.getTimeAsDouble(a)):(a.hour=0,o<s.tmInc.month?(o/=s.tmInc.day,a.day=s.tround(a.day,o,i),s.getTimeAsDouble(a)):(a.day=1,o<s.tmInc.year?(o/=s.tmInc.month,a.month=s.tround(a.month,o,i),s.getTimeAsDouble(a)):(a.month=0,o/=s.tmInc.year,a.year=s.tround(a.year,o,i),s.getTimeAsDouble(a))))))):(f=u,l=f-o,c=parseInt((l/r).toString(),10)*r,i&&c!==l&&(c+=r),f=o+c,f)},e.tround=function(t,n,r){var i=parseInt((t/n*n).toString(),10);return r&&i!==t&&(i+=parseInt(n,10)),i},e.getTimeAsDouble=function(t){var r=0,i=0,s=null;return t.day<1?(i=-1-t.day,t.day=1):t.day>28&&(i=t.day-28,t.day=28),t.month<0?(r=-1-t.day,t.month=0):t.month>11&&(r=t.month-11,t.month=11),s=new Date(t.year,t.month,t.day,t.hour,t.minute,t.second),s.setDate(s.getDate()+i),s.setMonth(s.getMonth()+r),n.toOADate(s)},e.getTimeDefaultFormat=function(t,n){var r=this,i=t-n,s="d";return i>2*r.tmInc.year?s="yyyy":i>r.tmInc.year?s="MMM yy":i>3*r.tmInc.month?s="MMM":i>2*r.tmInc.week?s="MMM d":i>2*r.tmInc.day?s="ddd d":i>r.tmInc.day?s="ddd H:mm":i>r.tmInc.hour?s="H:mm":i>=1e3&&(s="H:mm:ss"),s},e.niceTimeUnit=function(t,n){var r=this,i=t;return i=r.niceTimeSpan(i,n),i},e.niceTimeSpan=function(t,n){var r=this,i=r.manualTimeInc(n),s=0,o=0;s=Math.ceil(t);if(s===0)return r.timeSpanFromTmInc(i);o=1;if(i<r.tmInc.minute){if(s<r.tmInc.minute){o=r.getNiceInc([1,2,5,10,15,30],s,i);if(o!==0)return o}i=r.tmInc.minute}if(i<r.tmInc.hour){if(s<r.tmInc.hour){o=r.getNiceInc([1,2,5,10,15,30],s,i);if(o!==0)return o}i=r.tmInc.hour}if(i<r.tmInc.day){if(s<r.tmInc.day){o=r.getNiceInc([1,3,6,12],s,i);if(o!==0)return o}i=r.tmInc.day}if(i<r.tmInc.month){if(s<r.tmInc.month){o=r.getNiceInc([1,2,7,14],s,i);if(o!==0)return o}i=r.tmInc.month}if(i<r.tmInc.year){if(s<r.tmInc.year){o=r.getNiceInc([1,2,3,4,6],s,i);if(o!==0)return o}i=r.tmInc.year}return o=100*r.tmInc.year,s<o&&(o=r.getNiceInc([1,2,5,10,20,50],s,i),o===0&&(o=100*r.tmInc.year)),o},e.getNiceInc=function(t,n,r){var i=0,s=0,o=t.length;for(i=0;i<o;i++){s=t[i]*r;if(n<=s)return s}return 0},e.timeSpanFromTmInc=function(t){var n=1e3,r=t,i=1;if(t!==this.tmInc.maxtime)if(t>this.tmInc.tickf1)n=t;else{t+=7;while(r>0)i*=10,r--;n=i}return n},e.manualTimeInc=function(t){var n=this,r=n.tmInc.second;return!t||t.length===0?r:(t.indexOf("s")>=0?r=n.tmInc.second:t.indexOf("m")>=0?r=n.tmInc.minute:t.indexOf("h")>=0||t.indexOf("H")>=0?r=n.tmInc.hour:t.indexOf("d")>=0?r=n.tmInc.day:t.indexOf("M")>=0?r=n.tmInc.month:t.indexOf("y")>=0&&(r=n.tmInc.year),r)},e.tmInc={tickf7:-7e3,tickf6:-6e3,tickf5:-5e3,tickf4:-4e3,tickf3:-3e3,tickf2:-2e3,tickf1:-1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:26784e5,year:31536e6,maxtime:2147483647},e.niceTickNumber=function(t){if(parseFloat(t)===0)return t;t<0&&(t=-t);var n=Math.log(t)/Math.log(10),r=parseInt(this.signedFloor(n).toString(),10),i=t/Math.pow(10,r),s=10;return i<=1?s=1:i<=2?s=2:i<=5&&(s=5),s*Math.pow(10,r)},e.niceNumber=function(t,n,r){if(parseFloat(t)===0)return t;t<0&&(t=-t);var i=t/Math.pow(10,n),s=10;return r?i<1.5?s=1:i<3?s=2:i<7&&(s=5):i<=1?s=1:i<=2?s=2:i<=5&&(s=5),s*Math.pow(10,n)},e.nicePrecision=function(t){if(t<=0||typeof t!="number")return 0;var n=Math.log(t)/Math.log(10),r=parseInt(this.signedFloor(n).toString(),10),i=t/Math.pow(10,r);return i<3&&(r=-r+1),r},e.precCeil=function(t,n){var r=Math.pow(10,t),i=n/r;return i=Math.ceil(i),i*r},e.precFloor=function(t,n){var r=Math.pow(10,t),i=n/r;return i=Math.floor(i),i*r},e.signedCeiling=function(t){return t<0?Math.floor(t):Math.ceil(t)},e.signedFloor=function(t){return t<0?Math.ceil(t):Math.floor(t)},e}();t.ChartDataUtil=i,Raphael.fn.closeBtn=function(e,t,n){var r=Math.cos(45*Math.PI/180)*n,i=this.set(),s=["M",e-r,t-r,"L",e+r,t+r,"M",e-r,t+r,"L",e+r,t-r],o=this.path(s.join(" ")),u=null;return o.attr({cursor:"pointer"}),i.push(o),u=this.rect(e-n,t-n,n*2,n*2),u.attr({fill:"white","fill-opacity":0,cursor:"pointer",stroke:"none"}),i.push(u),i};var s=function(){function e(e,t,r){this.options={content:"",contentStyle:{},title:"",titleStyle:{},style:{fill:"white","fill-opacity":.5},closeBehavior:"auto",mouseTrailing:!0,triggers:"hover",animated:"fade",showAnimated:null,hideAnimated:null,duration:500,showDuration:500,hideDuration:500,easing:null,showEasing:null,hideEasing:null,showDelay:150,hideDelay:150,relativeTo:"mouse",compass:"east",offsetX:0,offsetY:0,showCallout:!0,calloutFilled:!1,calloutFilledStyle:{fill:"black"},calloutLength:12,calloutOffset:0,calloutAnimation:{easing:null,duration:500},windowCollisionDetection:"flip",calloutSide:null,width:null,height:null,beforeShowing:null},this.paper=e,this.targets=t,n.extend(this.options,r),this.init()}return e.prototype.init=function(){var e=this.options;this.calloutOffset=e.calloutOffset,this.offsetLength=0,this.gapLength=e.calloutLength/2,this.width=e.width,this.height=e.height,this.offset={x:0,y:0},this.targets&&this._bindLiveEvent(this.targets),this.selector&&this._bindLiveEventBySelector(this.selector)},e.prototype._getShowPoint=function(e,t){var n=e.getBBox(),r={x:0,y:0};switch(t.toLowerCase()){case"east":r.x=n.x+n.width,r.y=n.y+n.height/2;break;case"eastnorth":r.x=n.x+n.width,r.y=n.y;break;case"eastsouth":r.x=n.x+n.width,r.y=n.y+n.height;break;case"west":r.x=n.x,r.y=n.y+n.height/2;break;case"westnorth":r.x=n.x,r.y=n.y;break;case"westsouth":r.x=n.x,r.y=n.y+n.height;break;case"north":r.x=n.x+n.width/2,r.y=n.y;break;case"northeast":r.x=n.x+n.width,r.y=n.y;break;case"northwest":r.x=n.x,r.y=n.y;break;case"south":r.x=n.x+n.width/2,r.y=n.y+n.height;break;case"southeast":r.x=n.x+n.width,r.y=n.y+n.height;break;case"southwest":r.x=n.x,r.y=n.y+n.height}return r},e.prototype._clearIntentTimer=function(e){e&&(window.clearTimeout(e),e=null)},e.prototype._removeTooltip=function(t){var n=this,r=this,i=this.elements,s=r.options,o,u,a;if(i){if(s.hideAnimated||s.animated)o=s.hideAnimated,o||(o=s.animated),o&&e.animations[o]&&(a={animated:o,duration:s.hideDuration||s.duration,easing:s.hideEasing||s.easing,context:i,show:!1},e.animations[o](a));u=s.hideDuration||s.duration,t&&(u=t),window.setTimeout(function(){var e,t;n.content&&(n.content.wijRemove(),n.content=null),n.title&&(n.title.wijRemove(),n.title=null),n.container&&(n.container.wijRemove(),n.container=null);if(n.closeBtn){for(e=0,t=n.closeBtn.length;e<t;e++)n.closeBtn[e].unclick();n.closeBtn.wijRemove(),n.closeBtn=null}n.callout&&(n.callout.wijRemove(),n.callout=null),r.lastPoint=null,i=null},u)}},e.prototype._clearTimers=function(){this.intentShowTimer&&this._clearIntentTimer(this.intentShowTimer),this.intentHideTimer&&this._clearIntentTimer(this.intentHideTimer)},e.prototype._hide=function(e){var t=this;t._clearTimers(),t.options.hideDelay?t.intentHideTimer=window.setTimeout(function(){t._removeTooltip()},t.options.hideDelay):t._removeTooltip()},e.prototype._convertCompassToPosition=function(e){var t="",n={x:0,y:0};switch(e.toLowerCase()){case"east":t="right-middle",n.x=2,n.y=0;break;case"eastnorth":t="right-top",n.x=2,n.y=-2;break;case"eastsouth":t="right-bottom",n.x=2,n.y=2;break;case"west":t="left-middle",n.x=-2,n.y=0;break;case"westnorth":t="left-top",n.x=-2,n.y=-2;break;case"westsouth":t="left-bottom",n.x=-2,n.y=2;break;case"north":t="top-middle",n.x=0,n.y=-2;break;case"northeast":t="top-right",n.x=2,n.y=-2;break;case"northwest":t="top-left",n.x=-2,n.y=-2;break;case"south":t="bottom-middle",n.x=0,n.y=2;break;case"southeast":t="bottom-right",n.x=2,n.y=2;break;case"southwest":t="bottom-left",n.x=-2,n.y=2}return this.offset=n,t},e.prototype._getCalloutArr=function(e,t){var n=[],r=this.options,i=r.compass;r.calloutSide&&(i=r.calloutSide);switch(i.toLowerCase()){case"east":case"eastsouth":case"eastnorth":n=["M",e.x+t,e.y+t,"l",-t,-t,"l",t,-t,"Z"];break;case"west":case"westsouth":case"westnorth":n=["M",e.x-t,e.y-t,"l",t,t,"l",-t,t,"Z"];break;case"north":case"northeast":case"northwest":n=["M",e.x-t,e.y-t,"l",t,t,"l",t,-t,"Z"];break;case"south":case"southeast":case"southwest":n=["M",e.x-t,e.y+t,"l",t,-t,"l",t,t,"Z"]}return n},e.prototype._getFuncText=function(e,t){if(n.isFunction(e)){var r=null,i,s={target:null,fmt:e},o;if(t&&t.target){o=t.target;if(!o.raphael||!o.raphaelid)o=o.parentNode;o.raphael&&o.raphaelid?(i=this.paper.getById(o.raphaelid),s.target=i):s.target=t.target}return r=n.proxy(s.fmt,s),r().toString()}return e},e.prototype._translateCallout=function(e){var t=this.options,n=this.width,r=this.height,i=this.gapLength,s=this.offsetLength,o=this.calloutOffset,u=this.tooltipElements.callout;if(t.calloutSide){var a=i||s;switch(t.calloutSide){case"south":case"north":e?u.animate({translation:-n/2+a+o+",0"},e):u.translate(-n/2+a+o,0);break;case"east":case"west":e?u.animate({translation:"0,"+(-r/2+a+o)},e):u.translate(0,-r/2+a+o)}}},e.replacer=function(t,n,r){var i=r,s=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;return n.replace(s,function(e,t,n,r,s){t=t||r,i&&(i[t]!=="string"&&(i=i[t]),typeof i=="function"&&s&&(i=i()))}),i=(i===null||i===r?t:i).toString(),i},e.fill=function(n,r){var i=/\{([^\}]+)\}/g;return String(n).replace(i,function(t,n){return e.replacer(t,n,r)})},e.prototype._createPath=function(t,n,r){var i=n.split("-"),s=5,o=r.getBBox(),u=this.options,a=u.padding,f=this.gapLength,l=this.offsetLength,c=a&&!isNaN(a)?parseInt(a):0,h=Math.round(o.width+c*2),p=Math.round(o.height+c*2),d=Math.round(o.x-c)-s,v=Math.round(o.y-c)-s,m=0,g=0,y=0,b=0,w=null,E=null,S=null;u.width&&(h=h>u.width?h:u.width),u.height&&(p=p>u.height?p:u.height),this.width=h,this.height=p,m=Math.min(p/4,h/4,f),l&&(l=Math.min(p/4,h/4,l)),l?(g=l,w={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{offset},0,-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{offset},0,{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom},0-{offset},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},0,{offset},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}):w={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"},E=[{x:d+s,y:v,w:h,w4:h/4,h4:p/4,left:0,right:h-m*2-g*2,top:0,bottom:p-m*2-g*2,r:s,h:p,gap:m,offset:g*2},{x:d+s,y:v,w:h,w4:h/4,h4:p/4,left:h/2-m-g,right:h/2-m-g,top:p/2-m-g,bottom:p/2-m-g,r:s,h:p,gap:m,offset:g*2},{x:d+s,y:v,w:h,w4:h/4,h4:p/4,right:0,left:h-m*2-g*2,bottom:0,top:p-m*2-g*2,r:s,h:p,gap:m,offset:g*2}][i[1]==="middle"?1:(i[1]==="left"||i[1]==="top"?1:0)*2],S=this.paper.path(e.fill(w[i[0]],E));switch(i[0]){case"top":y=t.x-(d+s+E.left+m+l),b=t.y-(v+s+p+s+m+l);break;case"bottom":y=t.x-(d+s+E.left+m+l),b=t.y-(v-m-l);break;case"left":y=t.x-(d+s+h+s+m+l),b=t.y-(v+s+E.top+m+l);break;case"right":y=t.x-(d-m-g),b=t.y-(v+s+E.top+m+g)}return S.translate(y,b),r.transform(Raphael.format("...t{0},{1}",y,b)),S},e.prototype._isWindowCollision=function(e,t,r,i,s,o,u){var a=e.getBBox(),f=0,l=t.toLowerCase(),c=a.x+s,h=a.y+o,p=this.paper.width,d=this.paper.height,v=r,m=i,g=e.attr("stroke-width"),y=u===!0||u==="flip";return Raphael.vml&&(p=n(this.paper.canvas).width(),d=n(this.paper.canvas).height()),c-g<0&&(y?l.toLowerCase().indexOf("west")===-1?c+a.width/2+a.width-r<=p&&(f++,l=l.toLowerCase()+"east",v=0-r):c+a.width+a.width-r<=p&&(f++,l=l.toLowerCase().replace("west","east"),v=0-r):(f++,v=0-c+g+r)),h-g<0&&(y?l.toLowerCase().indexOf("north")===-1?h+a.height/2+a.height-i<=d&&(f++,l=l.toLowerCase()+"south",m=0-i):h+a.height+a.height-i<=d&&(f++,l=l.toLowerCase().replace("north","south"),m=0-i):(f++,m=0-h+g+i)),c+a.width+g>p&&(y?l.toLowerCase().indexOf("east")===-1?c-a.width/2-r>=0&&(f++,l=l.toLowerCase()+"west",v=0-r):c-a.width-r>=0&&(f++,l=l.toLowerCase().replace("east","west"),v=0-r):(f++,v=p-(c+a.width+g)+r)),h+a.height+g>d&&(y?l.toLowerCase().indexOf("south")===-1?h-a.height/2-i>=0&&(f++,l=l.toLowerCase()+"north",m=0-i):h-a.height-i>=0&&(f++,l=l.toLowerCase().replace("south","north"),m=0-i):(f++,m=d-(h+a.height+g)+i)),f?{compass:l,offsetX:v,offsetY:m}:!1},e.prototype._createTooltipEles=function(t,r,i,s,o,u,a){var f=this,l,c,h,p=this.paper.set(),d=null,v=null,m=this.options,g=this.closeBtnLength,y=this.calloutOffset,b=null,w=0,E=0,S=250,x=0,T=0,N,C={x:t.x,y:t.y},k=this.offset,L=null,A=null;n.wijraphael.clearRaphaelCache(),h=this._convertCompassToPosition(o),C.x+=u+k.x,C.y+=a+k.y,this.elements=this.paper.set(),this.title&&(n.each(this.title,function(e,t){n(t.node).unbind(".Rtooltip")}),this.title.wijRemove()),r&&r.length>0?(this.title=this.paper.htmlText(-1e3,-1e3,r,m.titleStyle),this.elements.push(this.title),l=this.title.getBBox()):l={left:-1e3,top:-1e3,width:0,height:0},this.content&&(n.each(this.content,function(e,t){n(t.node).unbind(".Rtooltip")}),this.content.wijRemove()),i&&i.length>0?(this.content=this.paper.htmlText(-1e3,-1e3,i,m.contentStyle),this.elements.push(this.content),c=this.content.getBBox()):c={left:-1e3,top:-1e3,width:0,height:0};if(this.closeBtn){for(x=0,T=this.closeBtn.length;x<T;x++)this.closeBtn[x].unclick();this.closeBtn.wijRemove()}this.content&&this.content.transform(Raphael.format("T0,{0}",l.height/2+c.height/2)),this.title&&this.title.transform(Raphael.format("T0,{0}",0)),m.closeBehavior==="sticky"&&(this.closeBtn=this.paper.closeBtn(-1e3,-1e3,g),this.elements.push(this.closeBtn),m.width&&m.width>l.width+g*2&&m.width>c.width+g*2?this.closeBtn.transform(Raphael.format("T{0},{1}",m.width-g,g)):l.width>=c.width-g*2?this.closeBtn.transform(Raphael.format("T{0},{1}",l.width+g,g)):this.closeBtn.transform(Raphael.format("T{0},{1}",c.width-g,g)),n.each(this.closeBtn,function(e,t){var n=f;t.click(function(e){n._hide(e)})})),this.title&&(p.push(this.title),m.relatedElement&&this.title.insertBefore(m.relatedElement)),this.content&&(p.push(this.content),m.relatedElement&&this.content.insertBefore(m.relatedElement)),this.closeBtn&&(p.push(this.closeBtn),m.relatedElement&&this.closeBtn.insertBefore(m.relatedElement)),m.showCallout||(this.gapLength=0);if(m.calloutSide||m.calloutFilled)this.gapLength=0,this.offsetLength=m.calloutLength/2,m.calloutSide&&(h=this._convertCompassToPosition(m.calloutSide));m.calloutSide&&p.length===0&&(this.content=this.paper.htmlText(-1e3,-1e3," "),p.push(this.content),m.relatedElement&&this.content.insertBefore(m.relatedElement)),this.callout&&(n(this.callout.node).unbind(".Rtooltip"),this.callout.wijRemove()),this.container&&(n(this.container.node).unbind(".Rtooltip"),this.container.wijRemove());if(this.lastPoint){m.showCallout&&(m.calloutSide||m.calloutFilled)&&(d=this._getCalloutArr(this.lastPoint,this.offsetLength),this.callout=this.paper.path(d.concat(" ")),m.relatedElement&&this.callout.insertBefore(m.relatedElement),m.calloutFilled&&this.callout.attr(m.calloutFilledStyle),m.calloutSide&&this._translateCallout(0)),this.container=this._createPath(this.lastPoint,h,p),m.relatedElement&&this.container.insertBefore(m.relatedElement);if(s){N=this._isWindowCollision(this.container,o,u,a,C.x-this.lastPoint.x,C.y-this.lastPoint.y,s);if(N){this._createTooltipEles(t,r,i,!1,N.compass,N.offsetX,N.offsetY);return}}this.elements.push(this.callout),this.elements.push(this.container),w=C.x-this.lastPoint.x,E=C.y-this.lastPoint.y,A=Raphael.format("...T{0},{1}",w,E),L=Raphael.animation({transform:A},S),this.container&&(m.showAnimated||m.animated?this.container.animate(L):this.container.attr("transform",A)),this.title&&(m.showAnimated||m.animated?this.title.animate(L):this.title.attr("transform",A)),this.content&&(m.showAnimated||m.animated?this.content.animate(L):this.content.attr("transform",A)),this.closeBtn&&(m.showAnimated||m.animated?this.closeBtn.animate(L):this.closeBtn.attr("transform",A)),this.callout&&(m.showAnimated||m.animated?this.callout.animate(L):this.callout.attr("transform",A))}else{m.showCallout&&(m.calloutSide||m.calloutFilled)&&(d=this._getCalloutArr(C,this.offsetLength),this.callout=this.paper.path(d.concat(" ")),m.relatedElement&&this.callout.insertBefore(m.relatedElement),m.calloutFilled&&this.callout.attr(m.calloutFilledStyle),m.calloutSide&&this._translateCallout(0)),this.container=this._createPath(C,h,p),m.relatedElement&&this.container.insertBefore(m.relatedElement);if(s){N=this._isWindowCollision(this.container,o,u,a,0,0,s);if(N){this._createTooltipEles(t,r,i,!1,N.compass,N.offsetX,N.offsetY);return}}this.elements.push(this.callout),this.elements.push(this.container);if(m.showAnimated||m.animated)v=m.showAnimated,v||(v=m.animated),v&&e.animations[v]&&(b={animated:v,duration:m.showDuration||m.duration,easing:m.showEasing||m.easing,context:this.elements,show:!0},e.animations[v](b))}this.lastPoint=C,this.container.attr(m.style),m.relatedElement?(this.title&&this.title.insertBefore(m.relatedElement),this.content&&this.content.insertBefore(m.relatedElement),this.closeBtn&&this.closeBtn.insertBefore(m.relatedElement)):p.toFront()},e.prototype._createTooltip=function(e,t){var r=null,i=null,s=null,o=null,u=this.options,a,f;if(n.isFunction(u.beforeShowing)){s=null,o={target:null,options:u,fmt:u.beforeShowing};if(t&&t.target){f=t.target;if(!f.raphael||!f.raphaelid)f=f.parentNode;f.raphael&&f.raphaelid?(a=this.paper.getById(f.raphaelid),o.target=a):(a=t.target,o.target=a)}s=n.proxy(o.fmt,o);if(s()===!1)return}r=u.title,i=u.content,r=this._getFuncText(r,t),i=this._getFuncText(i,t);if(!r&&!i)return;this._createTooltipEles(e,r,i,u.windowCollisionDetection,u.compass,u.offsetX,u.offsetY)},e.prototype._showAt=function(e,t){var n=this.options,r=this;this._clearTimers(),n.showDelay?this.intentShowTimer=window.setTimeout(function(){r._createTooltip(e,t)},n.showDelay):this._createTooltip(e,t)},e.prototype._show=function(e){var t=n(this.paper.canvas.parentNode).offset(),r=t.left,i=t.top,s=this.options,o=s.relativeTo,u={x:0,y:0},a=null,f=e.target;switch(o){case"mouse":u.x=e.pageX-r,u.y=e.pageY-i;break;case"element":if(!f.raphael||!f.raphaelid)f=f.parentNode;f.raphael&&f.raphaelid&&(a=this.paper.getById(f.raphaelid),u=this._getShowPoint(a,s.compass))}this._showAt(u,e)},e.prototype._bindEvent=function(e){var t=this.options,r=this;switch(t.triggers){case"hover":n(e.node).bind("mouseover.Rtooltip",function(e){r._show(e)}).bind("mouseout.Rtooltip",function(e){t.closeBehavior==="auto"&&r._hide(e)}),t.mouseTrailing&&t.relativeTo==="mouse"&&n(e.node).bind("mousemove.Rtooltip",function(e){r._show(e)});break;case"click":n(e.node).bind("click.Rtooltip",function(e){r._show(e)});break;case"custom":}},e.prototype._bindLiveEvent=function(e){var t,n;if(e)if(e.length)for(t=0,n=e.length;t<n;t++)this._bindEvent(e[t]);else this._bindEvent(e)},e.prototype._bindLiveEventBySelector=function(e){var t=this.options,n=this;if(e)switch(t.triggers){case"hover":e.on("mouseover.Rtooltip",function(e){n._show(e)}).on("mouseout.Rtooltip",function(e){t.closeBehavior==="auto"&&n._hide(e)}),t.mouseTrailing&&t.relativeTo==="mouse"&&e.on("mousemove.Rtooltip",function(e){n._show(e)});break;case"click":e.on("click.Rtooltip",function(e){n._show(e)});break;case"custom":}},e.prototype._unbindLiveEvent=function(e,t){var r,i;if(e)if(e.length)for(r=0,i=e.length;r<i;r++)n(e[r].node).unbind(".Rtooltip");else n(e.node).unbind(".Rtooltip");t&&t.off("Rtooltip").off(".Rtooltip")},e.prototype._destroy=function(){this._unbindLiveEvent(this.targets,this.selector),this._removeTooltip(0)},e.prototype.hide=function(){this._hide()},e.prototype.showAt=function(e,t){this._showAt(e,t)},e.prototype.resetCalloutOffset=function(e){var t=this.options,n=t.calloutOffset,r=t.calloutSide,i=t.calloutAnimation,s=this.tooltipElements;s.callout&&(r==="south"||r==="north"?s.callout.animate({translation:e-n+",0"},i.duration,i.easing):(r==="east"||r==="west")&&s.callout.animate({translation:"0,"+(e-n)},i.duration,i.easing)),t.calloutOffset=e},e.prototype.destroy=function(){this._destroy()},e.prototype.getOptions=function(){return this.options},e.prototype.setTargets=function(e){this.targets=e,this._bindLiveEvent(e)},e.prototype.setSelector=function(e){this.selector=e,this._bindLiveEventBySelector(e)},e.prototype.setOptions=function(e){n.extend(!0,this.options,e)},e.animations={fade:function(e){var t=e.context;e.show?(t.attr({opacity:0}),t.wijAnimate({opacity:1},e.duration,e.easing)):t.wijAnimate({opacity:0},e.duration,e.easing)}},e}();t.ChartTooltip=s,Raphael.fn.tooltip={animations:s.animations};var o=function(){function e(e){this.labels=[],this.crossLabels={},this.bBox=e}return e.prototype.push=function(e){var t=e.wijGetBBox();this.labels.push({ele:e,x:t.x,y:t.y,width:t.width,height:t.height,overlaps:[],bakBBox:t})},e.prototype.pushCross=function(e,t){var n,r,i,s,o;!this.crossLabels[Raphael.format("{0}-{1}",e,t)]&&!this.crossLabels[Raphael.format("{0}-{1}",t,e)]&&(n=this.labels[e],r=this.labels[t],this.crossLabels[Raphael.format("{0}-{1}",e,t)]={label1:n,label2:r,dx:this._getAdjust(n,r,"h"),dy:this._getAdjust(n,r,"v")})},e.prototype._detect=function(e,t){return(e.x+e.width>t.x&&e.x<t.x||t.x+t.width>e.x&&t.x<e.x)&&(e.y+e.height>t.y&&e.y<t.y||t.y+t.height>e.y&&t.y<e.y)},e.prototype._resetOverlaps=function(){this.crossLabels={}},e.prototype._detects=function(){var e=this.labels.length,t,n;for(var r=0;r<e;r++)for(var i=r+1;i<e;i++)t=this.labels[r],n=this.labels[i],this._detect(t,n)&&this.pushCross(r,i)},e.prototype._getAdjust=function(e,t,n){var r={dx:0,needRevert:!1};return n==="h"?e.x<t.x?r.dx=e.x+e.width-t.x:(r.dx=t.x+t.width-e.x,r.needRevert=!0):e.y<t.y?r.dx=e.y+e.height-t.y:(r.dx=t.y+t.height-e.y,r.needRevert=!0),r},e.prototype._adjustlabel=function(e,t,n,r){r==="h"?(e.x-=n/2,t.x+=n/2,this.bBox&&(e.x<this.bBox.x?(e.x=this.bBox.x,t.x=t.x+(this.bBox.x-e.x)):t.x>this.bBox.x+this.bBox.width&&(t.x=this.bBox.x+this.bBox.width,e.x-=t.x-this.bBox.x+this.bBox.width))):(e.y-=n/2,t.y+=n/2,this.bBox&&(e.y<this.bBox.y?(e.y=this.bBox.y,t.y=t.y+(this.bBox.y-e.y)):t.y>this.bBox.y+this.bBox.height&&(t.y=this.bBox.y+this.bBox.height,e.y-=t.y-this.bBox.y+this.bBox.height)))},e.prototype._adjustInternal=function(){var e=this;n.each(this.crossLabels,function(t,n){var r=n.label1,i=n.label2,s=n.dx,o=n.dy;s.dx<o.dx?o.needRevert?e._adjustlabel(i,r,o.dx,"v"):e._adjustlabel(r,i,o.dx,"v"):s.needRevert?e._adjustlabel(i,r,s.dx,"h"):e._adjustlabel(r,i,s.dx,"h")})},e.prototype._adjustTheEdge=function(){var e=this;this.bBox&&n.each(this.labels,function(t,n){n.x<e.bBox.x?n.x=e.bBox.x:n.x+n.width>e.bBox.x+e.bBox.width&&(n.x=e.bBox.x+e.bBox.width-n.width),n.y<e.bBox.y?n.y=e.bBox.y:n.y+n.height>e.bBox.y+e.bBox.height&&(n.y=e.bBox.y+e.bBox.height-n.height)})},e.prototype._translateLabels=function(){n.each(this.labels,function(e,t){t.x!==t.bakBBox.x&&(t.ele.attr("x",t.x+t.width/2),t.bakBBox.x=t.x),t.y!==t.bakBBox.y&&(t.ele.attr("y",t.y+t.height/2),t.bakBBox.y=t.y)})},e.prototype.adjust=function(){var e=1e3;while(e>0){this._resetOverlaps(),this._adjustTheEdge(),this._detects();if(n.isEmptyObject(this.crossLabels))break;e--,this._adjustInternal()}this._translateLabels()},e}();t.AdjustLabel=o;var u=function(e){function t(){e.apply(this,arguments),this.innerState={}}return __extends(t,e),t.prototype._setOption=function(r,i){var s=this,o=s.options,u=null,a=0,f=0,l=o.axis.x.tickMajor.factor,c=o.axis.x.tickMinor.factor,h,p,d,v,m,g=t.prototype.options.axis,y,b;if(r==="dataSource")s.seriesTransition=!0,o.dataSource=i,s.seriesList&&(o.seriesList=n.arrayClone(s.seriesList)),s._init();else if(r==="data")s.seriesTransition=!0,o.data=i,s.seriesList&&(o.seriesList=n.arrayClone(s.seriesList)),s._init();else if(r==="seriesList"){i||(i=[]),u=n.Event("beforeserieschange");if(s._trigger("beforeSeriesChange",u,{oldSeriesList:o.seriesList,newSeriesList:i})===!1)return!1;o.seriesList=i,s.seriesList=n.arrayClone(i),s._trigger("seriesChanged",null,i),s.seriesTransition=!0,s._seriesListSeted(),s._init()}else n.isPlainObject(o[r])?(r==="axis"&&(n.isArray(o.axis.y)?d=n.arrayClone(o.axis.y):d=n.extend(!0,{},o.axis.y)),r==="axis"?(b=n.extend(!0,{},i),s._verifyAxisAutoMinMax(b),n.extend(!0,o.axis.x,b.x||{}),n.isArray(o.axis.y)||n.isArray(b.y)?y={}:y=o.axis.y,n.isArray(b.y)?(n.each(b.y,function(e,t){b.y[e]=n.extend(!0,{},g.y,y,t)}),o.axis.y=b.y):o.axis.y=n.extend(!0,{},g.y,y,b.y)):n.extend(!0,o[r],i),r==="indicator"&&(this._unbindCanvasEvents(),this._bindCanvasEvents()),r==="axis"&&(v=o.axis.y,o.axis.x.tickMajor.factor<0&&(o.axis.x.tickMajor.factor=l),o.axis.x.tickMinor.factor<0&&(o.axis.x.tickMinor.factor=c),n.isArray(v)?(n.isArray(d)||(d=[d]),n.each(v,function(e,t){var n=d[e]||{};n.tickMajor&&n.tickMajor.factor&&t.tickMajor&&t.tickMajor.factor&&t.tickMajor.factor<0&&(t.tickMajor.factor=n.tickMajor.factor),n.tickMinor&&n.tickMinor.factor&&t.tickMinor&&t.tickMinor.factor&&t.tickMinor.factor<0&&(t.tickMinor.factor=n.tickMinor.factor)})):(n.isArray(d)?(h=d[0].tickMajor.factor,p=d[0].tickMinor.factor):(l=d.tickMajor.factor,c=d.tickMinor.factor),o.axis.y.tickMajor&&o.axis.y.tickMajor.factor!==undefined&&o.axis.y.tickMajor.factor<0&&(o.axis.y.tickMajor.factor=h),o.axis.y.tickMinor&&o.axis.y.tickMinor.factor!==undefined&&o.axis.y.tickMinor.factor<0&&(o.axis.y.tickMinor.factor=p)))):e.prototype._setOption.call(this,r,i);r==="disabled"&&s._handleDisabledOption(i,s.chartElement),r==="autoResize"&&(s._unbindResizeEvent(),s._bindResizeEvent());if(r==="seriesTransition"||r==="animation")return;if(r==="hint"){s._resetTooltip();return}a=o.seriesList.length;if(r==="seriesList"||r==="seriesStyles"||r==="seriesHoverStyles")r!=="seriesList"&&s._handleChartStyles(),s.styles={style:[].concat(o.seriesStyles.slice(0,o.seriesStyles.length)),hoverStyles:[].concat(o.seriesHoverStyles.slice(0,o.seriesHoverStyles.length))},s._initStyles();if(r==="seriesList"||r==="seriesHoverStyles"){m=o.seriesHoverStyles.length;for(f=m;f<a;f++)o.seriesHoverStyles[f]=o.seriesHoverStyles[f%m]}(r==="height"||r==="width")&&s.chartElement[r](i),s.redraw()},t.prototype._preHandleSeriesData=function(){},t.prototype._seriesListSeted=function(){},t.prototype._initStyles=function(){var e=this.options,t=e.seriesStyles,n=e.seriesHoverStyles,r,i,s,o;e.seriesList&&(i=e.seriesList.length||0),e.seriesStyles&&(r=e.seriesStyles.length||0),e.seriesHoverStyles&&(s=e.seriesHoverStyles.length||0);if(i>r&&r)for(o=r;o<i;o++)t[o]=t[o%r];if(i>s&&s)for(o=s;o<i;o++)n[o]=n[o%s]},t.prototype._verifyAxisAutoMinMax=function(e){var t=function(e){return e===null||typeof e=="undefined"};e.x&&(t(e.x.min)?e.x.autoMin=!0:e.x.autoMin=!1,t(e.x.max)?e.x.autoMax=!0:e.x.autoMax=!1),e.y&&(n.isArray(e.y)?n.each(e.y,function(e,n){t(n.min)?n.autoMin=!0:n.autoMin=!1,t(n.max)?n.autoMax=!0:n.autoMax=!1}):(t(e.y.min)?e.y.autoMin=!0:e.y.autoMin=!1,t(e.y.max)?e.y.autoMax=!0:e.y.autoMax=!1))},t.prototype._create=function(){var e=this,t=e.options,r=t.width||e.element.width(),i=t.height||e.element.height(),s=null,o;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._verifyAxisAutoMinMax(t.axis),e.updating=0,e.innerState={},e.axisCompass={},e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.redraw(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijchart"),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(t),e.styles={style:[].concat(t.seriesStyles.slice(0,t.seriesStyles.length)),hoverStyles:[].concat(t.seriesHoverStyles.slice(0,t.seriesHoverStyles.length))},t.hint&&typeof t.hint.content=="string"&&window[t.hint.content]&&(t.hint.content=window[t.hint.content]),t.hint&&typeof t.hint.title=="string"&&window[t.hint.title]&&(t.hint.title=window[t.hint.title]),e.headerEles=[],e.footerEles=[],e.legendEles=[],e.axisEles=[],e.legends=[],e.legendIcons=[],e.legendDots=[],e.chartLabelEles=[],e.seriesEles=[];if(e.element.length>0){e.element.is("table")?(e._parseTable(),s=n("<div></div>"),r&&s.css("width",r),i&&s.css("height",i),e.element.after(s),e.chartElement=s):e.chartElement=e.element,e._initStyles(),e.chartElement.addClass("ui-widget");try{o=Raphael(e.chartElement[0],r,i)}catch(u){var a=e.chartElement.css("display");s=n("<div></div>").insertBefore(e.chartElement).append(e.chartElement),e.chartElement.addClass("ui-helper-hidden-accessible").appendTo(n("body")),a==="none"&&e.chartElement.css("display","block"),o=Raphael(e.chartElement[0],r,i),e.chartElement.appendTo(s).unwrap().removeClass("ui-helper-hidden-accessible"),a==="none"&&e.chartElement.css("display","none")}e.canvas=o,i===0&&t.height!==0&&e.element.height(o.height),t.disabled&&e.disable(),o.customAttributes.rotation=function(e){this.transform("...R"+e)},o.customAttributes.scale=function(e){this.transform("...S"+e)},o.customAttributes.translation=function(e,t){this.transform(Raphael.format("...T{0},{1}",e,t))},e._bindLiveEvents()}},t.prototype._handleChartStyles=function(){this._extendArrayFromBase("seriesStyles"),this._extendArrayFromBase("seriesHoverStyles");var e=this.options,t=this._getDefFill();n.each(e.seriesStyles,function(e,n){n.fill||(n.fill=t[e])})},t.prototype._extendArrayFromBase=function(e){var r=n.extend(!0,{},t.prototype.options[e],this.options[e]),i=[];n.each(r,function(e,t){i.push(t)}),this.options[e]=i},t.prototype._getDefFill=function(){var e=["#00cc00","#0099cc","#0055cc","#2200cc","#8800cc","#d9007e","#ff0000","#ff6600","#ff9900","#ffcc00","#ffff00","#ace600"];return e},t.prototype._getCulture=function(e){return Globalize.findClosestCulture(e||this.options.culture)},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=t.options,i=e||t.element,s=i.offset(),o=r.width||i.outerWidth(),u=r.height||i.outerHeight(),a;return a=n("<div></div>").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),Raphael.vml&&a.addClass(r.wijCSS.stateDisabled).css("background-color","#fff"),a},t.prototype._bindData=function(){var e=this,t=this,r=t.options,i=r.dataSource,s=r.seriesList,o=r.data,u={};n.each(s,function(t,n){var r=n.dataSource||i;r&&n.data&&e._bindSeriesData(r,n,u)})},t.prototype._bindSeriesData=function(e,t,n){var r=t.data,i=r.x,s=r.y,o=this.options.data;i&&i.bind?r.x=this._getBindData(e,i.bind):o&&o.x&&o.x.bind&&(n.sharedXList===undefined&&(n.sharedXList=this._getBindData(e,o.x.bind)),r.x=n.sharedXList),s&&s.bind&&(r.y=this._getBindData(e,s.bind))},t.prototype._getBindData=function(e,t){if(n.isArray(e)){var r=[];return n.each(e,function(e,n){n&&n[t]!==undefined&&r.push(n[t])}),r}return null},t.prototype._hanldSharedXData=function(){var e=this,t=e.options,r=t.seriesList,i=t.data;i&&n.each(r,function(e,t){var r=t.data;if(r.x===undefined||r.x===null&&n.isArray(i.x))r.x=i.x})},t.prototype._init=function(){var e=this,t=e.options;e.rendered||(e.seriesList=n.arrayClone(t.seriesList)),e._bindData(),e._hanldSharedXData(),n.each(t.seriesList,function(e,r){var i=r.data,s;if(typeof i=="undefined"||i===null)s=n.inArray(r,t.seriesList),t.seriesList.splice(s,1)}),e.rendered||e._paint()},t.prototype.destroy=function(){var t=this,r=t.options;t._unbindLiveEvents(),t._clearChartElement(),t.chartElement.removeClass("ui-widget"),n("."+r.wijCSS.canvasObject,t.chartElement[0]).off(t.widgetName).off("."+t.widgetName),t.element!==t.chartElement&&t.chartElement.remove(),t.element.empty(),t.styles&&(t.styles=null),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null),e.prototype.destroy.call(this)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.addSeriesPoint=function(e,t,n){var r=this.options.seriesList,i=null,s=null;if(e>=r.length)return;i=r[e],s=i.data||[],s.x.push(t.x),s.y.push(t.y),n&&(s.x.shift(),s.y.shift()),this._setOption("seriesList",r)},t.prototype.beginUpdate=function(){var e=this;e.updating++},t.prototype.endUpdate=function(){var e=this;e.updating--,e.redraw()},t.prototype.redraw=function(e){var t=this,n=t.options,r=0,i=0;if(t.updating>0)return;if(e&&t.rendered)return;r=n.width||t.element.width(),i=n.height||t.element.height();if(r<1||i<1)return;t.canvas.setSize(r,i),t._paint()},t.prototype._parseTable=function(){if(!this.element.is("table"))return;var e=this,t=e.element,r=e.options,i=n("caption",t),s=n("thead th",t),o=[],u=n("tbody tr",t);i.length&&(r.header=n.extend({visible:!0,text:n.trim(n(i[0]).text())},r.header),i.length>1&&(r.footer=n.extend({visibel:!0,text:n.trim(n(i[1]).text())},r.footer))),r.legend=n.extend({visible:!0},r.legend),e._getSeriesFromTR(s,u,o),e.options.seriesList=o},t.prototype._getSeriesFromTR=function(e,t,r){var i=[],s=null,o=null;e.length&&e.each(function(){s=n.trim(n(this).text()),i.push(s)}),t.length&&t.each(function(){var e=n("th",n(this)),t=n.trim(e.text()),s=[],u=n("td",n(this));u.length&&u.each(function(e,t){var r=n(this);s.push(parseFloat(n.trim(r.text())))}),o={label:t,legendEntry:!0,data:{x:i,y:s}},r.push(o)})},t.prototype._destroyRaphaelArray=function(e){if(!e)return;var t=e.length,r=0,i,s;for(;t&&r<t;r++)i=e[r],i&&i[0]&&(s=n(i.node),s.unbind().removeData(),i.wijRemove(),s.remove(),s=null),e[r]=null},t.prototype._clearChartElement=function(){var e=this,t=e.chartElement.data("fields");e._destroyRaphaelArray(e.headerEles),e._destroyRaphaelArray(e.footerEles),e._destroyRaphaelArray(e.legendEles),e._destroyRaphaelArray(e.legends),e._destroyRaphaelArray(e.legendIcons),e._destroyRaphaelArray(e.legendDots),e._destroyRaphaelArray(e.axisEles),e._destroyRaphaelArray(e.chartLabelEles),e.tooltip&&(e.tooltip.destroy(),e.tooltip=null),e.dataPoints=null,e.pointXs=null,t&&t.trackers&&(e._destroyRaphaelArray(t.trackers),t.trackers=null),e.headerEles=[],e.footerEles=[],e.legendEles=[],e.legends=[],e.legendIcons=[],e.legendDots=[],e.axisEles=[],e.chartLabelEles=[],t&&t.chartElements&&(n.each(t.chartElements,function(t,n){e._destroyRaphaelArray(n)}),t.chartElements=null),t&&t.seriesEles&&(t.seriesEles=null),e.seriesEles&&(e.seriesEles=[]),e.canvas.clear(),e.innerState=null,e.axisInfo=null,e.seriesGroup=null,e.lastAxisOffset=null,e.innerState={}},t.prototype._text=function(e,t,n){var r=this.canvas.text(e,t,n);return this.options.disableDefaultTextStyle&&(r.node.style.cssText=""),r},t.prototype._paint=function(){var e=this,t=e.options,n=e.element,r=n.css("display")==="none"||n.css("visibility")==="hidden",i={},s=null;r&&(i=n.css("left"),s=n.css("position"),n.css("left","-10000px"),n.css("position","absolute"),n.show());if(n.is(":hidden")){r&&(n.css("left",i),n.css("position",s),n.hide());return}e._clearChartElement();if(e._trigger("beforePaint")===!1)return;e._preHandleSeriesData(),e.canvasBounds={startX:0,endX:t.width||n.width(),startY:0,endY:t.height||n.height()},e._paintHeader(),e._paintFooter(),e._paintLegend(),e._paintChartArea(),t.indicator&&t.indicator.visible&&this.pointXs&&(this.pointXs=this.pointXs.sort(function(e,t){return e-t})),e._paintTooltip(),e._trigger("painted"),e.rendered=!0,e.styles&&(t.seriesStyles=e.styles.style,t.seriesHoverStyles=e.styles.hoverStyles),r&&(n.css("left",i),n.css("position",s),n.hide())},t.prototype._paintIndicater=function(){},t.prototype._calculatePosition=function(e,t,n){var r={x:0,y:0},i=5,s=5,o=this.canvasBounds;switch(e){case"north":r.x=(o.endX-o.startX)/2,r.y=o.startY+n/2+s,o.startY=o.startY+s*2+n;break;case"south":r.x=(o.endX-o.startX)/2,r.y=o.endY-n/2-s,o.endY=o.endY-s*2-n;break;case"east":r.x=o.endX-t/2-i,r.y=(o.endY-o.startY)/2,o.endX=o.endX-i*2-t;break;case"west":r.x=o.startX+t/2+i,r.y=(o.endY-o.startY)/2,o.startX=o.startX+i*2+t}return r},t.prototype._paintHeader=function(){var e=2,t=this,r=t.options,i=r.header,s=null,o=null,u=null,a=null,f=null,l=null,c=0,h=null;i.text&&i.text.length>0&&i.visible&&(s=i.compass,o=t._text(0,0,i.text),n.wijraphael.addClass(n(o.node),r.wijCSS.headerText),c=t._getRotationByCompass(s),u=n.extend(!0,{},r.textStyle,i.textStyle),o.attr(u),o.transform("...R"+c),a=o.wijGetBBox(),f=t._calculatePosition(s,a.width,a.height),o.transform(Raphael.format("...T{0},{1}",f.x,f.y)),l=o.wijGetBBox(),h=t.canvas.rect(l.x-e,l.y-e,l.width+2*e,l.height+2*e),n.wijraphael.addClass(n(h.node),r.wijCSS.headerContainer),h.attr(i.style),h.toBack(),t.headerEles.push(o),t.headerEles.push(h))},t.prototype._paintFooter=function(){var e=2,t=this,r=t.options,i=r.footer,s=null,o=null,u=null,a=null,f=null,l=null,c=0,h=null;i.text&&i.text.length>0&&i.visible&&(s=i.compass,o=t._text(0,0,i.text),n.wijraphael.addClass(n(o.node),r.wijCSS.footerText),c=t._getRotationByCompass(s),u=n.extend(!0,{},r.textStyle,i.textStyle),o.attr(u),o.transform("...R"+c),a=o.wijGetBBox(),f=t._calculatePosition(s,a.width,a.height),o.transform(Raphael.format("...T{0},{1}",f.x,f.y)),l=o.wijGetBBox(),h=t.canvas.rect(l.x-e,l.y-e,l.width+2*e,l.height+2*e),n.wijraphael.addClass(n(h.node),r.wijCSS.footerContainer),h.attr(i.style),h.toBack(),t.footerEles.push(o),t.footerEles.push(h))},t.prototype._getRotationByCompass=function(e){var t=0;return e==="east"?t=90:e==="west"&&(t=-90),t},t.prototype._paintLegendIcon=function(e,t,r,i,s,o,u,a,f,l){var c=this,h=c.canvas.rect(e,t,r,i);return n(h.node).data("legendIndex",o).data("index",u),c.legendIcons.push(h),s&&h.attr(s),n.wijraphael.addClass(n(h.node),a),h},t.prototype._paintLegend=function(){if(!this.options.legend.visible)return;var e=this,t=e.options,r=n.extend(!0,{size:{width:22,height:10}},t.legend),i=2,s=t.seriesStyles,o=[].concat(t.seriesList),u=r.compass,a=r.orientation,f,l,c,h,p=e.canvasBounds,d=p.endX-p.startX,v=p.endY-p.startY,m=r.size.width,g=r.size.height,y,b=0,w=0,E=0,S=0,x=0,T=0,N=1,C=0,k=0,L=0,A=0,O=0,M,_,D,P,H=[],B=0,j=0,F=0,I=[];r.text&&r.text.length&&(f=e._text(0,0,r.text),n.wijraphael.addClass(n(f.node),t.wijCSS.legendTitle),l=n.extend(!0,{},t.textStyle,r.textStyle,r.titleStyle),f.wijAttr(l),e.legendEles.push(f)),r.reversed&&(o=o.reverse()),F=o.length,e.widgetName==="wijcompositechart"&&(F=0,n.each(o,function(e,t){t.type==="pie"?F+=t.data.length:F++})),n.each(o,function(i,o){function u(i){var o=r.reversed?F-1-B:B,u=e._getLegendStyle(s[o]),a=n.extend(!0,{fill:"none",opacity:1,stroke:"black"},u),f,l,c,h=!1,p=i.type,d;i.legendEntry&&i.display!=="exclude"&&(l=n.extend(!0,{},t.textStyle,r.textStyle),r.textWidth?f=e.canvas.wrapText(0,0,i.label,r.textWidth,"far",l):(f=e._text(0,0,i.label),f.wijAttr(l)),n.wijraphael.addClass(n(f.node),t.wijCSS.legendText+" "+t.wijCSS.legend),e.legends.push(f),c=n.extend(a,{"stroke-width":1}),H.push(c),I.push(i),e.widgetName==="wijcompositechart"?h=p==="line"||p==="spline"||p==="bezier"||p==="area":h=e.widgetName==="wijlinechart",r.textWidth?n.each(f,function(e,r){i.visible===!1&&(!h||h&&(!i.markers||!i.markers.visible))&&(n(r.node).data("hidden",!0).data("textOpacity",r.attr("opacity")||1),r.attr("opacity",.3)),n.wijraphael.addClass(n(r.node),t.wijCSS.legendText+" "+t.wijCSS.legend),n(r.node).data("legendIndex",j).data("index",B)}):(i.visible===!1&&(!h||h&&(!i.markers||!i.markers.visible))&&(n(f.node).data("hidden",!0).data("textOpacity",f.attr("opacity")||1),f.attr("opacity",.3)),n.wijraphael.addClass(n(f.node),t.wijCSS.legendText+" "+t.wijCSS.legend),n(f.node).data("legendIndex",j).data("index",B)),j++),B++}o=n.extend(!0,{legendEntry:!0,display:"show"},o),o.type==="pie"&&o.legendEntry?n.each(o.data,function(e,t){t=n.extend({legendEntry:o.legendEntry},t),u(t)}):e._isPieChart()?u(o):e._checkSeriesDataEmpty(o)||u(o)}),c=e.legends.length,h=r.textMargin,f&&(y=f.wijGetBBox(),b=y.height,w=y.width),n.each(e.legends,function(e,t){var n=t.wijGetBBox();n.width>E&&(E=n.width),n.height>S&&(S=n.height)});if(u==="east"||u==="west")a==="horizontal"?(x=c*(E+m+i)+c*(h.left+h.right),x>d/2?(N=Math.floor(d/2/E),N<1&&(N=1)):N=c):a==="vertical"&&(T=S*c+b+c*(h.top+h.bottom),T>v?N=Math.ceil(T/v):N=1);else if(u==="south"||u==="north")a==="horizontal"?(x=(E+m+i)*c+c*(h.left+h.right),x>d?(N=Math.floor(c/x*d),N<1&&(N=1)):N=c):a==="vertical"&&(T=S*c+b+c*(h.top+h.bottom),T>v/2?(C=Math.floor(v-b)/2/S,N=Math.ceil(c/C)):N=1);N===0&&(N=1),k=N*(E+m+i)+N*(h.left+h.right),L=S*Math.ceil(c/N)+b+Math.ceil(c/N)*(h.top+h.bottom),k=k>w?k:w,M=e._calculatePosition(u,k,L),_=M.x-k/2,D=M.y-L/2,P=e.canvas.rect(_-i,D-i,k+2*i,L+2*i),n.wijraphael.addClass(n(P.node),t.wijCSS.legendContainer),P.attr(r.style),P.toBack(),e.legendEles.push(P),f&&f.transform(Raphael.format("...T{0},{1}",_+k/2,D+b/2)),A=b,n.each(e.legends,function(s,o){d=H[s];var u=o.wijGetBBox(),a,f=d["stroke-width"]||0,l=_+O*(m+f*2+E+i)+(O+1)*h.left+O*h.right,c=D+A+u.height/2+h.top+S/2-u.height/2,p=c-g/2-f,d,v,y=o;r.textWidth&&(y=o[0]),a=e._paintLegendIcon(l,p,m,g,d,n(y.node).data("legendIndex"),n(y.node).data("index"),t.wijCSS.legendIcon+" "+t.wijCSS.legend,I[n(y.node).data("legendIndex")],y),n(y.node).data("hidden")===!0&&(n(y.node).data("iconOpacity",a.attr("opacity")||1),a.attr("opacity",.3)),r.textStyle["text-anchor"]==="start"&&(l-=u.width/2),r.textWidth?o.transform(Raphael.format("...T{0},{1}",l+m+i,c-u.height/2)):o.transform(Raphael.format("...T{0},{1}",l+m+i+u.width/2,c)),Raphael.vml&&(v=e.canvas.rect(l+m+i,c-u.height/2,u.width,u.height).attr({stroke:"none",fill:"#000000",opacity:.01}),n.wijraphael.addClass(n(v.node),t.wijCSS.legendTextCover+" "+t.wijCSS.legend),n(v.node).data("legendIndex",n(y.node).data("legendIndex")),n(v.node).data("index",n(y.node).data("index")),e.legendEles.push(v)),o.toFront(),O++,O===N&&(O=0,A+=S+h.top+h.bottom)})},t.prototype._getLegendStyle=function(e){return e},t.prototype._hasAxes=function(){return this.widgetName==="wijpiechart"?!1:!0},t.prototype._applyAxisText=function(e,t){var r=this,i=e.text,s=null,o=null,u=null,a=0,f=0,l=t.bounds||r.canvasBounds;if(i!==null&&i!==undefined&&i.length>0){o=r._text(-100,-100,i),u=n.extend(!0,{},r.options.textStyle,e.textStyle),o.attr(u),s=o.wijGetBBox(),u["margin-left"]&&(f+=parseFloat(u["margin-left"])),u["margin-top"]&&(a+=parseFloat(u["margin-top"])),u["margin-right"]&&(f+=parseFloat(u["margin-right"])),u["margin-bottom"]&&(a+=parseFloat(u["margin-bottom"]));switch(e.compass){case"north":l.startY+=s.height+a;break;case"south":l.endY-=s.height+a;break;case"east":l.endX-=s.height+f;break;case"west":l.startX+=s.height+f}o.wijRemove(),o=null}return s},t.prototype._isSeriesListDataEmpty=function(){var e=this,t=this,r=t.options.seriesList,i=!0;return n.each(r,function(t,n){if(!e._checkSeriesDataEmpty(n))return i=!1,!1}),i},t.prototype._checkEmptyData=function(e){return!e||!n.isArray(e)?!0:!1},t.prototype._checkSeriesDataEmpty=function(e){var t=this._checkEmptyData,n=e.data;return!n||(t(n.x)||t(n.y))&&t(n.xy)?!0:!1},t.prototype._setTooltipContent=function(e){var t=this,r,i,s,o=t.tooltip,u,a={},f=t.options.hint,l=n.isFunction;o&&(r=[],n.each(e,function(e,t){var i=t.valX,s=t.valY;i&&s?r.push(n.extend({},t,{x:i,y:s})):r.push(t)}),u=o.getOptions(),i=f.title,s=f.content,l(i)&&(a.title=function(){return i.call(r)}),l(s)&&(a.content=function(){return s.call(r)}),o.setOptions(a))},t.prototype._setTooltip=function(){var e=this,t=e.options,n=e.tooltip,r;n&&(r={closeBehavior:"none",style:{stroke:t.indicator.style.stroke},animated:!1,showDelay:0,hideDelay:0,windowCollisionDetection:"fit",beforeShowing:function(t,n){if(this.target&&e.indicatorLine)return!1}},t.horizontal&&(r.compass="east"),n.setOptions(r))},t.prototype._resetTooltip=function(){var e=this,t=e.options,r=t.hint,i=r.title,s=r.content,o=e.tooltip,u=n.isFunction,a=n.extend(!0,{},this.options.hint);o&&(a.animated=r.animated,a.showDelay=r.showDelay,a.hideDelay=r.hideDelay,a.title=r.title,a.content=r.content,a.closeBehavior=r.closeBehavior||"auto",a.windowCollisionDetection="fit",u(i)&&(a.title=function(){return e._getTooltipText(i,this.target)}),u(s)&&(a.content=function(){return e._getTooltipText(s,this.target)}),a.beforeShowing=function(){e._onBeforeTooltipShowing(this)},o.setOptions(a))},t.prototype._fotmatTooltip=function(e){var t=this;return t._isDate(e)?Globalize.format(e,"f",t._getCulture()):isNaN(e)?e:Globalize.format(parseFloat(e),"n",t._getCulture())},t.prototype._setDefaultTooltipText=function(e){var t=e.label;return e.lineSeries&&e.lineSeries.label&&(t=e.lineSeries.label),t+":"+this._fotmatTooltip(e.y)},t.prototype._paintTooltip=function(){var e=this,t=e.options,r=t.hint,i=!t.disabled&&r.enable,o=r,u,a,f=n.isFunction;i&&!e.tooltip&&(o=n.extend(!0,{},r,{}),u=r.title,a=r.content,a||(a=r.content=function(){var t;if(n.isArray(this)){var r="";return n.each(this,function(t,n){r+=e._setDefaultTooltipText(n)+"\n"}),r}return e._setDefaultTooltipText(this)}),f(u)&&(o.title=function(){return e._getTooltipText(u,this.target)}),f(a)&&(o.content=function(){return e._getTooltipText(a,this.target)}),o.beforeShowing=function(){e._onBeforeTooltipShowing(this)},e.tooltip=new s(e.canvas,null,o))},t.prototype._getTooltipText=function(e,t){var r=n(t.node).data("wijchartDataObj"),i={data:r,label:r.label,x:r.x,y:r.y,target:t,fmt:e};return n.proxy(e,i)()},t.prototype._onBeforeTooltipShowing=function(e){var t=e.target,n=this.options.hint.style;t&&(e.options.style.stroke=n.stroke||t.attrs.stroke||t.attrs.fill)},t.prototype._paintChartArea=function(){var e=this,t=e.options,r=t.axis,i=2,s=null,o=null,u={},a=5,f=0,l=0,c=n.isArray(r.y),h=0,p,d,v;e._applyMargins(),e.isMultiYAxis=c;if(e._isSeriesListDataEmpty())return;c&&n.each(r.y,function(e,t){r.y[e]=n.extend(!0,{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!1,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"center",width:null},compass:"west",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!0,style:{stroke:"#999999","stroke-width":"0.5","stroke-dasharray":"none"}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},t)});if(e._hasAxes()){if(e.innerState.axisInfo)e.axisInfo=e.innerState.axisInfo,e.canvasBounds=e.innerState.canvasBounds;else{s=e._applyAxisText(r.x,{}),e.axisInfo={x:{id:"x",tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,originalMax:0,originalMin:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:s,axisTextOffset:i,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:r.x.annoMethod,valueLabels:r.x.valueLabels||[]},y:{}},e.axisCompass[r.x.compass]=!0,c?n.each(r.y,function(t,n){o=e._applyAxisText(n,{}),e.axisInfo.y[t.toString()]={id:"y"+t,tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:o,axisTextOffset:i,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:n.annoMethod,valueLabels:n.valueLabels||[]},e.axisCompass[n.compass]||(e.axisCompass[n.compass]=!0)}):(o=e._applyAxisText(r.y,{}),e.axisInfo.y[0]={id:"y",tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:o,axisTextOffset:i,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:r.y.annoMethod,valueLabels:r.y.valueLabels||[]},e.axisCompass[r.y.compass]||(e.axisCompass[r.y.compass]=!0)),e._getSeriesGroup(c),u=e._getDataExtreme(c),e.extremeValue=u,r.x.autoMin&&e.axisInfo.x.autoMin?r.x.min=u.txn:r.x.min&&e._isDate(r.x.min)&&(r.x.min=n.toOADate(r.x.min)),r.x.autoMax&&e.axisInfo.x.autoMax?r.x.max=u.txx:r.x.max&&e._isDate(r.x.max)&&(r.x.max=n.toOADate(r.x.max)),n.each(u.y,function(e,t){h++});for(p=0;p<(r.y.length||1);p++){d=r.y[p]||r.y,v=p.toString(),d.autoMin&&e.axisInfo.y[v].autoMin&&u.y[v]?d.min=u.y[v].tyn:d.min&&e._isDate(d.min)&&(d.min=n.toOADate(d.min)),d.autoMax&&e.axisInfo.y[v].autoMax&&u.y[v]?d.max=u.y[v].tyx||0:d.max&&e._isDate(d.max)&&(d.max=n.toOADate(d.max));do{l=e._autoPosition(e.axisInfo,r,"y",v),f=e._autoPosition(e.axisInfo,r,"x",v);if(l===e.axisInfo.y[v].offset&&f===e.axisInfo.x.offset){a=0;break}!isNaN(f)&&!isNaN(l)&&(l!==e.axisInfo.y[v].offset&&l!==0&&(e.axisInfo.y[v].offset=l,e.axisInfo.y[v].vOffset=f),f!==e.axisInfo.x.offset&&f!==0&&(e.axisInfo.x.offset=f,e.axisInfo.x.vOffset=l)),a--}while(a>0)}e._adjustPlotArea(r.x,e.axisInfo.x),e._adjustPlotArea(r.y,e.axisInfo.y,!0),e.innerState.axisInfo=e.axisInfo,e.innerState.canvasBounds=e.canvasBounds}e._paintAxes(),e._paintPlotArea()}else e._paintPlotArea()},t.prototype._getSeriesGroup=function(e){var t=this,r=t.options,i={};n.each(r.seriesList,function(t,n){n.yAxis&&e?i[n.yAxis.toString()]?i[n.yAxis.toString()].push(n):i[n.yAxis.toString()]=[n]:i[0]?i[0].push(n):i[0]=[n]}),t.seriesGroup=i},t.prototype._adjustPlotArea=function(e,t,r){var i=this.canvasBounds,s,o={east:Number.MIN_VALUE,west:Number.MIN_VALUE,south:Number.MIN_VALUE,north:Number.MIN_VALUE};if(r)n.each(t,function(e,t){s=e}),n.each(t,function(t,n){var r=e[t]||e,i=r.compass;r.max=n.max,r.min=n.min;switch(i){case"north":o.north=Math.max(n.offset,o.north);break;case"south":o.south=Math.max(n.offset,o.south);break;case"east":o.east=Math.max(n.offset,o.east);break;case"west":o.west=Math.max(n.offset,o.west)}}),o.north!==Number.MIN_VALUE&&(i.startY+=o.north),o.south!==Number.MIN_VALUE&&(i.endY-=o.south),o.east!==Number.MIN_VALUE&&(i.endX-=o.east),o.west!==Number.MIN_VALUE&&(i.startX+=o.west);else{e.max=t.max,e.min=t.min;switch(e.compass){case"north":i.startY+=t.offset;break;case"south":i.endY-=t.offset;break;case"east":i.endX-=t.offset;break;case"west":i.startX+=t.offset}}},t.prototype._autoPosition=function(e,t,n,r){return this._autoPositionCartesianAxis(e,t,n,r)},t.prototype._autoPositionCartesianAxis=function(e,t,r,i){var s=this,o=null,u,a,f,l,c,h,p,d,v=s.lastAxisOffset||{},m,g;r==="y"?(u=e.y[i],a=t.y[i]||t.y,l=t.x,f=e.x):(u=e.x,a=t.x,f=e.y[i],l=t.y[i]||t.y),c=a.compass,h=l.origin,p=f.max,d=f.min,h!==null&&s._isDate(h)&&(h=n.toOADate(h)),s._calculateParameters(u,a),o=s._getMaxExtents(u,a);switch(c){case"north":case"south":m=o.height,u.maxExtent=m;break;case"east":case"west":m=o.width,u.maxExtent=m}return r==="y"&&v[c]&&(n.each(v[c],function(e,t){e!==i&&(g=t)}),g&&!u.isPartAxis&&(u.preStartOffset=g,m+=g)),r==="y"&&(v[c]===undefined&&(v[c]={}),v[c][i]=m+s._getAxisLabelBox(a).width,s.lastAxisOffset=v),m},t.prototype._getAxisLabelBox=function(e){var t=this,r=t.options,i=e.text,s=0,o=0,u=0,a=0,f,l,c=t._isVertical(e.compass),h=n.extend(!0,{},r.textStyle,e.textStyle);return h["margin-top"]&&(s=parseFloat(h["margin-top"])),h["margin-left"]&&(u=parseFloat(h["margin-left"])),h["margin-right"]&&(o=parseFloat(h["margin-right"])),h["margin-bottom"]&&(a=parseFloat(h["margin-bottom"])),f=t._text(0,0,i),f.attr(h),c&&f.transform("...R-90"),l=f.wijGetBBox(),f.wijRemove(),f=null,{width:l.width+u+o,height:l.height+a+s}},t.prototype._getMaxExtents=function(e,t,r){var i=this,s=i.options,o=null,u={width:0,height:0},a=e.min,f=e.max,l=e.isTime,c=t.annoFormatString,h=s.is100Percent,p=0,d=t.compass,v=t.labels,m,g=!1,y=e.bounds||i.canvasBounds,b,w;e.majorTickRect=i._getTickRect(e,t,!0,!0,r),e.minorTickRect=i._getTickRect(e,t,!1,!0,r),o=i._getMajorTickValues(e,t),e.id==="x"&&(o=this._adjustTickValuesForCandlestickChart(o));if(!t.textVisible)return u;if(!c||c.length===0)c=e.annoFormatString;return m=n.extend(!0,{},s.textStyle,t.textStyle,v.style),w=m.transform,g=w&&/r/i.test(w),m=n.extend(!0,m,e.textStyle),b=y.endX-y.startX-e.vOffset-e.axisTextOffset,o&&o.length&&(b/=o.length-1,n.each(o,function(t,r){var s,o,y;if(r<a||r>f)return!0;if(e.annoMethod==="valueLabels"){if(r<0)return!0;if(p>=e.valueLabels.length)return!1;r=e.valueLabels[p],r.text?r=r.text:typeof r.value!="undefined"&&(r=r.value,c&&c.length&&(r=Globalize.format(r,c,i._getCulture())))}else e.annoMethod==="values"&&(e.id==="x"&&(r=i._getXTickText(r)),c&&c.length?(l&&(r=n.fromOADate(r)),r=Globalize.format(r,c,i._getCulture())):h&&e.id==="y"&&(r=Globalize.format(r,"p0",i._getCulture())));v.width?s=i.canvas.wrapText(-100,-100,r,v.width,v.textAlign,m):s=i._text(-100,-100,r).attr(m),o=s.wijGetBBox(),!i._isVertical(d)&&!g&&e.annoMethod==="valueLabels"&&o.width>b&&(s.attr({transform:"r-45"}),o=s.wijGetBBox(),t===0&&(m.transform="r-45",e.textStyle={transform:"r-45"},y=s.clone(),y.attr({transform:"r0"}),o=y.wijGetBBox(),Math.sqrt(2)*o.height>b&&(s.attr({transform:"r-90"}),m.transform="r-90",e.textStyle={transform:"r-90"}),y.wijRemove(),y=null,o=s.wijGetBBox())),s.wijRemove(),s=null,o.width>u.width&&(u.width=o.width),o.height>u.height&&(u.height=o.height),p++})),u.width<v.width&&(u.width=v.width),e.labelWidth=u.width,u},t.prototype._getMajorTickValues=function(e,t){var r=[],i=t.autoMajor,s=t.unitMajor,o,u,a=e.valueLabels;return a&&a.length>0&&n.each(a,function(e,t){if(typeof t.text!="undefined"||typeof t.value!="undefined")return!1;typeof t=="string"?a[e]={text:t,gridLine:!1}:a[e]={value:t,gridLine:!1}}),e.annoMethod==="valueLabels"&&a&&a.length>0&&typeof a[0].value!="undefined"?(r=this._getSortedDataValues(e,t),r):(e.id==="x"?(o=i?e.max:e.originalMax,u=i?e.min:e.originalMin):(o=e.max,u=e.min),r=this._getTickValues(o,u,s,e.tprec,!e.isTime,i),r)},t.prototype._getSortedDataValues=function(e,t){var r=this,i=[],s=e.valueLabels;return n.each(s,function(e,t){var s=t.value;r._isDate(s)?i.push(n.toOADate(s)):typeof s=="number"?i.push(s):i.push(e)}),i},t.prototype._getMinorTickValues=function(e,t){var n=[],r=t.autoMinor,i=t.unitMinor,s,o;return e.id==="x"?(s=r?e.max:e.originalMax,o=r?e.min:e.originalMin):(s=e.max,o=e.min),n=this._getTickValues(s,o,i,e.tprec,!e.isTime,r),n},t.prototype._getTickValues=function(e,t,r,s,o,u){var a=this,f=[],l=t,c=0,h=0,p=0,d=0,v=0,m=0;try{if(r===0)f=[e,t];else{u?(s+1<0?s=-1:s+1>15&&(s=14),m=n.round(i.signedCeiling(t/r)*r,s+1),m<e&&(t=m),p=parseInt(n.round(e/r,5).toString(),10),d=parseInt(n.round(t/r,5).toString(),10),v=parseInt((p-d+1).toString(),10),v>1&&(h=d*r,h<t&&(v--,t+=r),h=t+(v-1)*r,h>e&&v--),v<1&&(v=2,t=l,r=e-t)):(v=parseInt(((e-t)/r+1).toString(),10),v>1&&(h=t+(v-1)*r,h>e&&v--),v<1&&(v=2,r=e-t));for(c=0;c<v;c++)o?u?f[c]=n.round(t+c*r,s+1):f[c]=t+c*r:f[c]=t+c*r}}catch(g){}return f},t.prototype._getTickRect=function(e,t,n,r,i){var s=t.compass,o=0,u=null,a=3,f=2,l=2,c=t.tickMajor.factor,h=t.tickMinor.factor,p={x:0,y:0,width:0,height:0};n?(u=t.tickMajor.position,c=c>0?c:1,o=a*c):(u=t.tickMinor.position,h=h>0?h:1,o=f*h);if(u==="none"||u==="inside"&&r)o=0;return s==="east"||s==="west"?(p={x:0,y:-1,width:o*l,height:l},s==="east"&&(u==="outside"||u==="cross"&&r)||s==="west"&&u==="inside"?p.width+=2:r||(u==="cross"&&(p.width<<=1),p.width+=2)):(p={x:-1,y:0,width:l,height:o*l},s==="south"&&(u==="outside"||u==="corss"&&r)||s==="north"&&u==="inside"?p.height+=2:r||(u==="cross"&&(p.height<<=1),p.height+=2)),p},t.prototype._applyMargins=function(){var e=this,t=e.options,n=e.canvasBounds;n.startX+=t.marginLeft,n.endX-=t.marginRight,n.startY+=t.marginTop,n.endY-=t.marginBottom},t.prototype._paintAxes=function(){var e=this,t=e.options.axis,r=e.axisInfo,i=t.x,s=t.y,o=r.x,u=r.y,a;a=e._paintAxis(i,o),n.each(u,function(t,n){var r=s[t]||s;r.origin!==null&&e._translateAxisIfNeeded(a,i.compass,r.origin,r.compass,n.max,n.min)}),n.each(u,function(t,n){var r=s[t]||s;a=e._paintAxis(r,n),i.origin!==null&&e._translateAxisIfNeeded(a,r.compass,i.origin,i.compass,o.max,o.min)})},t.prototype._translateAxisIfNeeded=function(e,t,r,i,s,o){var u=this,a=i==="west"||i==="east",f=u.canvasBounds,l=r,c;u._isDate(l)&&(l=n.toOADate(l)),a?(t==="south"?c=(o-l)/(s-o)*(f.endY-f.startY):c=(s-l)/(s-o)*(f.endY-f.startY),n.each(e,function(e,t){t.transform(Raphael.format("...T{0},{1}",0,c))})):(t==="west"?c=(l-o)/(s-o)*(f.endX-f.startX):c=(l-s)/(s-o)*(f.endX-f.startX),n.each(e,function(e,t){t.transform(Raphael.format("...T{0},{1}",c,0))}))},t.prototype._paintAxis=function(e,t){var r=this,i=r.options,s=t.bounds||r.canvasBounds,o={x:0,y:0},u={x:0,y:0},a=e.compass,f=2,l=!0,c=null,h=[],p=[],d=[],v=t.max,m=t.min,g=e.unitMajor,y=e.unitMinor,b=e.tickMajor.position,w=e.tickMinor.position,E=t.maxExtent,S=e.tickMajor.style,x=e.tickMinor.style,T=t.majorTickRect,N=t.minorTickRect,C=t.axisTextOffset,k=e.gridMajor,L=e.gridMinor,A=e.labels,O=0,M=[],_=0,D=e.annoFormatString,P=null,H=[];T=r._getTickRect(t,e,!0,!1),N=r._getTickRect(t,e,!1,!1);if(!D||D.length===0)D=t.annoFormatString;h=r._getMajorTickValues(t,e),p=r._getMinorTickValues(t,e),d=r._resetMinorTickValues(p,h),t.id==="x"&&(h=this._adjustTickValuesForCandlestickChart(h));switch(a){case"south":o.x=s.startX,o.y=s.endY,u.x=s.endX,u.y=s.endY,l=!1;break;case"north":o.x=s.startX,o.y=s.startY-f,u.x=s.endX,u.y=s.startY-f,l=!1;break;case"east":o.x=s.endX-f,o.y=s.endY,u.x=s.endX-f,u.y=s.startY+r._getOffsetOfAxis(e),t.preStartOffset&&(o.x+=t.preStartOffset,u.x+=t.preStartOffset);break;case"west":o.x=s.startX,o.y=s.endY,u.x=s.startX,u.y=s.startY+r._getOffsetOfAxis(e),t.preStartOffset&&(o.x-=t.preStartOffset,u.x-=t.preStartOffset)}return e.visible&&(c=r.canvas.line(o.x,o.y,u.x,u.y).attr(e.style),n.wijraphael.addClass(n(c.node),i.wijCSS.axis),r.axisEles.push(c),H.push(c)),n.each(h,function(s,f){var l=f,c=t.isTime,h=i.is100Percent,p,d,y=!1,w={};if(f<m||f>v)return _++,!0;if(t.annoMethod==="valueLabels"){if(_>=t.valueLabels.length)return!1;l=t.valueLabels[_],y=l.gridLine,w=l.gridLineStyle,l.text?l=l.text:typeof l.value!="undefined"&&(l=l.value,D&&D.length&&(l=Globalize.format(l,D,r._getCulture())))}else t.annoMethod==="values"&&(t.id==="x"&&(l=r._getXTickText(l)),D&&D.length?(c&&(l=n.fromOADate(f)),l=Globalize.format(l,D,r._getCulture())):h&&t.id==="y"&&(l=Globalize.format(f,"p0",r._getCulture())));P=n.extend(!0,{},i.textStyle,e.textStyle,A.style,t.textStyle),p=r._paintMajorMinor(e.origin,v,m,f,b,g,T,a,o,u,E,C,S,l,k,e.textVisible,P,A.textAlign,A.width?t.labelWidth:null,y,w),p&&(p.elements&&(H=H.concat(p.elements)),d=p.textInfo),d&&(M.push(d),O<d.len&&(O=d.len)),_++}),A.width||n.each(M,function(e,t){var n=t.text,r=(t.len-O)/2;r=A.textAlign==="near"?r*-1:r,l?n.transform(Raphael.format("...T{0},{1}",r,0)):n.transform(Raphael.format("...T{0},{1}",0,r))}),n.each(d,function(n,i){var s;i>m&&i<v&&(s=r._paintMajorMinor(e.origin,v,m,i,w,y,N,a,o,u,E,C,x,null,L,e.textVisible,P,A.textAlign,A.width?t.labelWidth:null),s&&s.elements&&(H=H.concat(s.elements)))}),e.text&&e.text.length>0&&H.push(r._paintAxisText(e,t)),t.isPartAxis&&!t.isLastAxis&&H.push(r.canvas.path(["M",o.x.toString(),(o.y+t.vOffset/2).toString(),"H",(o.x+t.maxExtent*2).toString()].join())),H},t.prototype._paintAxisText=function(e,t){if(!e.text||e.text.length===0)return;var r=this,i=r.options,s=e.text,o=e.compass,u=e.alignment,a=t.bounds||r.canvasBounds,f=a.startX,l=a.startY,c=a.endX,h=a.endY,p=f,d=l,v=t.textBounds,m=r._isVertical(o),g=t.axisTextOffset,y=t.majorTickRect,b=e.tickMajor.position,w=m?y.width:y.height,E=null,S=null,x=0,T=0,N=0,C=0;E=n.extend(!0,{},r.options.textStyle,e.textStyle),E["margin-top"]&&(x=parseFloat(E["margin-top"])),E["margin-left"]&&(T=parseFloat(E["margin-left"])),E["margin-right"]&&(N=parseFloat(E["margin-right"])),E["margin-bottom"]&&(C=parseFloat(E["margin-bottom"])),b==="cross"?w/=2:b==="inside"&&(w=0);if(m){switch(u){case"near":d=h-v.width/2;break;case"center":d=(l+h)/2;break;case"far":d=l+v.width/2}o==="west"?p=f-(t.offset+g+w+v.height/2+N):p=c+t.offset+g+w+v.height/2+T}else{switch(u){case"near":p=f+v.width/2;break;case"center":p=(f+c)/2;break;case"far":p=c-v.width/2}o==="north"?d=l-(t.offset+g+w+v.height/2+C):d=h+t.offset+g+w+v.height/2+x}return S=r._text(p,d,s),n.wijraphael.addClass(n(S.node),i.wijCSS.axisText),r.axisEles.push(S),S.attr(E),m&&S.transform("...R-90"),S},t.prototype._resetMinorTickValues=function(e,t){var n=0,r=0,i=null,s=null;for(n=e.length-1;n>=0;n--){i=e[n];for(r=t.length-1;r>=0;r--)s=t[r],i===s&&e.splice(n,1)}return e},t.prototype._getXTickText=function(e){return e},t.prototype._adjustTickValuesForCandlestickChart=function(e){return e},t.prototype._paintMajorMinor=function(e,t,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S=this,x=f.x,T=f.y,N=S.options,C=-1,k=-1,L=!0,A=S.canvasBounds,O=null,M=null,_=[],D=[],P=null,H={"stroke-width":2},B={text:null,len:0},j=null,F={},I=[],q=S.axisCompass;switch(a){case"south":s==="inside"?T-=u.height:s==="cross"&&(T-=u.height/2),b?k=T+h+u.height:k=T+h+u.height+c/2,L=!1;break;case"west":s==="outside"?x-=u.width:s==="cross"&&(x-=u.width/2),b?C=x-(h+c):C=x-(h+c/2);break;case"north":s==="outside"?T-=u.height:s==="cross"&&(T-=u.height/2),b?k=T-(h+c):k=T-(h+c/2),L=!1;break;case"east":s==="inside"?x-=u.width:s==="cross"&&(x-=u.width/2),b?C=x+h+u.width:C=x+h+u.width+c/2}return L?(T+=(i-r)/(t-r)*(l.y-f.y),D=["M",A.startX,T,"H",A.endX],v.visible&&((T!==A.startY||!q.north)&&(T!==A.endY||!q.south)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(v.style),S.axisEles.push(P)),w&&((T!==A.startY||!q.north)&&(T!==A.endY||!q.south)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(n.extend(!0,{},v.style,E)),S.axisEles.push(P)),k=T,s!=="none"&&(_=["M",x,T,"h",u.width],p["stroke-width"]=u.height)):(x+=(i-r)/(t-r)*(l.x-f.x),D=["M",x,A.startY,"V",A.endY],v.visible&&((x!==A.startX||!q.west)&&(x!==A.endX||!q.east)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(v.style),S.axisEles.push(P)),w&&((x!==A.startX||!q.west)&&(x!==A.endX||!q.east)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(n.extend(!0,{},v.style,E)),S.axisEles.push(P)),b?C=x-b/2:C=x,s!=="none"&&(_=["M",x,T,"v",u.height],p["stroke-width"]=u.width)),s!=="none"&&(M=S.canvas.path(_.join(" ")),n.wijraphael.addClass(n(M.node),N.wijCSS.axisTick),H=n.extend(H,p),M.attr(H),S.axisEles.push(M),I.push(M)),d!==null&&m&&(b?(B=S.canvas.wrapText(C,k,d.toString(),b,y,g),n.wijraphael.addClass(n(B.node),N.wijCSS.axisLabel)):(B=S._text(C,k,d.toString()),n.wijraphael.addClass(n(B.node),N.wijCSS.axisLabel),B.attr(g)),S.axisEles.push(B),I.push(B),m||B.hide(),y!=="center"&&(j=B.getBBox(),O={text:B,len:L?j.width:j.height})),F={textInfo:O,elements:I},F},t.prototype._paintPlotArea=function(){},t.prototype._paintChartLabels=function(){var e=this,t=e.options.chartLabels;t&&t.length&&n.each(t,function(t,r){var i;r=n.extend(!0,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,pointIndex:-1,x:-1,y:-1},offset:0,visible:!1,text:"",connected:!1},r);if(r.visible){i=e._getChartLabelPointPosition(r);if(typeof i.x!="number"||typeof i.y!="number")return!1;e._setChartLabel(r,i)}})},t.prototype._getChartLabelPointPosition=function(e){},t.prototype._setChartLabel=function(e,t,r,i){var s=this,o=e.compass,u=s.options,a=n.extend(!0,{},u.textStyle,u.chartLabelStyle),f=s._text(0,0,e.text).attr(a),l=e.offset,c=0,h=0,p=null,d=null;n.wijraphael.addClass(n(f.node),u.wijCSS.labelText),s.chartLabelEles.push(f),p=s._getCompassTextPosition(o,f.wijGetBBox(),l,t,r),l&&e.connected&&(d=s.canvas.path("M"+t.x+" "+t.y+"L"+p.endPoint.x+" "+p.endPoint.y),n.wijraphael.addClass(n(d.node),u.wijCSS.labelConnect),d.attr(i),s.chartLabelEles.push(d)),c=p.endPoint.x+p.offsetX,h=p.endPoint.y+p.offsetY,f.transform(Raphael.format("...T{0},{1}",c,h)).toFront()},t.prototype._getCompassTextPosition=function(e,t,r,i,s){var o=0,u=0,a={x:0,y:0};switch(e.toLowerCase()){case"east":s=0;break;case"west":s=180;break;case"north":s=90;break;case"south":s=270;break;case"northeast":s=45;break;case"northwest":s=135;break;case"southeast":s=315;break;case"southwest":s=225}return s>=0&&s<22.5||s>337.5&&s<360?o=t.width/2:s>=22.5&&s<67.5?(o=t.width/2,u=-1*t.height/2):s>=67.5&&s<112.5?u=-1*t.height/2:s>=112.5&&s<157.5?(o=-1*t.width/2,u=-1*t.height/2):s>=157.5&&s<202.5?o=-1*t.width/2:s>=202.5&&s<247.5?(o=-1*t.width/2,u=t.height/2):s>=247.5&&s<292.5?u=t.height/2:(o=t.width/2,u=t.height/2),a=n.wijraphael.getPositionByAngle(i.x,i.y,r,s),{endPoint:a,offsetX:o,offsetY:u}},t.prototype._isTouchEnabled=function(){return n.support.isTouchEnabled&&n.support.isTouchEnabled()},t.prototype._mouseDown=function(e,t){this._trigger("mouseDown",e,t)},t.prototype._mouseUp=function(e,t){this._trigger("mouseUp",e,t)},t.prototype._mouseOver=function(e,t){this._trigger("mouseOver",e,t)},t.prototype._mouseOut=function(e,t){this._trigger("mouseOut",e,t)},t.prototype._mouseMove=function(e,t){this._trigger("mouseMove",e,t)},t.prototype._click=function(e,t){this._trigger("click",e,t)},t.prototype._mouseMoveInsidePlotArea=function(e,t){var r=this,i=r.options,s=i.indicator,o=r.canvas,u,a,f,l=0,c=[],h=i.horizontal;s&&s.visible&&this.isPlotAreaMouseDown&&(h?u=this._calculatePositionByX(t.top):u=this._calculatePositionByX(t.left),u&&this.indicatorLine&&u.x!==this.lastIndicatorPosition&&(n.each(u.data,function(e,t){t.visible&&c.push(t)}),c.length>0&&(a=r.canvasBounds,h?this.indicatorLine.transform("T0 "+u.x):this.indicatorLine.transform("T"+u.x+" 0"),this._setTooltipContent(c),h?this.tooltip.showAt({x:a.endX,y:u.x}):this.tooltip.showAt({x:u.x,y:a.startY}),this.lastIndicatorPosition=u.x,r._indicatorLineShowing(c),this.lastIndicatorObjects=c)))},t.prototype._calculatePositionByX=function(e){var t=this,n=t.pointXs,r,i=t.dataPoints;return n&&n.length>0&&(r=this._calculatePositionByXInternal(e,n)),i?{x:r,data:i[r.toString()]}:null},t.prototype._calculatePositionByXInternal=function(e,t){var n=t.length,r,i;return n===1?t[0]:n===2?Math.abs(e-t[0])>Math.abs(e-t[1])?t[1]:t[0]:(r=parseInt((n/2).toString()),e>t[r]?i=t.slice(r):i=t.slice(0,r+1),this._calculatePositionByXInternal(e,i))},t.prototype._mouseMoveOutsidePlotArea=function(e,t){this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null,this.tooltip&&this.tooltip.hide(),this._resetTooltip())},t.prototype._mouseDownInsidePlotArea=function(e,t){this.isPlotAreaMouseDown=!0;var r=this,i=r.options,s=i.indicator,o=r.canvas,u,a,f,l=[],c=i.horizontal;s&&s.visible&&this.isPlotAreaMouseDown&&(r._setTooltip(),c?u=this._calculatePositionByX(t.top):u=this._calculatePositionByX(t.left),u&&(n.each(u.data,function(e,t){t.visible&&l.push(t)}),l.length>0&&(a=r.canvasBounds,c?f=["M",a.startX,0,"H",a.endX]:f=["M",0,a.startY,"V",a.endY],this.indicatorLine&&this.indicatorLine.wijRemove(),this.indicatorLine=o.path(f),this.indicatorLine.attr(s.style),c?this.indicatorLine.transform("T0 "+u.x):this.indicatorLine.transform("T"+u.x+" 0"),this._setTooltipContent(l),c?this.tooltip.showAt({x:a.endX,y:u.x}):this.tooltip.showAt({x:u.x,y:a.startY}),this.lastIndicatorPosition=u.x,r._indicatorLineShowing(l),this.lastIndicatorObjects=l)),e.preventDefault())},t.prototype._indicatorLineShowing=function(e){this.lastIndicatorObjects&&this._removeIndicatorStyles(this.lastIndicatorObjects)},t.prototype._removeIndicatorStyles=function(e){},t.prototype._mouseUpInsidePlotArea=function(e,t){this.isPlotAreaMouseDown=!1,this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null,this.tooltip&&this.tooltip.hide(),this._resetTooltip()),this.lastIndicatorObjects&&(this._removeIndicatorStyles(this.lastIndicatorObjects),this.lastIndicatorObjects=null)},t.prototype._bindLiveEvents=function(){this._bindLegendEvents(),this._bindCanvasEvents(),this._bindResizeEvent()},t.prototype._bindResizeEvent=function(){var e=this;this.resizeIntent=250,this.options.autoResize&&this.chartElement.on("resize."+this.widgetName,function(){clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.redraw()},e.resizeIntent)})},t.prototype._unbindResizeEvent=function(){this.chartElement.off("resize."+this.widgetName)},t.prototype._bindCanvasEvents=function(){var e=this,t=e.chartElement,r="",i="."+this.widgetName;n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(window.navigator.pointerEnabled?t.css("touch-action","none"):window.navigator.msPointerEnabled&&t.css("-ms-touch-action","none")),n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(r="wij"),t.bind(r+"mousemove"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY&&e._mouseMoveInsidePlotArea(n,s)}),t.bind(r+"mouseout"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;if(s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY)return;e._mouseMoveOutsidePlotArea(n,s)}),e.options.indicator&&e.options.indicator.visible&&t.bind(r+"mousedown"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY&&e._mouseDownInsidePlotArea(n,s)}).bind(r+"mouseup"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY&&e._mouseUpInsidePlotArea(n,s)})},t.prototype._unbindCanvasEvents=function(){n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(window.navigator.pointerEnabled?this.element.css("touch-action",""):window.navigator.msPointerEnabled&&this.element.css("-ms-touch-action","")),this.element.unbind("."+this.widgetName)},t.prototype._bindLegendEvents=function(){var e=this,t=e.chartElement;t.delegate("."+e.options.wijCSS.legend,"click.wijchartcore",function(t){if(e.options.disabled)return;var r=n(t.target);r[0].tagName&&r[0].tagName==="tspan"&&(r=r.parent()),e._legendClick(r)})},t.prototype._legendClick=function(e){if(typeof e.data("index")=="undefined")return;var t=this,r=t.options.legend,i=e.data("index"),s=e.data("legendIndex"),o=t.chartElement.data("fields"),u=t.seriesEles,a,f=t.legendIcons[s],l=t.legends[s],c=r.textWidth?n(l[0].node):n(l.node),h=i,p;o&&o.seriesEles&&(u=o.seriesEles),t.legendDots&&t.legendDots.length>i&&(p=t.legendDots[i]),r.reversed&&(h=t.legends.length-1-i),a=u[h],t.legends.length&&(c.data("hidden")?(a&&t._showSerieEles(a),l.attr("opacity",c.data("textOpacity")),f.attr("opacity",c.data("iconOpacity")),p&&p.attr("opacity",c.data("dotOpacity")),c.data("hidden",!1)):(a&&t._hideSerieEles(a),c.data("textOpacity")||(r.textWidth?c.data("textOpacity",l[0].attr("opacity")||1):c.data("textOpacity",l.attr("opacity")||1)),c.data("iconOpacity")||c.data("iconOpacity",f.attr("opacity")||1),p&&!c.data("dotOpacity")&&c.data("dotOpacity",f.attr("opacity")||1),l.attr("opacity","0.3"),f.attr("opacity","0.3"),p&&p.attr("opacity","0.3"),c.data("hidden",!0)))},t.prototype._showSerieEles=function(e){},t.prototype._hideSerieEles=function(e){},t.prototype._unbindLiveEvents=function(){var e=this,t=e.options,n=this.chartElement,r=e.widgetName;n.undelegate("."+t.wijCSS.legend,".wijchartcore").undelegate("."+t.wijCSS.legend,"wijchartcore"),this._unbindCanvasEvents(),this._unbindResizeEvent()},t.prototype._isBarChart=function(){return!1},t.prototype._isPieChart=function(){},t.prototype._validateSeriesData=function(e){return!1},t.prototype._getOffsetOfAxis=function(e){return 0},t.prototype._calculateParameters=function(e,t){var n=this,r=t.max,s=t.min,o=t.autoMax&&e.autoMax,u=t.autoMin&&e.autoMin,a=t.autoMajor&&e.autoMajor,f=t.autoMinor&&e.autoMinor,l=null,c=null,h=e.annoMethod==="valueLabels",p=0,d=0,v=0,m=0,g=0,y=e.isTime,b=n.options.adjustMinValue;o&&r!==Number.MIN_VALUE&&e.id!=="x"&&n._isBarChart()&&r<0&&.5*(r-s)>-r&&(r=0),u&&s!==Number.MAX_VALUE&&e.id!=="x"&&n._isBarChart()&&s>0&&.5*(r-s)>s&&(s=0),r===s&&(s!==0&&(s-=1),r+=1),m=r-s;if(y){l=t.annoFormatString;if(!l||l.length===0)l=i.getTimeDefaultFormat(r,s),e.annoFormatString=l;g=i.niceTimeUnit(0,l)}c=i.nicePrecision(m),e.tprec=c,o&&(y?(d=i.roundTime(r,g,!0),d<r?r=d+g:r=d):(d=i.precCeil(-c,r),typeof d=="number"&&(r=d))),u&&(y?(v=i.roundTime(s,g,!1),v>s?s=v-g:s=v):(v=i.precFloor(-c,s),typeof v=="number"&&(s=v))),e.max=r,e.min=s,e.originalMax=r,e.originalMin=s,e.annoFormatString=l,e.tinc=g;if(a||f)m=r-s,n._calculateMajorMinor(t,e),p=t.unitMajor,o&&p!==0&&!y&&!h&&(m=r-parseInt((r/p).toString(),10)*p,m!==0&&(r+=p-m,r=i.precCeil(-c,r))),u&&p!==0&&!y&&!h&&(m=s-parseInt((s/p).toString(),10)*p,m!==0&&(m<0&&(m+=p),s-=Math.abs(m),s=i.precFloor(-c,s))),u&&p!==0&&!h&&(typeof b=="undefined"||b===!1)&&u&&s===t.min&&s-p>=0&&e.id==="y"&&(s-=p);e.max=r,e.min=s,e.originalMax=r,e.originalMin=s},t.prototype._supportStacked=function(){return!1},t.prototype._getDataExtreme=function(e){var t={txx:0,txn:0,tyx:0,tyn:0},n;return n=this._getDataExtremes(t,e),n?(n.txn>n.txx&&(n.txn=0,n.txx=1),n):(t.txn>t.txx&&(t.txn=0,t.txx=1),t)},t.prototype._getDataExtremes=function(e,t){var i=this,s=i.options,o=s.seriesList,u=s.stacked&&i._supportStacked(),a=s.is100Percent,f=s.axis,l=i.axisInfo,c=[],h=[],p=[],d,v={y:{}},m=f.x.valueLabels,g=l.x.annoMethod,y=l.y.annoMethod,b=0;return!o||o.length===0?e:(n.each(o,function(e,t){var r=t.data,i=[],s=[],o,u=0;if(r.xy&&n.isArray(r.xy)){o=r.xy.length;while(u<o)i.push(r.xy[u]),s.push(r.xy[u+1]),u+=2;r.x=i,r.y=s}}),i.seriesGroup&&n.each(i.seriesGroup,function(t,s){var o=[],m=parseInt(t,10);n.each(s,function(t,r){if(r.type==="pie")return!0;r=n.extend(!0,{display:"show"},r);var s=r.data,a=0,f=0,l=[].concat(s.xy),p=l.length,d,v;if(r.display==="exclude")return!0;c=[].concat(s.x),o=[].concat(s.y);if(s.xy&&p){c=[],o=[];while(f<p)c[a]=l[f],o[a]=l[f+1],f+=2,a++,s.x=c,s.y=o}else s.x||(c=[],n.each(o,function(e){c.push(e)}),s.x=c);u&&t>0&&n.each(o,function(e){o[e]+=h[e]}),h=o,d=i._getMinMaxValue(c),v=i._getMinMaxValue(o),t===0?(e.tyx=v.max,e.tyn=v.min):(e.tyx<v.max&&(e.tyx=v.max),e.tyn>v.min&&(e.tyn=v.min)),b===0?(e.txx=d.max,e.txn=d.min):(e.txx<d.max&&(e.txx=d.max),e.txn>d.min&&(e.txn=d.min)),b++}),a&&(e.tyx=1,e.tyn=0),v.y[t]={tyx:e.tyx,tyn:e.tyn},v.txx=e.txx,v.txn=e.txn,e.tyx=0,e.tyn=0;if(o.length){d=r.getFirstValidListValue(o);if(i._isDate(d))l.y[t].isTime=!0;else{if(typeof d=="undefined")return!0;typeof d!="number"&&(n.each(o,function(e,t){var n=f.y.annoFormatString,r=t;n&&n.length>0?r=Globalize.format(r,n,i._getCulture()):r=r.toString(),p.push({text:r,value:t,gridLine:!1})}),l.y[t].annoMethod="valueLabels",!f.y[m].valueLabels&&f.y[m].valueLabels.length===0?l.y[t].valueLabels=p:l.y[t].valueLabels=f.y[m].valueLabels,f.x.max=o.length-1,f.x.min=0,f.y[m].unitMajor=1,f.x.unitMinor=.5,l.y[t].autoMax=!1,l.y[t].autoMin=!1,l.y[t].autoMajor=!1,l.y[t].autoMinor=!1)}}}),c.length&&(d=r.getFirstValidListValue(c),g==="valueLabels"&&m&&m.length>0&&(l.x.valueLabels=m),i._isDate(d)?l.x.isTime=!0:typeof d!="number"&&(n.each(c,function(e,t){var r={},s,o;if(g==="valueLabels"&&m&&m.length&&e<m.length){s=m[e],o=typeof s;if(o==="string")s={text:s};else if(o==="number"||i._isDate(s))s={value:s}}r=n.extend({text:t,value:e,gridLine:!1},s),p.push(r)}),f.x.max=c.length-1,f.x.min=0,f.x.unitMajor=1,f.x.unitMinor=.5,l.x.annoMethod="valueLabels",l.x.valueLabels=p,l.x.autoMax=!1,l.x.autoMin=!1,l.x.autoMajor=!1,l.x.autoMinor=!1)),v)},t.prototype._isVertical=function(e){return e==="west"||e==="east"},t.prototype._isDate=function(e){return e?typeof e=="object"&&e.constructor===Date:!1},t.prototype._getMinMaxValue=function(e){var t=this,i={min:0,max:0},s=0,o;if(!e.length)return i;o=r.getFirstValidListValue(e);if(typeof o!="number"){if(!t._isDate(o))return i.min=0,i.max=e.length-1,i;i.min=o,i.max=o}else i.min=o,i.max=o;for(s=0;s<e.length;s++){if(e[s]===null||typeof e[s]=="undefined")continue;if(typeof e[s]=="number"&&isNaN(e[s]))continue;e[s]<i.min?i.min=e[s]:e[s]>i.max&&(i.max=e[s])}return t._isDate(i.min)&&(i.min=n.toOADate(i.min),i.max=n.toOADate(i.max)),i},t.prototype._getTickTextForCalculateUnit=function(e,t,r){var i=t.isTime,s=t.annoFormatString;return i?Globalize.format(n.fromOADate(e),s,this._getCulture()):n.round(e,r).toString()},t.prototype._calculateMajorMinor=function(e,t){var r=this,s=r.options,o=t.bounds||r.canvasBounds,u=e.autoMajor,a=e.autoMinor,f=t.max,l=t.min,c=t.isTime,h=t.tinc,p=t.annoFormatString,d=null,v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=f-l,T=0,N=0,C=0,k=0;if(u){S=n.extend(!0,{},s.textStyle,e.textStyle,e.labels.style);if(!c){w=i.nicePrecision(x),E=w+1;if(E<0||E>15)E=0}d=this._getTickTextForCalculateUnit(f,t,w),v=this._getTickTextForCalculateUnit(l,t,w),y=r._text(-1e3,-1e3,d).attr(S),b=r._text(-1e3,-1e3,v).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null,m.width<g.width&&(m.width=g.width),m.height<g.height&&(m.height=g.height),r._isVertical(e.compass)?(N=o.endY-o.startY-t.vOffset-t.axisTextOffset,k=N/m.height,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)):(T=o.endX-o.startX-t.vOffset-t.axisTextOffset,k=T/m.width,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)),k=x,C>0&&(x/=C,c?x<h?k=h:k=i.niceTimeUnit(x,t.annoFormatString):(t.tprec=i.nicePrecision(x),k=i.niceNumber(2*x,-w,!0),k<x&&(k=i.niceNumber(x,-w+1,!1)),k<x&&(k=i.niceTickNumber(x)))),e.unitMajor=k}a&&e.unitMajor&&!isNaN(e.unitMajor)&&(e.unitMinor=e.unitMajor/2)},t}(e.wijmoWidget);t.wijchartcore=u;var a=function(){function e(){this.width=null,this.height=null,this.wijCSS={headerText:"wijchart-header-text",headerContainer:"wijchart-header-container",footerText:"wijchart-footer-text",footerContainer:"wijchart-footer-container",legendTitle:"wijchart-legend-title",legendText:"wijchart-legend-text",legend:"wijchart-legend",legendDot:"chart-legend-dot",legendIcon:"wijchart-legend-icon",legendContainer:"wijchart-legend-container",legendTextCover:"wijchart-legend-textCover",axis:"wijchart-axis",axisText:"wijchart-axis-text",axisGridLine:"wijchart-axis-gridline",axisTick:"wijchart-axis-tick",axisLabel:"wijchart-axis-label",labelText:"wijchart-label-text",labelConnect:"wijchart-label-connect",canvasObject:"wijchart-canvas-object"},this.culture="",this.autoResize=!0,this.seriesList=[],this.seriesStyles=[{stroke:"#00cc00",opacity:.9,"stroke-width":1},{stroke:"#0099cc",opacity:.9,"stroke-width":1},{stroke:"#0055cc",opacity:.9,"stroke-width":1},{stroke:"#2200cc",opacity:.9,"stroke-width":1},{stroke:"#8800cc",opacity:.9,"stroke-width":1},{stroke:"#d9007e",opacity:.9,"stroke-width":1},{stroke:"#ff0000",opacity:.9,"stroke-width":1},{stroke:"#ff6600",opacity:.9,"stroke-width":1},{stroke:"#ff9900",opacity:.9,"stroke-width":1},{stroke:"#ffcc00",opacity:.9,"stroke-width":1},{stroke:"#ffff00",opacity:.9,"stroke-width":1},{stroke:"#ace600",opacity:.9,"stroke-width":1}],this.seriesHoverStyles=[{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5}],this.marginTop=25,this.marginRight=25,this.marginBottom=25,this.marginLeft=25,this.textStyle={fill:"#888","font-size":10,stroke:"none"},this.header={text:"",style:{fill:"none",stroke:"none"},textStyle:{"font-size":18,fill:"#666",stroke:"none"},compass:"north",visible:!0},this.footer={text:"",style:{fill:"#fff",stroke:"none"},textStyle:{fill:"#000",stroke:"none"},compass:"south",visible:!1},this.legend={text:"",textMargin:{left:2,top:2,right:2,bottom:2},style:{fill:"none",stroke:"none"},textWidth:null,textStyle:{fill:"#333",stroke:"none"},titleStyle:{"font-weight":"bold",fill:"#000",stroke:"none"},compass:"east",orientation:"vertical",visible:!0},this.axis={x:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!0,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"near",width:null},compass:"south",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},y:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!1,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"center",width:null},compass:"west",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!0,style:{stroke:"#999999","stroke-width":.5,"stroke-dasharray":"none"}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]}},this.hint={enable:!0,content:null,contentStyle:{fill:"#d1d1d1","font-size":16},title:null,titleStyle:{fill:"#d1d1d1","font-size":16},style:{fill:"#000000","stroke-width":2},animated:"fade",showAnimated:"fade",hideAnimated:"fade",duration:120,showDuration:120,hideDuration:120,easing:"",showEasing:"",hideEasing:"",showDelay:0,hideDelay:150,compass:"north",offsetX:0,offsetY:0,showCallout:!0,calloutFilled:!1,calloutFilledStyle:{fill:"#000"}},this.indicator={visible:!1,style:{stroke:"#000000"}},this.showChartLabels=!0,this.chartLabelStyle={},this.chartLabelFormatString="",this.disableDefaultTextStyle=!1,this.shadow=!0,this.dataSource=null,this.data=null,this.beforeSeriesChange=null,this.seriesChanged=null,this.beforePaint=null,this.painted=null}return e}();u.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new a)})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this,n=t.options,r=t._getDefFill(),i;n.horizontal&&(i=n.axis.y.compass||"south",n.axis.y.compass=n.axis.x.compass||"west",n.axis.x.compass=i),$.extend(!0,{compass:"east"},n.hint),t._handleChartStyles(),r=null,e.prototype._create.call(this),t.chartElement.addClass(n.wijCSS.barChart)},t.prototype._setOption=function(t,n){t==="horizontal"&&$.extend(!0,this.options.axis,{x:{compass:n?"west":"south"},y:{compass:n?"south":"west"}}),e.prototype._setOption.call(this,t,n)},t.prototype.destroy=function(){var t=this,n=t.options,r=t.chartElement,i=r.data("fields"),s=i&&i.bars;r.removeClass(n.wijCSS.barChart),e.prototype.destroy.call(this),s&&s.length&&$.each(s,function(e,t){t=null}),r.data("fields",null)},t.prototype._clearChartElement=function(){var t=this,n=t.options,r=t.chartElement.data("fields");e.prototype._clearChartElement.call(this),t.element.removeData("plotInfos"),n.seriesTransition.enabled||r&&r.aniBarsAttr&&(r.aniBarsAttr=null)},t.prototype._isBarChart=function(){return!0},t.prototype.getBar=function(e){var t=this.chartElement,n=t.data("fields");return n.chartElements.bars[e]},t.prototype._paintTooltip=function(){var t=this,n=t.chartElement,r=n.data("fields");e.prototype._paintTooltip.call(this),t.tooltip&&r&&r.trackers&&r.trackers.length&&(t.tooltip.setTargets(r.trackers),t.tooltip.setOptions({relatedElement:r.trackers[0]}))},t.prototype._getTooltipText=function(e,t){var n=$(t.node),r,i;return n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),i={data:r,value:r.value,label:r.label,total:r.total,target:t,fmt:e,x:r.x,y:r.y},$.proxy(e,i)()},t.prototype._preHandleSeriesData=function(){e.prototype._preHandleSeriesData.call(this);var t=this,n=t.options,r=n.seriesList;$.each(r,function(e,n){var r=n.data;r.y&&$.each(r.y,function(e,n){try{t._isDate(n)||(r.y[e]=parseFloat(n))}catch(i){r.y[e]=1}})})},t.prototype._paintPlotArea=function(){var e=this,t=e.options;this.barchartRender=new i(this.chartElement,{canvas:e.canvas,bounds:e.canvasBounds,tooltip:e.tooltip,widgetName:e.widgetName,horizontal:t.horizontal,stacked:t.stacked,axis:t.axis,seriesList:t.seriesList,seriesStyles:t.seriesStyles,seriesHoverStyles:t.seriesHoverStyles,seriesTransition:t.seriesTransition,showChartLabels:t.showChartLabels,textStyle:t.textStyle,chartLabelStyle:t.chartLabelStyle,chartLabelFormatString:t.chartLabelFormatString,shadow:t.shadow,disabled:t.disabled,clusterOverlap:t.clusterOverlap,clusterWidth:t.clusterWidth,clusterSpacing:t.clusterSpacing,is100Percent:t.is100Percent,clusterRadius:t.clusterRadius,animation:t.animation,culture:e._getCulture(),isYTime:e.axisInfo.y[0].isTime,isXTime:e.axisInfo.x.isTime,mouseDown:$.proxy(e._mouseDown,e),mouseUp:$.proxy(e._mouseUp,e),mouseOver:$.proxy(e._mouseOver,e),mouseOut:$.proxy(e._mouseOut,e),mouseMove:$.proxy(e._mouseMove,e),click:$.proxy(e._click,e),wijCSS:t.wijCSS,widget:this}),this.barchartRender.render()},t.prototype._showSerieEles=function(e){var t=this.options.stacked,n=-1;$.each(e,function(e,t){t&&t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t&&t.dcl&&t.dcl.show(),t&&t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show(),t.sIndex&&(n=t.sIndex)}),t&&this.stackedSeriesObjs&&this._handleStackedVisible(e.length)},t.prototype._hideSerieEles=function(e){var t=this.options.stacked,n=-1,r=e.length;$.each(e,function(e,t){t&&t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t&&t.dcl&&t.dcl.hide(),t&&t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide(),t.sIndex&&(n=t.sIndex)}),t&&this.stackedSeriesObjs&&this._handleStackedVisible(e.length)},t.prototype._handleStackedVisible=function(e){function n(e){return $(e.bar.node).data("wijchartDataObj").visible!==!1}function r(e,t,n){e&&(e.bar&&(e.bar.attr("x",t),e.bar.attr("width",n)),e.bar.shadow&&(e.bar.shadow.attr("x",t),e.bar.shadow.attr("width",n)),e.bar.tracker&&(e.bar.tracker.attr("x",t),e.bar.tracker.attr("width",n)))}function i(e,t,n){e&&(e.bar&&(e.bar.attr("y",t),e.bar.attr("height",n)),e.bar.shadow&&(e.bar.shadow.attr("y",t),e.bar.shadow.attr("height",n)),e.bar.tracker&&(e.bar.tracker.attr("y",t),e.bar.tracker.attr("height",n)))}function s(e){if(e){var t=e.rect.x,n=e.rect.width;e.bar&&(e.bar.attr("x",t),e.bar.attr("width",n)),e.bar.shadow&&(e.bar.shadow.attr("x",t),e.bar.shadow.attr("width",n)),e.bar.tracker&&(e.bar.tracker.attr("x",t),e.bar.tracker.attr("width",n))}}function o(e){if(e){var t=e.rect.y,n=e.rect.height;e.bar&&(e.bar.attr("y",t),e.bar.attr("height",n)),e.bar.shadow&&(e.bar.shadow.attr("y",t),e.bar.shadow.attr("height",n)),e.bar.tracker&&(e.bar.tracker.attr("y",t),e.bar.tracker.attr("height",n))}}var t=this;if(this.stackedSeriesObjs){$.each(this.stackedSeriesObjs,function(e,n){t.options.horizontal?s(n):o(n)});var u=[],a=this.element.data("fields").seriesEles.length;for(var f=0;f<a;f++)u.push(n(this.stackedSeriesObjs[f+"0"]));var l=[],c=-1,h=-1,p=-1;for(var f=u.length-1;f>=0;f--)u[f]&&(p-f>1&&l.push({start:p,end:f+1}),p=f);p>0&&l.push({start:p,end:0}),$.each(l,function(n,s){var o=s.start,u=s.end,a,f,l,c,h,p;for(var n=0;n<e;n++)a=t.stackedSeriesObjs[o+""+n],f=t.stackedSeriesObjs[u+""+n],t.options.horizontal?(l=f.rect.x,h=a.rect.width+a.rect.x-f.rect.x,r(a,l,h)):(l=a.rect.y,h=f.rect.height+f.rect.y-a.rect.y,i(a,l,h))})}},t.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.bar&&t.bar.attr(t.hoverStyle)})},t.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.bar&&t.bar.attr(t.style)})},t.prototype._supportStacked=function(){return!0},t.prototype._calculateParameters=function(t,n){e.prototype._calculateParameters.call(this,t,n);if(t.id==="x"){var r=n.unitMinor,i=this._getBarAdjustment(t);i===0?i=r:r<i&&r!==0&&(i=Math.floor(i/r)*r),t.min-=i,t.max+=i,this._calculateMajorMinor(n,t)}},t.prototype._getBarAdjustment=function(e){var t=0,n=this.options,r=e.max,i=e.min,s=n.seriesList,o=0,u=0;for(o=0;o<s.length&&s[o].data.x;o++)u=s[o].data.x.length,t<u&&(t=u);return t>1?(r-i)/t*n.clusterWidth*.0125:t===1?(i===0&&r===1&&(i=-1,e.min=i),(r-i)*.0125):0},t}(e.wijchartcore);e.wijbarchart=t;var n=function(){function e(){this.initSelector=":jqmData(role='wijbarchart')",this.wijCSS={barChart:"wijmo-wijbarchart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker"},this.horizontal=!0,this.stacked=!1,this.is100Percent=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),t.prototype.widgetEventPrefix="wijbarchart",$.wijmo.registerWidget("wijbarchart",t.prototype);var r=function(){function e(e){this.x=e,this.paSpec=[]}return e.prototype.stackValues=function(){var e=this,t=e.paSpec.length,n;t>1&&(n=e.paSpec[0],$.each(e.paSpec,function(e,t){if(e===0)return!0;t.y+=n.y,n=t}))},e}(),i=function(){function t(e,t){this.options=t,this.element=e,this._init()}return t.prototype._init=function(){var t=this.options,n=t.horizontal,r=t.axis.x,i=t.bounds;this.startLocation={x:i.startX,y:i.startY},this.width=i.endX-this.startLocation.x,this.height=i.endY-this.startLocation.y,this.nSeries=t.seriesList.length,this.seriesList=$.arrayClone(t.seriesList),this.seriesStyles=[].concat(t.seriesStyles.slice(0,this.nSeries)),this.seriesHoverStyles=[].concat(t.seriesHoverStyles.slice(0,this.nSeries)),this.xscale=e.ChartUtil.getScaling(n,r.max,r.min,n?this.height:this.width),this.xlate=e.ChartUtil.getTranslation(n,this.startLocation,r.max,r.min,this.xscale),this.fields=this.element.data("fields")||{},this.chartElements=this.fields.chartElements||{},this.aniBarsAttr=this.fields.aniBarsAttr,this.canvas=t.canvas},t.prototype._paintShadow=function(t,n,r){this.options.shadow&&e.ChartUtil.paintShadow(t,n,r)},t.prototype.getMinDX=function(e){var t=Number.MAX_VALUE,n=e.length,r,i;for(r=1;r<n;r++)i=e[r].x-e[r-1].x,i<t&&i>0&&(t=i);return t===Number.MAX_VALUE?2:t},t.prototype.stackValues=function(e){return $.each(e,function(e,t){t.stackValues()}),e},t.prototype.barPointList=function(t){function s(e,t){var s=i(t),o=t.length,u=null,a=0,f=0,l=0,c=!0,h=0,p=!1;s&&(a=s.length),n&&(l=n.length);if(s===undefined)return;$.each(s,function(t,i){c?(c=!1,h=i.x):(h===i.x?p=!0:p=!1,h=i.x);while(f<l&&n[f].x<i.x)f++;f<l?n[f].x!==i.x?(u=new r(i.x),n.splice(f,0,u),l=n.length):u=n[f]:(u=new r(i.x),n.push(u),l=n.length),u.paSpec.push({y:i.y,sIdx:e,pIdx:t,dupl:p})})}var n=[],i=e.ChartUtil.getXSortedPoints;return $.each(t,function(e,t){s(e,t)}),n},t.prototype.adjustToLimits=function(e,t,n){return e<t?t:e>n?n:e},t.prototype.transformPoints=function(e,t,n,r,i,s){return $.each(s,function(s,o){var u=o.x,a=o.y,f=0;o.x=t*u+r,o.y=n*a+i,e&&(f=o.x,o.x=o.y,o.y=f)}),s},t.prototype.paintDefaultChartLabel=function(e,t,n,r){var i=this.options,s=i.horizontal,o=i.canvas,u=i.wijCSS,a=i.culture,f=$.extend(!0,{},i.textStyle,i.chartLabelStyle),l=s?{x:e.x+e.width,y:e.y+e.height/2}:{x:e.x+e.width/2,y:e.y},c=i.chartLabelFormatString,h,p,d=this.options.widget,v=t;return r&&(f=$.extend(!0,f,r)),n&&(v=$.fromOADate(t)),c&&c.length?v=Globalize.format(v,i.chartLabelFormatString,a):n||(v=$.round(v,2)),p=d._text.call(d,l.x,l.y,v).attr(f),$.wijraphael.addClass($(p.node),u.barLabel),h=p.getBBox(),s?p.attr({x:l.x+h.width/2}):p.attr({y:l.y-h.height/2}),p},t.prototype.paintBar=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=this.options,m=v.stacked,g=v.horizontal,y=v.is100Percent,b=r.min,w=r.max,E=i.min,S=i.max,x=r.scale,T=r.late,N=i.scale,C=i.late,k,L,A,O,M=null,_,D=s,P=s["stroke-width"],H=s.stroke,B,j,F,I,q=-1;d.origin!==null&&(q=N*d.origin+C);if(m)if(y){c>0&&(e.height=t/c);if(l||l===0)e.y=l/c,e.height-=e.y}else{e.height=t;if(l||l===0)e.height-=l,e.y=l}else if(l||l===0)e.x+=e.width*(1-f),e.height=t;L=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y+e.height}],A=(b<=L[0].x&&L[0].x<=w||b<=L[1].x&&L[1].x<=w)&&(E<=L[0].y&&L[0].y<=S||E<=L[1].y&&L[1].y<=S),L[0].x=this.adjustToLimits(L[0].x,b,w),L[0].y=this.adjustToLimits(L[0].y,E,S),L[1].x=this.adjustToLimits(L[1].x,b,w),L[1].y=this.adjustToLimits(L[1].y,E,S),L=this.transformPoints(g,x,N,T,C,L),L[0].x>L[1].x&&(k=L[0].x,L[0].x=L[1].x,L[1].x=k),L[0].y>L[1].y&&(k=L[0].y,L[0].y=L[1].y,L[1].y=k),O={x:L[0].x,y:L[0].y,width:L[1].x-L[0].x,height:L[1].y-L[0].y},A&&!m&&(O.width===0&&(O.width=1),O.height===0&&(O.height=1,O.y-=1)),v.showChartLabels&&(M=this.paintDefaultChartLabel(O,t,h,p)),_=s.r?s.r:v.clusterRadius,_&&(D=$.extend(!0,{},s,{r:0})),H!=="none"&&P&&(P=parseInt(P,10));if(!P||isNaN(P))P=0;return j=O.width,F=O.height,P>1&&(P--,j=O.width-P,F=O.height-P/2,O.x+=P/2),j<0&&(j=0),F<0&&(F=0),o?(q===-1&&(g?q=a.x+P/2:q=a.y+n-P/2),_?(g?(t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,0,0,_,_).hide():B=this.canvas.roundRect(O.x,O.y,j,F,_,_,0,0).hide(),I=this.canvas.rect(q,O.y,O.width,O.height)):(t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,_,0,0,_).hide():B=this.canvas.roundRect(O.x,O.y,j,F,0,_,_,0).hide(),I=this.canvas.rect(O.x,q,O.width,O.height)),this._paintShadow(I,u),I.wijAttr(D),I.bar=B):(g?B=this.canvas.rect(q,O.y,O.width,F):B=this.canvas.rect(O.x,q,j,O.height),I=B),M&&(M.attr({opacity:0}),I.chartLabel=M),I.left=O.x,I.top=O.y,I.width=j,I.height=F,I.r=_):_?g?t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,0,0,_,_):B=this.canvas.roundRect(O.x,O.y,j,F,_,_,0,0):t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,_,0,0,_):B=this.canvas.roundRect(O.x,O.y,j,F,0,_,_,0):B=this.canvas.rect(O.x,O.y,j,F),this._paintShadow(B,u),o&&_&&B.shadow&&B.shadow.hide(),B.wijAttr(s),{rect:O,dcl:M,animatedBar:I,bar:B}},t.prototype.paintClusters=function(t,n,r,i,s,o,u,a,f,l){var c=this,h=c.options,p=h.clusterOverlap/100,d=h.clusterWidth/100,v=1,m=h.clusterSpacing+v,g=t.length,y=h.canvas,b=h.stacked,w=h.horizontal,E=h.axis.y,S=h.widget,x=h.wijCSS,T=h.animation&&h.animation.enabled,N,C,k,L=[],A=[],O=[],M=[],_=[],D=[],P=y.set(),H,B=0;return f||l?($.each(t,function(e,t){var n=$.extend(!0,{},t);n.data&&n.data.y&&n.data.y.length&&f&&$.each(n.data.y,function(e,t){n.data.y[e]=$.toOADate(t)}),n.data&&n.data.x&&n.data.x.length&&l&&$.each(n.data.x,function(e,t){n.data.x[e]=$.toOADate(t)}),_.push(n)}),N=c.barPointList(_)):N=c.barPointList(t),b&&(N=c.stackValues(N)),C=c.getMinDX(N)*d,$.each(n,function(e,t){t["stroke-width"]&&!isNaN(t["stroke-width"])&&(B!==0?B=Math.min(parseFloat(t["stroke-width"]),B):B=parseFloat(t["stroke-width"]))}),g>1&&!b&&(p-=N.length*(g-1)*(m+B*2)/(w?u:o),C/=g*(1-p)+p),$.each(N,function(l,d){var m=d.paSpec,g=m.length,y,N,_,B;b?y=C:y=C*(g*(1-p)+p),N={x:d.x-y/2,y:0,width:C,height:m[0].y},$.each(m,function(l,d){if(N.height===undefined)return!0;var g=d.sIdx,y=d.pIdx,b=n[g],C=t[g],j,F=C.yAxis||0,I=E[F]||E,q=s[F]||s;M[g]||(M[g]=[]),D[g]||(D[g]=[]),c.yscale=e.ChartUtil.getScaling(!w,I.max,I.min,w?o:u),c.ylate=e.ChartUtil.getTranslation(!w,a,I.max,I.min,c.yscale),q.late=c.ylate,q.scale=c.yscale,B=c.paintBar(N,d.y,u,i,q,b,T,v,a,p,l>0?m[l-1].y:null,m[m.length-1].y,f,C.textStyle,I),_=B.bar,j=_.clone().attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}),C.visible===!1&&(_.hide(),B.dcl&&B.dcl.hide(),j.hide(),_.shadow&&_.shadow.hide()),$.wijraphael.addClass($(_.node),x.canvasObject+" "+x.barElement),H=$.extend(!1,{index:y,bar:_,type:"bar",style:b,hoverStyle:r[g],x:C.data.x[y],y:C.data.y[y],visible:!0},C),$(_.node).data("wijchartDataObj",H),S.dataPoints=S.dataPoints||{},S.pointXs=S.pointXs||[],h.horizontal?k=$.round(B.rect.y+B.rect.height/2,2):k=$.round(B.rect.x+B.rect.width/2,2),S.dataPoints[k.toString()]||(S.dataPoints[k.toString()]=[],S.pointXs.push(k)),S.dataPoints[k.toString()].push(H),$(j.node).data("owner",$(_.node)),$.wijraphael.addClass($(j.node),x.barElement+" "+x.barTracker),B.bar.tracker=j,P.push(j),A.push(_),B.animatedBar&&O.push(B.animatedBar),B.dcl&&L.push(B.dcl),M[g][y]=B.rect,D[g][y]=B,_=null,j=null})}),$.each(L,function(e,t){t.toFront()}),P.toFront(),{bars:A,animatedBars:O,rects:M,chartLabels:L,seriesEles:D,trackers:P}},t.prototype.processStackedElement=function(e){var t={};$.each(e,function(e,n){$.each(n,function(n,r){r.sIndex=e,r.stackIndex=n,t[e+""+n]=r})}),this.options.widget.stackedSeriesObjs=t},t.prototype.playAnimation=function(t){var n=this,r=n.options,i=r.animation,s=i&&i.enabled,o=r.horizontal,u=r.seriesTransition,a,f,l=[],c,h=r.chartLabelStyle;s&&(a=i.duration||2e3,f=i.easing||"linear",$.each(t,function(t,r){var i;o?(r.wijAttr({width:0}),i={width:r.width,x:r.left}):(r.wijAttr({height:0}),i={height:r.height,y:r.top}),n.aniBarsAttr&&u.enabled&&n.aniBarsAttr.length>t&&(c=e.ChartUtil.getDiffAttrs(n.aniBarsAttr[t],r.attr()),o?(c.x=n.aniBarsAttr[t].x,c.width=n.aniBarsAttr[t].width):(c.y=n.aniBarsAttr[t].y,c.height=n.aniBarsAttr[t].height),c.path&&delete c.path,r.attr(c),a=u.duration,f=u.easing),l.push($.extend(!0,{},r.attr(),i)),r.tracker&&r.tracker.hide(),r.stop().wijAnimate(i,a,f,function(){var e=this,t=e.r,n=e;e.chartLabel&&(h&&h.opacity?e.chartLabel.wijAnimate({opacity:h.opacity},250):e.chartLabel.wijAnimate({opacity:1},250)),e.tracker&&(e.tracker.show(),e.tracker.attr({width:e.width,height:e.height,x:e.attr("x"),y:e.attr("y")})),t&&(n=e.bar,n.show(),n.shadow&&n.shadow.show(),e.shadow&&(e.shadow.wijRemove(),e.shadow=null),e.wijRemove(),e=null)})}),n.aniBarsAttr=l)},t.prototype.bindLiveEvents=function(){var e=this.options,t=e.wijCSS,n=e.widgetName,r=e.disabled,i=e.mouseDown,s=e.mouseUp,o=e.mouseOver,u=e.mouseOut,a=e.mouseMove,f=e.click,l=this.element,c=$.isFunction,h="";$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(h="wij"),$("."+t.barElement,l[0]).on(h+"mousedown."+n,function(e){if(r)return;if(c(i)){var t=$(e.target),n;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i.call(l,e,n),n=null}}).on(h+"mouseup."+n,function(e){if(r)return;if(c(s)){var t=$(e.target),n;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),s.call(l,e,n),n=null}}).on(h+"mouseover."+n,function(e){if(r)return;if(c(o)){var t=$(e.target),n,i;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i=n.bar,n.hoverStyle?(n.initTransform=i.matrix.toTransformString(),i.wijAttr(n.hoverStyle)):i&&i.wijAttr({opacity:"0.8"}),o.call(l,e,n),n=null}}).on(h+"mouseout."+n,function(e){if(r)return;var t=$(e.target),n,i;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i=n.bar,n.hoverStyle?(i.transform(""),i.shadow&&i.shadow.transform(""),i.wijAttr(n.style)):i&&i.wijAttr({opacity:"1"}),c(u)&&u.call(l,e,n),n=null}).on(h+"mousemove."+n,function(e){if(r)return;var t=$(e.target),n,i;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i=n.bar,c(a)&&a.call(l,e,n),n=null}).on(h+"click."+n,function(e){if(r)return;if(c(f)){var t=$(e.target),n;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),f.call(l,e,n)}})},t.prototype.unbindLiveEvents=function(){var e=this.options,t=e.widgetName,n=e.wijCSS,r=this.element;$("."+n.barElement,r[0]).off(t).off("."+t)},t.prototype.render=function(){var e=this.options,t=e.horizontal,n=e.stacked,r=this.seriesList,i=this.seriesStyles,s=this.seriesHoverStyles,o=e.axis.x,u=e.axis.y,a=e.isYTime,f=e.isXTime,l;this.unbindLiveEvents(),t&&!n&&(r.reverse(),i.reverse(),s.reverse());if(this.nSeries===0)return;l=this.paintClusters(r,i,s,{min:o.min,max:o.max,late:this.xlate,scale:this.xscale},u,this.width,this.height,this.startLocation,a,f),this.element.data("plotInfos",{xscale:this.xscale,xlate:this.xlate,yscale:this.yscale,ylate:this.ylate,rects:l.rects}),this.playAnimation(l.animatedBars),this.chartElements.bars=l.bars,this.chartElements.animatedBars=l.animatedBars,this.chartElements.chartLabels=l.chartLabels,this.fields.seriesEles=l.seriesEles,this.fields.trackers=l.trackers,this.fields.chartElements||(this.fields.chartElements={}),t&&!n&&this.fields.seriesEles.reverse(),n&&this.processStackedElement(this.fields.seriesEles),$.extend(!0,this.fields.chartElements,this.chartElements),this.fields.aniBarsAttr=this.aniBarsAttr,this.element.data("fields",this.fields),this.bindLiveEvents()},t}();e.BarChartRender=i})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this.options;this._handleChartStyles(),e.prototype._create.call(this),this.chartElement.addClass(t.wijCSS.lineChart),t.type==="area"&&this.chartElement.addClass(t.wijCSS.areaChart)},t.prototype.destroy=function(){var t=this.options;this.chartElement.removeClass(t.wijCSS.lineChart),t.type==="area"&&this.chartElement.removeClass(t.wijCSS.areaChart),e.prototype.destroy.call(this),this.aniPathsAttr&&this.aniPathsAttr.length&&($.each(this.aniPathsAttr,function(e,t){t=null}),this.aniPathsAttr=null)},t.prototype.getLinePath=function(e){var t=this.chartElement.data("fields"),n,r;if(t&&t.chartElements){n=t.chartElements;if(n.paths&&n.paths.length)return n.paths[e]}return r},t.prototype.getLineMarkers=function(e){var t=this.options,n=this.chartElement.data("fields"),r,i;if(t.seriesList&&t.seriesList[e].markers&&t.seriesList[e].markers.visible&&n&&n.chartElements){r=n.chartElements;if(r.markersSet&&r.markersSet.length)return r.markersSet[e]}return i},t.prototype._showSerieEles=function(e){var t=this.options,n;e.markers&&$.each(e.markers,function(e,t){var n=$(t.node).data("wijchartDataObj");if(n&&n.lineSeries&&n.lineSeries.markers&&!n.lineSeries.markers.visible)return!0;t.show()}),e.dcl&&$.each(e.dcl,function(e,n){t.showChartLabels&&n.show()}),e.path&&(n=$(e.path.node).data("wijchartDataObj"),!n.visible&&n.markers&&n.markers.visible||(e.path.show(),e.path.shadow&&e.path.shadow.show(),e.path.area&&e.path.area.show(),e.path.tracker&&e.path.tracker.show()),$(e.path.node).data("wijchartDataObj")&&$(e.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(e.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0}))},t.prototype._hideSerieEles=function(e){e.markers&&$.each(e.markers,function(e,t){t.hide()}),e.dcl&&$.each(e.dcl,function(e,t){t.hide()}),e.path&&(e.path.hide(),e.path.shadow&&e.path.shadow.hide(),e.path.area&&e.path.area.hide(),e.path.tracker&&e.path.tracker.hide(),$(e.path.node).data("wijchartDataObj")&&$(e.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(e.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}))},t.prototype._supportStacked=function(){return!0},t.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.marker&&t.marker.attr(t.markerHoverStyle)})},t.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.marker&&(t.marker.attr(t.markerStyle),t.marker.transform("s1"))})},t.prototype._mouseDownInsidePlotArea=function(t,n){e.prototype._mouseDownInsidePlotArea.call(this,t,n),this._clearHoverState(!0)},t.prototype._mouseDown=function(t,n){e.prototype._mouseDown.call(this,t,n)},t.prototype._mouseUp=function(t,n){e.prototype._mouseUp.call(this,t,n)},t.prototype._mouseOver=function(t,n){if(!n||n.type!=="line"&&n.type!=="marker")return;if(this.indicatorLine)return;e.prototype._mouseOver.call(this,t,n),n.type==="marker"&&(n=n.lineSeries);if(n.path.removed)return;if(this.hoverLine!==n||this.hoverLine===null)this.isNewLine=!0,this.hoverLine&&(this.hoverLine.path.removed||(this.options.type==="line"&&this.hoverLine.lineStyle.fill&&delete this.hoverLine.lineStyle.fill,this.hoverLine.path.wijAttr(this.hoverLine.lineStyle),this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1")))),n.lineHoverStyle&&n.path.wijAttr(n.lineHoverStyle),this.hoverLine=n,this.hoverPoint=null,this.hoverVirtualPoint=null},t.prototype._mouseOut=function(t,n){e.prototype._mouseOut.call(this,t,n)},t.prototype._mouseMove=function(t,n){e.prototype._mouseMove.call(this,t,n)},t.prototype._click=function(t,n){e.prototype._click.call(this,t,n)},t.prototype._mouseMoveInsidePlotArea=function(t,n){var r=this,i=this.tooltip,s=this.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0;i&&(v=i.getOptions());if(this.hoverLine&&!this.indicatorLine){this.isNewLine&&(s.enable&&i&&i.hide(),this.isNewLine=!1),o=this.hoverLine.lineMarkers,u=this.hoverLine.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,t){if(t.removed)return!0;var r=t.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-n.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(this.hoverPoint&&this.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.removed||(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),this.hoverPoint=l,this.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,t){var r=Math.abs(t.x-n.left);if(e===0||r<w)w=r,a=e,f={x:t.x,y:t.y}});if(this.hoverVirtualPoint&&this.hoverVirtualPoint.index===a)return;a>-1&&(this.hoverPoint=null,this.hoverVirtualPoint=u[a])}if(i){d=this.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:r.hoverLine.index,x:c,y:h,label:r.hoverLine.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:r.hoverLine.index,x:c,y:h,label:r.hoverLine.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:this.hoverLine.path.attr("stroke")},s.style),v.style.stroke=p.stroke,i.showAt(f)}}e.prototype._mouseMoveInsidePlotArea.call(this,t,n)},t.prototype._mouseMoveOutsidePlotArea=function(t,n){this._clearHoverState(!1),e.prototype._mouseMoveOutsidePlotArea.call(this,t,n)},t.prototype._clearHoverState=function(e){var t=this.tooltip,n=this.options.hint;n.enable&&t&&!e&&t.hide(),this.hoverLine&&(this.hoverLine.path.removed||(this.options.type==="line"&&this.hoverLine.lineStyle.fill&&delete this.hoverLine.lineStyle.fill,this.hoverLine.path.wijAttr(this.hoverLine.lineStyle),this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1")))),this.hoverLine=null,this.hoverPoint=null,this.hoverVirtualPoint=null},t.prototype._paintLegendIcon=function(e,t,n,r,i,s,o,u,a,f){var l=this,c=this.options,h=l.canvas.path(Raphael.format("M{0},{1}L{2},{3}",e,t+r/2,e+n,t+r/2)),p;$(h.node).data("legendIndex",s).data("index",o),l.legendIcons.push(h),i&&h.attr($.extend(!0,{},i,{"stroke-width":c.legend.size.height})),$.wijraphael.addClass($(h.node),u);var d=a.markerStyle;d=$.extend({fill:i.stroke,stroke:i.stroke,opacity:1},d),i["stroke-dasharray"]&&h.attr({"stroke-width":1,"stroke-dasharray":i["stroke-dasharray"]});if(a.markers&&a.markers.visible){var v=a.markers.type;v||(v="circle"),p=this.canvas.paintMarker(v,e+n/2,t+r/2,3),$.wijraphael.addClass($(p.node),Raphael.format("{0} {1} {2}",c.wijCSS.legend,c.wijCSS.legendDot,c.wijCSS.canvasObject)),p.attr(d),$(p.node).data("index",o).data("legendIndex",s),this.legendDots.push(p)}return h},t.prototype._paintLegend=function(){var t=this.options,n=0,r=0,i=0,s=null,o=t.seriesList,u=t.seriesStyles,a=null,f=null,l=null,c=0,h=0,p=null,d=null,v=null;$.extend(!0,t,{legend:{size:{width:30,height:3}}}),e.prototype._paintLegend.call(this)},t.prototype._paintPlotArea=function(){var e=this.options,t;this.aniPathsAttr||(this.aniPathsAttr=[]),this.linechartRender=new r(this.chartElement,{bounds:this.canvasBounds,widgetName:this.widgetName,canvas:this.canvas,tooltip:this.tooltip,wijCSS:e.wijCSS,stacked:e.stacked,hole:e.hole,type:e.type,axis:e.axis,animation:e.animation,seriesTransition:e.seriesTransition,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,showChartLabels:e.showChartLabels,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,isXTime:this.axisInfo.x.isTime,isYTime:this.axisInfo.y.isTime||this.axisInfo.y[0].isTime,disabled:e.disabled,culture:this._getCulture(),hint:e.hint,aniPathsAttr:this.aniPathsAttr,chartLabelEles:this.chartLabelEles,mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),widget:this,extremeValue:{txx:this.extremeValue.txx,txn:this.extremeValue.txn,tyx:this.extremeValue.y[0].tyx,tyn:this.extremeValue.y[0].tyn}}),this.linechartRender.render()},t.prototype._clearChartElement=function(){e.prototype._clearChartElement.call(this),this.hoverLine=null,this.hoverPoint=null,this.hoverVirtualPoint=null},t}(e.wijchartcore);e.wijlinechart=t;var n=function(){function e(){this.initSelector=":jqmData(role='wijlinechart')",this.wijCSS={lineChart:"wijmo-wijlinechart",areaChart:"wijmo-wijareachart",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker"},this.stacked=!1,this.hole=null,this.type="line",this.animation={enabled:!0,direction:"horizontal",duration:2e3,easing:"easeInCubic"},this.seriesTransition={enabled:!0,duration:2e3,easing:"easeInCubic"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijlinechart",t.prototype);var r=function(){function t(e,t){this.options=t,this.element=e}return t.prototype.render=function(){var e=this.element,t=this.options,n=t.wijCSS,r=t.bounds,i=t.widgetName,s=t.canvas,o=t.animation,u=t.seriesTransition,a=t.hint,f=t.tooltip,l=t.mouseDown,c=t.mouseUp,h=t.mouseOver,p=t.mouseOut,d=t.mouseMove,v=t.click,m=[],g=[],y=[],b=[],w=[],E=t.disabled,S=s.set(),x=t.aniPathsAttr,T=[],N,C=e.data("fields")||{},k=[],L=t.culture,A=t.widget,O=t.extremeValue,M={enable:!1,left:-10,top:-10,right:10,bottom:10};this.widget=A,this.renderLineChart(t,T,x,b,w,m,S,g,y,k,L),!t.axis.x.autoMax&&t.axis.x.max<O.txx&&(M.enable=!0,M.right=0),!t.axis.x.autoMin&&t.axis.x.min>O.txn&&(M.enable=!0,M.left=0),!t.axis.y.autoMax&&t.axis.y.max<O.tyx&&(M.enable=!0,M.top=0),!t.axis.y.autoMin&&t.axis.y.min>O.tyn&&(M.enable=!0,M.bottom=0),o.enabled||u.enabled?this.playAnimation(o,u,S,r,b,x,M):M.enable&&this.setClipRect(M,S,r),x.length=0,$.each(T,function(e,t){x.push(t)}),this.unbindLiveEvents(e,i,n),this.bindLiveEvents(e,s,r,i,l,c,h,p,d,v,E,a,y,f,n),N={paths:b,shadowPaths:w,markersSet:m,animationSet:S,symbols:g},C.chartElements||(C.chartElements={}),C.seriesEles=k,$.extend(!0,C.chartElements,N),e.data("fields",C)},t.prototype.setClipRect=function(e,t,n){var r=n.endX-n.startX-e.left+e.right,i=n.endY-n.startY-e.top+e.bottom;t.wijAttr("clip-rect",Raphael.format("{0} {1} {2} {3}",n.startX+e.left,n.startY+e.top,r,i))},t.prototype.playAnimation=function(e,t,n,r,i,s,o){var u=this,a=e.duration,f=e.easing;e.direction==="horizontal"?(s&&s.length&&t.enabled&&(a=t.duration,f=t.easing),this.playHAnimation(a,f,n,r,i,o)):(o.enable&&this.setClipRect(o,n,r),$.each(i,function(e,n){if(typeof n=="undefined"||n===null)return!0;s&&s.length>e&&t.enabled?(a=t.duration,f=t.easing,u.playVAnimation(n,s,e,a,f)):n.straight&&u.playVStraightAnimation(n,a,f)}))},t.prototype.playVAnimation=function(t,n,r,i,s){var o,u;t.shadow&&t.shadow.hide(),t.tracker&&t.tracker.hide(),o=n[r],o&&o.path&&(u=e.ChartUtil.getDiffAttrs(o.path,t.attr())),$.isEmptyObject(u)||(t.attr(o.path),t.wijAnimate(u,i,s,function(){t.shadow&&t.visible!==!1&&t.shadow.show(),t.tracker&&t.visible!==!1&&t.tracker.show()})),$.each(t.markers,function(t,n){var r=e.ChartUtil.getDiffAttrs(o.markers[t],n.attr());$.isEmptyObject(r)||(n.attr(o.markers[t]),n.wijAnimate(r,i,s))}),t.labels&&$.each(t.labels,function(t,n){var r=e.ChartUtil.getDiffAttrs(o.labels[t],n.attr()),u=o.labels[t];u&&u.text&&delete u.text,$.isEmptyObject(r)||(n.attr(u),n.wijAnimate(r,i,s))}),t.area&&(u=e.ChartUtil.getDiffAttrs(o.area,t.area.attr()),$.isEmptyObject(u)||(t.area.attr(o.area),t.area.wijAnimate(u,i,s)))},t.prototype.playVStraightAnimation=function(e,t,n){var r,i,s;e.shadow&&e.shadow.hide(),e.tracker&&e.tracker.hide(),r=e.straight,i=e.attr().path,e.attr({path:r}),e.wijAnimate({path:i},t,n,function(){e.shadow&&e.visible!==!1&&e.shadow.show(),e.tracker&&e.visible!==!1&&e.tracker.show()}),$.each(e.markers,function(e,r){if(r.straight){var i=r.attr().cy;r.attr({cy:r.straight}),r.wijAnimate({cy:i},t,n)}}),e.area&&(s=e.area,r=s.straight,i=s.attr().path,s.attr({path:r}),s.wijAnimate({path:i},t,n))},t.prototype.playHAnimation=function(e,t,n,r,i,s){$.each(i,function(e,t){t.tracker&&t.tracker.hide()});var o=s.enable,u=r.endX-r.startX-s.left+s.right,a=r.endY-r.startY-s.top+s.bottom;n.wijAttr("clip-rect",Raphael.format("{0} {1} 0 {2}",r.startX+s.left,r.startY+s.top,a)),n.wijAnimate({"clip-rect":Raphael.format("{0} {1} {2} {3}",r.startX+s.left,r.startY+s.top,u,a)},e,t,function(){this.tracker&&this.visible!==!1&&this.tracker.show();if(Raphael.vml&&!o){var e=null,t=null,n=this.node;n&&n.clipRect&&(e=this.attrs,delete e["clip-rect"],n.clipRect=null,t=$(n).parent(),t.before(n),t.remove(),this.attr(e),e.src&&e.src.length&&this.attr({src:e.src}),e.gradient&&e.gradient.length&&e.fill==="none"&&this.attr({fill:e.gradient}))}})},t.prototype.renderLineChart=function(t,n,r,i,s,o,u,a,f,l,c){var h=this,p=t.wijCSS,d=t.bounds,v=t.canvas,m=t.stacked,g=t.hole,y=t.type,b=t.axis,w=t.animation,E=t.seriesTransition,S=!1,x=t.seriesList,T=t.seriesStyles,N=t.seriesHoverStyles,C=t.showChartLabels,k=t.chartLabelStyle,L=t.chartLabelFormatString,A=t.isXTime,O=t.isYTime,M=t.chartLabelEles,_,D,P,H,B,j,F=[],I=[],q,R,U,z,W;$.each(x,function(t,X){var V=[],J=[],K=[],Q,G,Y,Z,et,tt,nt=[];if(X.display==="exclude")return!0;tt=T[t],X=$.extend(!0,{display:"show",fitType:"line",markers:{visible:!1,type:"circle"},visible:!0},X),Q=X.data,G=$.extend({stroke:"black",opacity:1,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},tt),Z=X.markerStyle,Z=$.extend({fill:G.stroke,stroke:G.stroke,opacity:1,width:3},Z),Y=N[t],et=$.extend(!0,{},Y,{transform:"s1.5","stroke-width":1},x.markerHoverStyle),B=[].concat(Q.x),j=[].concat(Q.y),U=v.set(),R=[],H=X.fitType,z=!1,X.markers.symbol&&X.markers.symbol.length&&(z=!0),_=v.set();if(!r||r.length<=t||w.enabled&&!E.enabled)S=!0;S&&j.length>0&&(D=e.ChartUtil.getFirstValidListValue(j),O&&(D=$.toOADate(D)),P=e.ChartUtil.getLastValidListValue(j),O&&(P=$.toOADate(P))),W=h.processYValues(j,X.display,g,m,F),$.each(j,function(e,t){q=B[e],A&&(q=$.toOADate(q)),t=j[e];if(W[e].isHole){if(X.display==="excludeHole")return!0;if(!W[e].isValue)return!0}O&&(t=$.toOADate(t));if(q===undefined)return!1;R=h.renderPoint(d,v,K,R,U,V,u,_,J,M,L,S,D,P,q,t,Q.y[e],b,H,A,O,e,Z,et,X,z,C,a,B,j,W,X.display,m,nt,c,p)}),h.renderPath(v,d,X,i,s,f,Y,Z,et,U,o,u,R,n,K,G,k,V,J,_,t,y,I,m,nt,p),l.push({markers:U,path:i[i.length-1],shadowPath:s[s.length-1],dcl:_})}),$.each($.merge([],i).reverse(),function(e,t){t.toFront(),t.area&&t.area.toFront()}),$.each(i,function(e,t){t.tracker&&t.tracker.toFront()}),$.each(i,function(e,t){t.markers&&t.markers.toFront()})},t.prototype.renderPath=function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){var k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U;U=n.endY,this.options.axis&&this.options.axis.y&&!isNaN(this.options.axis.y.origin)&&(U=this._calculatePoint(this.options.axis.y.origin,"y")),k=t.path(p.join(" ")),k.straight=v.join(" "),e.ChartUtil.paintShadow(k,1,"#cccccc"),E===0&&(x.length=0,p.length>1?(_=p[1],D=p[p.length-2]):(_=n.startX,D=n.endX),$.merge(x,["L",_,U,"L",D,U])),P=t.path(p.join(" ")),k.tracker=P,m["stroke-width"]?H=10+parseFloat(m["stroke-width"]):H=10,P.attr({"stroke-width":H,stroke:"#C0C0C0",opacity:.01}),$.wijraphael.addClass($(P.node),Raphael.format("{0} {1} {2}",C.canvasObject,C.lineElement,C.lineTracker)),$(P.node).data("owner",$(k.node)),S==="area"?(m.fill&&m.fill!=="none"?(L=m.fill,delete m.fill):L=m.stroke,A=.5,O=1,m["fill-opacity"]&&m["fill-opacity"]!=="none"&&(A=m["fill-opacity"]),m.opacity&&m.opacity!=="none"&&(O=m.opacity),k.wijAttr(m),p.length>1?_=p[1]:_=n.startX,T?(p.push("V"),p.push(U),p.push("H"),p.push(_),p.push("Z")):(I=Raphael.parsePathString(k.attr("path")),I&&I.length>0&&(p=[],$.each(I,function(e,t){$.each(t,function(e,t){p.push(t)}),t[0]==="M"&&(_=t[1]),e<I.length-1&&I[e+1][0]==="M"&&(p.push("V"),p.push(U),p.push("H"),p.push(_),p.push("Z")),e===I.length-1&&(p.push("V"),p.push(U),p.push("H"),p.push(_),p.push("Z"))}))),M=t.path(p.join(" ")),$.wijraphael.addClass($(M.node),C.areaElement),M.wijAttr({fill:L,opacity:O,"fill-opacity":A,stroke:"none"}),v.push("V"),v.push(U),v.push("H"),v.push(_),v.push("Z"),M.straight=v.join(" "),k.area=M,h.push(M),d.push({path:$.extend(!0,{},k.attr()),area:$.extend(!0,{},M.attr()),markers:y,labels:b})):(R=$.extend(!0,{},m),R.fill&&delete R.fill,k.wijAttr(R),u.fill&&delete u.fill,d.push({path:$.extend(!0,{},k.attr()),markers:y,labels:b})),k.markers=l,i.push(k),k.shadow&&(s[E]=k.shadow),h.push(k),o[E]={lineStyle:m,lineHoverStyle:u,markerStyle:a,markerHoverStyle:f},(!r.markers.visible||r.display==="hide")&&l.hide();if(!r.visible||r.display==="hide")k.hide(),k.tracker&&k.tracker.hide(),k.shadow&&k.shadow.hide(),k.area&&k.area.hide(),k.visible=!1;r.markers.style&&l.attr(r.markers.style),l.toFront(),w.length&&(B=$.extend(!0,{},g),r.textStyle&&(B=$.extend(!0,B,r.textStyle)),w.attr(B),w.toFront(),k.labels=w),c[E]=l,r.index=E,r.type="line",r.path=k,r.lineMarkers=l,r.lineStyle=m,r.lineHoverStyle=u,r.virtualMarkers=N,$.wijraphael.addClass($(k.node),Raphael.format("{0} {1}",C.canvasObject,C.lineElement)),$(k.node).data("wijchartDataObj",r)},t.prototype._calculatePoint=function(e,t){var n=this.options.axis,r=this.options.bounds,i=n[t].min,s=n[t].max,o,u;return t==="x"?(u=(r.endX-r.startX)/(s-i),r.startX+(e-i)*u):(u=(r.endY-r.startY)/(s-i),r.endY-(e-i)*u)},t.prototype.renderPoint=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){var B=e.endX-e.startX,j=e.endY-e.startY,F=g.x.min,I=g.y.min,q=g.x.max,R=g.y.max,U=B/(q-F),z=j/(R-I),W,X,V,J=0,K,Q,G,Y,Z=T.markers.visible,et=this.widget,tt;return isNaN(d)||typeof d=="string"?V=E:V=d,J=this._calculatePoint(V,"x"),K=this._calculatePoint(v,"y"),O[E].x=J,O[E].y=K,c&&(Q=h+(p-h)/(q-F)*(V-F),Q=e.endY-(Q-I)*z,n.push(O[E].idx?"L":"M"),n.push(J),n.push(Q)),O[E].isHole?r:(r=this.getPathArrByFitType(r,y,E,A.length,e,L,A,J,K,b,w,d,v,O,M,_),C&&(Y=this.renderChartLabel(t,w,v,l,J,K,P,H),f.push(Y),u.push(Y),a.push($.extend(!0,{},Y.attr()))),Z&&(W=this.renderMarker(t,k,N,T.markers,E,J,K,S,H),X=W.dot,c&&(X.straight=Q)),G={},G.valX=L[E],G.valY=m,G.index=E,G.type="marker",G.lineSeries=T,G.x=J,G.y=K,G.markerStyle=S,G.markerHoverStyle=x,G.visible=!0,Z&&(G.marker=X,G.isSymbol=W.isSymbol,$(X.node).data("wijchartDataObj",G),i.push(X),s.push($.extend(!0,{},X.attr())),o.push(X)),et.dataPoints=et.dataPoints||{},et.pointXs=et.pointXs||[],tt=$.round(J,2),et.dataPoints[tt.toString()]||(et.dataPoints[tt.toString()]=[],et.pointXs.push(tt)),et.dataPoints[tt.toString()].push(G),D.push(G),r)},t.prototype.processYValues=function(t,n,r,i,s){var o=[],u=0,a=0;return $.each(t,function(f,l){u||(a=f);var c={isHole:!1,isValue:!0,idx:u,firstYIdx:a,x:0,y:0};u++,e.ChartUtil.isHolefunction(l,r)&&(i?t[f]=0:(c.isHole=!0,n==="excludeHole"?(u--,c.idx=0):(u=0,c.idx=0),!e.ChartUtil.isHolefunction(r,undefined)&&l===r?c.isValue=!0:c.isValue=!1)),o.push(c),i&&f<s.length&&(t[f]+=s[f])}),s.length=0,$.merge(s,t),o},t.prototype.renderMarker=function(e,t,n,r,i,s,o,u,a){var f,l=null,c=!1,h,p;return n&&(f=r.symbol,$.each(f,function(n,r){if(r.index===i)return l=e.image(r.url,s-r.width/2,o-r.height/2,r.width,r.height),t.push(l),c=!0,!1})),l===null&&(h=r.type,p=u.width,l=e.paintMarker(h,s,o,p),r.visible&&l.attr(u)),$.wijraphael.addClass($(l.node),Raphael.format("{0} {1} {2}",a.canvasObject,a.lineElement,a.canvasMarker)),{dot:l,isSymbol:c}},t.prototype.renderChartLabel=function(e,t,n,r,i,s,o,u){var a,f,l,c=this.options.widget;return a=t?$.fromOADate(n):n,r&&r.length&&(a=Globalize.format(a,r,o)),f=c._text.call(c,i,s,a),$.wijraphael.addClass($(f.node),u.lineLabel),l=f.wijGetBBox(),f.transform(Raphael.format("...T{0},{1}",0,-l.height)),f},t.prototype.getAnchors=function(e,t,n,r,i,s){var o=(n-e)/2,u=(i-n)/2,a=Math.atan((n-e)/Math.abs(r-t)),f=Math.atan((i-n)/Math.abs(r-s)),l=0,c=0,h=0,p=0,d=0;return a=t<r?Math.PI-a:a,f=s<r?Math.PI-f:f,l=Math.PI/2-(a+f)%(Math.PI*2)/2,c=o*Math.sin(l+a),h=o*Math.cos(l+a),p=u*Math.sin(l+f),d=u*Math.cos(l+f),{x1:n-c,y1:r+h,x2:n+p,y2:r+d}},t.prototype.getPathArrByFitType=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=null,g=0,y=0,b=0,w=0,E=null,S=null,x=p[n],T=!1,N=x.idx,C,k=n-1,L=n+1;if(d==="excludeHole"&&!v){if(n>0&&n<r-1){L=-1,k=-1;for(C=n+1;C<r;C++){T=!0;if(p[C].isHole)continue;L=C,T=!1;break}for(C=n-1;C>=0;C--){if(p[C].isHole)continue;k=C;break}k>-1&&(b=p[k].x,g=p[k].y)}}else n<r-1&&(T=p[L].isHole),n>0&&n<r-1&&(b=p[k].x,g=p[k].y);return v&&(t="line"),t==="line"?e=e.concat([N?"L":"M",u,a]):t==="spline"?N?N&&n<r-1&&!T?(m=o[L],l&&(m=$.toOADate(m)),y=this._calculatePoint(m,"y"),isNaN(c)||typeof c=="string"?w=this._calculatePoint(L,"x"):(E=s[L],f&&(E=$.toOADate(E)),w=this._calculatePoint(E,"x")),S=this.getAnchors(b,g,u,a,w,y),e=e.concat([S.x1,S.y1,u,a,S.x2,S.y2])):e=e.concat([u,a,u,a]):n===r-1?e=e.concat(["M",u,a]):T?e=e.concat(["M",u,a]):e=e.concat(["M",u,a,"C",u,a]):t==="bezier"&&(N?n<r-1&&p[n+1].isHole&&N%2===1||n===r-1&&N%2===1?e=e.concat(["Q",u,a,u,a]):N%2===0?e=e.concat([u,a]):e=e.concat(["Q",u,a]):e=e.concat(["M",u,a])),e},t.prototype.bindLiveEvents=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v="",m={element:e,mousedown:function(t){if(l)return;var n=$(t.target),r,s=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(s=r.lineSeries,s.markers.visible?i.call(e,t,r):i.call(e,t,s)):i.call(e,t,r)},mouseup:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?s.call(e,t,r):s.call(e,t,i)):s.call(e,t,r)},mouseover:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?o.call(e,t,r):o.call(e,t,i)):o.call(e,t,r)},mouseout:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?u.call(e,t,r):u.call(e,t,i)):u.call(e,t,r)},mousemove:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?a.call(e,t,r):a.call(e,t,i)):a.call(e,t,r)},click:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?f.call(e,t,r):f.call(e,t,i)):f.call(e,t,r)}};$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(v="wij"),e.on(v+"mousedown."+r,"."+d.lineElement,$.proxy(m.mousedown,m)).on(v+"mouseup."+r,"."+d.lineElement,$.proxy(m.mouseup,m)).on(v+"mouseover."+r,"."+d.lineElement,$.proxy(m.mouseover,m)).on(v+"mouseout."+r,"."+d.lineElement,$.proxy(m.mouseout,m)).on(v+"mousemove."+r,"."+d.lineElement,$.proxy(m.mousemove,m)).on(v+"click."+r,"."+d.lineElement,$.proxy(m.click,m))},t.prototype.unbindLiveEvents=function(e,t,n){e.off("."+t,"."+n.lineElement)},t}();e.LineChartRender=r})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=180,n=360,r=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype._create=function(){this._handleChartStyles(),e.prototype._create.call(this),this.chartElement.addClass(this.options.wijCSS.pieChart)},r.prototype.destroy=function(){var t=this.options.wijCSS,n=this.chartElement,r=n.data("fields"),i=r&&r.sectors,s=r&&r.labels;n.removeClass(t.pieChart),e.prototype.destroy.call(this),i&&i.length&&$.each(i,function(e,t){t=null}),s&&s.length&&$.each(s,function(e,t){t=null}),n.data("fields",null)},r.prototype._isPieChart=function(){return!0},r.prototype.getSector=function(e){var t=this.chartElement.data("fields");return t&&t.chartElements?t.chartElements.sectors[e]:null},r.prototype._bindData=function(){var e=this.options,t=e.dataSource,n=e.data,r=[],i,s,o;t&&n&&(i=n.label,s=n.value,o=n.offset,i&&i.bind&&(i=this._getBindData(t,i.bind)),s&&s.bind&&(s=this._getBindData(t,s.bind)),o&&o.bind&&(o=this._getBindData(t,o.bind)),i&&$.isArray(i)&&i.length&&s&&$.isArray(s)&&s.length&&($.each(s,function(e,t){var n,u=0;e>=0&&e<i.length&&(n=i[e]),o&&$.isArray(s)&&o.length&&e>=0&&e<o.length&&(u=typeof o[e]=="undefined"?0:o[e]),r.push({data:t,label:n,offset:u,legendEntry:!0})}),e.seriesList=r))},r.prototype._hanldSharedXData=function(){},r.prototype._checkSeriesDataEmpty=function(e){return isNaN(e.data)},r.prototype._getSeriesFromTR=function(e,t,n){var r=null,i=null,s=null,o=null,u=null;t.length&&t.each(function(){i=$("th",$(this)),r=$.trim(i.text()),s=$("td",$(this)),s.length&&(o=parseFloat($.trim($(s[0]).text()))),u={label:r,legendEntry:!0,data:o},n.push(u)})},r.prototype._showSerieEles=function(e){var t=this.options.showChartLabels;e.sector&&(e.sector.show(),e.sector.shadow&&e.sector.shadow.show(),e.sector.tracker&&e.sector.tracker.show()),e.label&&t&&(e.label.show(),e.label.connector&&e.label.connector.show(),$(e.label.node).data("legendHide",!1))},r.prototype._hideSerieEles=function(e){e.sector&&(e.sector.hide(),e.sector.shadow&&e.sector.shadow.hide(),e.sector.tracker&&e.sector.tracker.hide()),e.label&&(e.label.hide(),e.label.connector&&e.label.connector.hide(),$(e.label.node).data("legendHide",!0))},r.prototype._hasAxes=function(){return!1},r.prototype._mouseMoveInsidePlotArea=function(r,i){e.prototype._mouseMoveInsidePlotArea.call(this,r,i);if(this.isTapAndHold){var s=this.previousAngle,o=0,u="",a=this.chartElement,f=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},l=f.pieID||"",c=a.data("fields").chartElements["sectors"+l],h=this.canvasBounds,p=(h.startX+h.endX)/2,d=(h.startY+h.endY)/2,v=Raphael.angle(i.left,i.top,p,d);s&&(o=Math.round(v-s),Math.abs(v-s)>t&&(v>s?o-=n:o+=n),o&&(u=Raphael.format("...r{0},{1},{2}",o,p,d),$.each(c,function(e,t){t.transform(u)}),this.tooltip&&this._setTouchTooltip(null))),this.previousAngle=v}},r.prototype._mouseMoveOutsidePlotArea=function(t,n){e.prototype._mouseMoveOutsidePlotArea.call(this,t,n),this.isTapAndHold&&this._rotateToSectorCenter(null)},r.prototype._rotateToSectorCenter=function(e){var r=this,i=this.options.animation,s=this.chartElement,o=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},u=o.pieID||"",a=s.data("fields").chartElements["sectors"+u],f=s.data("fields").chartElements["labels"+u],l=this.canvasBounds,c=(l.startX+l.endX)/2,h=(l.startY+l.endY)/2,p,d,v,m=this;this._hideSectorElements(a,f),this.tooltip&&(d=this._getTouchttSector(e)),this.touchttSector&&this.touchttSector===d&&Math.abs(this.targetCenterAngle)>=.01?(this.targetCenterAngle>t?v=this.targetCenterAngle-n:this.targetCenterAngle<-t?v=this.targetCenterAngle+n:v=this.targetCenterAngle,p=Raphael.animation({transform:Raphael.format("...r{0},{1},{2}",v,c,h)},i.duration,i.easing,function(){m._rotateCallback(this,f)}),$.each(a,function(e,t){t.animate(p)})):$.each(a,function(e,t){r._rotateCallback(t,f)}),this.previousAngle=null,this.isTapAndHold=!1,this.tapTarget=null},r.prototype._rotateCallback=function(e,t){var r=this.canvasBounds,i=(r.startX+r.endX)/2,s=(r.startY+r.endY)/2,o=e.index,u=0,a=e.attr("transform"),f,l;$.each(a,function(e,t){if(t[0]!=="r")return!0;t.length>=4&&(u+=t[1])}),f=Raphael.format("r{0},{1},{2}",u,i,s),i>0&&(u%=n,f=Raphael.format("r{0},{1},{2}",u,i,s),e.attr("transform",f)),e.tracker&&(e.tracker.attr("transform",f),e.tracker.show()),e.shadow&&(e.shadow.attr("transform",f),e.shadow.show());if(t&&t.length&&t.length>o){l=t[o],l.attr("transform",Raphael.format("r{0},{1},{2}r{3}",u,i,s,0-u)),l.connector&&l.connector.attr("transform",f);if($(l.node).data("legendHide"))return;l.show(),l.connector&&l.connector.show()}},r.prototype._getTouchttSector=function(e){var r=this,i=this.chartElement,s=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},o=s.pieID||"",u=i.data("fields").chartElements["sectors"+o],a=this.tooltip.getOptions(),f=a.compass,l=90,c;switch(f){case"east":l=0;break;case"south":l=270;break;case"west":l=t;break;case"north":default:l=90}return $.each(u,function(t,i){var s=i.attr("transform"),o=0,u=i.angles;$.each(s,function(e,t){if(t[0]!=="r")return!0;t.length>=4&&(o+=t[1])}),o%=n,o<0&&(o=n+o),o=(l+o)%n;if(e){if(i===e)return r.targetCenterAngle=(u.start+u.end)/2-o,c=e,!1}else if(u.start<=o&&u.end>=o)return r.targetCenterAngle=(u.start+u.end)/2-o,c=i,!1}),c},r.prototype._setTouchTooltip=function(e){var t=this.tooltip.getOptions(),n=t.compass,r=this._getTouchttSector(e),i=this.options.hint,s=i.title,o=i.content,u=$.isFunction(s),a=$.isFunction(o),f,l;if(!r||this.touchttSector&&this.touchttSector===r)return;f=$(r.node).data("wijchartDataObj"),l={data:f,value:f.value,label:f.label,total:f.total,y:f.value};if(u||a)u&&(t.title=function(){l.fmt=s;var e=$.proxy(l.fmt,l),t=e();return t}),a&&(t.content=function(){l.fmt=o;var e=$.proxy(l.fmt,l),t=e();return t});this._showTouchTooltip(n),this.touchttSector=r},r.prototype._showTouchTooltip=function(e){var t=this.chartElement,n=this.canvasBounds,r={x:0,y:0};switch(e){case"east":r={x:t.width(),y:(n.startY+n.endY)/2};break;case"south":r={x:(n.startX+n.endX)/2,y:t.height()};break;case"west":r={x:0,y:(n.startY+n.endY)/2};break;case"north":default:r={x:(n.startX+n.endX)/2,y:0}}this.tooltip.showAt(r)},r.prototype._isTouchBehaviorEnabled=function(){return this.options.enableTouchBehavior&&this._isTouchEnabled()},r.prototype._mouseDown=function(t,n){var r=$(t.target),i=this.chartElement,s,o,u;e.prototype._mouseDown.call(this,t,n),this._isTouchBehaviorEnabled()&&(this.isTapAndHold=!0,r.data("owner")&&(r=r.data("owner")),this.tapTarget=r,s=n.pieID||"",o=i.data("fields").chartElements["sectors"+s],u=i.data("fields").chartElements["labels"+s],this._hideSectorElements(o,u))},r.prototype._hideSectorElements=function(e,t){$.each(e,function(e,n){n.stop(),n.tracker&&n.tracker.hide(),n.shadow&&n.shadow.hide();if(t&&t.length){var r=t[e];r.hide(),r.connector&&r.connector.hide()}})},r.prototype._mouseUp=function(t,n){e.prototype._mouseUp.call(this,t,n),this._isTouchBehaviorEnabled()&&this.isTapAndHold&&this._rotateToSectorCenter(null)},r.prototype._mouseOver=function(t,n){e.prototype._mouseOver.call(this,t,n)},r.prototype._mouseOut=function(t,n){e.prototype._mouseOut.call(this,t,n)},r.prototype._mouseMove=function(t,n){e.prototype._mouseMove.call(this,t,n)},r.prototype._click=function(t,n){var r=this.chartElement,i,s,o;e.prototype._click.call(this,t,n),this._isTouchBehaviorEnabled()&&this.tooltip&&(i=n.pieID||"",s=r.data("fields").chartElements["sectors"+i],s.length&&s.length>n.index&&(o=s[n.index],this._setTouchTooltip(o),this._rotateToSectorCenter(o)))},r.prototype._paintTooltip=function(){var t=this.options.wijCSS,n=this.chartElement,r=n.data("fields");e.prototype._paintTooltip.call(this),this.tooltip&&r&&(this._isTouchBehaviorEnabled()?(this.tooltip.setOptions({closeBehavior:"none",mouseTrailing:!1,animated:null,showAnimated:null,windowCollisionDetection:"fit"}),this._setTouchTooltip(null),this._rotateToSectorCenter(null)):r.trackers&&r.trackers.length&&(this.tooltip.setSelector($("."+t.canvasObject,n[0])),this.tooltip.setOptions({relatedElement:r.trackers[0]})))},r.prototype._paintPlotArea=function(){var e=this.options,t=this.canvasBounds,n=t.endX-t.startX,r=t.endY-t.startY,i=e.radius;i?(n<2*i&&(i=n/2),r<2*i&&(i=r/2)):i=Math.min(n,r)/2,t.startX+=n/2-i,t.endX=t.startX+2*i,t.startY+=r/2-i,t.endY=t.startY+2*i,this.chartElement.data("fields")&&(this.chartElement.data("fields").seriesEles=null),this.piechartRender=new o(this.chartElement,{canvas:this.canvas,tooltip:this.tooltip,bounds:t,wijCSS:e.wijCSS,radius:i,startAngle:e.startAngle,widgetName:this.widgetName,innerRadius:e.innerRadius,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,seriesTransition:e.seriesTransition,showChartLabels:e.showChartLabels,disabled:e.disabled,textStyle:e.textStyle,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,chartLabelFormatter:e.chartLabelFormatter,labels:e.labels,shadow:e.shadow,animation:e.animation,culture:this._getCulture(),mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),widget:this,enableTouchBehavior:e.enableTouchBehavior,availableWidth:n,availableHeight:r,direction:e.direction,isTouchBehaviorEnable:this._isTouchBehaviorEnabled()}),this.piechartRender.render(!e.radius)},r.prototype._getTooltipText=function(e,t){var n=$(t.node),r,i;return n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),i={data:r,value:r.value,label:r.label,total:r.total,target:t,y:r.value,fmt:e},$.proxy(e,i)()},r}(e.wijchartcore);e.wijpiechart=r;var i=function(){function e(){}return e.clockwise="clockwise",e.counterClockwise="counterClockwise",e}(),s=function(){function e(){this.initSelector=":jqmData(role='wijpiechart')",this.wijCSS={pieChart:"wijmo-wijpiechart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker"},this.startAngle=0,this.radius=null,this.innerRadius=0,this.chartLabelFormatter=null,this.labels={style:{},formatString:"",formatter:null,connectorStyle:{},position:"inside",offset:10},this.animation={enabled:!0,duration:400,easing:"easeInCubic",offset:10},this.seriesTransition={enabled:!0,duration:1e3,easing:"bounce"},this.seriesList=[],this.enableTouchBehavior=!0,this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null,this.direction=i.counterClockwise}return e}();r.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new s),$.wijmo.registerWidget("wijpiechart",r.prototype);var o=function(){function t(e,t){this.options=t,this.element=e}return t.prototype.render=function(t){var r=this.element,s=this.options,o=function(t,n,r){s.shadow&&e.ChartUtil.paintShadow(t,n,r)},u=e.ChartUtil.getDiffAttrs,a=s.canvas,f=$.wijraphael.getPositionByAngle,l=s.seriesList,c=s.seriesStyles,h=s.seriesHoverStyles,p=c.length,d=s.textStyle,v=s.labels||{style:{},formatString:"",formatter:null,connectorStyle:{},position:"inside",offset:10},m=$.extend(!0,{},d,s.chartLabelStyle,v.style),g=v.formatString||s.chartLabelFormatString,y=v.formatter||s.chartLabelFormatter,b=s.culture,w=s.bounds,E=w.startX,S=w.startY,x=s.radius,T=s.showChartLabels,N=s.animation,C=s.seriesTransition,k=s.innerRadius,L=r.data("fields")||{},A=L.chartElements||{},O=L.aniSectorAttrs,M=L.aniLabelAttrs,_=0,D=s.startAngle||0,P=s.wijCSS,H,B,j,F=[],I=[],q=[],R=[],U=[],z=[],W=a.set(),X=this.options.widget,V=D,J=s.availableWidth,K=s.availableHeight,Q=s.radius,G=s.direction;a.customAttributes.segment=function(t,r,i,s,o,u){var a=null,f=.01;return s-i>n-f?s-=f:s-i<f&&(s+=f),u?a=e.ChartUtil.donut(t,r,o,u,i,s):a=e.ChartUtil.sector(t,r,o,i,s),{path:a}},$.each(l,function(e,t){t&&typeof t.data=="number"&&(_+=Math.abs(t.data))}),t&&T&&v.position==="outside"&&($.each(l,function(e,t){var r,i,s,o,u,a,l=x,c=0,h=0,p=n*Math.abs(t.data)/_,d=p/2+V;t=$.extend(!0,{offset:0},t),i=$.extend(!0,{},i,m),t.textStyle&&(i=$.extend(!0,i,t.textStyle)),s=t.label,g&&g.length>0&&(s=Globalize.format(s,g,b)),y&&$.isFunction(y)&&(o={index:e,value:t.data,y:t.data,total:_,chartLabel:s,chartLabelFormatter:y},s=$.proxy(y,o)()),M&&C.enabled?e<M.length?(j=M[e],j.text=s,u=X._text.call(X,0,0,"").attr(j)):u=X._text.call(X,0,0,s).attr(i):u=X._text.call(X,0,0,s).attr(i),a=u.wijGetBBox(),r=f(0,0,t.offset+v.offset+x,d),c=a.width+Math.abs(r.x),h=a.height/2+Math.abs(r.y),c>J/2&&(x=l-(c-J/2)/Math.abs(Math.cos(Raphael.rad(d)))),h>K/2&&(x=Math.min(x,l-(K/2-h)/Math.abs(Math.sin(Raphael.rad(d))))),V+=p,u.remove();if(x<k)return x=k,!1}),x!=Q&&(s.bounds.startX=s.bounds.startX+Q-x,s.bounds.endX=s.bounds.startX+2*x,s.bounds.startY=s.bounds.startY+Q-x,s.bounds.endY=s.bounds.startY+2*x,E=w.startX,S=w.startY)),$.each(l,function(e,t){var r=$.extend({opacity:1,stroke:"gray","stroke-width":1},c[e%p]),s=n*Math.abs(t.data)/_,l=E+x,d=S+x,w,N,L,A,V,J,K,Q,Y,Z=v.position,et=v.connectorStyle,tt=v.offset,nt,rt,it,st=!1;H=t.pieID;var ot,ut,at=G==i.clockwise;at?(ot=D-s,ut=D-s/2):(ot=D+s,ut=D+s/2),t=$.extend(!0,{offset:0},t),t.offset&&(w=f(l,d,t.offset,ut),l=w.x,d=w.y),B=[l,d,D,ot,x,k],O&&C.enabled?(r.segment=B,e<O.length?j=O[e]:(j=$.extend(!0,{},r),j.segment=[l,d,0,n,x,k]),N=a.path().attr(j),r=u(j,r),N.removed||N.wijAnimate(r,C.duration,C.easing,function(){o(N,1,"#cccccc"),K&&!K.removed&&!N.removed&&K.attr({path:N.attr("path")}),delete r.segment})):(N=a.path().attr({segment:B}),o(N,1,"#ccccc"),N.wijAttr(r)),N.angles={start:D,end:ot},N.index=e,N.getOffset=function(e){var t=f(l,d,e,(N.angles.start+N.angles.end)/2);return{x:t.x-l,y:t.y-d}},N.center={x:l,y:d},N.radius=x,k&&(N.innerRadius=k),K=N.clone(),Raphael.vml?K.attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}):K.attr({opacity:.01,fill:"white","fill-opacity":.01}),$.wijraphael.addClass($(K.node),Raphael.format("{0} {1} {2} wijchart-tracker"+e,P.canvasObject,P.pieElement,P.pieTracker)),$(K.node).data("owner",$(N.node)),N.tracker=K,W.push(K),$.wijraphael.addClass($(N.node),Raphael.format("{0} {1} wijmo-wijpiechart-series-"+e,P.canvasObject,P.pieElement)),$(N.node).data("wijchartDataObj",t),T&&(Z==="outside"?(J=f(l,d,x,ut),A=f(l,d,x+tt,ut)):A=f(l,d,t.offset+x*2/3,ut),V=$.extend(!0,{},V,m),t.textStyle&&(V=$.extend(!0,V,t.textStyle)),Q=t.label,g&&g.length>0&&(Q=Globalize.format(Q,g,b)),y&&$.isFunction(y)&&(Y={index:e,value:t.data,y:t.data,total:_,chartLabel:Q,chartLabelFormatter:y},Q=$.proxy(y,Y)()),M&&C.enabled?e<M.length?(st=!0,j=M[e],j.text=Q,L=X._text.call(X,0,0,"").attr(j),V=u(j,V),V.x=A.x,V.y=A.y,L.wijAnimate(V,C.duration,C.easing,function(){it&&it.show()})):L=X._text.call(X,A.x,A.y,Q).attr(V):L=X._text.call(X,A.x,A.y,Q).attr(V),Z==="outside"&&(nt=ut%n,rt=L.wijGetBBox(),nt>=90&&nt<=270?L.transform(Raphael.format("T{0},{1}",-rt.width/2,0)):L.transform(Raphael.format("T{0},{1}",rt.width/2,0)),it=a.path(Raphael.format("M{0} {1}L{2} {3}",J.x,J.y,A.x,A.y)).attr(et),st&&it.hide(),L.connector=it),$.wijraphael.addClass($(L.node),Raphael.format("{0} {1} {2}",P.canvasObject,P.pieElement,P.pieLabel)),$(L.node).data("wijchartDataObj",t),U.push(L),R.push(L),I[e]=L.attr()),z.push({label:R[e],sector:N}),t.visible===!1&&(N.hide(),R[e]&&R[e].hide(),it&&it.hide(),N.shadow&&N.shadow.hide(),K.hide()),F[e]=N.attr(),q.push(N),U.push(N),t.style=r,t.hoverStyle=h[e],t.index=e,t.value=t.data,t.y=t.data,t.total=_,t.type="pie",D=ot}),R&&R.length&&$.each(R,function(e,t){t.toFront()}),A.sectors=q,H&&(A["sectors"+H]=q,A["labels"+H]=R),A.labels=R,L.chartElements||(L.chartElements={}),W.toFront(),$.extend(!0,L.chartElements,A),L.aniSectorAttrs=F,L.aniLabelAttrs=I,L.seriesEles=z,L.trackers=W,r.data("fields",L),this.unbindLiveEvents(),this.bindLiveEvents()},t.prototype.bindLiveEvents=function(){var e=this.options,t=e.widget._isTouchEnabled(),n=e.isTouchBehaviorEnable,r=this.element,i=e.tooltip,s={x:0,y:0},o="",u="",a=$.isFunction,f=e.disabled,l=e.animation;t&&(o="wij"),n&&(u="wij"),i&&i.setTargets(this.tooltipTars),r.on(o+"mousedown."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(f)return;var n=e.mouseDown,i=$(t.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;a(n)&&n.call(r,t,s)}).on(o+"mouseup."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(f)return;var n=e.mouseUp,i=$(t.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;a(n)&&n.call(r,t,s)}).on(u+"mouseover."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(f)return;var i=e.mouseOver,o=$(t.target),u=l&&l.enabled,c,h,p,d,v,m,g;o.data("owner")&&(o=o.data("owner")),c=o.data("wijchartDataObj");if(!c)return;h=c.pieID||"",p=c.index,d=r.data("fields").chartElements["sectors"+h][p],v=d.showAnimationTimer,m=d.hideAnimationTimer,g=d.explodeAnimationShowing,a(i)&&i.call(r,t,c);if(n)return;if(d.removed)return;d.wijAttr(c.hoverStyle);if(u){m&&(window.clearTimeout(m),m=null,d.hideAnimationTimer=m),v&&(window.clearTimeout(v),v=null,d.showAnimationTimer=null);if(g)return;v=window.setTimeout(function(){var e=l.duration,t=l.easing;if(d.removed)return;s=d.getOffset(l.offset||10),d.offset=s,d.shadow&&!d.shadow.removed&&d.shadow.hide(),d.wijAnimate({transform:Raphael.format("t{0},{1}",s.x,s.y)},e,t),d.tracker&&!d.tracker.removed&&d.tracker.wijAnimate({transform:Raphael.format("t{0},{1}",s.x,s.y)},e,t),g=!0,d.explodeAnimationShowing=g},150),d.showAnimationTimer=v}}).on(u+"mouseout."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(f)return;var i=e.mouseOut,o=$(t.target),u=l&&l.enabled,c,h,p,d,v,m,g;o.data("owner")&&(o=o.data("owner")),c=o.data("wijchartDataObj");if(!c)return;h=c.pieID||"",p=c.index,d=r.data("fields").chartElements["sectors"+h][p],v=d.showAnimationTimer,m=d.hideAnimationTimer,g=d.explodeAnimationShowing,a(i)&&i.call(r,t,c);if(n)return;if(d.removed)return;c.style.segment&&delete c.style.segment,d.wijAttr(c.style);if(u){m&&(window.clearTimeout(m),m=null,d.hideAnimationTimer=m),v&&(window.clearTimeout(v),v=null,d.showAnimationTimer=v);if(!g)return;m=window.setTimeout(function(){var e=l.duration,t=l.easing;s=d.offset,d.shadow&&!d.shadow.removed&&d.shadow.show(),d.removed||d.wijAnimate({transform:"t0,0"},e,t),d.tracker&&!d.tracker.removed&&d.tracker.wijAnimate({transform:"t0,0"},e,t),d.shadow&&!d.shadow.removed&&d.shadow.wijAnimate({transform:"t0,0"},e,t),s={x:0,y:0},g=!1,d.explodeAnimationShowing=g},150),d.hideAnimationTimer=m}}).on(o+"mousemove."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(f)return;var n=e.mouseMove,i=$(t.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;a(n)&&n.call(r,t,s)}).on(o+"click."+e.widgetName,"."+e.wijCSS.pieElement,function(t){if(f)return;if(window.navigator.userAgent.match(/iPhone|iPad|iPod/i)&&n&&!$.wijraphael.hasClass(t.target,e.wijCSS.pieTracker))return;var i=e.click,s=$(t.target),o;s.data("owner")&&(s=s.data("owner")),o=s.data("wijchartDataObj");if(!o)return;a(i)&&i.call(r,t,o)})},t.prototype.unbindLiveEvents=function(){var e=this.element,t=this.options;e.off("."+t.widgetName,"."+t.wijCSS.pieElement)},t}();e.PieChartRender=o})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t="wijcandlestickchart",n="ohlc",r="candlestick",i="hl",s="stroke-width",o=function(){function e(e){this.init(e)}return e.prototype.init=function(e){var t=[],n={},r,i;$.each(e,function(e,n){var r=$.toOADate(n);$.inArray(r,t)===-1&&t.push(r)}),this.count=r=t.length,this.times=t=t.sort(),this.timeDic=n;if(r<2){this.max=t[0]||0,this.min=t[0]||0,this.unit=864e5,r===1&&(n[t[0]]=0);return}for(i=0;i<r;i++)n[t[i]]=i;this._calculateUnit(),this.max=t[this.count-1],this.min=t[0]},e.prototype._calculateUnit=function(){var e=Number.MAX_VALUE,t=1;for(;t<this.count;t++)e=Math.min(e,this.times[t]-this.times[t-1]);this.unit=e},e.prototype.getOATime=function(e){var t=this.count,n=this.times,r;return e<0?this.min+e*this.unit:e>t-1?this.max+(e-t+1)*this.unit:(r=parseInt(e),n[r]+(e-r)*this.unit)},e.prototype.getTime=function(e){return $.fromOADate(this.getOATime(e))},e.prototype.getTimeIndex=function(e){var t=$.toOADate(e),n;return t>this.max?this.count-1+(t-this.max)/this.unit:t<this.min?(t-this.min)/this.unit:this.timeDic&&this.timeDic[t]!=null?this.timeDic[t]:($.each(this.times,function(e,r){if(r>t)return n=e-1,!1}),n+(t-this.times[n])/this.unit)},e.prototype.getCount=function(){return this.times.length},e.prototype.dispose=function(){this.times=null,this.timeDic=null},e}();e.datetimeUtil=o;var u=function(t){function s(){t.apply(this,arguments)}return __extends(s,t),s.prototype._paintChartArea=function(){var e=this.options;if(this._isSeriesListDataEmpty())return;$.each(e.seriesList,function(e,t){var n=t.data;n.y=[].concat(n.high).concat(n.low)}),t.prototype._paintChartArea.call(this),$.each(e.seriesList,function(e,t){delete t.data.y})},s.prototype._checkSeriesDataEmpty=function(e){var t=this.options.type,i=e.data,s=this._checkEmptyData;if(!i||s(i.x)||s(i.high)||s(i.low))return!0;if(t===n||t===r)if(s(i.open)||s(i.close))return!0;return!1},s.prototype._getLegendStyle=function(e){var t=e.highLow;return t?(t=$.extend({},t),delete t.width,delete t.height,t.stroke||(t.stroke=t.fill),t):e},s.prototype._showHideSeries=function(e,t){var n=["highLow","open","close","path","high","low","openClose"];$.each(e,function(e,r){$.each(n,function(e,n){r[n]&&r[n][t]()}),r.path&&$(r.path.node).data("wijchartDataObj")&&($(r.path.node).data("wijchartDataObj").visible=t==="show")})},s.prototype._showSerieEles=function(e){this._showHideSeries(e,"show")},s.prototype._hideSerieEles=function(e){this._showHideSeries(e,"hide")},s.prototype._paintPlotArea=function(){var e=this.options,t=new a(this.chartElement,{canvas:this.canvas,bounds:this.canvasBounds,tooltip:this.tooltip,widgetName:this.widgetName,axis:e.axis,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,seriesTransition:e.seriesTransition,showChartLabels:e.showChartLabels,textStyle:e.textStyle,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,shadow:e.shadow,disabled:e.disabled,animation:e.animation,culture:this._getCulture(),type:e.type,wijCSS:e.wijCSS,mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),timeUtil:this.timeUtil,candlestickFormatter:e.candlestickFormatter,widget:this});t.render()},s.prototype._paintTooltip=function(){var e=this.chartElement.data("fields"),n;t.prototype._paintTooltip.call(this),this.tooltip&&e&&e.trackers&&(n=e.trackers,this.tooltip.setTargets(n),this.tooltip.setOptions({relatedElement:n[0]}))},s.prototype._getTooltipText=function(e,t){var n=$(t.node).data("wijchartDataObj"),r={data:n,label:n.label,x:n.x,high:n.high,low:n.low,open:n.open,close:n.close,target:t,fmt:e};return $.proxy(e,r)()},s.prototype._setDefaultTooltipText=function(e){var t=this.options.type,n;return n=e.label+" - "+Globalize.format(e.x,"d")+"\n High:"+e.high+"\n Low:"+e.low,t!==i&&(n+="\n Open:"+e.open+"\n Close:"+e.close+""),n},s.prototype._setDefaultFill=function(e,t){function r(e,t){var n=e[t]||{};n.fill||(n.fill=e.fill),e[t]=n}function s(e,t){$.isArray(t)?$.each(t,function(t,n){r(e,n)}):r(e,t)}e===i?s(t,"highLow"):e===n?s(t,["open","close","highLow"]):s(t,["fallingClose","risingClose","unchangeClose","highLow"])},s.prototype._setDefaultCandlestickStyle=function(){var e=this,t=this.options,n=t.type,r=this._getDefFill();$.each(t.seriesStyles,function(t,i){i.fill||(i.fill=r[t]),e._setDefaultFill(n,i)}),r=null},s.prototype._handleChartStyles=function(){t.prototype._handleChartStyles.call(this),this._setDefaultCandlestickStyle()},s.prototype._create=function(){this._handleChartStyles(),this.bindXData=!1,this._handleXData(),t.prototype._create.call(this),this.chartElement.addClass(this.options.wijCSS.wijCandlestickChart)},s.prototype._setOption=function(e,n){e==="axis"&&this._handleMaxMinInAxis(n),t.prototype._setOption.call(this,e,n)},s.prototype._seriesListSeted=function(){this.timeUtil.dispose(),this.timeUtil=null,this._handleXData()},s.prototype._handleMaxMinInAxis=function(e){var t=this,n,r=this.options.axis,i=function(e){return t._isDate(e)?t.timeUtil.getTimeIndex(e):t.timeUtil.getTimeIndex($.fromOADate(e))};e&&e.x&&(n=e.x,$.each(["max","min"],function(e,t){if(!r||!r.x||r.x[t]!==n[t])n[t]=i(n[t])}))},s.prototype._handleXData=function(){var e=this,t=this.options,n=t.seriesList=$.arrayClone(t.seriesList),r=[],i=!1,s=function(e){return e.data&&e.data.x},u=function(t){var n=t.data.x;$.each(n,function(t,r){e._isDate(r)||(n[t]=e.timeUtil.getTime(r))})};if(this.timeUtil&&!this.bindXData)return;this.bindXData=!1,$.each(n,function(e,t){s(t)&&$.isArray(t.data.x)&&(r=r.concat(t.data.x))}),this.timeUtil&&($.each(r,function(t,n){if(e._isDate(n))return i=!0,!1}),i&&(r=[],$.each(n,function(e,t){s(t)&&(u(t),r=r.concat(t.data.x))}),this.timeUtil.dispose(),this.timeUtil=null)),this.timeUtil||(this.timeUtil=new o(r)),$.each(n,function(t,n){s(n)&&$.isArray(n.data.x)&&(n.data.x=$.map(n.data.x,function(t,n){return e.timeUtil.getTimeIndex(t)}))})},s.prototype._bindData=function(){t.prototype._bindData.call(this),this._handleXData()},s.prototype._bindSeriesData=function(e,n,r){var i=this,s=n.data;t.prototype._bindSeriesData.call(this,e,n,r),s.x&&$.isArray(s.x)&&(this.bindXData=!0),$.each(["high","low","open","close"],function(t,n){var r=s[n];r&&r.bind&&(s[n]=i._getBindData(e,r.bind))})},s.prototype.destroy=function(){var e=this.chartElement;e.removeClass(this.options.wijCSS.wijCandlestickChart),t.prototype.destroy.call(this),this.timeUtil&&this.timeUtil.dispose(),e.data("fields",null)},s.prototype.getCandlestick=function(e){var t=this.chartElement.data("fields");return t&&t.chartElements&&t.chartElements.candlestickEles?t.chartElements.candlestickEles[e]||null:null},s.prototype._clearChartElement=function(){var e=this.options,n=this.chartElement.data("fields"),r,i;n&&n.chartElements&&(r=n.chartElements,i=r.candlestickEles,$.each(i,function(e,t){$.each(t,function(e,n){n&&n[0]&&n.wijRemove(),t[e]=null}),i[e]=null}),r.candlestickEles=null,r.group&&r.group.wijRemove(),r.group=null,n.trackers&&n.trackers.wijRemove(),n.trackers=null),t.prototype._clearChartElement.call(this)},s.prototype._calculateParameters=function(e,n){t.prototype._calculateParameters.call(this,e,n);if(e.id==="x"){var r=n.unitMinor,i=n.autoMin,s=n.autoMax,o=this._getCandlestickAdjustment(e,r);i&&(e.min-=o),s&&(e.max+=o),this._calculateMajorMinor(n,e)}},s.prototype._calculateMajorMinor=function(n,r){r.id==="x"&&(!n.annoFormatString||n.annoFormatString.length===0?r.annoFormatString=e.ChartDataUtil.getTimeDefaultFormat(this.timeUtil.getOATime(r.max),this.timeUtil.getOATime(r.min)):r.annoFormatString=n.annoFormatString),t.prototype._calculateMajorMinor.call(this,n,r)},s.prototype._getCandlestickAdjustment=function(e,t){var n=0,r;return $.each(this.options.seriesList,function(e,t){t.data&&t.data.x&&$.isArray(t.data.x)&&(n=Math.max(t.data.x.length,n))}),r=(e.max-e.min)/n,r===0?r=t:t<r&&t!==0&&(r=Math.floor(r/t)*t),r},s.prototype._getXTickText=function(e){return this.timeUtil.getCount()===0?"":this.timeUtil.getTime(e)},s.prototype._adjustTickValuesForCandlestickChart=function(e){var n=this,r=this.options.axis.x.annoMethod==="valueLabels",i=[];return r&&e&&$.isArray(e)?($.each(e,function(e,t){i[e]=n.timeUtil.getTimeIndex($.fromOADate(t))}),i):t.prototype._adjustTickValuesForCandlestickChart.call(this,e)},s.prototype._getTickTextForCalculateUnit=function(e,n,r){return n.id==="x"?Globalize.format(this._getXTickText(e),n.annoFormatString,this._getCulture()):t.prototype._getTickTextForCalculateUnit.call(this,e,n,r)},s}(e.wijchartcore);e.wijcandlestickchart=u;var a=function(){function e(e,t){this.element=e,this.options=t,this.bounds=t.bounds,this.width=this.bounds.endX-this.bounds.startX,this.height=this.bounds.endY-this.bounds.startY,this.type=t.type,this.timeUtil=t.timeUtil,this.trackers=t.canvas.set(),this.isHover=!1}return e.prototype._paintCandlestickElements=function(e,t,n){var r=e.data,s=Math.min(r.x.length,r.high.length,r.low.length),o=this.options.wijCSS,u=$.extend({candlestickType:this.type,visible:!0},e),a=[],f=this.options.widget,l,c,h,p,d,v;u.type="candlestick",r.open&&r.close&&(s=Math.min(s,r.open.length,r.close.length)),l=this.width/s;for(c=0;c<s;c++)h=this._paintCandlestickGraphic(r,c,l,t,n),d=$.extend({},u),h.path&&(p=$(h.path.node),$.wijraphael.addClass(p,o.canvasObject+" "+o.candlestickChart+" "+o.candlestickChartTracker),p.css("opacity",0),this.type!==i&&$.extend(d,{open:r.open[c],close:r.close[c]}),$.extend(d,{high:r.high[c],low:r.low[c],index:c,x:this.timeUtil.getTime(r.x[c]),candlestickEles:h,style:t,hoverStyle:n}),p.data("wijchartDataObj",d)),e.visible===!1&&$.each(h,function(e,t){t&&t.hide&&t.hide()}),a.push(h),f.dataPoints=f.dataPoints||{},f.pointXs=f.pointXs||[],v=h.x,f.dataPoints[v.toString()]||(f.dataPoints[v.toString()]=[],f.pointXs.push(v)),f.dataPoints[v.toString()].push(d);return a},e.prototype._unbindLiveEvents=function(){var e=this.options.widgetName;this.element.off("."+e,".wijcandlestickchart")},e.prototype._bindLiveEvents=function(){function i(e){var t=$(e.target);return t.data("wijchartDataObj")}function s(e,n,i){var s={mouseover:t.mouseOver,mouseout:t.mouseOut,mousedown:t.mouseDown,mouseup:t.mouseUp,mousemove:t.mouseMove,click:t.click};if($.isFunction(s[e]))return s[e].call(r,n,i)}var e=this,t=this.options,n="",r=this.element;$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(n="wij"),$.each(["mouseover","mouseout","mousedown","mouseup","mousemove","click"],function(r,o){e.element.on(n+o+"."+t.widgetName,".wijcandlestickchart",function(n){if(t.disabled)return;var r=i(n);s(o,n,r)!==!1&&(o==="mouseover"||o==="mouseout")&&e["_"+o](r),r=null})})},e.prototype._setCandlestickStyleForHover=function(e,t,n,r){var i=function(e,t){e&&t&&e.attr(t)};i(e.highLow,t.highLow),i(e.open,t.open),i(e.close,t.close),i(e.high,t.highLow),i(e.low,t.highLow),n!==undefined&&r!==undefined&&(n>r?i(e.openClose,t.fallingClose):n<r?i(e.openClose,t.risingClose):i(e.openClose,t.unchangeClose))},e.prototype._mouseover=function(e){e.hoverStyle&&(this.isHover=!0,this._setCandlestickStyleForHover(e.candlestickEles,e.hoverStyle,e.open,e.close))},e.prototype._mouseout=function(e){var t=e.style;this.isHover&&(this._setCandlestickStyleForHover(e.candlestickEles,t,e.open,e.close),this._formatCandlestick({high:e.high,low:e.low,open:e.open,close:e.close,hlStyle:t.highLow,oStyle:t.open,cStyle:t.close,index:e.index,eles:e.candlestickEles,fallingCloseStyle:t.fallingClose,risingCloseStyle:t.risingClose,unchangeCloseStyle:t.unchangeClose}),this.isHover=!1)},e.prototype._paintCandlestickGraphic=function(e,t,o,u,a){function G(e){return e?{fill:e.fill,stroke:e.stroke}:null}var f=this.options,l=e.x[t],c=e.high[t],h=e.low[t],p=e.open?e.open[t]:0,d=e.close?e.close[t]:0,v=this.bounds.startX,m=this.bounds.endY,g=this.type!==i,y=f.axis,b=y.x,w=y.y,E=b.min,S=w.min,x=b.max,T=w.max,N=0,C=0,k=this.width/(x-E),L=this.height/(T-S),A,O,M,_,N,C,D,P,H,B,j,F,I,q,R,U,z,W,X,V,J,K,Q;return M=u.open,O=u.close,A=u.highLow,z=u.fallingClose,W=u.risingClose,V=u.unchangeClose,_=A[s]||0,j=(l-E)*k+this.bounds.startX,F=m-(c-S)*L,I=j,q=m-(h-S)*L,g&&(this.type===n?(N=M[s]||0,C=O[s]||0):(p>d?(N=C=z[s]||0,K=z.width||0,J=G(z),Q=z):p===d?(N=C=V[s]||0,K=V.width||0,J=G(V),Q=V):(N=C=W[s]||0,K=W.width||0,J=G(W),Q=W),A=$.extend({},J,A),o-=(N+C)/2,o<2&&(o=2)),U=o/2*.8,this.type===r&&(U=Math.min(K/2,U)),U<1&&(U=1),D=j-U,P=m-(p-S)*L,H=j+U,B=m-(d-S)*L,P=Math.max(P,F+N/2),P=Math.min(P,q-N/2),B=Math.max(B,F+C/2),B=Math.min(B,q-C/2)),this.type===n?(R=this._paintOHLC({h:{x:j,y:F},l:{x:I,y:q},o:{x:D,y:P},c:{x:H,y:B}}),R.open.attr(M),R.close.attr(O)):this.type===i?R=this._paintHL({h:{x:j,y:F},l:{x:I,y:q}}):(R=this._paintCandlestick({h:{x:j,y:F},l:{x:I,y:q},o:{x:D,y:P},c:{x:H,y:B}}),R.high.attr(A),R.low.attr(A),R.openClose.attr(Q)),R.highLow&&R.highLow.attr(A),this._formatCandlestick({high:c,low:h,open:p,close:d,hlStyle:A,oStyle:M,cStyle:O,index:t,eles:R,fallingCloseStyle:z,risingCloseStyle:W,unchangeCloseStyle:V}),R.path.attr({"stroke-width":Math.max(K||1,C||1,_||1,N||1),fill:"#000"}),this.trackers.push(R.path),R.x=$.round(j),u.highLow=A,R},e.prototype._formatCandlestick=function(e){var t=this.options.candlestickFormatter,i=e.index,s=e.high,o=e.low,u=e.open,a=e.close,f=e.hlStyle,l=e.oStyle,c=e.cStyle,h=e.fallingCloseStyle,p=e.risingCloseStyle,d=e.unchangeCloseStyle,v=this.type,m,g;t&&(m={high:s,low:o},g={highLow:f},v===n?($.extend(m,{open:u,close:a}),$.extend(g,{open:l,close:c})):v===r&&($.extend(m,{open:u,close:a}),$.extend(g,{fallingClose:h,risingClose:p,unchangeClose:d})),t.call(this,{data:m,eles:e.eles,style:g}))},e.prototype._paintTracker=function(e,t){var n=[],r=[],i,s,o,u;return $.each(e,function(e,t){n.push(t.x),r.push(t.y)}),i=Math.max.apply(null,n),s=Math.min.apply(null,n),o=Math.max.apply(null,r),u=Math.min.apply(null,r),t.rect(s,u,i-s,o-u)},e.prototype._paintOHLC=function(e){var t=e.h,n=e.l,r=e.o,i=e.c,s=this.options.canvas,o=["M",t.x,",",t.y,"V",n.y],u=["M",r.x,",",r.y,"H",t.x],a=["M",t.x,",",i.y,"H",i.x],f,l,c,h;return f=s.path(o.join("")),l=s.path(u.join("")),c=s.path(a.join("")),h=this._paintTracker(e,s),this._setTrackerForCandlestickEle([f,l,c],h),this.group.push(l,c,f),{highLow:f,open:l,close:c,path:h}},e.prototype._setTrackerForCandlestickEle=function(e,t){$.each(e,function(e,n){n.node.tracker=t})},e.prototype._paintHL=function(e){var t=e.h,n=e.l,r=this.options.canvas,i,s;return i=r.path(["M",t.x,",",t.y,"V",n.y].join("")),s=i.clone(),this._setTrackerForCandlestickEle([i],s),this.group.push(i),{highLow:i,path:s}},e.prototype._paintCandlestick=function(e){var t=e.h,n=e.l,r=e.o,i=e.c,s=this.options.canvas,o,u,a,f,l,c,h,p,d;return i.y<r.y?(f=i.y,l=r.y):(f=r.y,l=i.y),c=["M",t.x,",",t.y,"V",f],h=["M",n.x,",",n.y,"V",l],p=["M",r.x,",",f,"H",i.x,"V",l,"H",r.x,"V",f,"Z"],u=s.path(c.join("")),a=s.path(h.join("")),o=s.path(p.join("")),d=this._paintTracker(e,s),this.group.push(u,a,o),this._setTrackerForCandlestickEle([u,a,o],d),{high:u,low:a,openClose:o,path:d}},e.prototype._handleStyle=function(e,t){if(!e)return;return e.stroke||(e.stroke=e.fill),t!==!0&&$.each(["width","height"],function(t,n){e[n]&&(e["stroke-width"]=e[n],delete e[n])}),e},e.prototype._extendStyles=function(e){var t=$.extend(!0,{},e);return t&&(t.highLow=this._handleStyle(t.highLow),t.close=this._handleStyle(t.close),t.open=this._handleStyle(t.open),t.fallingClose=this._handleStyle(t.fallingClose,!0),t.risingClose=this._handleStyle(t.risingClose,!0),t.unchangeClose=this._handleStyle(t.unchangeClose,!0)),t},e.prototype._paintCandlesticks=function(){var e=this,t=[],n,r=this.options,i=r.seriesList,s=r.seriesStyles,o=r.seriesHoverStyles,u=this.element.data("fields")||{},a=u.chartElements||{},f=a.candlestickEles||[];$.each(i,function(r,i){var u=e._extendStyles(s[r]),a=e._extendStyles(o[r]);n=e._paintCandlestickElements(i,u,a),f=f.concat(n),t.push(n)}),u.seriesEles=t,u.trackers=this.trackers,a.candlestickEles=f,a.group=this.group,u.chartElements=a,this.fields=u,this.trackers.toFront()},e.prototype._playAnimation=function(){var e=this.options.animation,t=e&&e.enabled,n,r;t&&(n=e.duration||400,r=e.easing,this.group.attr("clip-rect",[this.bounds.startX,this.bounds.startY,0,this.height].join(",")),this.group.wijAnimate({"clip-rect":[this.bounds.startX,this.bounds.startY,this.width,this.height].join(",")},n,r))},e.prototype.render=function(){this.group=this.options.canvas.group(),this._paintCandlesticks(),this.element.data("fields",this.fields),this._unbindLiveEvents(),this._bindLiveEvents(),this._playAnimation()},e}();e.CandlestickChartRender=a;var f=function(){function e(){this.type=r,this.animation={enabled:!0,duration:400,easing:">"},this.wijCSS={wijCandlestickChart:"wijmo-wijcandlestickchart",candlestickChart:"wijcandlestickchart",candlestickChartTracker:"candlesticktracker"},this.candlestickFormatter=null,this.showChartLabels=!0,this.chartLabelStyle={},this.chartLabelFormatString="",this.hint={contentStyle:{"font-size":12}},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();u.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new f),u.prototype.widgetEventPrefix=t,$.wijmo.registerWidget(t,u.prototype)})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijtree",i=function(e){if(!n.isPlainObject(e))return;var t=e.navigateUrl||"#",r="<li><a href='"+t+"'>";return typeof e.text=="string"&&e.text&&(r+="<span>"+e.text+"</span>"),r+="</a></li>",r},s=function(e){var t="";return n.each(e,function(e,r){if(!n.isPlainObject(r))return!0;var i=r.navigateUrl||"#",o=r.nodes&&r.nodes.length>0,u="<li><div class='wijmo-wijtree-node'><span class='wijmo-wijtree-inner'>";o&&(u+="<span class='wijmo-wijtree-hitarea'></span>"),u+="<span class='wijmo-wijtree-nodeimage'></span><a href='"+i+"'>",typeof r.text=="string"&&r.text&&(u+="<span>"+r.text+"</span>"),u+="</a></span></div>",o&&(u+="<ul>",u+=s(r.nodes),u+="</ul>"),u+="</li> ",t+=u}),t},o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._useDOMInit=!0,this._initState(),this._createTree(),this._attachEvent(),this._attachNodeEvent()},t.prototype._setOption=function(e,t){var r=this,i=!1,s=r.options,o,u;switch(e){case"allowDrag":r._setAllowDrag(t);break;case"allowDrop":r._setAllowDrop(t);break;case"showCheckBoxes":r._setCheckBoxes(t);break;case"showExpandCollapse":r.options.showExpandCollapse!==t&&(i=!0);break;case"disabled":o=r.element.find(":wijmo-wijtreecheck"),o.length&&o.wijtreecheck("option","disabled",t),r._setAllowDrag(!t);break;default:}n.Widget.prototype._setOption.apply(r,arguments),e==="nodes"&&(t&&t.length&&(r._useDOMInit=!1),r._createChildNodes()),i===!0&&r._setHitArea(t)},t.prototype._initState=function(){var e=this,t=e.options;e._selectedNodes=[],e._checkedNodes=[],t.nodes||(t.nodes=[]),t.nodes&&t.nodes.length&&(e._useDOMInit=!1),e._insertPosition="unKnown",e.nodeWidgetName="wijtreenode"},t.prototype._createTree=function(){var e=this,t=e.options,r=[],i=["wijmo-wijtree",t.wijCSS.widget,t.wijCSS.content,t.wijCSS.helperClearFix,t.wijCSS.cornerAll].join(" ");e.element.is("ul")?(e.$nodes=e.element,e.element.wrap("<div></div>"),e.widgetDom=e.element.parent()):e.element.is("div")&&(e.widgetDom=e.element,e.$nodes=e.widgetDom.children("ul:eq(0)")),e.$nodes.length&&(e.widgetDom.addClass(i).attr({role:"tree","aria-multiselectable":!0}),e.$nodes.addClass("wijmo-wijtree-list "+t.wijCSS.helperReset+(t.showExpandCollapse?"":" wijmo-wijtree-allexpanded")),e._createChildNodes(),e.widgetDom.append(n("<div>").css("clear","both"))),t.disabled&&e.disable()},t.prototype._createChildNodes=function(){var e=this,t={nIndex:undefined},r=[],i=e.$nodes,o=e.options.nodes,u;!e._useDOMInit||o.length?(i.empty(),u=s(o),i.html(u),e.htmlGenerated=!0,u=i.children("li"),u.each(function(i,s){var o=n(s);t.nIndex=i,e._createNodeWidget(o,t),r.push(e._getNodeWidget(o))}),e.htmlGenerated=!1):(u=i.children("li"),u.each(function(i,s){var u=n(s),a;e._createNodeWidget(u,t),a=e._getNodeWidget(u),r.push(a),o.push(a.options)})),e._hasChildren=r.length>0,e._setField("nodes",r),e.nodes=r},t.prototype._createNodeWidget=function(e,t){var r=this,i=r.nodeWidgetName;return n.fn[i]&&(e.data("owner",this),!!t&&n.isPlainObject(t)?(n.extend(t,{treeClass:this.widgetFullName}),e[i](t)):e[i]({treeClass:this.widgetFullName})),e},t.prototype._attachEvent=function(){var e=this;e.element.bind(n.browser.msie?"focusin.":"focus."+e.widgetName,n.proxy(e._onFocus,e)).bind("mouseover."+this.widgetName,n.proxy(e._onMouseOver,e)),e.options.allowDrop&&e._attachDroppable()},t.prototype._attachDroppable=function(){var e=this,t=e.options,r={accept:"li",scope:"tree",drop:undefined},i=function(n){t.showCheckBoxes&&t.allowTriState&&!n.element.is(":"+e.widgetFullName)&&n._getField("nodes").length>0&&n._getField("nodes")[0]._setParentCheckState()},s=t.droppable;n.extend(r,s),r.drop=function(r,o){var u=o.draggable,a=e._getNodeWidget(u),f,l,c,h,p,d,v,m=-1;if(e._trigger("nodeBeforeDropped",r,o)===!1||!a||t.disabled){e._isDragging=!1;return}f=a._dropTarget,l=a._insertPosition;if(f&&l!=="unKnown"){c=u.data("owner"),c&&(v=u.index());if(l==="end")m=f._getField("nodes").length,h=f;else if(l==="before"||l==="after")h=f._getField("owner"),p=h._getField("nodes"),d=n.inArray(f,p),d!==-1&&(m=l==="before"?d:d+1);s&&n.isFunction(s.drop)?(o.oldParent=c.element,o.newParent=h.element,o.oldIndex=v,o.newIndex=m,s.drop.call(e.element,r,o)):(c&&c.remove(u),m!==-1&&((l==="before"||l==="after")&&d!=n.inArray(f,p)&&m--,e.$nodes.children("li").length?h.add(u,m):e.add(u,m))),n("a:eq(0)",u).blur(),a._tree._isDragging=!1,a.options.selected&&a._setSelected(!1),i(c),i(h),n.extend(o,{sourceParent:c?c.element:null,sIndex:v,targetParent:h.element,tIndex:m,widget:a}),e._trigger("nodeDropped",r,o)}},n.fn.droppable&&e.widgetDom.droppable(r)},t.prototype._attachNodeEvent=function(){this.element.bind("click."+this.widgetName,n.proxy(this._onClick,this)).bind("mouseout."+this.widgetName,n.proxy(this._onMouseOut,this)).bind("keydown."+this.widgetName,n.proxy(this._onKeyDown,this))},t.prototype._onClick=function(e){this._callEvent(e,"_onClick"),n.browser.webkit&&this.widgetDom.focus()},t.prototype._onFocus=function(e){this._callEvent(e,"_onFocus")},t.prototype._onKeyDown=function(e){this._callEvent(e,"_onKeyDown")},t.prototype._onMouseOut=function(e){this._callEvent(e,"_onMouseOut")},t.prototype._onMouseOver=function(e){this._callEvent(e,"_onMouseOver")},t.prototype._callEvent=function(e,t){var n=e.target,r;if(n){r=this._getNodeWidgetByDom(n);if(r===null)return;r[t](e)}},t.prototype._nodeSelector=function(){return":wijmo-wijtreenode"},t.prototype.getSelectedNodes=function(){return this._selectedNodes},t.prototype.getCheckedNodes=function(){var e=this,t=[],r=e.nodeWidgetName;return n(e._nodeSelector(),e.element).each(function(e,i){n(i)[r]("option","checked")&&n(i)[r]("option","checkState")!=="indeterminate"&&t.push(n(i))}),t},t.prototype.destroy=function(){var t=this,r=t.$nodes,i=t.options,s=["wijmo-wijtree",i.wijCSS.widget,i.wijCSS.content,i.wijCSS.helperClearFix,i.wijCSS.cornerAll].join(" ");t.widgetDom.removeClass(s).removeAttr("role").removeAttr("aria-multiselectable"),t.widgetDom.data("uiDroppable")&&t.widgetDom.droppable("destroy"),t.widgetDom.children("div[style]:last").remove(),r.removeData("nodes").removeClass("wijmo-wijtree-list").removeClass(i.wijCSS.helperReset),r.children("li").each(function(e,r){var i=t._getNodeWidget(n(r));i&&i.destroy()}),n.wijmo.wijtree.prototype.options.nodes=null,e.prototype.destroy.call(this)},t.prototype.add=function(e,t){var r=null,i={},s,o,u=this,a,f,l="<li><a href='{0}'>{1}</a></li>",c;typeof e=="string"?(s=n(l.replace(/\{0\}/,"#").replace(/\{1\}/,e)),u._createNodeWidget(s,i),r=s.data(s.data("widgetName"))):e.jquery?(e.data("widgetName")||u._createNodeWidget(e,i),r=e.data(e.data("widgetName"))):e.nodeType?(s=n(e),u._createNodeWidget(s,i),r=s.data(s.data("widgetName"))):n.isPlainObject(e)&&(s=n(l.replace(/\{0\}/,e.url?e.url:"#").replace(/\{1\}/,e.text)),u._createNodeWidget(s,e),r=s.data(s.data("widgetName")));if(r===null)return;o=u._getField("nodes"),(!t||t>o.length)&&t!==0&&(t=o.length),c=r._getField("nodes"),r._tree=u;for(a=0;a<c.length;a++)c[a]._tree=u;r._setField("owner",this),f=o.length,f>0&&f!==t?r.element.get(0)!==o[t].element.get(0)&&r.element.insertBefore(o[t].element):u.$nodes.append(r.element),u._changeCollection(t,r),r._initNodeClass()},t.prototype.remove=function(e){var t=-1,n,r;e&&e.jquery?t=e.index():typeof e=="number"&&(t=e),r=this._getField("nodes");if(t<0||t>=r.length)return;n=r[t],n.element.detach(),this._changeCollection(t)},t.prototype._changeCollection=function(e,t){var n=this._getField("nodes"),r=this.options.nodes;t?(n.splice(e,0,t),r.splice(e,0,t.options)):(n.splice(e,1),r.splice(e,1))},t.prototype.getNodes=function(){return this.nodes},t.prototype.findNodeByText=function(e){var t=n(".wijmo-wijtree-node a>span",this.$nodes).filter(function(){return n(this).text()===e});return t.length?this._getNodeWidgetByDom(t.get(0)):null},t.prototype._setAllowDrag=function(e){var t=this,r,i=t._nodeSelector(),s="wijmoWijtreenode";if(!n.fn.draggable)return;e?(r=t.element.find(i),r.each(function(){var e=n(this).data(s);(!n(this).data("uiDraggable")&&!e.$navigateUrl.data("events")||!e.$navigateUrl.data("events").mousedown)&&e.$navigateUrl.one("mousedown",e,e._onMouseDown)})):(r=t.element.find(i+":ui-draggable"),r.draggable("destroy"))},t.prototype._setAllowDrop=function(e){if(!n.fn.droppable)return;e?this.widgetDom.data("uiDroppable")||this._attachDroppable():this.widgetDom.droppable&&this.widgetDom.droppable("destroy")},t.prototype._setCheckBoxes=function(e){var t=this;t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setCheckBoxes(e)})},t.prototype._setHitArea=function(e){var t=this;t.$nodes[e?"addClass":"removeClass"]("wijmo-wijtree-allexpanded"),t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setHitArea(e)})},t.prototype._getNodeWidget=function(e){if(e.is(this._nodeSelector())){var t=e.data(e.data("widgetName"));return t}return null},t.prototype._getNodeWidgetByDom=function(e){var t=this._getNodeByDom(e);return this._getNodeWidget(t)},t.prototype._getNodeByDom=function(e){return n(e).closest(this._nodeSelector())},t.prototype._refreshNodesClass=function(){var e=this._getField("nodes"),t;for(t=0;t<e.length;t++)e[t]._initNodeClass()},t.prototype._getField=function(e){return this.element.data(e)},t.prototype._setField=function(e,t){return this.element.data(e,t)},t}(e.wijmoWidget);t.wijtree=o;var u=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._setOption=function(e,t){var r=this,i,s;switch(e){case"accessKey":r.$navigateUrl!==null&&r.$navigateUrl.attr("accesskey",t);break;case"checked":r._checkState=t?"checked":"unChecked",r._setChecked(t);break;case"collapsedIconClass":case"expandedIconClass":case"itemIconClass":r.options[e]=t,r._initNodeImg();break;case"expanded":r._setExpanded(t);break;case"selected":r._setSelected(t);break;case"text":r._setText(t);break;case"toolTip":r._setToolTip(t);break;case"navigateUrl":r._setNavigateUrlHref(t);break;case"disabled":if(r._isClosestDisabled()&&t===!0)return;i=r.element.find(":wijmo-wijtreecheck"),i.length&&i.wijtreecheck("option","disabled",t);break;default:}e==="nodes"?(r.options.nodes.length=0,n.each(t,function(e,t){r.options.nodes.push(t)}),r.options.nodes.concat(),r._hasChildren=r._getChildren(),r._createChildNodes(r.element),r._initNodeClass()):n.Widget.prototype._setOption.apply(r,arguments)},r.prototype._initState=function(){this._tree=null,this._dropTarget=null,this._checkState="unChecked",this._value=this._text=this._navigateUrl="",this._insertPosition="unKnown",this._hasNodes=!1},r.prototype._create=function(){var e=this,t=e.options;e._initState(),e._createTreeNode(),e._initNode(),e.element.data("widgetName","wijmoWijtreenode"),t.selected&&e._tree._selectedNodes.push(e),t.checked&&(e._checkState="checked",e.$checkBox&&(t.checkState==="indeterminate"?e.$checkBox.wijtreecheck("option","checkState","triState"):e.$checkBox.wijtreecheck("option","checkState","check")))},r.prototype._createTreeNode=function(){var e=this.element,t,r,i=this,s,o=i.options,u=[];this.$navigateUrl=e.children("a"),i._tree===null&&(i._tree=i._getTree()),isNaN(o.nIndex)?o.nodes||(o.nodes=[]):(s=i._getOwner().options,r=s.nodes[o.nIndex],r&&!r.nodes&&(r.nodes=[]),n.extend(o,r),s.nodes[o.nIndex]=o),i.$nodeBody=null,i.$checkBox=null,i.$hitArea=null,i.$nodes=null,i._tree&&i._tree.htmlGenerated?(i.$nodeBody=e.children(".wijmo-wijtree-node").attr({role:"treeitem","aria-expanded":!1,"aria-checked":!1,"aria-selected":!1}),i.$inner=i.$nodeBody.children(".wijmo-wijtree-inner"),i.$inner.addClass(o.wijCSS.helperClearFix+" wijmo-wijtree-inner "+o.wijCSS.cornerAll),i.$nodeImage=i.$inner.children(".wijmo-wijtree-nodeimage"),i._tree.options.showCheckBoxes===!0&&(i.$checkBox=n("<div>"),i.$checkBox.insertAfter(i.$nodeImage),i.$checkBox.wijtreecheck()),i.$navigateUrl=i.$inner.children("a"),i.$text=i.$navigateUrl.children("span:eq(0)"),i._hasChildren=i._getChildren(),i._createChildNodes(e)):(i.$nodeImage=n("<span>"),i.$nodeBody=n("<div>").attr({role:"treeitem","aria-expanded":!1,"aria-checked":!1,"aria-selected":!1}),i._tree.options.showCheckBoxes===!0&&(i.$checkBox=n("<div>")),i.$navigateUrl.length===0&&(i.$navigateUrl=e.children("div"),i.$navigateUrl.addClass("wijmo-wijtree-template"),i._isTemplate=!0),i.$navigateUrl.length===0&&(i.$navigateUrl=n("<a href='#'></a>")),i._isTemplate||(i.$text=i.$navigateUrl.children("span:eq(0)"),i.$text.length===0&&(i.$navigateUrl.wrapInner("<span></span>"),i.$text=i.$navigateUrl.children("span:eq(0)"))),i._hasChildren=i._getChildren(),i.$inner=n("<span></span>").addClass(o.wijCSS.helperClearFix+" wijmo-wijtree-inner "+o.wijCSS.cornerAll),i._createChildNodes(e),i.$inner.append(i.$nodeImage),i.$checkBox!==null&&(i.$inner.append(i.$checkBox),i.$checkBox.wijtreecheck()),i.$inner.append(i.$navigateUrl),i.$nodeBody.append(i.$inner),e.prepend(i.$nodeBody))},r.prototype._createChildNodes=function(e){var t=this,r=[],i=t.options;t._hasChildren?(e.addClass("wijmo-wijtree-parent"),t.$nodeBody.addClass("wijmo-wijtree-node wijmo-wijtree-header "+i.wijCSS.stateDefault),t._tree&&t._tree.htmlGenerated?t.$hitArea=t.$inner.children(".wijmo-wijtree-hitarea"):(t.$hitArea=n("<span>"),t.$inner.prepend(t.$hitArea)),t.$nodes=e.children("ul:eq(0)"),r=t._createChildNode(),t.$nodes.addClass("wijmo-wijtree-list wijmo-wijtree-child "+i.wijCSS.helperReset)):(e.addClass("wijmo-wijtree-item"),t.$nodeBody.addClass("wijmo-wijtree-node "+i.wijCSS.stateDefault)),e.css("list-style-type","none"),t._setField("nodes",r)},r.prototype._createChildNode=function(){var e=this,t=e.options,r=[],s,o={nIndex:undefined,treeClass:t.treeClass,cfli:undefined,nodes:undefined};if(t.nodes&&t.nodes.length)if(e._tree&&e._tree.htmlGenerated){var s=e.$nodes.children("li");n.each(s,function(t,i){var s=n(i),u;s.data("owner",e),o.nIndex=t,s.wijtreenode(o),u=e._getNodeWidget(s),u._index=t,r.push(u)})}else e.$nodes&&e.$nodes.length?e.$nodes.empty():e.$nodes=n("<ul>").appendTo(e.element),n.each(t.nodes,function(t,s){var u=n(i(s)),a;e.$nodes.append(u),u.data("owner",e),o.nIndex=t,u.wijtreenode(o),a=e._getNodeWidget(u),a._index=t,r.push(a)});else t.nodes||(t.nodes=[]),e.$nodes.children("li").each(function(t,i){var s=n(i),u;s.data("owner",e),o.cfli=!0,o.nIndex=t,o.nodes=[],s.wijtreenode(o),u=e._getNodeWidget(s),u._index=t,r.push(u)});return r},r.prototype._initNode=function(){var e=this,t=e.options;e._initialized||(e._initialized=!0,e._initNavigateUrl(),!e._isTemplate&&e.$text&&(e._text=e.$text.html(),t.text=e.$text.html()),e._hasChildren=e._getChildren(),e._initNodesUL(),e._initNodeClass(),e._initNodeImg(),e._initCheckBox(),e.$navigateUrl.one("mousedown",e,e._onMouseDown))},r.prototype._initNodeClass=function(){var e=this,t=e.options,r,i="wijmo-wijtree-item",s=t.wijCSS.icon+" "+(t.expanded?t.wijCSS.iconArrowRightDown:t.wijCSS.iconArrowRight);e._tree.options.showExpandCollapse&&(e._hasChildren||!!t.hasChildren?(e.$nodeBody.removeClass("wijmo-state-expanded").removeClass("wijmo-state-collapsed"),t.expanded?e.$nodeBody.addClass("wijmo-state-expanded"):e.$nodeBody.addClass("wijmo-state-collapsed"),e.$hitArea!==null?e.$hitArea.removeClass([t.wijCSS.icon,t.wijCSS.iconArrowRightDown,t.wijCSS.iconArrowRight].join(" ")).addClass(s):(e.$hitArea=n("<span>").addClass(s).prependTo(e.$inner),e.element.removeClass(i).addClass("wijmo-wijtree-parent")),e._hasChildren&&(r=t.expanded?"":"none",e.$nodes.css({display:r}))):e.$hitArea&&(e.$hitArea.remove(),e.$hitArea=null,e.element.removeClass("wijmo-wijtree-parent").addClass(i))),!e._hasChildren&&e.$nodes&&e.$nodes.css({display:"none"}),t.selected&&e.$inner&&e.$inner.addClass(t.wijCSS.stateActive)},r.prototype._initCheckBox=function(){var e=this,t=e.options;if(e.$checkBox&&t.checkState)switch(t.checkState){case"checked":e.$checkBox.wijtreecheck("option","checkState","check");break;case"indeterminate":e.$checkBox.wijtreecheck("option","checkState","triState");break;case"unChecked":e.$checkBox.wijtreecheck("option","checkState","unCheck");break;default:e.$checkBox.wijtreecheck("option","checkState","unCheck")}},r.prototype._initNodesUL=function(){var e=this;e._tree.options.showExpandCollapse&&e._hasChildren&&e.$nodes[e._expanded?"show":"hide"]()},r.prototype._initNavigateUrl=function(){var e=this,t=e.$navigateUrl.attr("href");e.$navigateUrl.bind("blur."+e.widgetName,e,e._onBlur),this._isTemplate||(e._navigateUrl=t?t:"",e._setNavigateUrlHref(t))},r.prototype._applyIconClass=function(e,t){e.attr("expandediconclass")&&(t.expandedIconClass=e.attr("expandediconclass"),e.removeAttr("expandediconclass")),e.attr("collapsediconclass")&&(t.collapsedIconClass=e.attr("collapsediconclass"),e.removeAttr("collapsediconclass")),e.attr("itemiconclass")&&(t.itemIconClass=e.attr("itemiconclass"),e.removeAttr("itemiconclass"))},r.prototype._initNodeImg=function(){var e=this,t=e.options,r=e.element;if(e.$nodeImage===null||!e.$nodeImage.length)e.$nodeImage=n("<span>");e._applyIconClass(r,t),t.collapsedIconClass!==""&&t.expandedIconClass!==""?(e.$nodeImage.removeClass().addClass(t.wijCSS.icon).addClass(t.expanded?t.expandedIconClass:t.collapsedIconClass),e._tree.options.showExpandCollapse||e.$nodeImage.addClass(t.expandedIconClass),e.$nodeImage.insertBefore(e.$checkBox)):t.itemIconClass!==""&&(e.$nodeImage.removeClass().addClass(t.wijCSS.icon),e.$nodeImage.addClass(t.itemIconClass),e.$nodeImage.insertBefore(e.$checkBox))},r.prototype._setNavigateUrlHref=function(e){if(this.$navigateUrl){if(e===""||typeof e=="undefined")e="#";this.$navigateUrl.attr("href",e)}},r.prototype._editNode=function(){this._tree._editMode=!0,this.$navigateUrl.hide(),this.$editArea||(this.$editArea=n('<input type="text">').wijtextbox()),this.$editArea.val(this.$text.html()),this.$editArea.insertBefore(this.$navigateUrl),this.$editArea.bind("blur",this,this._editionComplete),this.$editArea.focus()},r.prototype._editionComplete=function(e){var t=e.data,n;t._tree._editMode=!1,t.$editArea&&(n=t.$editArea.val(),t.$editArea.remove()),t.$navigateUrl.show(),t.$editArea=null,t._changeText(n)},r.prototype._changeText=function(e){var t=this,n=t.options;t.$text!==null&&e!==""&&(t.$text.text(e),n.text=e,t._tree._trigger("nodeTextChanged",null,t))},r.prototype._expandCollapseItem=function(){var e=this,t=e.options;!e._tree.options.disabled&&!e._isClosestDisabled()&&(e._hasChildren||t.hasChildren)&&e._setExpanded(!t.expanded)},r.prototype._expandNode=function(e){var t=this,n=t._tree.options,r=e?"nodeExpanding":"nodeCollapsing";if(t._tree._trigger(r,null,{node:this,params:this.options.params})===!1)return;t.$nodeBody.attr("aria-expanded",e),t._expanded=e,t.options.expanded=e,!n.disabled&&!t._isClosestDisabled()&&(e?n.expandDelay>0?(typeof t._expandTimer!="undefined"&&(t._expandTimer=window.clearTimeout(t._expandTimer)),t._expandTimer=window.setTimeout(function(){t._expandNodeVisually()},n.expandDelay)):t._expandNodeVisually():n.collapseDelay>0?(t._collapseTimer=window.clearTimeout(t._collapseTimer),t._collapseTimer=window.setTimeout(function(){t._collapseNodeVisually()},n.collapseDelay)):t._collapseNodeVisually())},r.prototype._expandNodeVisually=function(){var e=this,t,r=e.options;e._tree.options.autoCollapse&&(t=e.element.siblings(":"+this.widgetFullName),n.each(t,function(n){var r=e._getNodeWidget(t[n]);r.options.expanded&&r._setExpanded(!1)})),r.collapsedIconClass!==""&&r.expandedIconClass!==""&&e.$nodeImage.removeClass(r.collapsedIconClass).addClass(r.expandedIconClass),e._internalSetNodeClass(!0),e._show()},r.prototype._collapseNodeVisually=function(){var e=this;e.options.collapsedIconClass!==""&&e.options.expandedIconClass!==""&&e.$nodeImage.removeClass(e.options.expandedIconClass).addClass(e.options.collapsedIconClass),e._internalSetNodeClass(!1),e._hide()},r.prototype._internalSetNodeClass=function(e){var t=this.options.wijCSS,n=[t.icon,t.iconArrowRightDown,t.iconArrowRight].join(" ");if(!this.$hitArea)return;this.$hitArea.removeClass(n).addClass(t.icon).addClass(e?t.iconArrowRightDown:t.iconArrowRight),this.$nodeBody.removeClass("wijmo-state-expanded").removeClass("wijmo-state-collapsed"),e?this.$nodeBody.addClass("wijmo-state-expanded"):this.$nodeBody.addClass("wijmo-state-collapsed")},r.prototype._show=function(){this._animation(!0)},r.prototype._hide=function(){this._animation(!1)},r.prototype._animation=function(e){function l(e){e.css(f)!==a&&e.css(f,a)}var t=this,r=t.$nodes,i=e?"expandAnimation":"collapseAnimation",s=e?"nodeExpanded":"nodeCollapsed",o,u=t._tree.options[i],a,f;r&&(u?(n.browser.msie&&parseInt(n.browser.version)<9?f="filter":f="opacity",a=r.css(f),o=u.animated||u.effect,n.effects&&!!o?r[e?"show":"hide"](o,{easing:u.easing},u.duration,function(){l(r),t._tree._trigger(s,null,t)}):r[e?"show":"hide"](u.duration,function(){l(r),t._tree._trigger(s,null,t)})):(r[e?"show":"hide"](),t._tree._trigger(s,null,t)))},r.prototype._getBounds=function(e){var t=e.height(),n=e.width(),r=e.offset().top,i=e.offset().left;return{h:t,w:n,t:r,l:i}},r.prototype._isMouseInsideRect=function(e,t){return e.x<t.l||e.x>=t.l+t.w?!1:e.y<=t.t+1||e.y>=t.t+t.h?!1:!0},r.prototype._getNodeByMouseOn=function(e){return n("li").each(function(){var t=this._getBounds(n(this));if(n.ui.isOver(e.y,e.x,t.t,t.l,t.h,t.w))return n(this)}),null},r.prototype._drowTemplate=function(e,t,n){var r="unKnown",i=n.is(".wijmo-wijtree-node")?n:n.children(".wijmo-wijtree-node"),s=this._getBounds(i);return t.width(i.width()),e.y>s.t&&e.y<s.t+s.h/2?(t.offset({left:s.l,top:s.t}),r="before"):e.y>s.t+s.h/2&&e.y<s.t+s.h&&(t.offset({left:s.l,top:s.t+s.h}),r="after"),r},r.prototype._beginDrag=function(e){var t=this,r=t.element,i,s=t._tree.options,o=s.draggable,u={cursor:"point",cursorAt:{top:15,left:-25},helper:function(){return n("<div>"+t.$navigateUrl.html()+"</div>").addClass(s.wijCSS.header).addClass(s.wijCSS.cornerAll)},distance:n.browser.msie?1:10,handle:t.$navigateUrl,scope:"tree",stop:undefined,start:undefined,drag:undefined},a=n("<div>").addClass("wijmo-wijtree-insertion").addClass(s.wijCSS.stateDefault);typeof s.dropVisual=="string"?(i=n(s.dropVisual),a=i.length?i:a):n.isFunction(s.dropVisual)&&(i=n(s.dropVisual.call()),a=i.length?i:a),a.hide(),n.extend(u,o),u.start=function(e,i){t._tree._isDragging=!0,t._tree.widgetDom.prepend(a),t._tree._trigger("nodeDragStarted",e,t),o&&n.isFunction(o.start)?o.start.call(t.element,e,i):r.hide()},u.drag=function(e,r){var i=e.srcElement||e.originalEvent.target,s=n(i),u,f={x:e.pageX,y:e.pageY};a&&a.hide(),s&&(u=t._getNodeWidget(s),u&&!u._tree.options.disabled?(s.closest(".wijmo-wijtree-inner",t.element).length?t._insertPosition="end":(a.show(),t._insertPosition=t._drowTemplate(f,a,u.element)),u!=t&&(t._dropTarget=u)):s.is(":"+t.options.treeClass)&&(t._dropTarget=s.data(t.options.treeClass),t._insertPosition="end")),t._tree._trigger("nodeDragging",e,t),o&&n.isFunction(o.drag)&&o.drag.call(t.element,e,r)},u.stop=function(e,i){a.remove(),t._dropTarget=null,t._insertPosition="unKnown",t._tree._isDragging=!1,o&&n.isFunction(o.stop)?o.stop.call(t.element,e,i):(r.show(),t._resetDrag())},n.fn.draggable&&(r.draggable(u).trigger(e),n.browser.mozilla&&t._setFocused(!0))},r.prototype._resetDrag=function(){var e=this,t,n;!e._tree.options.allowDrag&&e.element.data("uiDraggable")&&e.element.draggable("destroy"),t=e._getField("nodes");for(n=0;n<t.length;n++)t[n]._resetDrag()},r.prototype._checkClick=function(){var e=this,t=e.options;!e._tree.options.disabled&&!e._isClosestDisabled()&&(t.checked&&e._checkState==="indeterminate"?(e._checkState="checked",e._checkItem()):(e._checkState=t.checked?"unChecked":"checked",e._setChecked(!t.checked)),e._tree._trigger("nodeCheckChanged",null,e))},r.prototype._checkItem=function(){var e=this,t=!1,n=e._tree;if(n===null||!n.options.showCheckBoxes)return;n.options.autoCheckNodes&&e._checkState!=="indeterminate"&&(t=!0,e._changeCheckState(e.options.checked)),n.options.allowTriState&&e._setParentCheckState(),e[e.options.checked?"_checkNode":"_unCheckNode"](t)},r.prototype._checkNode=function(e){var t=this,n=t.options,r=this._getField("nodes"),i;t._checkState==="checked"?(t.$checkBox.wijtreecheck("option","checkState","check"),n.checkState="checked"):t._checkState==="indeterminate"&&(t.$checkBox.wijtreecheck("option","checkState","triState"),n.checkState="indeterminate");if(e)for(i=0;i<r.length;i++)r[i]._checkNode(!0)},r.prototype._unCheckNode=function(e){var t=this._getField("nodes"),n=this.options,r;this.$checkBox.wijtreecheck("option","checkState","unCheck"),n.checkState="unChecked";if(e)for(r=0;r<t.length;r++)t[r]._unCheckNode(!0)},r.prototype._changeCheckState=function(e){var t=this._getField("nodes");n.each(t,function(t,n){n.options.checked=e,n.$nodeBody.attr("aria-checked",e),n._checkState=e?"checked":"unChecked",n._changeCheckState(e)})},r.prototype._setParentCheckState=function(){var e=this._getOwner(),t,n=!0,r=!1,i=!1,s,o=this;if(e.element.is(":"+o.options.treeClass))return;t=e._getField("nodes");for(s=0;s<t.length;s++){t[s]._checkState==="indeterminate"&&(i=!0),t[s].options.checked?r=!0:n=!1;if(!n&&r)break}i?(e._checkState="indeterminate",e._setChecked(!0)):r?(n?(e._checkState="checked",e._checkNode(!1)):e._checkState="indeterminate",e._setChecked(!0)):(e._checkState="unChecked",e._setChecked(!1),e._unCheckNode(!1)),e._setParentCheckState()},r.prototype._onKeyDown=function(e){var t=n(e.target),r=this;t.closest(".wijmo-wijtree-inner",r.element).length>0&&r._keyAction(e)},r.prototype._onClick=function(e){var t=n(e.target),r=this;t.closest(".wijmo-checkbox",r.element).length>0?(r._checkClick(),e.preventDefault(),e.stopPropagation()):r.$hitArea&&r.$hitArea[0]===t[0]?(r._expandCollapseItem(),e.preventDefault(),e.stopPropagation()):t.closest(".wijmo-wijtree-inner",r.element).length>0&&r._click(e)},r.prototype._onMouseDown=function(e){var t=n(e.target),r=e.data;!r._tree.options.disabled&&r._tree.options.allowDrag&&t.closest(".wijmo-wijtree-node",r.element).length>0&&r._beginDrag(e)},r.prototype._onMouseOver=function(e){var t=n(e.target),r=this,i=n(e.relatedTarget);t.closest(".wijmo-wijtree-inner",r.element).length>0&&(this._tree._overNode!==r||i.is(":"+this.widgetFullName))&&(r._mouseOver(e),this._tree._overNode=r),r._mouseOverHitArea(e)},r.prototype._onMouseOut=function(e){var t=n(e.target),r=this,i=n(e.relatedTarget),s=this._getNodeWidget(i);t.closest(".wijmo-wijtree-inner",r.element).length>0&&(this._tree._overNode!==s||i.is(":"+this.widgetFullName)||i.is(".wijmo-wijtree-list")||i.is(".ui-effects-wrapper"))&&(r._mouseOut(e),s||(this._tree._overNode=null)),r._mouseOutHitArea(e)},r.prototype._onFocus=function(e){var t=n(e.target),r=this,i=r.options.wijCSS;t.closest(".wijmo-wijtree-inner",r.element).length>0&&!r._tree.options.disabled&&!r._isClosestDisabled()&&!t.hasAllClasses(i.iconArrowRightDown)&&!t.hasAllClasses(i.iconArrowRight)&&!t.closest(".wijmo-checkbox",r.element).length&&(r._tree._focusNode&&r._tree._focusNode.$navigateUrl.blur(),r._focused=!0,r._tree._focusNode=this,r.$inner.addClass(i.stateFocus),r._tree._trigger("nodeFocus",e,r))},r.prototype._onBlur=function(e){var t=n(e.target),r=e.data,i=r.options.wijCSS;!r._tree.options.disabled&&!r._isClosestDisabled()&&(r._focused=!1,t.closest(".wijmo-wijtree-inner",r.element).length>0&&r.$inner.removeClass(i.stateFocus),r._tree._trigger("nodeBlur",e,r))},r.prototype._click=function(e){var t=this,r=t.options,i=t._tree,s=t.$navigateUrl.attr("href");if(!i.options.disabled&&!t._isClosestDisabled()){if(!/^[#,\s]*$/.test(s)){if(!n.browser.msie||!/^7\.[\d]*/.test(n.browser.version))return;if(s.indexOf(window.location.href)<0)return}t._isClick=!0,i._ctrlKey=e.ctrlKey,r.selected&&i._ctrlKey?t._setSelected(!1):r.selected&&!t._tree._editMode&&i.options.allowEdit&&!t._isTemplate?t._editNode():t._setSelected(!r.selected),t._isTemplate||(e.preventDefault(),e.stopPropagation())}else t._setNavigateUrlHref("")},r.prototype._selectNode=function(e,t){var r=this,i=r.options,s,o;!r._tree.options.disabled&&!r._isClosestDisabled()&&!r._tree._isDragging&&(s=r._tree._ctrlKey,s?(o=n.inArray(r,r._tree._selectedNodes),o!==-1&&!e&&(r._tree._selectedNodes.splice(o,1),r.$inner.removeClass(i.wijCSS.stateActive))):(n.each(r._tree._selectedNodes,function(e,t){t.$inner.removeClass(i.wijCSS.stateActive),t.options.selected=!1,t.$nodeBody.attr("aria-selected",!1)}),r._tree._selectedNodes=[]),e?(o=n.inArray(r,r._tree._selectedNodes),o===-1&&this._tree._selectedNodes.push(r),r.$inner.addClass(i.wijCSS.stateActive)):r.$inner.removeClass(i.wijCSS.stateActive),r._isClick&&r._tree._trigger("nodeClick",t,r),r._isClick=!1,r._tree._ctrlKey=!1,r._tree._trigger("selectedNodeChanged",t,r))},r.prototype._keyAction=function(t){var n=t.target,r=this,i=!1,s=e.getKeyCodeEnum();if(r._tree.options.disabled||r._isClosestDisabled())return;if(n){if(r._tree._editMode&&t.keyCode!==s.ENTER)return;switch(t.keyCode){case s.UP:r._moveUp();break;case s.DOWN:r._moveDown();break;case s.RIGHT:r._tree.options.showExpandCollapse&&r._moveRight();break;case s.LEFT:r._tree.options.showExpandCollapse&&r._moveLeft();break;case 83:!r._tree._editMode&&r._tree.options.allowSorting&&r.sortNodes();break;case 113:r._tree.options.allowEdit&&r._editNode();break;case 109:r._tree.options.showExpandCollapse&&this._expanded&&r._setExpanded(!1);break;case 107:r._tree.options.showExpandCollapse&&!this._expanded&&r._setExpanded(!0);break;case s.ENTER:r._tree._editMode&&(t.data=r,r._editionComplete(t),r._setFocused(!0),i=!0,t.preventDefault());break;case s.SPACE:r._tree.options.showCheckBoxes&&(r._checkState=r.options.checked?"unChecked":"checked",r._setChecked(!r.options.checked))}r._customKeyDown(t.keyCode,i),!r._isTemplate&&t.keyCode!==s.ENTER&&(t.preventDefault(),t.stopPropagation())}},r.prototype._customKeyDown=function(e,t){},r.prototype._prevNode=function(e){var t=e.element;if(t.prev().length>0)return t.prev().data(t.data("widgetName"))},r.prototype._nextNode=function(e){var t=e.element;if(t.next().length>0)return t.next().data(t.data("widgetName"))},r.prototype._getNextExpandedNode=function(e){var t=e,n=e._getField("nodes"),r;return e._expanded&&n.length>0&&(r=n[n.length-1],r!==null&&(t=this._getNextExpandedNode(r))),t},r.prototype._getNextNode=function(e){var t=null,n=this;return e.element.is(":"+n.options.treeClass)?null:(t=n._nextNode(e),t?t:n._getNextNode(e._getOwner()))},r.prototype._moveUp=function(){var e=this._getCurrentLevel(),t=this._prevNode(this);t?this._getNextExpandedNode(t)._setFocused(!0):e>0&&this._getOwner()._setFocused(!0)},r.prototype._moveDown=function(){var e=this._getField("nodes"),t,n,r;this._expanded&&e.length>0?e[0]._setFocused(!0):(t=this._nextNode(this),t?t._setFocused(!0):(n=this._getOwner(),r=this._getNextNode(n),r&&r._setFocused(!0)))},r.prototype._moveLeft=function(){var e=this._getOwner();this._expanded?this._setExpanded(!1):e!==null&&!e.element.is(":"+this.options.treeClass)&&e._setFocused(!0)},r.prototype._moveRight=function(){if(this._hasChildren)if(!this._expanded)this._setExpanded(!0);else{var e=this._getField("nodes")[0];e!==null&&e._setFocused(!0)}},r.prototype._mouseOver=function(e){var t=this,n=t._tree;!n.options.disabled&&!t._isClosestDisabled()&&!n._editMode&&(t._mouseOverNode(),n._isDragging||n._trigger("nodeMouseOver",e,t))},r.prototype._mouseOut=function(e){var t=this,n=t._tree;!n.options.disabled&&!t._isClosestDisabled()&&!n._editMode&&(t._mouseOutNode(),n._isDragging||n._trigger("nodeMouseOut",e,t))},r.prototype._mouseOverNode=function(){this.$inner!==null&&!this._isOverNode&&(this.$inner.addClass(this.options.wijCSS.stateHover),this._isOverNode=!0)},r.prototype._mouseOutNode=function(){this.$inner!==null&&this._isOverNode&&(this.$inner.removeClass(this.options.wijCSS.stateHover),this._isOverNode=!1)},r.prototype._mouseOverHitArea=function(e){var t,n,r=this,i=r._tree;!i.options.disabled&&!r._isClosestDisabled()&&i.options.expandCollapseHoverUsed&&r._hasChildren&&!r._isOverHitArea&&(t=r._getBounds(r.element),n={x:e.pageX,y:e.pageY},r._isMouseInsideRect(n,t)&&(r._isOverHitArea=!0,r._setExpanded(!0)))},r.prototype._mouseOutHitArea=function(e){var t={x:e.pageX,y:e.pageY},n,r=this,i=r._tree;!i.options.disabled&&!r._isClosestDisabled()&&i.options.expandCollapseHoverUsed&&(r._hasChildren&&!!r._isOverHitArea?(n=r._getBounds(r.element),r._isMouseInsideRect(t,n)||(r._isOverHitArea=!1,r._setExpanded(!1))):r._getOwner().element.is(":"+r.widgetFullName)&&(n=r._getBounds(r._getOwner().element),r._isMouseInsideRect(t,n)||(r._getOwner()._isOverHitArea=!1,r._getOwner()._setExpanded(!1))))},r.prototype.destroy=function(){var e=this,t,r=e.options;e.element.data("uiDraggable")&&e.element.draggable("destroy"),e.$hitArea&&e.$hitArea.remove(),e.$checkBox&&e.$checkBox.remove(),e.$nodeImage&&e.$nodeImage.remove(),e.$navigateUrl.unwrap().unwrap().removeClass(r.wijCSS.stateDefault).removeClass(r.wijCSS.stateActive).unbind("mousedown").unbind("blur"),t=this.element.find("ul:first").show(),t.removeClass(),t.children("li").each(function(){var t=e._getNodeWidget(n(this));t.destroy()}),e.element.removeData("nodes").removeData("owner").removeData("widgetName").removeClass(),n.Widget.prototype.destroy.apply(this)},r.prototype.add=function(e,t){var r=null,i,s,o=this,u,a,f="<li><a href='{0}'>{1}</a></li>",l;typeof e=="string"?(i=n(f.replace(/\{0\}/,"#").replace(/\{1\}/,e)),o._createNodeWidget(i),r=i.data(i.data("widgetName"))):e.jquery?(e.data("widgetName")||o._createNodeWidget(e),r=e.data(e.data("widgetName"))):e.nodeType?(i=n(e),o._createNodeWidget(i),r=i.data(i.data("widgetName"))):n.isPlainObject(e)&&(i=n(f.replace(/\{0\}/,e.url?e.url:"#").replace(/\{1\}/,e.text)),o._createNodeWidget(i,e),r=i.data(i.data("widgetName")));if(r===null)return;s=o._getField("nodes"),(!t||t>s.length)&&t!==0&&(t=s.length),n.mobile&&r.element.find("a").addClass("ui-link"),u=r._getField("nodes"),r._tree=o._tree;for(a=0;a<u.length;a++)u[a]._tree=o._tree;r._setField("owner",o),l=s.length,o.$nodes||(o.$nodes=n("<ul></ul>").addClass("wijmo-wijtree-list").addClass(o.options.wijCSS.helperReset).addClass("wijmo-wijtree-child"),o.element.append(o.$nodes)),l>0&&l!==t?r.element.get(0)!==s[t].element.get(0)&&r.element.insertBefore(s[t].element):o.$nodes.append(r.element),o._changeCollection(t,r),o._collectionChanged(),r._initNodeClass()},r.prototype.remove=function(e){var t=-1,n,r=this,i=this._getField("nodes");e.jquery?t=e.index():typeof e=="number"&&(t=e);if(t<0||t>=i.length)return;n=i[t],n.element.detach(),r._changeCollection(t),r._collectionChanged()},r.prototype.getNodes=function(){return this._getField("nodes")},r.prototype._changeCollection=function(e,t){var n=this._getField("nodes"),r=this.options.nodes;t?(n.splice(e,0,t),r.splice(e,0,t.options)):(n.splice(e,1),r.splice(e,1))},r.prototype.sortNodes=function(){var e=this._getField("nodes");this._sort(),n.each(e,function(e,t){t._index=e,t._insertBefore(e)}),this._refreshNodesClass()},r.prototype.check=function(e){this._setOption("checked",e)},r.prototype.select=function(e){this._setOption("selected",e)},r.prototype.getOwner=function(){var e=this._getOwner();return e&&e.element.is("li")?e:null},r.prototype.expand=function(){this._setOption("expanded",!0)},r.prototype.collapse=function(){this._setOption("expanded",!1)},r.prototype._insertBefore=function(e){var t=this.element.parent().children("li");this.element.index()!==e&&this.element.insertBefore(t.eq(e))},r.prototype._sort=function(){var e=this._getField("nodes");this._isSorted?this._isDecsSort?(e.sort(this._compare2NodeTextDesc),this._isDecsSort=!1):(e.sort(this._compare2NodeTextAcs),this._isDecsSort=!0):(e.sort(this._compare2NodeTextAcs),this._isSorted=!0,this._isDecsSort=!0)},r.prototype._compare2NodeTextAcs=function(e,t){if(e!==null&&t!==null)return e._text.localeCompare(t._text)},r.prototype._compare2NodeTextDesc=function(e,t){if(e!==null&&t!==null)return-1*e._text.localeCompare(t._text)},r.prototype._collectionChanged=function(){this._hasChildren=this._getChildren(),this._initNodeClass()},r.prototype._refreshNodesClass=function(){var e=this._getField("nodes"),t;for(t=0;t<e.length;t++)e[t]._initNodeClass()},r.prototype._setChecked=function(e){var t=this;if(t.options.checked===e&&t._checkState!=="indeterminate")return;t.options.checked=e,t.$nodeBody.attr("aria-checked",e),this._checkItem()},r.prototype._isClosestDisabled=function(){var e=this;return e.element.closest(".wijmo-wijtree-disabled,.wijmo-wijtreenode-disabled",e._tree.element).length?!0:!1},r.prototype._setExpanded=function(e){var t=this,n=t.options;if(t._expanded===e)return;(t._hasChildren||n.hasChildren)&&t._expandNode(e)},r.prototype._setFocused=function(e){e?(this.$navigateUrl.focus(),this._setFocusNode()):this.$navigateUrl.blur()},r.prototype._setFocusNode=function(){this._tree._focusNode&&n.browser.webkit&&this._tree._focusNode.$navigateUrl.blur(),this._focused=!0,this._tree._focusNode=this,this.$inner.addClass(this.options.wijCSS.stateFocus),this._tree._trigger("nodeFocus",null,this)},r.prototype._setToolTip=function(e){e.length?this.element.attr("title",e):this.element.removeAttr("title")},r.prototype._setText=function(e){this._text!==e&&e.length&&(this._text=e,this._changeText(e))},r.prototype._setSelected=function(e){var t=this,n=t.options;n.selected!==e&&(n.selected=e,t.$nodeBody.attr("aria-selected",e),t._selectNode(e),t._setFocused(e))},r.prototype._setCheckBoxes=function(e){var t=this;t.$checkBox?t.$checkBox[e?"show":"hide"]():e&&(t.$checkBox=n("<div>"),t.$checkBox.insertBefore(t.$navigateUrl),t.$checkBox.wijtreecheck()),t.$nodes&&t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setCheckBoxes(e)})},r.prototype._setHitArea=function(e){var t=this;t._hasChildren&&(e?(t._initNodeClass(),t.$hitArea&&t.$hitArea.show()):(t._expanded=!0,t.options.expanded=!0,t.$nodeBody.attr("aria-expanded",!0),t.$nodes&&t.$nodes.show(),t._initNodeClass(),t.$hitArea&&t.$hitArea.hide())),t.$nodes&&t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setHitArea(e)})},r.prototype._getOwner=function(){return this._getField("owner")},r.prototype._getTree=function(){var e=this._getOwner();return e?e.element.is(":"+this.options.treeClass)?e:e._tree:null},r.prototype._getInitElement=function(){var e=n("<li>"),t=this,r=n("<ul>"),i=t._getField("nodes");return e.append(t.$navigateUrl.clone()),i.length&&(e.append(r),n.each(i,function(e,t){var n=t._getInitElement();r.append(n)})),e},r.prototype._getChildren=function(){return!!this.options.nodes&&!!this.options.nodes.length||this.element.children("ul:first").children("li").length>0},r.prototype._getNodeWidget=function(e){var t=this._getNodeByDom(e),n;return t.length>0?(n=t.data(t.data("widgetName")),n):null},r.prototype._createNodeWidget=function(e,t){return n.fn.wijtreenode&&(e.data("owner",this),!!t&&n.isPlainObject(t)?(n.extend(t,{treeClass:this.options.treeClass}),e.wijtreenode(t)):e.wijtreenode({treeClass:this.options.treeClass})),e},r.prototype._getNodeByDom=function(e){return n(e).closest(":"+this.widgetFullName)},r.prototype._getCurrentLevel=function(){return this.element.parentsUntil(":"+this.options.treeClass).length-1},r.prototype._getField=function(e){return this.element.data(e)},r.prototype._setField=function(e,t){return this.element.data(e,t)},r}(e.wijmoWidget);t.wijtreenode=u;var a="",f="",l=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._initCSS=function(e){var t=e.wijCSS;a=t.icon+" "+t.iconCheck,f=t.icon+" "+t.iconStop},t.prototype._create=function(){var e=this,t=this.options,r=t.wijCSS;e._initCSS(t),e.element.is("div")&&(e.element.addClass("wijmo-checkbox").addClass(r.widget).attr("role","checkbox"),e.$icon=n("<span>"),e.$icon.addClass("wijmo-checkbox-icon"),t.checkState==="check"?e.$icon.addClass(a):t.checkState==="triState"&&e.$icon.addClass(f),e.$body=n("<div></div>").addClass(["wijmo-checkbox-box",r.widget,r.cornerAll,r.stateDefault].join(" ")).css({position:"relative"}).append(e.$icon),e.element.append(e.$body),e.element.bind("mouseover.wijtreecheck",function(){e.options.disabled||e.$body.addClass(r.stateHover)}).bind("mouseout.wijtreecheck",function(){e.options.disabled||e.$body.removeClass(r.stateHover).not(r.stateFocus).addClass(r.stateDefault)}))},t.prototype._setOption=function(e,t){var r=this,i=r.options.wijCSS;e==="checkState"&&(t==="unCheck"?(r.$body.removeClass(i.stateActive),r.$icon.removeClass(a).removeClass(f).removeClass(i.stateActive)):t==="check"?(r.$body.addClass(i.stateActive),r.$icon.removeClass(f).addClass(a)):t==="triState"&&(r.$body.addClass(i.stateActive),r.$icon.removeClass(a).addClass(f))),n.Widget.prototype._setOption.apply(r,arguments)},t.prototype.destory=function(){this.element.children().remove(),this.element.removeClass("wijmo-checkbox").removeClass(this.options.wijCSS.widget),n.Widget.prototype.destroy.apply(this)},t}(e.wijmoWidget);t.wijtreecheck=l,l.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-b",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-b"},checkState:"unCheck"});var c=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-b"},this.treeClass="wijmo-wijtree",this.initSelector=":jqmData(role='wijtreenode')",this.accessKey="",this.checked=!1,this.collapsedIconClass="",this.expanded=!1,this.expandedIconClass="",this.itemIconClass="",this.navigateUrl="",this.selected=!1,this.text="",this.toolTip="",this.hasChildren=!1,this.params={},this.nodes=null}return e}(),h=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateDefault:"ui-btn ui-btn-b",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-c"},this.allowDrag=!1,this.allowDrop=!1,this.allowEdit=!1,this.allowSorting=!0,this.allowTriState=!0,this.autoCheckNodes=!0,this.autoCollapse=!1,this.disabled=!1,this.expandCollapseHoverUsed=!1,this.showCheckBoxes=!1,this.showExpandCollapse=!0,this.expandAnimation={effect:"blind",easing:"linear",duration:200},this.expandDelay=0,this.collapseAnimation={effect:"blind",easing:"linear",duration:200},this.collapseDelay=0,this.draggable=null,this.droppable=null,this.dropVisual=null,this.nodes=null,this.nodeBlur=null,this.nodeFocus=null,this.nodeClick=null,this.nodeCheckChanged=null,this.nodeCollapsed=null,this.nodeExpanded=null,this.nodeDragging=null,this.nodeDragStarted=null,this.nodeBeforeDropped=null,this.nodeDropped=null,this.nodeMouseOver=null,this.nodeMouseOut=null,this.nodeTextChanged=null,this.selectedNodeChanged=null,this.nodeExpanding=null,this.nodeCollapsing=null}return e}();u.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new c),o.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new h),n.wijmo.registerWidget("wijtree",o.prototype),n.wijmo.registerWidget("wijtreenode",u.prototype),n.wijmo.registerWidget("wijtreecheck",l.prototype)})(e.tree||(e.tree={}));var t=e.tree})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijupload",i="wijmo-wijupload",s="wijmo-wijupload-fileRow",o="."+s,u="wijmo-wijupload-filesList",a="wijmo-wijupload-commandRow",f="wijmo-wijupload-uploadAll",l="wijmo-wijupload-cancelAll",c="wijmo-wijupload-buttonContainer",h="wijmo-wijupload-upload",p="."+h,d="wijmo-wijupload-cancel",v="."+d,m="wijmo-wijupload-file",g="wijmo-wijupload-progress",y="wijmo-wijupload-loading",b,w,E=function(e){return e.indexOf("\\")>-1&&(e=e.substring(e.lastIndexOf("\\")+1)),e},S=function(e){var t=e.files,r="";return t?(n.each(t,function(e,t){r+=E(t.name)+"; "}),r.length&&(r=r.substring(0,r.lastIndexOf(";")))):r=E(e.value),r},x=function(e){var t=e.files,r=0;return t&&t.length>0&&n.each(t,function(e,t){t.size&&(r+=t.size)}),r};b=function(e,t,r){var i,s=n("input",t),o=function(e){e&&(e.abort(),e=null)},u=function(e){e&&(e=null)},a=function(){var e=this,i=s.get(0).files,a=[],f=0,l=0,c=function(t,r){var o=new XMLHttpRequest;return o.open("POST",r,!0),o.setRequestHeader("Wijmo-RequestType","XMLHttpRequest"),o.setRequestHeader("Cache-Control","no-cache"),o.setRequestHeader("Wijmo-FileName",encodeURI(t)),o.setRequestHeader("Content-Type","application/octet-stream"),o.upload.onprogress=function(t){if(t.lengthComputable){var r;n.isFunction(e.onProgress)&&(r={supportProgress:!0,loaded:l+t.loaded,total:x(s[0]),fileName:E(e.currentFile.name),fileNameList:S(s[0]).split("; ")},e.onProgress(r))}},o.onreadystatechange=function(t){if(this.readyState===4){var r=this.responseText,s;l+=i[f].size,f++,i.length>f?h(i[f]):n.isFunction(e.onComplete)&&(s={e:t,response:r,supportProgress:!0},e.onComplete(s))}},a.push(o),o},h=function(t){var n=E(t.name),i=c(n,r);e.handleRequest(i,t),e.currentFile=t,i.send(t)};e.fileRow=t,e.inputFile=s,e.upload=function(){h(i[f])},e.cancel=function(){n.each(a,function(e,t){o(t)}),n.isFunction(e.onCancel)&&e.onCancel()},e.destroy=function(){n.each(a,function(e,t){u(t)})},e.updateAction=function(e){r=e},e.handleRequest=null,e.onCancel=null,e.onComplete=null,e.onProgress=null};return i=new a,i},w=function(e,t,r){var i,s=n("input",t),o=s.attr("id"),u="wijUploadForm_"+e,a=n("#"+u),f="wijUploadIfm_"+o,l=!0,c=n('<iframe id="'+f+'" name="'+f+'">'),h=function(e,t){a.empty(),a.attr("target",e.attr("name")),t&&(t.parent().append(t.clone()),a.append(t)),a.submit()},p=function(e){e.attr("src","javascript".concat(":false;"))},d=function(e,t){t&&a&&(a.remove(),a=null),e&&(e.remove(),e=null)},v;return a.length===0&&(a=n('<form method="post" enctype="multipart/form-data"></form>'),a.attr("action",r).attr("id",u).attr("name",u).appendTo("body")),c.css("position","absolute").css("top","-1000px").css("left","-1000px"),c.appendTo("body"),v=function(){var e=this;e.fileRow=t,e.iframe=c,e.inputFile=s,e.upload=function(){var t;h(c,s),n.isFunction(e.onProgress)&&(t={supportProgress:!1,loaded:1,total:1},e.onProgress(t))},e.doPost=function(){h(c)},e.cancel=function(){p(c),n.isFunction(e.onCancel)&&e.onCancel()},e.updateAction=function(e){r=e,a.attr("action",e)},e.destroy=function(e){d(c,e)},e.onCancel=null,e.onComplete=null,e.onProgress=null,c.bind("load",function(t){if(!n.browser.safari&&l&&!e.autoSubmit){l=!1;return}if(c.attr("src")==="javascript".concat(":false;"))return;var r=t.target,i,s,o;try{s=r.contentDocument?r.contentDocument:window.frames[0].document,s.XMLDocument?i=s.XMLDocument:s.body?i=s.body.innerHTML:i=s,n.isFunction(e.onComplete)&&(o={e:t,response:i,supportProgress:!1},e.onComplete(o))}catch(u){i=""}finally{}})},i=new v,i};var T=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._swfAppendAddtionalData=function(e){e.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:""},e.widget=this},t.prototype._swfGetHandlers=function(){var e=this,t=e.element;return{onSelect:function(t){var n=this,r={};if(e._trigger("change",null,t)===!1)return!1;e._createFileRow(t),this.queueData.queueSize+=t.size,this.queueData.files[t.id]=t},onSelectError:function(e,t){t==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT?alert("File size exceeds the limitation!"):t==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED&&alert("Too many files!")},onDialogOpen:function(){this.queueData.filesReplaced=0,this.queueData.filesCancelled=0},onDialogClose:function(t,n,r){var i=this.settings;this.queueData.filesErrored=t-n,this.queueData.filesSelected=t,this.queueData.filesQueued=n-this.queueData.filesCancelled,this.queueData.queueLength=r,e.isStartUpload=!1,e.options.autoSubmit&&(e.uploadAll=!0,e._swfUploadFile()),i.onDialogClose&&i.onDialogClose.call(this,this.queueData)},onUploadStart:function(t){this.bytesLoaded=0,this.queueData.uploadQueue.length==0&&(this.queueData.uploadSize=t.size);if(!e.isStartUpload&&e.uploadAll){if(e._trigger("totalUpload",null,null)===!1)return this.cancelUpload(),!1;e.isStartUpload=!0}if(e._trigger("upload",null,t)===!1)return this.cancelUpload(t.id),!1},onUploadProgress:function(r,i,s){var o=n("#"+r.id,t),u,a,f=Math.round(i/s*100),l=n("."+g,o),c={sender:r.name,loaded:i,total:s},h=this.queueData;l.html(f+"%"),e._trigger("progress",null,c),u=h.queueBytesUploaded+i,a=h.queueSize,e._updateSwfProgress(u,a),e._trigger("totalProgress",null,{loaded:u,total:a})},onUploadError:function(e,r,i){var s=this.settings,o=n("#"+e.id,t),u=n("."+g,o),a="Error";switch(r){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:a="HTTP Error ("+i+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:a="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:a="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:a="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+i+")."),a="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:a="Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:a="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:a="Cancelled",this.queueData.queueSize-=e.size,this.queueData.queueLength-=1;if(e.status==SWFUpload.FILE_STATUS.IN_PROGRESS||n.inArray(e.id,this.queueData.uploadQueue)>=0)this.queueData.uploadSize-=e.size;s.onCancel&&s.onCancel.call(this,e),delete this.queueData.files[e.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:a="Stopped"}u.text(a);var f=this.getStats();this.queueData.uploadsErrored=f.upload_errors},onUploadSuccess:function(r,i,s){var o=this.getStats();this.queueData.uploadsSuccessful=o.successful_uploads,this.queueData.queueBytesUploaded+=r.size,this.queueData.response=s;var u=n("#"+r.id,t),a=this;a.queueData.queueLength-=1,u.fadeOut(1500,function(){u.remove(),e.options.showUploadedFiles&&e._createUploadedFiles(r.name),a.queueData.queueLength||e.commandRow.hide()}),e._trigger("complete",null,{response:s})},onUploadComplete:function(t,n,r){var i=this;!i.queueData.queueLength&&e.uploadAll&&(e._cleanSwfProgress(),e._trigger("totalComplete",null,i.queueData)),e.uploadAll&&e._swfUploadFile()}}},t.prototype._cleanSwfProgress=function(){},t.prototype._updateSwfProgress=function(e,t){},t.prototype._initSwfUploadOptions=function(e,t){var r=this,i=r.element,s,o=r._swfGetHandlers(),u=r.options,a=r.options.swfUploadOptions,f=i.attr("id"),l=f+"_SWFUpload";return n("<input type='file' id='"+l+"'>").appendTo(i),s=n.extend({id:l,swf:"SWFUpload.swf",auto:!1,buttonClass:"",buttonCursor:"hand",buttonImage:null,checkExisting:!1,debug:!1,fileObjName:"Filedata",fileSizeLimit:u.maximumFileSize?u.maximumFileSize:0,fileTypeDesc:"All Files",fileTypeExts:u.accept?u.accept:"*.*",height:t,itemTemplate:!1,method:"post",multi:u.multiple,formData:{},preventCaching:!0,progressData:"percentage",queueID:!1,queueSizeLimit:u.maximumFiles?u.maximumFiles:999,removeCompleted:!0,removeTimeout:3,requeueErrors:!1,successTimeout:30,uploadLimit:0,width:e,uploader:u.action,overrideEvents:[]},a),{assume_success_timeout:s.successTimeout,button_placeholder_id:s.id,button_width:s.width,button_height:s.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:u.multiple?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_disabled:!1,button_cursor:s.buttonCursor=="arrow"?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:s.debug,requeue_on_error:s.requeueErrors,file_post_name:s.fileObjName,file_size_limit:s.fileSizeLimit,file_types:s.fileTypeExts,file_types_description:s.fileTypeDesc,file_queue_limit:s.queueSizeLimit,file_upload_limit:s.uploadLimit,flash_url:s.swf,prevent_swf_caching:s.preventCaching,post_params:s.formData,upload_url:s.uploader,use_query_string:s.method=="get",file_dialog_complete_handler:o.onDialogClose,file_dialog_start_handler:o.onDialogOpen,file_queued_handler:o.onSelect,file_queue_error_handler:o.onSelectError,swfupload_loaded_handler:s.onSWFReady,upload_complete_handler:o.onUploadComplete,upload_error_handler:o.onUploadError,upload_progress_handler:o.onUploadProgress,upload_start_handler:o.onUploadStart,upload_success_handler:o.onUploadSuccess}},t.prototype._createSWFUpload=function(){var e=this,t=e.element,r=e.addBtn,i,s=e.options.swfUploadOptions,o,u=r.width(),a=r.height(),f=swfobject.getFlashPlayerVersion(),l=f.major>=9;l?(i=e._initSwfUploadOptions(u,a),o=new SWFUpload(i),e.swfupload=o,n("#"+o.movieName).css({position:"absolute","z-index":100,top:0,left:0,width:u,height:a}),e._swfAppendAddtionalData(o)):(alert("Please install flash player."),s&&s.onFallback&&s.onFallback.call())},t.prototype._create=function(){var e=this,t=e.options,r=(new Date).getTime(),i=e.supportXhr();window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.filesLen=0,e.totalUploadFiles=0,e.useXhr=i,e.id=r,e._createContainers(),e._createUploadButton(),t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload?e._createSWFUpload():e._createFileInput(),e._bindEvents(),t.disabled&&e.disable(),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e._applyInputPosition(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijupload")},t.prototype._setOption=function(e,t){var r=this;n.Widget.prototype._setOption.apply(this,arguments),e==="disabled"?r._handleDisabledOption(t,r.upload):e==="accept"&&r.input&&r.input.attr("accept",t)},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r,i=e?e:t.upload,s=i.offset(),o=i.outerWidth(),u=i.outerHeight();return r=n("<div></div>").addClass(t.options.wijCSS.stateDisabled).css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),n.browser.msie&&(r.css("background-color","white"),parseInt(n.browser.version)>=9&&r.css("opacity","0.1")),r},t.prototype.destroy=function(){var t=this;t.upload.removeClass(i),t.upload.undelegate(t.widgetName).undelegate("."+t.widgetName),t.input.remove(),t.addBtn.remove(),t.filesList.remove(),t.commandRow.remove(),t.isCreateByInput===!0&&t.element.css({display:""}).unwrap(),t.uploaders&&(n.each(t.uploaders,function(e,t){t.destroy&&t.destroy(!0),t=null}),t.uploaders=null),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null),e.prototype.destroy.call(this)},t.prototype.widget=function(){return this.upload},t.prototype.supportXhr=function(){var e=!1;return typeof (new XMLHttpRequest).upload=="undefined"?e=!1:e=!0,e},t.prototype._createContainers=function(){var e=this,t,r,s=e.element;if(s.is(":input")&&s.attr("type")==="file")e.isCreateByInput=!0,e.maxDisplay=s.attr("multiple")||e.options.multiple?0:1,e.upload=s.css({display:"none"}).wrap("<div>").parent();else{if(!e.element.is("div"))throw'The initial markup must be "DIV", "INPUT[type=file]"';e.maxDisplay=e.options.multiple?0:1,e.upload=s}e.upload.addClass(i),t=n("<ul>").addClass(u).appendTo(e.upload),r=n("<div>").addClass(a).appendTo(e.upload),e.filesList=t,r.hide(),e.commandRow=r,e._createCommandRow(r)},t.prototype._createCommandRow=function(e){var t=this,r=t.options,i=n("<a>").attr("href","#").text("uploadAll").addClass(f).button({icons:{primary:r.wijCSS.iconCircleArrowN},label:t._getLocalization("uploadAll","Upload All")}).button("widget").addClass(r.wijCSS.stateDefault),s=n("<a>").attr("href","#").text("cancelAll").addClass(l).button({icons:{primary:r.wijCSS.iconCancel},label:t._getLocalization("cancelAll","Cancel All")}).button("widget").addClass(r.wijCSS.stateDefault);e.append(i).append(s)},t.prototype._getLocalization=function(e,t){var n=this.options.localization;return n&&n[e]||t},t.prototype._createUploadButton=function(){var e=this,t=e.options,r=n("<a>").attr("href","javascript:void(0);").button({label:e._getLocalization("uploadFiles","Upload files")}).button("widget").addClass(t.wijCSS.stateDefault);r.mousemove(function(t){var n=r.data("uiButton").options.disabled;if(e.input){var i=t.pageX,s=t.pageY;n||e.input.offset({left:i+10-e.input.width(),top:s+10-e.input.height()})}}),e.addBtn=r,e.upload.prepend(r)},t.prototype._applyInputPosition=function(){var e=this,t=e.addBtn,n=t.offset(),r=e.cuurentInput;r.offset({left:n.left+t.width()-r.width(),top:n.top}).height(t.height())},t.prototype._createFileInput=function(){var e=this,t=e.addBtn,r=t.offset(),i=e.element.attr("accept")||e.options.accept,s="wijUpload_"+e.id+"_input"+e.filesLen,o=n("<input>").attr("type","file").prependTo(e.upload),u=e.options.maximumFiles||e.maxDisplay;u!==1&&e.maxDisplay===0&&o.attr("multiple","multiple"),i&&o.attr("accept",i),e.cuurentInput=o,e.filesLen++,o.attr("id",s).attr("name",s).css("position","absolute").offset({left:r.left+t.width()-o.width(),top:r.top}).css("z-index","9999").css("opacity",0).height(t.height()).css("cursor","pointer"),e.input=o,o.bind("change",function(t){var r,i;if(e._trigger("change",t,n(this))===!1)return!1;e._createFileInput(),r=e._createFileRow(n(this)),e._setAddBtnState(),e.options.autoSubmit&&(i=n(p,r),i&&i.click()),o.unbind("change")}),e.uploadAll=!1},t.prototype._createUploadedFiles=function(e){},t.prototype._setAddBtnState=function(){var e=this,t=e.options.maximumFiles||e.maxDisplay,r=e.addBtn,i;if(!t)return;if(!r)return;e.maskDiv||(e.maskDiv=n("<div></div>").css("position","absolute").css("z-index","9999").width(r.outerWidth()).height(r.outerHeight()).appendTo(e.upload).offset(r.offset())),i=n("li",e.filesList),i.length>=t?(r.button({disabled:!0}),e.maskDiv.show(),e.input&&e.input.css("left","-1000px")):(r.button({disabled:!1}),e.maskDiv.hide())},t.prototype._createFileRow=function(e){var t=this,r=t.options,i=n("<li>"),u="",a,f,l,p=n("<span>").addClass(c),v=n("<a>").attr("href","#").text("upload").addClass(h).button({text:!1,icons:{primary:r.wijCSS.iconCircleArrowN},label:t._getLocalization("upload","upload")}).button("widget").addClass(r.wijCSS.stateDefault),y=n("<a>").attr("href","#").text("cancel").addClass(d).button({text:!1,icons:{primary:r.wijCSS.iconCancel},label:t._getLocalization("cancel","cancel")}).button("widget").addClass(r.wijCSS.stateDefault);return i.addClass(s).addClass(r.wijCSS.content).addClass(r.wijCSS.cornerAll),r.enableSWFUploadOnIE&&n.browser.msie||r.enableSWFUpload?(u=e.name,i.attr("id",e.id).data("file",e)):(i.append(e),e.hide(),u=S(e[0])),a=n("<span>"+u+"</span>").addClass(m).addClass(r.wijCSS.stateHighlight).addClass(r.wijCSS.cornerAll),i.append(a),i.append(p),f=n("<span />").addClass(g),p.append(f),p.append(v).append(y),i.appendTo(t.filesList),l=n(o,t.upload),l.length&&(t.commandRow.show(),(!r.enableSWFUploadOnIE||!n.browser.msie)&&!r.enableSWFUpload&&t._createUploader(i),t._resetProgressAll()),i},t.prototype._createUploader=function(e){var t=this,r=n("input",e),i=t.options.action,s=t.options.handleRequest,o;t.useXhr?(o=b(t.id,e,i),o.handleRequest=function(e,r){n.isFunction(s)&&s.call(t,e,r)}):o=w(t.id,e,i),o.onCancel=function(){var e=this;t._trigger("cancel",null,e.inputFile),t.totalUploadFiles===0&&t.uploadAll&&t._trigger("totalComplete")},t._wijUpload()&&(o.onProgress=function(e){var r=n("."+g,this.fileRow),i={sender:e.fileName,loaded:e.loaded,total:e.total,fileNameList:undefined},s=this.inputFile.attr("id");e.supportProgress?(r.html(Math.round(1e3*e.loaded/e.total)/10+"%"),e.fileNameList&&(i.fileNameList=e.fileNameList),t._trigger("progress",null,i),t._progressTotal(s,e.loaded)):r.addClass(y)},o.onComplete=function(e){var r=this,i=r.inputFile.attr("id"),s=t.uploaders[i],o=x(r.inputFile[0]),u=n("."+g,r.fileRow);t._trigger("complete",e.e,n.extend(!0,r.inputFile,e)),u.removeClass(y),u.html("100%"),t._removeFileRow(r.fileRow,s,!0),t._progressTotal(i,o),t.totalUploadFiles--,t.totalUploadFiles===0&&(t.uploadAll||t.options.autoSubmit)&&t._trigger("totalComplete",e.e,e)}),typeof t.uploaders=="undefined"&&(t.uploaders={}),t.uploaders[r.attr("id")]=o},t.prototype._progressTotal=function(e,t){var n=this,r=n.progressAll,i,s;if(!n.uploadAll)return;r&&r.loadedSize&&(r.loadedSize[e]=t,i=n._getLoadedSize(r.loadedSize),s=r.totalSize),n._trigger("totalProgress",null,{loaded:i,total:s})},t.prototype._getLoadedSize=function(e){var t=0;return n.each(e,function(e,n){t+=n}),t},t.prototype._getTotalSize=function(){var e=this,t=0;return e.uploaders&&n.each(e.uploaders,function(e,n){t+=x(n.inputFile[0])}),t},t.prototype._resetProgressAll=function(){this.progressAll={totalSize:0,loadedSize:{}}},t.prototype._wijUpload=function(){return!0},t.prototype._wijcancel=function(e){},t.prototype._upload=function(e,t){},t.prototype._swfUploadFile=function(e){this.swfupload.startUpload(e)},t.prototype._bindEvents=function(){var e=this,t=e.options,r=e.progressAll;e.upload.delegate(v,"click."+e.widgetName,function(i){var s=n(this),u=s.parents(o),a,f;i.preventDefault();if(t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload){var l=u.data("file");e.swfupload.cancelUpload(l.id),u.fadeOut(1500,function(){u.remove(),e.swfupload.queueData.queueLength==0&&e.commandRow.hide()})}else a=n("input",u[0]),f=e.uploaders[a.attr("id")],e._wijcancel(a),e._wijUpload()&&f&&f.cancel(),r&&(r.totalSize-=x(a[0]),r.loadedSize[a.val()]&&delete r.loadedSize[a.val()]),e._removeFileRow(u,f,!1)}),e.upload.delegate(p,"click."+e.widgetName,function(r){var i=n(this),s=i.parents(o),u,a;r.preventDefault();if(t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload){var f=s.data("file");e.uploadAll=!1,e._wijUpload()?e._swfUploadFile(f.id):e._upload(f.id,!0)}else{u=n("input",s[0]),a=e.uploaders[u.attr("id")];if(e._trigger("upload",r,u)===!1)return!1;if(e.options.autoSubmit){a.autoSubmit=!0;if(e._trigger("totalUpload",r,null)===!1)return!1}e.totalUploadFiles++,e._upload(s),a&&e._wijUpload()&&a.upload()}}),e.upload.delegate("."+f,"click."+e.widgetName,function(r){r.preventDefault();if(t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload)e.uploadAll=!0,e._wijUpload()?e._swfUploadFile():e._upload(!0,!0);else{e.uploadAll=!0,e.progressAll||e._resetProgressAll();if(e._trigger("totalUpload",r,null)===!1)return!1;e.progressAll.totalSize=e._getTotalSize(),e._wijuploadAll(n(p,e.filesList[0])),e._wijUpload()&&n(p,e.filesList[0]).each(function(e,t){return n(t).click(),e})}}),e.upload.delegate("."+l,"click."+e.widgetName,function(r){r.preventDefault(),t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload?(n.each(e.swfupload.queueData.files,function(t,n){e.swfupload.cancelUpload(t)}),n(o,e.element).fadeOut(1500,function(){n(this).remove(),e.commandRow.hide()})):(e._resetProgressAll(),n(v,e.filesList[0]).each(function(e,t){n(t).click()}))})},t.prototype._wijuploadAll=function(e){},t.prototype._wijFileRowRemoved=function(e,t,n){this._setAddBtnState()},t.prototype._removeFileRow=function(e,t,r){var i=this,s,u;t&&(s=t.inputFile.attr("id")),e.fadeOut(1500,function(){e.remove(),i._wijFileRowRemoved(e,t.inputFile,r),i.uploaders[s]&&delete i.uploaders[s],u=n(o,i.upload),u.length?(i.commandRow.show(),t&&t.destroy&&t.destroy()):(i.commandRow.hide(),i.totalUploadFiles=0,i._resetProgressAll(),t&&t.destroy&&t.destroy(!0))})},t.prototype._getFileName=function(e){return E(e)},t.prototype._getFileNameByInput=function(e){return S(e)},t.prototype._getFileSize=function(e){return x(e)},t}(e.wijmoWidget);t.wijupload=T;var N=function(){function e(){this.wijCSS={iconCircleArrowN:"ui-icon-circle-arrow-n",iconCancel:"ui-icon-cancel"},this.action="",this.autoSubmit=!1,this.change=null,this.upload=null,this.totalUpload=null,this.progress=null,this.totalProgress=null,this.complete=null,this.totalComplete=null,this.maximumFiles=0,this.multiple=!0,this.accept="",this.enableSWFUploadOnIE=!1,this.enableSWFUpload=!1,this.swfUploadOptions={},this.localization={},this.handleRequest=null}return e}(),C="wijmo-wijupload",k=C+"-";T.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new N),n.wijmo.registerWidget("wijupload",T.prototype)})(e.upload||(e.upload={}));var t=e.upload})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this;this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver(),e._pageLize(!0)},"wijwizard"),this._pageLize(!0)},t.prototype._init=function(){var e=this.options,t=e.disabled;e.disabledState?(this.disable(),e.disabled=t):e.autoPlay&&this.play()},t.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"activeIndex":this.show(n);break;case"navButtons":case"backBtnText":case"nextBtnText":this._createButtons();break;case"autoPlay":n===!0?this.play():this.stop();default:this._pageLize(!1)}},t.prototype.destroy=function(){var e=this.options;return this.abort(),this.stop(),this._removeScroller(),this._removeButtons(),this.element.unbind(".wijwizard").removeClass(e.wijCSS.wijwizard).removeClass(e.wijCSS.widget).removeClass(e.wijCSS.helperClearFix).removeData("wijwizard"),this.list&&this.list.removeClass(e.wijCSS.widget).removeClass(e.wijCSS.helperReset).removeClass(e.wijCSS.wijwizardSteps).removeClass(e.wijCSS.helperClearFix).removeAttr("role"),this.lis&&(this.lis.removeClass(e.wijCSS.header).removeClass(e.wijCSS.cornerAll).removeClass(e.wijCSS.priorityPrimary).removeClass(e.wijCSS.prioritySecondary).removeAttr("role"),n.each(this.lis,function(){n.data(this,"destroy.wijwizard")?n(this).remove():n(this).removeAttr("aria-selected")})),n.each(this.panels,function(){var t=n(this).unbind(".wijwizard");n.each(["load","cache"],function(e,n){t.removeData(n+".wijwizard")}),n.data(this,"destroy.wijwizard")?t.remove():t.removeClass(e.wijCSS.stateDefault).removeClass(e.wijCSS.wijwizardActived).removeClass(e.wijCSS.stateActive).removeClass(e.wijCSS.stateHover).removeClass(e.wijCSS.stateFocus).removeClass(e.wijCSS.stateDisabled).removeClass(e.wijCSS.wijwizardPanel).removeClass(e.wijCSS.content).removeClass(e.wijCSS.wijwizardHide).css({position:"",left:"",top:""}).removeAttr("aria-hidden")}),this.container.replaceWith(this.container.contents()),e.cookie&&this._cookie(null,e.cookie),this},t.prototype._pageLize=function(e){var t=this.options,r=/^#.+/;this.list=this.element.children("ol,ul").eq(0),this.list&&this.list.length===0&&(this.list=this.element.find("."+t.wijCSS.wijwizardSteps).eq(0),this.list&&this.list.length===0&&(this.list=null)),this.list&&(this.lis=n("li",this.list)),e?(this.panels=n("> div",this.element),n.each(this.panels,function(e,t){var i=n(t).attr("src");i&&!r.test(i)&&n.data(t,"load.wijwizard",i.replace(/#.*$/,""))}),this.element.addClass(t.wijCSS.wijwizard).addClass(t.wijCSS.widget).addClass(t.wijCSS.helperClearFix),this.list&&(this.list.addClass(t.wijCSS.widget).addClass(t.wijCSS.helperReset).addClass(t.wijCSS.wijwizardSteps).addClass(t.wijCSS.helperClearFix).attr("role","tablist"),this.lis.addClass(t.wijCSS.header).addClass(t.wijCSS.cornerAll).attr("role","tab")),this.container=n("<div/>"),this.container.addClass(t.wijCSS.wijwizardContent).addClass(t.wijCSS.widget).addClass(t.wijCSS.content).addClass(t.wijCSS.cornerAll),this.container.append(this.panels),this.container.appendTo(this.element),this.panels.addClass(t.wijCSS.wijwizardPanel).addClass(t.wijCSS.content).attr("role","tabpanel"),t.activeIndex===undefined?(typeof t.activeIndex!="number"&&t.cookie&&(t.activeIndex=parseInt(this._cookie(undefined,undefined),10)),typeof t.activeIndex!="number"&&this.panels.filter("."+t.wijCSS.wijwizardActived).length&&(t.activeIndex=this.panels.index(this.panels.filter("."+t.wijCSS.wijwizardActived))),t.activeIndex=t.activeIndex||(this.panels.length?0:-1)):t.activeIndex===null&&(t.activeIndex=-1),t.activeIndex=t.activeIndex>=0&&this.panels[t.activeIndex]||t.activeIndex<0?t.activeIndex:0,this.panels.addClass(t.wijCSS.wijwizardHide).attr("aria-hidden",!0),t.activeIndex>=0&&this.panels.length&&(this.panels.eq(t.activeIndex).removeClass(t.wijCSS.wijwizardHide).addClass(t.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.load(t.activeIndex)),this._createButtons(),this._addScrollForContent()):(this.panels=n("> div",this.container),t.activeIndex=this.panels.index(this.panels.filter("."+t.wijCSS.wijwizardActived))),this._refreshStep(),this._initScroller(),t.cookie&&this._cookie(t.activeIndex,t.cookie),t.cache===!1&&this.panels.removeData("cache.wijwizard");if(t.showOption===undefined||t.showOption===null)t.showOption={};this._normalizeBlindOption(t.showOption);if(t.hideOption===undefined||t.hideOption===null)t.hideOption={};this._normalizeBlindOption(t.hideOption),this.panels.unbind(".wijwizard")},t.prototype._removeButtons=function(){this.buttons&&(this.buttons.remove(),this.buttons=undefined)},t.prototype._createButtons=function(){var e=this,t=this,r=this.options,i,s,o,u=r.backBtnText,a=r.nextBtnText;this._removeButtons();if(r.navButtons==="none")return;this.buttons||(i=r.navButtons,i==="auto"&&(i=this.list?"common":"edge"),this.buttons=n("<div/>"),this.buttons.addClass(r.wijCSS.wijwizardButtons),s=function(e,t){if(r.disabled)return;t.is(":not(."+r.wijCSS.stateDisabled+")")&&t.addClass(e)},o=function(e,t){if(r.disabled)return;t.removeClass(e)},i==="common"?(this.backBtn=n("<a href='#'><span class='"+r.wijCSS.buttonText+"'>"+u+"</span></a>").addClass(r.wijCSS.widget).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.button).addClass(r.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return e.back(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button"),this.nextBtn=n("<a href='#'><span class='"+r.wijCSS.buttonText+"'>"+a+"</span></a>").addClass(r.wijCSS.widget).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.button).addClass(r.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return t.next(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button")):(this.backBtn=n("<a href='#'/>").addClass(r.wijCSS.wijwizardPrev).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerRight).append("<span class='"+r.wijCSS.icon+" "+r.wijCSS.iconArrowLeft+"'></span>").appendTo(this.buttons).bind({click:function(){return t.back(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button"),this.nextBtn=n("<a href='#'/>").addClass(r.wijCSS.wijwizardNext).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerLeft).append("<span class='"+r.wijCSS.icon+" "+r.wijCSS.iconArrowRight+"'></span>").appendTo(this.buttons).bind({click:function(){return t.next(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button")),this.buttons.appendTo(this.element))},t.prototype._refreshStep=function(){var e=this.options;this.lis&&(this.lis.removeClass(e.wijCSS.priorityPrimary).addClass(e.wijCSS.prioritySecondary).attr("aria-selected",!1),e.activeIndex>=0&&e.activeIndex<=this.lis.length-1&&(this.lis&&this.lis.eq(e.activeIndex).removeClass(e.wijCSS.prioritySecondary).addClass(e.wijCSS.priorityPrimary).attr("aria-selected",!0),this.scrollWrap&&this.scrollWrap.wijsuperpanel("scrollChildIntoView",this.lis.eq(e.activeIndex)))),this.buttons&&!e.loop&&(this.backBtn[e.activeIndex<=0?"addClass":"removeClass"](e.wijCSS.stateDisabled).attr("aria-disabled",e.activeIndex===0),this.nextBtn[e.activeIndex>=this.panels.length-1?"addClass":"removeClass"](e.wijCSS.stateDisabled).attr("aria-disabled",e.activeIndex>=this.panels.length-1))},t.prototype._initScroller=function(){if(!this.lis)return;var e=0;n.each(this.lis,function(){e+=n(this).outerWidth(!0)}),this.element.innerWidth()<e?(this.scrollWrap===undefined&&(this.list.wrap("<div class='scrollWrap'></div>"),this.scrollWrap=this.list.parent(),n.effects&&n.effects.save?n.effects.save(this.list,["width","height","overflow"]):n.save&&n.save(this.list,["width","height","overflow"])),this.list.width(e+8),this.scrollWrap.height(this.list.outerHeight(!0)),this.scrollWrap.wijsuperpanel({allowResize:!1,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollBarVisibility:"hidden"}})):this._removeScroller()},t.prototype._removeScroller=function(){this.scrollWrap&&(this.scrollWrap.wijsuperpanel("destroy").replaceWith(this.scrollWrap.contents()),this.scrollWrap=undefined,n.effects&&n.effects.restore?n.effects.restore(this.list,["width","height","overflow"]):n.restore&&n.restore(this.list,["width","height","overflow"]))},t.prototype._cookie=function(e,t){var r=this.cookie||(this.cookie=this.options.cookie.name);return n.cookie.apply(null,[r].concat(n.makeArray(arguments)))},t.prototype._normalizeBlindOption=function(e){e.blind===undefined&&(e.blind=!1),e.fade===undefined&&(e.fade=!1),e.duration===undefined&&(e.duration=200);if(typeof e.duration=="string")try{e.duration=parseInt(e.duration,10)}catch(t){e.duration=200}},t.prototype._ui=function(e){return{panel:e,index:this.panels.index(e)}},t.prototype._removeSpinner=function(){this.element.removeClass(this.options.wijCSS.tabsLoading);var e=this.element.data("spinner.wijwizard");e&&(this.element.removeData("spinner.wijwizard"),e.remove())},t.prototype._showPanel=function(e){var t=this,r=this.options,i=n(e),s;i.addClass(r.wijCSS.wijwizardActived),(r.showOption.blind||r.showOption.fade)&&r.showOption.duration>0?(s={duration:r.showOption.duration},r.showOption.blind&&(s.height="toggle"),r.showOption.fade&&(s.opacity="toggle"),i.hide().removeClass(r.wijCSS.wijwizardHide).animate(s,r.showOption.duration||"normal","linear",function(){t._resetStyle(i),i.wijTriggerVisibility&&i.wijTriggerVisibility(),t._trigger("show",null,t._ui(i[0])),t._removeSpinner(),i.attr("aria-hidden",!1),t._trigger("activeIndexChanged",null,t._ui(i[0]))})):(i.removeClass(r.wijCSS.wijwizardHide).attr("aria-hidden",!1),i.wijTriggerVisibility&&i.wijTriggerVisibility(),this._trigger("show",null,this._ui(i[0])),this._removeSpinner(),this._trigger("activeIndexChanged",null,this._ui(i[0])))},t.prototype._hidePanel=function(e){var t=this,r=this,i=this.options,s=n(e),o;s.removeClass(i.wijCSS.wijwizardActived),(i.hideOption.blind||i.hideOption.fade)&&i.hideOption.duration>0?(o={duration:i.hideOption.duration},i.hideOption.blind&&(o.height="toggle"),i.hideOption.fade&&(o.opacity="toggle"),s.animate(o,i.hideOption.duration||"normal","linear",function(){s.addClass(i.wijCSS.wijwizardHide).attr("aria-hidden",!0),t._resetStyle(s),t.element.dequeue("wijwizard")})):(s.addClass(i.wijCSS.wijwizardHide).attr("aria-hidden",!0),this.element.dequeue("wijwizard"))},t.prototype._resetStyle=function(e){e.css({display:""}),n.support.opacity||e[0].style.removeAttribute("filter")},t.prototype._addScrollForContent=function(){var e=this,t=e.element.height();e.buttons&&(t-=e.buttons.outerHeight(!0)),e.list&&(t-=e.list.outerHeight(!0)),t-=e.container.outerHeight(!0)-e.container.innerHeight()-(e.container.innerHeight()-e.container.height()),t<e.container.height()&&e.container.height(t),e.container.css("overflow","auto")},t.prototype.add=function(e,t,r){e===undefined&&(e=this.panels.length),t===undefined&&(t="Step "+e);var i=this,s=this.options,o=n(s.panelTemplate||i._defaults.panelTemplate).data("destroy.wijwizard",!0),u;return o.addClass(s.wijCSS.wijwizardPanel).addClass(s.wijCSS.content).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.wijwizardHide).attr("aria-hidden",!0),e>=this.panels.length?this.panels.length>0?o.insertAfter(this.panels[this.panels.length-1]):o.appendTo(this.container):o.insertBefore(this.panels[e]),this.list&&this.lis&&(u=n((s.stepHeaderTemplate||i._defaults.stepHeaderTemplate).replace(/#\{title\}/g,t).replace(/#\{desc\}/g,r)),u.addClass(s.wijCSS.header).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.prioritySecondary).data("destroy.wijwizard",!0),e>=this.lis.length?u.appendTo(this.list):u.insertBefore(this.lis[e])),this._pageLize(!1),this.panels.length===1&&(s.activeIndex=0,u.addClass(s.wijCSS.priorityPrimary),o.removeClass(s.wijCSS.wijwizardHide).addClass(s.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.element.queue("wijwizard",function(){i._trigger("show",null,i._ui(i.panels[0]))}),this._refreshStep(),this.load(0)),this._trigger("add",null,this._ui(this.panels[e])),this},t.prototype.remove=function(e){var t=this.options,n=this.panels.eq(e).remove();return this.lis.eq(e).remove(),e<t.activeIndex&&t.activeIndex--,this._pageLize(!1),n.hasClass(t.wijCSS.wijwizardActived)&&this.panels.length>=1&&this.show(e+(e<this.panels.length?0:-1)),this._trigger("remove",null,this._ui(n[0])),this},t.prototype.show=function(e){var t=this;if(e<0||e>=this.panels.length)return this;if(this.element.queue("wijwizard").length>0)return this;var r=this.options,i={nextIndex:0,nextPanel:null},s,o;n.extend(i,this._ui(this.panels[r.activeIndex])),i.nextIndex=e,i.nextPanel=this.panels[e];if(this._trigger("validating",null,i)===!1)return this;s=this.panels.filter(":not(."+r.wijCSS.wijwizardHide+")"),o=this.panels.eq(e),r.activeIndex=e,this.abort(),r.cookie&&this._cookie(r.activeIndex,r.cookie),this._refreshStep();if(!o.length)throw"jQuery UI wijwizard: Mismatching fragment identifier.";return s.length&&this.element.queue("wijwizard",function(){t._hidePanel(s)}),this.element.queue("wijwizard",function(){t._showPanel(o)}),this.load(e),this},t.prototype.next=function(){var e=this.options,t=e.activeIndex+1;return e.disabled?!1:(e.loop&&(t%=this.panels.length),t<this.panels.length?(this.show(t),!0):!1)},t.prototype.back=function(){var e=this.options,t=e.activeIndex-1;return e.disabled?!1:(e.loop&&(t=t<0?this.panels.length-1:t),t>=0?(this.show(t),!0):!1)},t.prototype.load=function(e){var t=this,r=t.options,i=t.panels.eq(e)[0],s=n.data(i,"load.wijwizard"),o;t.abort();if(!s||t.element.queue("wijwizard").length!==0&&n.data(i,"cache.wijwizard")){t.element.dequeue("wijwizard");return}return this.element.addClass(r.wijCSS.tabsLoading),r.spinner&&(o=this.element.data("spinner.wijwizard"),o||(o=n("<div/>"),o.addClass(r.wijCSS.wijwizardSpinner),o.html(r.spinner||t._defaults.spinner),o.appendTo(document.body),this.element.data("spinner.wijwizard",o),o.wijpopup({showEffect:"blind",hideEffect:"blind"})),o.wijpopup("show",{of:this.element,my:"center center",at:"center center"})),this.xhr=n.ajax(n.extend({},r.ajaxOptions,{url:s,dataType:"html",success:function(s,o){n(i).html(s),r.cache&&n.data(i,"cache.wijwizard",!0),t._trigger("load",null,t._ui(t.panels[e]));try{r.ajaxOptions&&r.ajaxOptions.success&&r.ajaxOptions.success(s,o)}catch(u){}},error:function(n,s,o){t._trigger("load",null,t._ui(t.panels[e]));try{r.ajaxOptions&&r.ajaxOptions.error&&r.ajaxOptions.error(n,s,e,i)}catch(u){}}})),t.element.dequeue("wijwizard"),t},t.prototype.abort=function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("wijwizard",this.element.queue("wijwizard").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._removeSpinner(),this},t.prototype.url=function(e,t){return this.panels.eq(e).removeData("cache.wijwizard").data("load.wijwizard",t),this},t.prototype.count=function(){return this.panels.length},t.prototype.stop=function(){var e=this.element.data("intId.wijwizard");e&&(window.clearInterval(e),this.element.removeData("intId.wijwizard"))},t.prototype.play=function(){var e=this,t=this.options,n,r=this.panels.length;this.element.data("intId.wijwizard")||(n=window.setInterval(function(){var n=t.activeIndex+1;if(n>=r){if(!t.loop){e.stop();return}n=0}e.show(n)},t.delay),this.element.data("intId.wijwizard",n))},t}(e.wijmoWidget);t.wijwizard=r,r.prototype._defaults={stepHeaderTemplate:"<li><h1>#{title}</h1>#{desc}</li>",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"};var i=function(){function e(){this.wijCSS={wijwizard:"wijmo-wijwizard",wijwizardButtons:"wijmo-wijwizard-buttons",wijwizardPrev:"wijmo-wijwizard-prev",wijwizardNext:"wijmo-wijwizard-next",wijwizardSteps:"wijmo-wijwizard-steps",wijwizardContent:"wijmo-wijwizard-content",wijwizardPanel:"wijmo-wijwizard-panel",wijwizardActived:"wijmo-wijwizard-actived",wijwizardHide:"wijmo-wijwizard-hide",wijwizardSpinner:"wijmo-wijwizard-spinner"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-b",stateDefault:"ui-btn ui-btn-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a"},this.navButtons="auto",this.autoPlay=!1,this.delay=3e3,this.loop=!1,this.hideOption={fade:!0},this.showOption={fade:!0,duration:400},this.ajaxOptions=null,this.cache=!1,this.cookie=null,this.stepHeaderTemplate="",this.panelTemplate="",this.spinner="",this.backBtnText="back",this.nextBtnText="next",this.add=null,this.remove=null,this.activeIndexChanged=null,this.show=null,this.load=null,this.validating=null}return e}();r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("wijwizard",r.prototype)})(e.wizard||(e.wizard={}));var t=e.wizard})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijribbon",i="wijmo-wijribbon",s=i+"-disabled",o=i+"-bigbutton",u=i+"-panel",a=i+"-groups",f=i+"-group",l=f+"-content",c=f+"-label",h=i+"-dropdown",p=i+"-dropdowngroup",d=i+"-abbrev",v=d+"group",m=i+"-text",g=i+"-icon",y=i+"-abbrevicon",b="ui-button",w="ui-state-active",E=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._ribbonify(),n(window).bind("resize.wijribbon",function(){e.updateRibbonSize()}),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.updateRibbonSize(),e.options.disabled&&e._setDisabled(!0),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijribbon"),e.options.disabled&&e._setDisabled(!0)},t.prototype._setOption=function(e,t){n.wijmo.widget.prototype._setOption.apply(this,arguments),e==="disabled"&&this._setDisabled(t),n(".wijmo-wijribbon-startmenulink",this.element).unbind("click.tabs")},t.prototype._setDisabled=function(e){var t=this,r=t.element,i=r.offset(),o=i.top,u=i.left,a=n("body"),f=this.options.wijCSS,l=t.disabledModal;r.data("wijmo-wijtabs")&&r.wijtabs("option","disabled",e),r.closest(".wijmo-wijeditor").length!==0&&(o=0,u=0,a=r.parent()),e?(l||(l=n("<div></div>").addClass(f.stateDisabled+" "+s).css({top:o,left:u,"background-color":"lightgray",position:"absolute"}).appendTo(a).bind("click mousedown mouseup mouseover mouseout focus keydown keypress",function(e){return e.stopPropagation(),e.preventDefault(),!1}),t.disabledModal=l),t.disabledModal.width(r.width()).height(r.outerHeight()).show()):t.disabledModal&&t.disabledModal.hide()},t.prototype._initCustomButtons=function(){var e=this,t;n.each(n("[customtype]",e.element),function(r,i){t=n(i).attr("customtype"),t&&e.options.custombuttons[t]&&e.options.custombuttons[t].create(n(i))})},t.prototype._ribbonify=function(){var e=this,t=this.options.wijCSS;e.buttons={},e.listUis={},e.accessbarBtns={},e._initCustomButtons(),e._createAccessToolBar(),e._getButtonSets(),e._createButtons(),e._createGroup(),e._createSplit(),e._createDropdwon(),e._createInputDropdown(),e._createGallery(),e._hideShowedList(),e._createTab(),n("."+t.helperReset+":not(."+a+", ."+t.tabsNav+", .wijmo-wijmenu-list)",e.element).hover(function(){n(this).addClass(t.stateHover)},function(){n(this).removeClass(t.stateHover)}),n("."+b,e.element).bind("mouseenter",function(){n("."+t.buttonText,this).addClass(t.stateHover)}).bind("mouseleave",function(){n("."+t.buttonText,this).removeClass(t.stateHover)}),n("button."+b,e.element).bind("mousedown",function(){e._addActiveClassToButtonText(this)}).bind("mouseup",function(){e._addActiveClassToButtonText(this)}),n("label."+b,e.element).bind("click",function(){n("span",this)&&n("span",this).length===1&&e._addActiveClassToLabelButtonText(this)})},t.prototype._addActiveClassToButtonText=function(e){var t=this.options.wijCSS;e&&(n(e).hasAllClasses(w)?n("."+t.buttonText,e).addClass(t.stateActive).addClass(t.stateDefault):n("."+t.buttonText,e).removeClass(t.stateActive).removeClass(t.stateDefault))},t.prototype._addActiveClassToLabelButtonText=function(e){var t=this,r,i,s;e&&(i=n(e).attr("for"),r=n("#"+i,t.element),r.is(":checkbox")?t._addActiveClassToButtonText(e):r.is(":radio")&&(s=t.element.find("[name='"+r.attr("name")+"']"),n.each(s,function(){t._updateGroupElementTextState(this)})))},t.prototype._updateGroupElementTextState=function(e){var t,r=this.options.wijCSS;if(!e)return;t=n("[for='"+n(e).attr("id")+"']",n(e).parent()),t&&(t.hasAllClasses(w)?t.children("."+r.buttonText).addClass(r.stateActive).addClass(r.stateDefault):t.children("."+r.buttonText).removeClass(r.stateActive).removeClass(r.stateDefault))},t.prototype._getButtonSets=function(){var e=this,t;e.groups=[],e.splits=[],e.dropdowns=[],e.inputDropdowns=[],n("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text",e.element).each(function(r,i){if(n(i).parents("[customtype]")&&n(i).parents("[customtype]").length!==0)return;return t=n(i).parent(),n(">ul",t).length===0&&!t.hasClass("wijmo-wijribbon-accesstoolbar")?e.groups.push(t):n(">button",t).length===2?e.splits.push(t):n(">button",t).length===1?e.dropdowns.push(t):n(">input[type='text']",t).length===1&&e.inputDropdowns.push(t),this}),e.groups=e._unique(e.groups),e.splits=e._unique(e.splits)},t.prototype._unique=function(e){var t=n.makeArray(n.map(e,function(e){return e.get(0)}));return n.map(n.unique(t),function(e){return n(e)})},t.prototype._createButtons=function(){var e=this,t=e.element;n(":checkbox",t).each(function(){if(n(this).parents("[customtype]")&&n(this).parents("[customtype]").length!==0)return;return e._createButton(n(this),"checkbox"),n(this).bind("change",function(){e._addActiveClassToLabelButtonText(n(this).button("widget")[0])}),this}),n(":radio",t).each(function(){if(n(this).parents("[customtype]")&&n(this).parents("[customtype]").length!==0)return;return e._createButton(n(this),"radio"),n(this).bind("change",function(){e._addActiveClassToLabelButtonText(n(this).button("widget")[0])}),this}),n("button",t).each(function(){if(n(this).parents("[customtype]")&&n(this).parents("[customtype]").length!==0)return;return e._createButton(n(this),"button"),this})},t.prototype._createButton=function(e,t){var r=this,i=this.options.wijCSS,s=r._buildButtonOption(e,t),o=e.data("commandName"),u;e.button(s),s.text||(t==="button"?e.children("."+i.buttonText).text(o):(u=n("[for='"+e.attr("id")+"']",e.parent()),u&&u.children("."+i.buttonText).text(o))),e.parent().is(".wijmo-wijribbon-accesstoolbar")&&e.attr("canlocateonaccesstoolbar")==="true"&&e.button("widget").hide(),r._triggerEvent(e)},t.prototype._createGroup=function(){n.each(this.groups,function(e,t){t.buttonset()})},t.prototype._createSplit=function(){var e=this,t=this.options.wijCSS;n.each(e.splits,function(r,s){var o=s.children("ul"),u=s.children("button:eq(0)"),a=u.data("commandName"),f=s.children("button:eq(1)"),l;o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+a),f.button({icons:{primary:t.iconArrowDown},text:!1}).data("list",o).unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault()}).bind("mouseup",function(t){o=n(this).data("list"),o.is(":visible")?(e.showList.hide().css("z-index",""),e.showList=null):(o.show().position({my:"left top",at:"left bottom",of:s}).css("z-index",9999),e.showList=o),t.stopPropagation(),t.preventDefault()}),f.children("."+t.buttonText).text("foo"),s.after(o),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),s.buttonset(),l={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"split",trigger:f,list:o},n("button, :checkbox, :radio",o).bind("click",function(t){o.hide().css("z-index",""),e.showList=null,t.preventDefault()}),o.find(">li>button,>li>:radio,>li>:checkbox").each(function(t,r){var i=n(r).data("commandName");i!==""&&e.buttons[i]&&(e.buttons[i].parent=u,e.buttons[i].type="split"),l.buttons.push(n(r))}),a!==""&&(e.listUis[a]=l)})},t.prototype._createDropdwon=function(){var e=this,t=this.options.wijCSS,r,s;e.dropdownLabels={},n.each(e.dropdowns,function(r,s){var o=s.children("ul"),u=s.children("button:eq(0)"),a=u.data("commandName"),f;o.children("li").addClass(t.cornerAll+" "+t.stateDefault),s.addClass(i+"-"+a),u.button({icons:{secondary:t.iconArrowDown}}).unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault()}).bind("mouseup",function(t){e._showDropDownList(o,u),t.stopPropagation(),t.preventDefault()}).bind("keydown",function(t){if(!o.is(":visible"))return;e._dropdownListKeyHandler(t,o,u)}),f={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"dropdown",list:o},n("button, :checkbox, :radio",o).bind("click",function(r){var i=n(this).data("commandName"),s,a=u.children("."+t.buttonText).width();e.dropdownLabels[i]||(e.dropdownLabels[i]=e._getDropdownLabelSubstr(n(this).button("option","label"),u.children("."+t.buttonText),a)),s=e.dropdownLabels[i],u.button("option","label",s),u.attr("title",n(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,r.preventDefault()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),s.buttonset(),e._collectDropDownButtons(o,u,f,a)})},t.prototype._createInputDropdown=function(){var e=this,t=this.options.wijCSS;e.dropdownLabels={},n.each(e.inputDropdowns,function(r,s){var o=s.children("ul"),u=s.children("input[type='text']:eq(0)"),a=e._createInputDropDownWrapper(u),f=u.prop("name"),l;s.prepend(a),o.children("li").addClass(t.cornerAll+" "+t.stateDefault),s.addClass(i+"-"+f),u.removeProp("name").data("commandName",f).addClass(t.stateDefault+" "+t.content+" "+t.cornerLeft),a.find("a").bind("mouseup",function(t){e._showDropDownList(o,u),u.focus(),t.stopPropagation(),t.preventDefault()}).bind("keydown",function(t){e._dropdownListKeyHandler(t,o,a)}),e._bindInputEvent(u,o),l={ui:u,defaultValue:u.val(),buttons:[],type:"dropdown",list:o},n("button, :checkbox, :radio",o).bind("click",function(t){var r=n(this).data("commandName"),i;e.dropdownLabels[r]||(e.dropdownLabels[r]=n(this).button("option","label")),i=e.dropdownLabels[r],u.val(n(this).button("option","label")).attr("title",n(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,t.preventDefault(),t.stopPropagation()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),e._collectDropDownButtons(o,u,l,f)})},t.prototype._collectDropDownButtons=function(e,t,r,i){var s=this;e.find(">li>button,>li>:radio,>li>:checkbox").each(function(e,i){var o=n(i).data("commandName");o!==""&&s.buttons[o]&&(s.buttons[o].parent=t,s.buttons[o].type="dropdown"),r.buttons.push(n(i))}),i!==""&&(s.listUis[i]=r)},t.prototype._showDropDownList=function(e,t){var n=this;e.is(":visible")&&!e.find("li."+n.options.wijCSS.stateActive)?(n.showList.hide().css("z-index",""),n.showList=null):(n.showList&&(n.showList.hide(),n.showList=null),e.show().position({my:"left top",at:"left bottom",of:t}).css("z-index",9999),n.showList=e,n.isShow=!0)},t.prototype._bindInputEvent=function(e,t){var n=this,r,i;e.bind("change",function(t){var r={name:undefined,commandName:undefined};r.name=e.prop("name"),r.commandName=e.val(),n._trigger("click",t,r)}).bind("keydown",function(r){n._dropdownListKeyHandler(r,t,e)})},t.prototype._dropdownListKeyHandler=function(e,t,n){var r=this,i=e.keyCode,s=r._getKeyCodeEnum();switch(i){case s.UP:r._activeDropDownListElement(!1,t,n),e.preventDefault();break;case s.DOWN:r._activeDropDownListElement(!0,t,n),e.preventDefault();break;case s.ENTER:t.find("label."+r.options.wijCSS.stateActive).parent("li").find("input").trigger("click"),e.preventDefault()}},t.prototype._activeDropDownListElement=function(e,t,r){var i=this,s=t.find("li").length,o,u;if(!t.is(":visible")){i._showDropDownList(t,r);return}u=t.find("label."+i.options.wijCSS.stateActive).parent("li"),u&&u.length>0&&(o=t.find("li").index(u)),i._changeListItemActiveState(u,!1),o===undefined?o=0:e?(o++,o==s&&(o=undefined)):(o--,o==-1&&(o=s-1)),i._changeListItemActiveState(n(t.find("li")[o]),!0)},t.prototype._changeListItemActiveState=function(e,t){var r=this.options.wijCSS;if(!e)return;t?(n("label",e).addClass(r.stateActive),n("span",e).addClass(r.stateActive)):(n("label",e).removeClass(r.stateActive),n("span",e).removeClass(r.stateActive))},t.prototype._createGallery=function(){var e=this,t=e.options.wijCSS;n(".wijmo-wijribbon-gallery",e.element).each(function(r,i){n(i).children("div").each(function(r,i){n(i).bind("mouseenter",function(e){if(n(i).hasAllClasses(t.stateDisabled))return;n(i).addClass(t.stateHover)}).bind("mouseleave",function(e){if(n(i).hasAllClasses(t.stateDisabled))return;n(i).removeClass(t.stateHover)}).bind("click",function(r){if(n(i).hasAllClasses(t.stateDisabled))return;n(i).parent("div.wijmo-wijribbon-gallery").children("div").removeClass(t.stateActive),n(i).addClass(t.stateActive);var s={name:undefined,commandName:undefined};s.name=n(i).parent("div.wijmo-wijribbon-gallery").attr("name"),s.commandName=n(i).attr("name"),e._trigger("click",r,s)}),e.buttons[n(i).attr("name")]={button:n(i),type:"galleryBtn"}})})},t.prototype._getKeyCodeEnum=function(){if(n.ui&&n.ui.keyCode)return n.ui.keyCode;if(n.mobile&&n.mobile.keyCode)return n.mobile.keyCode;throw"keyCode object is not found"},t.prototype._createInputDropDownWrapper=function(e){var t=this.options.wijCSS,r=n("<span class='wijmo-wijribbon-inputdropdownwrapper'></span>").append(e);return n("<a></a>").appendTo(r).button({icons:{primary:t.iconArrowDown},text:!1}).removeClass(t.cornerAll).addClass("wijmo-wijribbon-inputdropdownbtn "+t.cornerRight),r},t.prototype._createTab=function(){var e=this,t=this.options.wijCSS,r=e.element;return r.addClass(i),e.tabEle=r,n(">ul",r).length>0?(r.wijtabs({select:function(t,n){e._hideAllMenus()}}),e._createRibbonGroups(),n(".wijmo-wijribbon-startmenu")&&n(".wijmo-wijribbon-startmenu").length>0&&(r.wijtabs("option","selected",1),e._createStartMenu()),!0):(r.addClass(i+"-simple").addClass(t.stateDefault).addClass(t.helperClearFix),!1)},t.prototype._createAccessToolBar=function(){var e=this,t,r=n("<div class='wijmo-wijribbon-accesstoolbar'></div>"),i;if(n("*[canlocateonaccesstoolbar='true']",e.element).length===0&&n("*[locateonaccesstoolbar='true']",e.element).length===0)return;n("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']",e.element).each(function(){t=n(this).attr("id")+"_accessbar";var r=n("label[for="+n(this).attr("id")+"]");e.accessbarBtns[r.attr("title")]={button:n(this).clone().attr("id",t),type:n(this).attr("type"),labelEle:r.clone().attr("for",t),selected:n(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),n("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']",e.element).each(function(){t=n(this).attr("id")+"_accessbar",e.accessbarBtns[n(this).attr("title")]={button:n(this).clone(),type:"button",selected:n(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),n.each(e.accessbarBtns,function(e,t){r.append(t.button),t.labelEle&&r.append(t.labelEle)}),i=n('<button title="Customize Access Toolbar" class ="wijmo-wijribbon-accesstoolbarbtn '+e.options.wijCSS.iconArrowDown+'"'+' name="quicktoolbar"></button>'),r.append(i),e.accessbarBtns&&e.element.prepend(r),e._createCustomQuickToolbarMenu(i,r)},t.prototype._createCustomQuickToolbarMenu=function(e,t){var r=this,i,s,o=r.options.wijCSS,u=n('<ul class="wijmo-wijribbon-accesstoolbarmenu"></ul>');n.each(r.accessbarBtns,function(e,t){s=t.selected?" wijmo-wijribbon-accesstoolbarmenuitemchecked":" wijmo-wijribbon-accesstoolbarmenuitemunchecked",i=n('<li><a class="'+o.cornerAll+'" tabindex="-1">'+'<span class="'+o.icon+s+'"></span><span'+' class="wijmo-wijmenu-text">'+e+"</span></a></li>"),i.data("accessbarcommand",e),u.append(i)}),u.prepend("<li class='wijmo-wijribbon-accesstoolbarmenutitleitem'><a>Customize Access Toolbar</a></li>"),t.append(u),u.wijmenu({trigger:e,triggerEvent:"click",orientation:"vertical",select:function(e,t){var i=t.item,s=i.element.data("accessbarcommand"),a=n("span."+o.icon,i.element),f=r.accessbarBtns[s].button,l=f.button("widget");a.hasClass("wijmo-wijribbon-accesstoolbarmenuitemchecked")?(a.removeClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").addClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),l.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar","true")):(a.addClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").removeClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),l.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar","true")),u.wijmenu("deactivate",null)}}),u.wijmenu("setItemDisabled",n(".wijmo-wijribbon-accesstoolbarmenutitleitem"),!0)},t.prototype.updateRibbonSize=function(){var e=this,t,r=this.options.wijCSS,s;e.tabEle.children("div").not(".wijmo-wijmenu").each(function(o,u){var a=n(u),f=a.is(":visible"),l=a.find(">ul>li:not(.wijmo-wijmenu-item)"),c=[],h=a.width();return f||(a.removeClass(r.wijtabsHide),h=a.width()),l.each(function(r,o){var u=n(o),a=u.find(">div:last"),f=e._getGroupLabelText(a);return t=u.children("."+p),s=u.children("."+v),t&&(u.addClass(i+"-"+f.toLowerCase()).prepend(t.children()),t.remove(),s&&s.remove()),c.push({width:u.outerWidth(!0),text:f}),this}),e._adjustRibbonGroupIfNeeded(l,c,h),f||a.addClass(r.wijtabsHide),this}),e.options.disabled&&e._setDisabled(!0)},t.prototype._createRibbonGroups=function(){var e=this,t=this.options.wijCSS;e.tabEle.children("div").each(function(r,s){var o=n(s),h=o.is(":visible"),p=o.find(">ul:not(.wijmo-wijribbon-accesstoolbarmenu)>li"),d=[],v;if(o.data("destroy.tabs")){o.remove();return}return h||o.removeClass(t.wijtabsHide),v=o.width(),o.addClass(u),o.hasAllClasses(t.tabsPanel)||(o.addClass("wijmo-wijribbon-accesstoolbar"),e.tabEle.prepend(o)),o.find(">ul").addClass(t.helperReset+" "+t.helperClearFix+" "+t.content+" "+t.cornerAll+" "+a),p.each(function(r,s){var o=n(s),u=o.find(">div:last"),a=u.find("span"),h=t.stateDefault+" "+f,p=e._getGroupLabelText(u);return u&&(h+=" "+i+"-"+p.toLowerCase()),o.addClass(h),u.addClass(c).bind("click",function(){return!1}),o.wrapInner("<div class = '"+l+"'></div>"),o.children().bind("mouseover",function(){n(this).addClass(t.stateHover)}).bind("mouseout",function(){n(this).removeClass(t.stateHover)}),u.appendTo(o),d.push({width:o.outerWidth(!0),text:p}),this}),e._originalGroupInfo=d,e._adjustRibbonGroupIfNeeded(p,d,v),h||o.addClass(t.wijtabsHide),this})},t.prototype._createStartMenu=function(){var e=this,t=n(".wijmo-wijribbon-startmenulink",e.element),r=e.options.wijCSS;t.unbind("click"),t.parent("li").addClass("wijmo-wijribbon-startmenulinkcontainer").hover(function(){n(this).removeClass("wijmo-wijribbon-startmenulinkcontainer")},function(){n(this).addClass("wijmo-wijribbon-startmenulinkcontainer")}),n(".wijmo-wijribbon-startmenuindicator",e.element).addClass(r.icon+" "+r.iconArrowDown),n(".wijmo-wijribbon-startmenu",e.element).wijmenu({trigger:n(".wijmo-wijribbon-startmenulink",e.element).parent(),triggerEvent:"click",orientation:"vertical",select:function(t,n){var r={name:undefined,commandName:undefined};r.commandName=n.item._link.attr("name"),e._trigger("click",t,r)},hidden:function(e,t){t.activeItem&&t.activeItem._link.removeClass(r.stateFocus)}})},t.prototype._getGroupLabelText=function(e){var t,r;return e&&(t=e.find("span"),e.attr("displayname")?r=e.attr("displayname"):t&&t.length>0&&!e.hasAllClasses(v)?r=n(t[0]).text():r=n.trim(e.text())),r},t.prototype._adjustRibbonGroupIfNeeded=function(e,t,r){var s=this,o=e.length-1,u=0,a=0,f=0,l,c,h;for(;o>=0;o--){f=0;for(u=0;u<o;u++)f+=t[u].width;f+a+t[o].width<=r?(l=n(e[o]).children("."+p),c=n(e[o]).children("."+v),l&&(n(e[o]).addClass(i+"-"+t[o].text.toLowerCase()).prepend(l.children()),l.remove(),c&&c.remove())):(h=t[o],a+=s._createDropDownRibbonGroup(h.text,e[o]))}},t.prototype._createDropDownRibbonGroup=function(e,t){var r=this,s=i+"-"+e.toLowerCase(),o=this.options.wijCSS,u=n(t).removeClass(s),a=r._getGroupLabelText(u.find(">div:last"))||e,l;return u.wrapInner("<div class='"+p+" "+f+"'></div>").children().hide().addClass(s).bind("mouseup."+r.widget,function(e){r.showDrpDwnGroup!==null&&(r.showDrpDwnGroup.hide().css("z-index",""),r.showDrpDwnGroup=null)}),l=n("<div class='"+v+"'>"+"<span class='"+d+a.toLowerCase()+" "+g+" "+y+"'></span>"+"<span class='"+m+"'>"+a+"</span>"+"<span class='"+o.icon+" "+o.iconArrowDown+" "+g+"'></span></div>").appendTo(u).unbind(r.widget).bind("mouseover."+r.widget,function(e){n(this).addClass(o.stateHover)}).bind("mouseout."+r.widget,function(e){n(this).removeClass(o.stateHover)}).bind("click."+r.widget,function(e){var t=n(this).siblings("."+p);t.is(":visible")?(t.hide().css("z-index",""),r.showDrpDwnGroup=null):(r.showDrpDwnGroup&&r.showDrpDwnGroup.hide().css("z-index",""),t.show().position({my:"left top",at:"left bottom",of:this}).css("z-index","10000"),r.showDrpDwnGroup=t,e.stopPropagation())}),u.outerWidth(!0)},t.prototype._hideShowedList=function(){var e=this;n(document).bind("mouseup",function(t){var r=t.target;e.showList&&(n(r).is(document)||!n.contains(e.showList.get(0),r))&&(e.showList.hide().css("z-index",""),e.showList=null),e.showDrpDwnGroup&&(n(r).is(document)||!n.contains(e.showDrpDwnGroup.get(0),r))&&(e.showDrpDwnGroup.hide().css("z-index",""),e.showDrpDwnGroup=null)})},t.prototype._buildButtonOption=function(e,t){var r=!0,i=this,s=e.attr("class"),u,a,f,l,c,h,p;if(s&&s!==""&&s!==o)a=s.split(" ")[0],e.removeClass(a),c=n.trim(e.text()),c===""&&(r=!1);else{if(t==="checkbox"||t==="radio"){if(n.trim(e.attr("id"))==="")return;h=n("[for='"+e.attr("id")+"']",e.parent());if(!h.is("label"))return;s=h.attr("class"),s&&s!==""&&s!==o?(a=s.split(" ")[0],h.removeClass(a),c=n.trim(h.text()),c===""&&(r=!1)):u=h.children("span,div")}else t==="button"&&(u=e.children("span,div"));u&&(u.length===1?u.eq(0).attr("class")!==""&&(f=u.eq(0),a=f.attr("class"),r=!1):u.length===2?u.eq(0).attr("class")&&(f=u.eq(0),a=f.attr("class"),f.is("span")?l="left":f.is("div")&&(l="top"),c=u.eq(1).text()):t==="button"&&n.trim(e.text())!==""&&(c=n.trim(e.text())))}return t==="button"?(e.empty(),p=n.trim(e.attr("name")),p!==""&&e.removeAttr("name")):(p=n.trim(h.attr("name")),p!==""&&h.removeAttr("name")),p!==""&&(e.data("commandName",p),i.buttons[p]||(i.buttons[p]={button:undefined,accessToolbarButton:undefined}),e.parent().is(".wijmo-wijribbon-accesstoolbar")?i.buttons[p].accessToolbarButton=e:i.buttons[p].button=e),{label:c,icons:{primary:a},position:l,text:r}},t.prototype._triggerEvent=function(e){var t=this,n,r,i=t.options.wijCSS;e.bind("click",function(i){if(t.options.disabled){i.preventDefault(),i.stopPropagation();return}t._hideAllMenus();var s=!0,o=e.data("commandName"),u=t.buttons[o],a={name:undefined,commandName:undefined};u&&u.parent&&(a.name=u.parent.data("commandName")),a.commandName=o,t._trigger("click",i,a),e.parent().is(".wijmo-wijribbon-accesstoolbar")?n=t.buttons[o].button:n=t.buttons[o].accessToolbarButton,n&&(r=n.button("widget"),n.is("button")||(r&&r.hasAllClasses(w)&&(s=!1),t._setBtnWidgetCheckedStyle(n,s))),e.is("button")&&(i.preventDefault(),i.stopPropagation())})},t.prototype._getDropdownLabelSubstr=function(e,t,r){var i=this,s=e.length,o=0,u=s,a=Math.floor((o+u)/2),f=n("<span></span>"),l=e.substr(0,a),c;f.appendTo(t.parent()),c=i._calculateWidth(l,f);while(c!==r&&u>o)l=e.substr(0,a+1),c=i._calculateWidth(l,f),c>r?u=a-1:c<r&&(o=a+1),a=Math.floor((o+u)/2);return f.remove(),l},t.prototype._calculateWidth=function(e,t){return t.text(e),t.width()},t.prototype.hideDropdown=function(e){var t=this,n=t.listUis[e];n&&n.list&&n.list.hide()},t.prototype._hideAllMenus=function(){var e=this;n(".wijmo-wijmenu",e.tabEle).hide()},t.prototype.setTabPageVisible=function(e,t){var r=this,i=n("a[href=#"+e+"]",r.element).parent("li"),s=i.parent("ul"),o;i&&i.length>0&&(t?(i.show(),o=n("li",s).index(i)):(i.hide(),o=n("li",s).index(n('li:visible:not(".wijmo-wijribbon-startmenulinkcontainer")',s)))),r.element.wijtabs("option","selected",o)},t.prototype.destroy=function(){this.disabledModal&&this.disabledModal.remove(),n(window).unbind("resize.wijribbon"),n.Widget.prototype.destroy.call(this)},t.prototype.getDropdownList=function(e){var t=this,r=t.listUis[e],i={};return r&&n.each(r.buttons,function(e,t){i[t.data("commandName")]=t.button("option","label")}),i},t.prototype.setButtonDisabled=function(e,t){var r=this.buttons[e],i=this.options.wijCSS,s,o,u=!1,a,f,l;if(r&&r.disabled){r.disabled(t);return}r&&r.button&&r.type==="galleryBtn"&&r.button.addClass(i.stateDisabled);if(r&&r.button){a=r.button,f=r.accessToolbarButton,u=a.is("button");if(r.type==="galleryBtn"){t?a.addClass(i.stateDisabled):a.removeClass(i.stateDisabled);return}a.button("option","disabled",t),s=n("."+i.buttonText,a),s&&s.removeClass(i.stateHover),f&&(f.button("option","disabled",t),o=n("."+i.buttonText,f),o&&o.removeClass(i.stateHover)),u?e!=="save"&&(a.children("."+i.buttonText).text(e),f&&a.children("."+i.buttonText).text(e)):n("[for='"+a.attr("id")+"']",a.parent()).children("."+i.buttonText).text(e),l=this.listUis[e],l&&l.type==="split"&&(l.trigger.button("option","disabled",t),l.trigger.children("."+i.buttonText).text(e))}},t.prototype.setButtonsDisabled=function(e){var t=this;n.each(e,function(e,n){t.setButtonDisabled(e,n)})},t.prototype.setButtonsChecked=function(e){var t=this;n.each(e,function(e,r){n.isPlainObject(r)?t.setButtonChecked(e,r.checked,r.name):t.setButtonChecked(e,r,null)})},t.prototype.registerButtonInformation=function(e,t){if(e&&t)return this.buttons[e]=t},t.prototype.ribbonClick=function(e,t){this._trigger("click",e,t)},t.prototype._setBtnWidgetCheckedStyle=function(e,t){var n=this,e,r=n.options.wijCSS;e.is("button")?t?e.addClass(r.stateActive):e.removeClass(r.stateActive):e.is("input[type='text']")||(e.prop("checked",t),e.button("refresh")),n._addActiveClassToButtonText(e.button("widget"))},t.prototype.removeButtonHoverState=function(e){var t=this,r,i=this.options.wijCSS,s=t.buttons[e];s&&s.button&&(r=s.button,r.is("button")&&(r.removeClass(i.stateHover).removeClass(i.stateFocus),n("span",r).removeClass(i.stateHover)))},t.prototype.setButtonChecked=function(e,t,r){var i=this,s,o=i.buttons[e],u=this.options.wijCSS,a,f,l,c;if(o&&o.checked){o.checked(t);return}if(o&&o.button){a=o.button,f=o.accessToolbarButton;if(a.is("button"))t?(a.addClass(u.stateActive),f&&f.addClass(u.stateActive)):(a.removeClass(u.stateActive),f&&f.removeClass(u.stateActive));else{if(o.type==="galleryBtn"){var h=a.parent("div");n("div",h).removeClass(u.stateActive),t?a.addClass(u.stateActive):a.removeClass(u.stateActive);return}a.is("input[type='text']")||(a.prop("checked",t),a.button("refresh"),f&&(f.prop("checked",t),f.button("refresh")))}o.parent?o.type==="dropdown"&&t&&(i.dropdownLabels[e]||(i.dropdownLabels[e]=i._getDropdownLabelSubstr(a.button("option","label"),o.parent.children("."+u.buttonText),o.parent.children("."+u.buttonText).width())),c=i.dropdownLabels[e],o.parent.is("input[type='text']")?(o.parent.val(c),o.parent.attr("title",c)):(o.parent.button("option","label",c),o.parent.attr("title",a.button("option","label"))),s=n(":radio",o.button.closest("ul")),s&&n.each(s,function(){i._updateGroupElementTextState(this)})):(i._addActiveClassToButtonText(a.button("widget")),f&&i._addActiveClassToButtonText(f.button("widget")))}else r&&(l=i.listUis[r],l&&(l.ui.is("input[type='text']")?l.ui.val(l.defaultValue):l.ui.button("option","label",l.defaultValue),l.buttons&&n.each(l.buttons,function(e,t){t.prop("checked",!1),t.button("refresh"),i._addActiveClassToButtonText(t.button("widget"))})))},t}(e.wijmoWidget);t.wijribbon=E;var S=function(){function e(){this.initSelector=":jqmData(role='wijribbon')",this.wijCSS={wijtabsHide:"wijmo-wijtabs-hide"},this.click=null,this.custombuttons=null}return e}();E.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new S),n.wijmo.registerWidget("wijribbon",E.prototype)})(e.ribbon||(e.ribbon={}));var t=e.ribbon})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijeditor",i=alert,s=window,o=document,u=parseInt,a,f,l,c=[],h=null,p=!0,d=!0,v=0,m=[],g=null,y=null,b="setButtonDisabled",w="setButtonsDisabled",E="setButtonChecked",S="setButtonsChecked",x="form",T="imagebutton",N="textarea",C="button",k="textbox",L="list",A="passwordfield",O="dropdownlist",M="hiddenfield",_="radio",D="checkbox",P="insertcol",H="insertrow",B="insertcell",j="splitcell",F="mergecell",I="deletecol",q="deleterow",R="deletecell",U="justifyleft",z="justifycenter",W="justifyright",X="justifyfull",V="borders",$="insertorderedlist",J="insertunorderedlist",K="outdent",Q="indent",G="backcolor",Y="fontcolor",Z="bold",et="italic",tt="strikethrough",nt="underline",rt="subscript",it="superscript",st="template",ot="removeformat",ut="insertbreak",at="insertparagraph",ft="insertprintpagebreak",lt="inserthorizontalrule",ct="tablebutton",ht="inserttable",pt="edittable",dt="wysiwyg",vt="split",mt="code",gt="wordwrap",yt="fullscreen",bt="undo",wt="redo",Et="preview",St="cleanup",xt="cut",Tt="copy",Nt="paste",Ct="selectall",kt="media",Lt="specialchar",At="datetime",Ot="find",Mt="inspect",_t="save",Dt="spelling",Pt="imagebrowser",Ht="link",Bt="xx-small",jt="x-small",Ft="small",It="medium",qt="large",Rt="x-large",Ut="xx-large",zt="fontname",Wt="fontsize",Xt="blockquote",Vt="insertcode",$t="wijmo-wijribbon",Jt=$t+"-bigbutton",Kt=$t+"-dropdownbutton",Qt=$t+"-splitbutton",Gt=$t+"-list",Yt=$t+"-save",Zt=$t+"-save16",en=$t+"-undo",tn=$t+"-redo",nn=$t+"-preview",rn=$t+"-cleanup",sn=$t+"-cut",on=$t+"-copy",un=$t+"-paste",an=$t+"-selectall",fn=$t+"-bgcolor",ln=$t+"-color",cn=$t+"-bold",hn=$t+"-italic",pn=$t+"-underline",dn=$t+"-strike",vn=$t+"-sub",mn=$t+"-sup",gn=$t+"-template",yn=$t+"-removeformat",bn=$t+"-justifyleft",wn=$t+"-justifycenter",En=$t+"-justifyright",Sn=$t+"-justifyfull",xn=$t+"-borders",Tn=$t+"-orderlist",Nn=$t+"-unorderlist",Cn=$t+"-outdent",kn=$t+"-indent",Ln=$t+"-inspect",An=$t+"-find",On=$t+"-table",Mn=$t+"-inserttable",_n=$t+"-edittable",Dn=$t+"-insertcol",Pn=$t+"-insertrow",Hn=$t+"-insertcell",Bn=$t+"-splitcell",jn=$t+"-mergecell",Fn=$t+"-deletecol",In=$t+"-deleterow",qn=$t+"-deletecell",Rn=$t+"-insertbreak",Un=$t+"-insertparagraph",zn=$t+"-insertprintpagebreak",Wn=$t+"-inserthr",Xn=$t+"-form",Vn=$t+"-textarea",$n=$t+"-textbox",Jn=$t+"-password",Kn=$t+"-hiddenfield",Qn=$t+"-imagebutton",Gn=$t+"-button",Yn=$t+"-listbox",Zn=$t+"-dropdownlist",er=$t+"-radio",tr=$t+"-checkbox",nr=$t+"-link",rr=$t+"-link16",ir=$t+"-imagebrowser",sr=$t+"-media",or=$t+"-specialchar",ur=$t+"-datetime",ar=$t+"-blockquote",fr=$t+"-insertcode",lr=$t+"-modes",cr=$t+"-designview",hr=$t+"-sourceview",pr=$t+"-splitview",dr=$t+"-wordwrap",vr=$t+"-fullscreen",mr="wijmo-wijeditor",gr=mr+"-container",yr=mr+"-header",br=mr+"-content",wr=mr+"-footer",Er=mr+"-pathselector",Sr=mr+"-fullscreen",xr=mr+"-dialog",Tr=xr+"-hr",Nr=xr+"-buttons",Cr=xr+"-button",kr=xr+"-text",Lr=mr+"-imagedlg",Ar=Lr+"-content",Or=Lr+"-fields",Mr=Lr+"-imagefield",_r=Lr+"-imagelist",Dr=Lr+"-preview",Pr=Lr+"-imagesrc",Hr=Lr+"-imagealt",Br=Lr+"-imagewidth",jr=Lr+"-imageheight",Fr=Lr+"-css",Ir=Lr+"-hideimagelist",qr=mr+"-templatedlg",Rr=qr+"-toplabels",Ur=qr+"-topleftlabel",zr=qr+"-toprightlabel",Wr=qr+"-content",Xr=qr+"-templatelist",Vr=qr+"-preview",$r=qr+"-templateinfo",Jr=qr+"-nameinfo",Kr=qr+"-descriptioninfo",Qr=qr+"-fields",Gr=qr+"-name",Yr=qr+"-description",Zr=qr+"-buttons",ei=qr+"-delete",ti=qr+"-save",ni=mr+"-linkdlg",ri=ni+"-address",ii=ni+"-linktype",si=ni+"-anchor",oi=ni+"-text",ui=ni+"-target",ai=ni+"-css",fi=ni+"-src",li=ni+"-width",ci=ni+"-height",hi=ni+"-imagecontainer",pi=ni+"-linkicontype",di=mr+"-codedlg",vi=di+"-source",mi=di+"-sourcelabel",gi=mr+"-taginsdlg",yi=gi+"-caption",bi=gi+"-taglabel",wi=gi+"-tagtext",Ei=gi+"-filterempty",Si=gi+"-attribs",xi=gi+"-attriblist",Ti=gi+"-innerhtml",Ni=gi+"-css",Ci=mr+"-colordlg",ki=Ci+"-picker",Li=Ci+"-color",Ai=mr+"-tabledlg",Oi=Ai+"-rows",Mi=Ai+"-columns",_i=Ai+"-width",Di=Ai+"-height",Pi=Ai+"-border",Hi=Ai+"-cellpadding",Bi=Ai+"-cellspacing",ji=Ai+"-csstext",Fi=Ai+"-bgcolor",Ii=mr+"-previewdlg",qi=Ii+"-caption",Ri=Ii+"-navigator",Ui=Ii+"-prev",zi=Ii+"-next",Wi=Ii+"-printall",Xi=Ii+"-printone",Vi=Ii+"-ok",$i=Ii+"-printdocument",Ji=Ii+"-previewiframe",Ki=mr+"-cleanupdlg",Qi=Ki+"-caption",Gi=Ki+"-document",Yi=Ki+"-actions",Zi=mr+"-finddlg",es=Zi+"-find",ts=Zi+"-replace",ns=mr+"-mediadlg",rs=ns+"-type",is=ns+"-src",ss=ns+"-width",os=ns+"-height",us=mr+"-specialchardlg",as=us+"-chars",fs=us+"-preview",ls=us+"-content",cs=us+"-list",hs=us+"_label",ps=us+"-punctuation",ds=us+"-symbols",vs=us+"-diacritics",ms="wijmo-formatspan",gs="."+Nr+" input:first",ys="."+Nr+" input:last",bs="."+Nr+" input[value='OK']",ws="."+Nr+" input[engValue='Cancel']",Es=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Ss=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],xs=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],Ts={Form:{name:"form",tip:"Form",css:Xn},Image:{name:"imagebutton",tip:"Image Button",css:Qn},TextArea:{name:"textarea",tip:"TextArea",css:Vn},Button:{name:"button",tip:"Button",css:Gn},TextBox:{name:"textbox",tip:"TextBox",css:$n},List:{name:"list",tip:"ListBox",css:Yn},PasswordField:{name:"passwordfield",tip:"Password Field",css:Jn},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Zn},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Kn},Radio:{name:"radio",tip:"RadioButton",css:er},CheckBox:{name:"checkbox",tip:"CheckBox",css:tr},InsertColumn:{name:"insertcol",tip:"Insert Column",css:Dn},InsertRow:{name:"insertrow",tip:"Insert Row",css:Pn},InsertCell:{name:"insertcell",tip:"Insert Cell",css:Hn},SplitCell:{name:"splitcell",tip:"Split Cell",css:Bn},MergeCell:{name:"mergecell",tip:"Merge Cell",css:jn},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:Fn},DeleteRow:{name:"deleterow",tip:"Delete Row",css:In},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:qn},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:bn,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:wn,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:En,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:Sn,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:xn},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:Tn,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:Nn,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Cn,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:kn,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:fn},ForeColor:{name:"fontcolor",tip:"Font Color",css:ln},Bold:{name:"bold",tip:"Bold",css:cn},Italic:{name:"italic",tip:"Italic",css:hn},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:dn},UnderLine:{name:"underline",tip:"Underline",css:pn},SubScript:{name:"subscript",tip:"Subscript",css:vn},SuperScript:{name:"superscript",tip:"Superscript",css:mn},Template:{name:"template",tip:"Template",css:gn},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:yn},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:Rn},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Un},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:zn},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:Wn},Table:{name:"tablebutton",tip:"Table",css:On},InsertTable:{name:"inserttable",tip:"Insert Table",css:Mn},EditTable:{name:"edittable",tip:"Edit Table",css:_n},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:cr,grpname:"modes"},Split:{name:"split",tip:"Split View",css:pr,grpname:"modes"},Code:{name:"code",tip:"Source View",css:hr,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:dr},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:vr},Undo:{name:"undo",tip:"Undo",css:en},Redo:{name:"redo",tip:"Redo",css:tn},Preview:{name:"preview",tip:"Preview",css:nn},Cleanup:{name:"cleanup",tip:"Clean up",css:rn},Cut:{name:"cut",tip:"Cut",css:sn},Copy:{name:"copy",tip:"Copy",css:on},Paste:{name:"paste",tip:"Paste",css:un},SelectAll:{name:"selectall",tip:"Select All",css:an},Media:{name:"media",tip:"Media",css:sr},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:or},InsertDate:{name:"datetime",tip:"Insert Date Time",css:ur},Find:{name:"find",tip:"Find And Replace",css:An,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:Ln,text:"Inspect"},Save:{name:"save",tip:"Save",css:Yt,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:ir},Link:{name:"link",tip:"Link",css:nr,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:Kt},FontSize:{name:"fontsize",tip:"Font Size",css:Kt},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ar},InsertCode:{name:"insertcode",tip:"Insert Code",css:fr}},Ns=function(){var e=this,t=[];e.append=function(e){t.push(e)},e.toString=function(){return t.join("")},e.dispose=function(){t=null}},Cs=function(e){this.text=e,this.render=function(){return this.text}},ks=function(e,t,r){var i=this,s={br:!0,img:!0,hr:!0,input:!0};i.tagName=e||"div",i.attributes=r||{},i.innerText=t||"",i.children=[],n.isPlainObject(t)&&(i.innerText="",i.attributes=t),i._isShortTag=!1,s[i.tagName]===!0&&(i._isShortTag=!0),i.render=function(){var e=new Ns,t="";return e.append(i._renderBeginTag(i.tagName,i.attributes)),i.innerText!==""&&e.append(i.innerText),i.children.length>0&&n.each(i.children,function(t,n){e.append(n.render())}),e.append(i._renderEndTag(i.tagName)),t=e.toString(),e.dispose(),t},i.add=function(e){this.children.push(e)},i._renderBeginTag=function(e,t){var r=new Ns,i="";return r.append("<"),r.append(e),n.each(t,function(e,t){r.append(" "),r.append(e),r.append("="),r.append('"'),r.append(t?t.toString():""),r.append('"')}),this._isShortTag?r.append(" "):r.append(">"),i=r.toString(),r.dispose(),i},i._renderEndTag=function(e){var t=new Ns,n="";return this._isShortTag?t.append("/>"):(t.append("</"),t.append(e),t.append(">")),n=t.toString(),t.dispose(),n}},Ls=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.wijeditor=function(){this._curPageIdx=0,this.tRange=null,this.txtFoundInIE=!1,this.txtFoundInNoneIE=!1},t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));if(e.element.is("input"))return;e.wijeditor(),e.id_prefix="wijeditor-"+e.element.attr("id")+"-",e.$ribbon=undefined,e.$modes=undefined,e._isIE11=n.browser.msie&&n.browser.version&&parseFloat(n.browser.version)>=11,e._editorify(),e._initElements(),s.setTimeout(function(){e.options.disabled&&e._handleDisabledOption(!0,e.editor)},40),e._continueSavingInputTextForUndo=!1,e.element.is(":hidden")&&e.editor.wijAddVisibilityObserver&&e.editor.wijAddVisibilityObserver(function(t){if(n.contains(e.editor[0],t.target))return;e.refresh(),e.editor.wijRemoveVisibilityObserver&&e.editor.wijRemoveVisibilityObserver()},"wijeditor")},t.prototype._contextMenuWidgetName=function(){return"wijmenu"},t.prototype._createBigButton=function(e,t,n,r){var i=this,s=i._createElement("button",{title:e,name:n,"class":Jt});return s.add(i._createDiv(t)),s.add(i._createSpan("",r)),s},t.prototype._createTextButton=function(e,t,n){return this._createElement("button",n,{title:e,name:t})},t.prototype._createButton=function(e,t,n,r){var i=this,s;return r?(s=i._createElement("button",{title:e,name:n}),s.add(i._createSpan(t)),s.add(i._createSpan("",r)),s):i._createElement("button",{title:e,name:n,"class":t})},t.prototype._createTextRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+n,type:"radio",name:r})),o.push(s._createElement("label",i,{"for":t+n,title:e,name:n})),o},t.prototype._createImageRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+r,type:"radio",name:i})),o.push(s._createElement("label",{"for":t+r,title:e,name:r,"class":n})),o},t.prototype._createImageCheckButton=function(e,t,n,r){var i=this,s=[];return s.push(i._createElement("input",{id:t+r,type:"checkbox"})),s.push(i._createElement("label",{"for":t+r,title:e,name:r,"class":n})),s},t.prototype._createRibbonList=function(){return this._createSpan(Gt)},t.prototype._createDropdownButton=function(e,t,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Kt}),a=o._createElement("ul");return u.add(o._createTextButton(e,t,r)),u.add(a),n.each(i,function(e,r){var i=o._createElement("li"),u=o._createTextRadioButton(r.tip,s,r.name,t,r.text);n.each(u,function(e,t){i.add(t)}),a.add(i)}),u},t.prototype._createSplitButton=function(e,t,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Qt}),a=o._createElement("ul");return u.add(o._createBigButton(e,t,r,i)),u.add(o._createElement("button",{"class":Jt})),u.add(a),n.each(s,function(e,t){var n=o._createElement("li");n.add(o._createButton(t.tip,t.css,t.name,t.text)),a.add(n)}),u},t.prototype._createButtonByCommand=function(e){var t=this,n,r=Ts[e],i;if(!r)return;i=r.name;switch(i){case Xt:case x:case T:case N:case C:case k:case L:case A:case O:case M:case _:case D:case P:case H:case B:case j:case F:case I:case q:case R:case ot:case ut:case at:case ft:case yt:case bt:case wt:case xt:case Tt:case Nt:case At:case gt:case G:case Y:case Et:case St:case kt:case Lt:case st:case Pt:case Vt:case lt:case Ct:n=t._createButton(r.tip,r.css,i);break;case Ot:case Mt:n=t._createButton(r.tip,r.css,i,r.text);break;case V:case rt:case it:case Z:case et:case nt:case tt:n=t._createImageCheckButton(r.tip,t.id_prefix,r.css,i);break;case dt:case vt:case mt:case U:case z:case W:case X:case K:case Q:case $:case J:n=t._createImageRadioButton(r.tip,t.id_prefix,r.css,i,r.grpname);break;case ct:n=t._createSplitButton("Table",On,ct,"Table",[{tip:"Insert Table",css:Mn,name:ht,text:"Insert"},{tip:"Edit Table",css:_n,name:pt,text:"Edit"}]);break;case _t:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,Zt,i);break;case Ht:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,rr,i);break;case zt:n=t._createDropdownButton("Font Name",zt,"Font Name",t.options.fontNames||[],t.id_prefix);break;case Wt:n=t._createDropdownButton("Font Size",Wt,"Font Size",t.options.fontSizes||[],t.id_prefix);break;case Dt:}return n},t.prototype._createActionGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Save")),t.add(n),n.add(e._createButtonByCommand("Undo")),n.add(e._createButtonByCommand("Redo")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Preview")),n.add(e._createButtonByCommand("Cleanup")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Cut")),n.add(e._createButtonByCommand("Copy")),n.add(e._createButtonByCommand("Paste")),n.add(e._createButtonByCommand("SelectAll")),t.add(e._createElement("div","Actions")),t},t.prototype._createFontGroup=function(){var e=this,t=e._createElement("li"),r=e._createRibbonList();return t.add(e._createButtonByCommand("FontName")),t.add(e._createButtonByCommand("FontSize")),t.add(r),r.add(e._createButtonByCommand("BackColor")),r.add(e._createButtonByCommand("ForeColor")),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Bold"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Italic"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("UnderLine"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("StrikeThrough"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("SubScript"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("SuperScript"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),r.add(e._createButtonByCommand("Template")),r=e._createRibbonList(),t.add(r),r.add(e._createButtonByCommand("RemoveFormat")),t.add(e._createElement("div","Font")),t},t.prototype._createParaGroup=function(){var e=this,t=e._createElement("li"),r=e._createRibbonList();return t.add(r),n.each(e._createButtonByCommand("JustifyLeft"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyCenter"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyRight"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyFull"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Border"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("NumberedList"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("BulletedList"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Outdent"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Indent"),function(e,t){r.add(t)}),t.add(e._createElement("div","Paragraph")),t},t.prototype._createReviewGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Inspect")),t.add(e._createButtonByCommand("Find")),t.add(e._createElement("div","Review")),t},t.prototype._createTablesGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Table")),t.add(n),n.add(e._createButtonByCommand("InsertColumn")),n.add(e._createButtonByCommand("InsertRow")),n.add(e._createButtonByCommand("InsertCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("SplitCell")),n.add(e._createButtonByCommand("MergeCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("DeleteColumn")),n.add(e._createButtonByCommand("DeleteRow")),n.add(e._createButtonByCommand("DeleteCell")),t.add(e._createElement("div","Tables")),t},t.prototype._createBreaksGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("InsertBreak")),t.add(e._createButtonByCommand("InsertParagraph")),t.add(e._createButtonByCommand("InsertPrint")),t.add(e._createButtonByCommand("InsertHR")),t.add(e._createElement("div","Breaks")),t},t.prototype._createFormsGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(n),n.add(e._createButtonByCommand("Form")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("TextArea")),n.add(e._createButtonByCommand("TextBox")),n.add(e._createButtonByCommand("PasswordField")),n.add(e._createButtonByCommand("HiddenField")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Image")),n.add(e._createButtonByCommand("Button")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("List")),n.add(e._createButtonByCommand("DropDownList")),n.add(e._createButtonByCommand("Radio")),n.add(e._createButtonByCommand("CheckBox")),t.add(e._createElement("div","Forms")),t},t.prototype._createSpecialGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Link")),t.add(e._createButtonByCommand("InsertImage")),t.add(e._createButtonByCommand("Media")),t.add(e._createButtonByCommand("InsertSpecialChar")),t.add(e._createButtonByCommand("InsertDate")),t.add(e._createElement("div","Special")),t},t.prototype._getDefaultRibbonMarkup=function(){var e=this,t=e._createElement("div"),n=e._createElement("ul"),r=e._createElement("li"),i=e._createElement("li"),s=e._createElement("div",{id:e.id_prefix+"format"}),o=e._createElement("div",{id:e.id_prefix+"insert"}),u=e._createElement("ul"),a=e._createElement("ul");return t.add(n),t.add(s),t.add(o),n.add(r),n.add(i),r.add(e._createElement("a","Format",{href:"#"+e.id_prefix+"format"})),i.add(e._createElement("a","Insert",{href:"#"+e.id_prefix+"insert"})),s.add(u),u.add(e._createActionGroup()),u.add(e._createFontGroup()),u.add(e._createParaGroup()),u.add(e._createReviewGroup()),o.add(a),a.add(e._createTablesGroup()),a.add(e._createBreaksGroup()),a.add(e._createFormsGroup()),a.add(e._createSpecialGroup()),t.render()},t.prototype._getRibbonModesMarkup=function(){var e=this,t=e._createDiv(lr),r=e._createRibbonList(),i=e.element.find(".wijeditor-footer"),s,o,u,a,f;return i.length>0&&(s=n(i.find("."+cr)),s.length>0&&(Ts.Wysiwyg.tip=s.attr("title")||Ts.Wysiwyg.tip),o=n(i.find("."+pr)),o.length>0&&(Ts.Split.tip=o.attr("title")||Ts.Split.tip),u=n(i.find("."+hr)),u.length>0&&(Ts.Code.tip=u.attr("title")||Ts.Code.tip),a=n(i.find("."+dr)),s.length>0&&(Ts.Wordwrap.tip=a.attr("title")||Ts.Wordwrap.tip),f=n(i.find("."+vr)),s.length>0&&(Ts.FullScreen.tip=f.attr("title")||Ts.FullScreen.tip),i.remove()),t.add(r),n.each(e._createButtonByCommand("Wysiwyg"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Code"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Split"),function(e,t){r.add(t)}),t.add(e._createButtonByCommand("Wordwrap")),t.add(e._createButtonByCommand("FullScreen")),t.render()},t.prototype._getSimpleToolBar=function(e){var t=this,r,i=t._createDiv("");return n.each(e,function(e,s){r=t._createButtonByCommand(s),r&&(n.inArray(s,Es)!==-1?n.each(r,function(e,t){i.add(t)}):i.add(r))}),i.render()},t.prototype._editorify=function(){var e=this,t=e.element,r=t.width(),i=t.height(),s=e.options,o=s.mode,u,a,f,l,c,h,p;e._oriStyle=t.attr("style"),e._oriContent=t.html(),e._oriEleWidth=r,e._oriEleHeight=i,t.is("textarea")?(o==="ribbon"?e.$ribbon=n(e._getDefaultRibbonMarkup()):o==="bbcode"?e.$ribbon=n(e._getSimpleToolBar(xs)):s.simpleModeCommands&&s.simpleModeCommands.length!==0?(f=n.grep(s.simpleModeCommands,function(e,t){return e!=="Table"},undefined),e.$ribbon=n(e._getSimpleToolBar(f))):e.$ribbon=n(e._getSimpleToolBar(Ss)),s.text&&t.val(s.text),e.sourceView=t,e.editor=t.wrap("<div></div>").parent(),e.editor.width(r).height(i)):(e.editor=t,e.$ribbon=t.children(":eq(0)"),h=t.children(":eq(1)"),h.is("textarea")?(s.text&&h.val(s.text),e.sourceView=h):(s.text?p=s.text:p=h.html(),h.remove(),e.sourceView=n("<textarea></textarea>").val(p))),u=n("<div class='"+gr+"'></div>"),e.dialog=n("<div class ='"+mr+"'></div>"),e.subDialog=n("<div class ='"+mr+"'></div>"),e.editor.addClass(mr).addClass(e.options.wijCSS.widget).append(u).append(e.dialog).append(e.subDialog),e._createMenuMarkUp(e,s),e.$ribbon.wrap("<a href='javascript:void(null)'></a>").parent().appendTo("<div class='"+yr+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(u),a=n("<div class='"+br+"'></div>").appendTo(u),e.designView=n("<iframe frameborder='0'></iframe>"),e.designView.wrap("<div></div>").parent().appendTo(a),e.sourceView.wrap("<div></div>").parent().appendTo(a),l=[e.$ribbon],e.$modes=n(e._getRibbonModesMarkup()),s.showFooter&&(c=n("<div class='"+wr+" "+"ui-widget ui-widget-content ui-state-default'></div>"),u.append(c),c.append("<div class='"+Er+"'></div>"),e.$modes.appendTo(c),l.push(e.$modes)),n.each(l,function(t,n){n.wijribbon({click:function(t,n){e._ribbonCommand(n.commandName,n.name),e._trigger("commandButtonClick",t,n)}})})},t.prototype._createMenuMarkUp=function(e,t){t.customContextMenu&&!n.browser.webkit&&(e.contextMenu=n("<ul><li _c1buttoncmd='cut'><a>"+this.localizeString("contextMenuCut","Cut")+"</a></li>"+"<li _c1buttoncmd='copy'><a>"+this.localizeString("contextMenuCopy","Copy")+"</a></li>"+"<li _c1buttoncmd='paste'><a>"+this.localizeString("contextMenuPaste","Paste")+"</a></li></ul>"),n("<a href='#'></a>").append(e.contextMenu).appendTo(e.editor))},t.prototype._handleDisabledOption=function(e,t){var r=this;e?(r.disabledDiv||(r.disabledDiv=r._createDisabledDiv(t)),n("body").focus(),r.disabledDiv.appendTo(r.editor)):r.disabledDiv&&(r.disabledDiv.remove(),r.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=e?e:t.element,i=r.outerWidth(),s=r.outerHeight();return n("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"relative","background-color":"lightgray",width:i,height:s,left:0,top:-s})},t.prototype._initElements=function(){var e=this,t=e.options,n=e.element.height()-e._getHeader().outerHeight(!0)-e._getFooter().outerHeight(!0),r={};e._getContent().height(n).wijsplitter({showExpander:!1,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:!1},panel2:{scrollBars:"none",collapsed:!0}}),e.sourceView.css("width","").css("height",""),e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu(),(!t.showPathSelector||e.options.mode==="bbcode")&&e._getPathSelector().hide(),e._ribbonCommand(t.editorMode,null,!0),t.fullScreenMode&&e._setFullScreen(t.fullScreenMode),r[wt]=!0,r[bt]=!0,e.$ribbon.wijribbon(w,r),e._handleWinDocumentKeyDown()},t.prototype._handleWinDocumentKeyDown=function(){var e=this;n(document).keydown(function(t){if(e.options.disabled)return;switch(t.keyCode){case 27:e._escActionAssociated()}})},t.prototype._setOption=function(e,t){var r=this,i=r.options,s=i.mode,o=i.editorMode,u=r.$ribbon.parent(),a=i.fullScreenMode,f=i.customContextMenu;n.Widget.prototype._setOption.apply(r,arguments);if(e==="fullScreenMode")t!==a&&r._setFullScreen(t);else if(e==="showPathSelector")t?r._getPathSelector().show():r._getPathSelector().hide();else if(e==="editorMode"&&o!==t)r._ribbonCommand(t),r.$modes.data("wijmo-wijribbon")&&r.$modes.wijribbon(E,o,!1);else if(e==="fullScreenContainerSelector")r.options.fullScreenMode&&r._setFullScreen(!0);else if(e==="disabled")r._handleDisabledOption(t,r.editor);else if(e==="showFooter")t?n("."+wr).is(":visible")||n("."+wr).show():n("."+wr).is(":visible")&&n("."+wr).hide();else if(e==="commandButtonClick")i.commandButtonClick=t;else if(e==="text")r.setText(t);else if(e==="customContextMenu"){if(f===t)return;t?(r.contextMenu||r._createMenuMarkUp(r,i),r._createWijMenu()):(r.contextMenu[r._contextMenuWidgetName()]("destroy").remove(),r.contextMenu=undefined)}else e==="mode"&&t!==s?(r._recreateRibbon(t),r._ribbonCommand(i.editorMode)):(e==="fontNames"||e==="fontSizes")&&r._recreateRibbon(r.options.mode)},t.prototype._recreateRibbon=function(e){var t=this,r=t.$ribbon.parent();t.$ribbon.wijribbon("destroy"),t.$ribbon.remove(),e==="ribbon"?t.$ribbon=n(t._getDefaultRibbonMarkup()):e==="bbcode"?t.$ribbon=n(t._getSimpleToolBar(xs)):t.$ribbon=n(t._getSimpleToolBar(Ss)),r.append(t.$ribbon),t.$ribbon.wijribbon({click:function(e,n){t._ribbonCommand(n.commandName,n.name),t._trigger("commandButtonClick",e,n)}})},t.prototype._getHeader=function(){return n("."+yr,this.editor)},t.prototype._getContent=function(){return n("."+br,this.editor)},t.prototype._getFooter=function(){return n("."+wr,this.editor)},t.prototype._getPathSelector=function(){return n("."+Er,this.editor)},t.prototype._getModes=function(){return n("."+lr,this.editor)},t.prototype._getDesignView=function(){return this.designView},t.prototype._getDesignViewWindow=function(){var e=this.designView;return e&&e.length>0?e[0].contentWindow:null},t.prototype._getDesignViewDocument=function(){var e=this._getDesignViewWindow();return e?e.document:null},t.prototype._getDesignViewText=function(){var e=this._getDesignViewDocument();return e&&e.body&&e.body.innerHTML?e.body.innerHTML:""},t.prototype._setDesignViewText=function(e){var t=this,n=this._getDesignViewDocument();this.options.mode==="bbcode"&&(e=t._convertBBCodeToHtml(e)),n&&n.body&&(n.body.innerHTML=e),t.options.text=e},t.prototype._getDialog=function(){return this.dialog},t.prototype._getSubDialog=function(){return this.subDialog},t.prototype._initContentDocument=function(){var e=this,t=e.sourceView.val(),r=e._getDesignViewDocument();e.options.mode==="bbcode"&&(t=e._convertBBCodeToHtml(n.trim(t))),r.open(),r.write('<html style="width:100%;height:100%;'+(e.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle" '+' type="text/css" >table,td,tr{border: 1px #acacac dashed;}'+'</style></head><body style="word-wrap:break-word">'+t+"</body></html>"),r.close(),d||n("#__wijStyle",r).prop("disabled",!d),e.element.attr("accesskey")&&(n(r.body).attr("accesskey",e.element.attr("accesskey")),e.element.removeAttr("accesskey")),m=[],m.push(t),v=0},t.prototype._addHandlerToDesignView=function(){var e=this,t=e._getDesignViewWindow(),r=t.document;e._initContentDocument(),e._loadDesignView(),n.browser.msie&&n(r).unbind("beforedeactivate").bind("beforedeactivate",function(){e._saveSelectionForIE()})},t.prototype._loadDesignView=function(){var e=this,t=e._getDesignViewWindow(),r=t.document;n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(r,!0),n.browser.msie&&e._setContentSpellCheck(r,!1),e.sourceView.bind("blur."+e.widgetName,function(t){e._onSourceViewBlur()}),e.sourceView.bind("keyup."+e.widgetName,function(t){e._onSourceViewBlur()}),n.browser.mozilla?n(r).bind("blur."+e.widgetName,function(t){e._onDesignViewBlur(t)}):n(t).blur(function(t){e._onDesignViewBlur(t)}),n(r).bind("mouseup."+e.widgetName,function(t){e._onDesignViewMouseUp(t)}).bind("keydown."+e.widgetName,function(t){e._onDesignViewKeyDown(t)}).bind("keyup."+e.widgetName,function(t){e._onDesignViewKeyUp(t),e._onDesignViewBlur(t)})},t.prototype._addDefaultFontStyleToDesignView=function(){var e=this,t=e.options,r=e._getDesignViewDocument(),i=t.defaultFontName,s=t.defaultFontSize,o='<style type="text/css"> body {';if(!(i!==""&&i!==null||s!==""&&s!==null))return;i!==""&&i!==null&&(o+="font-family: "+i+";"),t.defaultFontSize!==""&&t.defaultFontSize!==null&&(o+=" font-size: "+s+";"),o+="}</style>",window.setTimeout(function(){n(o).appendTo(n("head",r))},200),e._setFontStyleButtonState(i,zt),e._setFontStyleButtonState(s,Wt)},t.prototype._setFontStyleButtonState=function(e,t){var r="";if(!e||e===null)return;n.each(this.$ribbon.wijribbon("getDropdownList",t),function(t,n){if(n.toUpperCase()===e.toUpperCase())return r=t,!1}),this.$ribbon.wijribbon(E,r,!0,t)},t.prototype._setDesignModeForFF=function(e){var t=e._getDesignViewDocument();t&&(t.designMode="on")},t.prototype.destroy=function(){var e=this;e.element.html(e._oriContent),e.element.removeAttr("tabindex"),e._oriStyle===undefined?e.element.removeAttr("style"):e.element.attr("style",e._oriStyle),e.dialog&&e.dialog.remove(),e.element.insertBefore(e.editor),e.element.unbind("."+e.widgetName),e.editor.remove(),n.Widget.prototype.destroy.call(e)},t.prototype.showEditorDialog=function(e){switch(e){case ht:case st:case Pt:case Mt:case Ot:case Lt:case kt:case St:case Ht:case G:case Y:case Vt:this._ribbonCommand(e);break;default:i("Cannot find the dialog with command name '"+e+"'!")}},t.prototype.executeEditorAction=function(e,t){this._ribbonCommand(e,t)},t.prototype._isFontSizeCustomized=function(){if(h!==null)return h;var e=this.$ribbon.wijribbon("getDropdownList",Wt),t=[Bt,jt,Ft,It,qt,Rt,Ut];return h=!1,n.each(e,function(e,r){if(n.inArray(e,t)===-1)return h=!0,!1}),h},t.prototype._fontSizeCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=4,o="font-size",a=[];t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection());switch(e){case Bt:s=1;break;case jt:s=2;break;case Ft:s=3;break;case It:s=4;break;case qt:s=5;break;case Rt:s=6;break;case Ut:s=7}t._setIEFocus(),t._isFontSizeCustomized()?t._formatFontSpan(r,o,e):n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontSize",!1,s):r.execCommand("FontSize",!1,s),t.options.mode==="bbcode"&&!n.browser.msie&&t._convertFontStyleToStandTag(),t._addtoUndoBuffer()},t.prototype._fontNameCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=t.$ribbon.wijribbon("getDropdownList",zt),o;t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection()),n.each(s,function(t,n){if(e===t)return o=n,!1}),t._setIEFocus(),n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontName",!1,o):r.execCommand("FontName",!1,o),t._isFontSizeCustomized()&&n.browser.msie&&t._formatFontSpan(r,"font-family",o),t._addtoUndoBuffer()},t.prototype._formatFontSpan=function(e,t,r){var i=this,s=r,o="fontFamily",u=[];t!=="font-family"&&(s="c1-temp",o="fontSize"),e.execCommand("FontName",!1,s),n.each(n("font[face='"+s+"']",e),function(e,s){var a=i._replaceFontWithSpan(n(s),"face",t,r),f,l;u.push(a),f=n("span."+ms,a);for(l=f.length-1;l>=0;l--)i._removeSpecifiedStyleSpan(n(f[l]),o,t);n.each(a,function(e,r){n.each(n(r).parents("span."+ms),function(e,s){var u=n(s);if(u.children().length>1)return!1;u.text()===n(r).text()&&i._removeSpecifiedStyleSpan(u,o,t)})})}),i._setSelection(u)},t.prototype._replaceFontWithSpan=function(e,t,n,r){e.wrap("<span class = '"+ms+"' style='"+n+":"+r+"'></span>");var i=e.parent();return e.removeAttr(t),/<font\s*>/ig.test(i.html())&&(i.html(e.html()),e.remove()),i},t.prototype._removeSpecifiedStyleSpan=function(e,t,r){var i,s=!0;e[0].style[t]!==""&&e.css(r,""),i=e.attr("style"),i&&n.each(i.split(";"),function(e,t){var i=n.trim(t).toLowerCase();if(i!==""&&i.indexOf(r)!==-1)return s=!1,!1}),s&&e.replaceWith(e.html())},t.prototype._removeFormat=function(){var e=this,t=e._getDesignViewDocument(),r={};t.execCommand(ot,!1,null),e._isFontSizeCustomized()&&n.browser.msie&&e._removeFormatForIE(t),e._addtoUndoBuffer(),r[Z]=!1,r[et]=!1,r[tt]=!1,r[nt]=!1,r[rt]=!1,r[it]=!1,r[$]=!1,r[J]=!1,r[U]=!1,r[z]=!1,r[W]=!1,r[X]=!1,e.$ribbon.wijribbon(S,r)},t.prototype._removeFormatForIE=function(e){var t=e.selection.createRange(),r=t.htmlText,i=t.text,s=0,o=n(t.parentElement()),u=n(e.body),a="",f="",l="__c1temp",c="c1-temp",h="<span class='"+c+"'>"+l+"</span>",p,d,v,m,g,y;o.addClass("c1-app-parent"),t.pasteHTML(h),s=u.text().indexOf(l),p=n("span."+c,e),d=p,p.parentsUntil("body").each(function(e){if(n(this).is(".c1-app-parent"))return!1;d=n(this)}),p.html(r),v=n("span."+ms,p);for(g=v.length-1;g>=0;g--)m=n(v[g]),m.replaceWith(m.html());d.is("."+c)||d.after(p),n.each(d.parents("span."+ms),function(e,t){a+="</span>",f="<span class='"+ms+"' style = '"+n(t).attr("style")+"'>"+f}),r=p.html(),p.replaceWith(l),y=u.html().split(l),u.html(y[0]+a+r+f+y[1]),v=n("span."+ms,e);for(g=v.length-1;g>=0;g--)m=n(v[g]),m.text()===""&&m.replaceWith(m.html());n(".c1-app-parent",e).removeClass("c1-app-parent"),this._setSelection(null,s,i.length)},t.prototype._toggleFullScreen=function(){var e=this,t=e.options;t.fullScreenMode=!t.fullScreenMode,e._setFullScreen(t.fullScreenMode),e.$modes.wijribbon(E,yt,t.fullScreenMode),e.$modes.wijribbon("removeButtonHoverState",yt)},t.prototype._setFullScreen=function(e){var t=this,r=1,i=t._getHeader(),o=t._getFooter(),c=t._getContent(),h=t.options.fullScreenContainerSelector,p=n(h),d=t._getDesignViewText(),v,m,g;e?(p.length===0&&(p=n(s),h="body",t._oriDocOverFlow=n(document.documentElement).css("overflow"),n(document.documentElement).css({overflow:"hidden"}),n.browser.mozilla||window.scrollTo(0,0),n(s).bind("resize.wijeditor",function(){t._fullscreenOnWindowResize()})),v=p.width(),m=p.height()-2*r,a=t.editor.width(),f=t.editor.height(),l||(l=t.editor.parent()),t._replacedDiv||(t._replacedDiv=n("<div />")),t.editor.after(t._replacedDiv),n(h).append(t.editor),t.editor.css({width:v,height:m,position:""}).addClass(Sr),t.$ribbon.wijribbon("updateRibbonSize")):(t._replacedDiv.after(t.editor).remove(),t.editor.css({width:a,height:f,position:"static"}).removeClass(Sr),t.options.fullScreenContainerSelector||n(document.documentElement).css({overflow:t._oriDocOverFlow}),n(s).unbind("resize.wijeditor"),t.$ribbon.wijribbon("updateRibbonSize")),g=t.editor.height()-i.outerHeight(!0)-o.outerHeight(!0),c.height(g).wijsplitter("refresh"),t._addHandlerToDesignView(),t._addDefaultFontStyleToDesignView(),t._createWijMenu(),n.browser.msie&&window.setTimeout(function(){var e=t._getDesignViewDocument();t.options.mode==="bbcode"&&(d=t._convertHtmlToBBCode(n.trim(d))),t._setDesignViewText(d),e&&e.body&&t._restoreSelectionForIE(),u(n.browser.version)>=9&&t.sourceView.val(d)},40),t.$modes.data("wijmo-wijribbon")&&t.$modes.wijribbon(E,yt,e)},t.prototype._createWijMenu=function(){var e=this,t=e._getDesignViewDocument();e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]({orientation:"vertical",trigger:e.designView,triggerEvent:"rtclick",showing:function(t,r){n.browser.msie&&e._saveSelectionForIE();var i=e.designView.offset(),s=n(n(e.designView)[0].contentWindow).scrollLeft(),o=n(n(e.designView)[0].contentWindow).scrollTop(),u=i.left+2-s,a=i.top-o;r.options.position={my:"left+"+u+" "+"top+"+a,at:"right top",of:t,collision:"none none"}},animation:{animated:"fade"},select:function(t,n){e._setIESelection(),e._contextMenuItemClick(t,n),e.contextMenu[e._contextMenuWidgetName()]("deactivate")}})},t.prototype._fullscreenOnWindowResize=function(){var e=this,t=e._getHeader(),r=e._getFooter(),i=e._getContent(),s,o=n(window).width(),u=n(window).height();e.editor.css({width:o,height:u}),s=e.editor.height()-t.height()-r.height(),i.height(s),i.data("wijmo-wijsplitter")&&i.wijsplitter("refresh")},t.prototype._saveText=function(e){},t.prototype._doSpellCheck=function(){},t.prototype._ribbonCommand=function(e,t,r){var i=this,s=i.options.disabled,o=i._getDesignViewDocument(),u=i._getContent(),a,f=u.height()/2,l,c,h;if(t===zt){i._fontNameCommand(e),i._onDesignViewBlur(null);return}if(t===Wt){i._fontSizeCommand(e),i._onDesignViewBlur(null);return}!i.editor.hasClass("ui-helper-hidden-accessible")&&!s&&(r?setTimeout(function(){i._setIEFocus()},0):n.browser.msie&&i.focus());switch(e){case Xt:n.browser.msie?(o.execCommand("FormatBlock",!1,"<ADDRESS>"),i._isIE11&&o.getSelection?(a=o.getSelection(),a&&a.anchorNode&&(h=n(a.anchorNode).closest("address"))):(h=o.selection.createRange(),h=n(h.parentElement()).closest("address")),h.length&&(h.replaceWith("<blockquote>"+h.html()+"</blockquote>"),o.body.innerHTML=o.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>"),o.body.innerHTML=o.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>"),o.body.innerHTML=o.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,""))):o.execCommand("FormatBlock",!1,"<BLOCKQUOTE>"),i._addtoUndoBuffer(),i._setFocusNotIE();break;case x:l=i._generateUniqueName("form"),i.insertHTML('<form id="'+l+'" name="'+l+'" method="post">'+l+"</form>"),i._setFocusNotIE();break;case T:l=i._generateUniqueName("image"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="image"'+' value="'+l+'"/>'),i._setFocusNotIE();break;case N:l=i._generateUniqueName("textarea"),i.insertHTML('<textarea id="'+l+'" name="'+l+'" rows="4" cols="48"></textarea>'),i._setFocusNotIE();break;case C:l=i._generateUniqueName("button"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="button"'+' value="'+l+'"/>'),i._setFocusNotIE();break;case k:l=i._generateUniqueName("textbox"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="text"'+' value="'+l+'"/>'),i._setFocusNotIE();break;case L:l=i._generateUniqueName("list"),i.insertHTML('<select id="'+l+'" name="'+l+'" style="width: 120px" size="8"></select>'),i._setFocusNotIE();break;case A:l=i._generateUniqueName("password"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="password" value="'+l+'"/>'),i._setFocusNotIE();break;case O:l=i._generateUniqueName("dropdown"),i.insertHTML('<select id="'+l+'" name="'+l+'"></select>'),i._setFocusNotIE();break;case M:l=i._generateUniqueName("hidden"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="hidden" value="'+l+'" />'),i._setFocusNotIE();break;case _:l=i._generateUniqueName("radiobox"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="radio"'+' value="'+l+'">'+'<label for="'+l+'">'+l+"</label></input>"),i._setFocusNotIE();break;case D:l=i._generateUniqueName("checkbox"),i.insertHTML('<input id="'+l+'" name="'+l+'" type="checkbox"'+' value="'+l+'">'+'<label for="'+l+'">'+l+"</label></input>"),i._setFocusNotIE();break;case P:case H:case B:case j:case F:case I:case q:case R:i._tableAction(e);break;case V:i._toggleTableBorders();break;case rt:try{o.queryCommandState(it)&&(o.execCommand(it,!1,null),i.$ribbon.wijribbon(E,it,!1))}catch(p){}o.execCommand(rt,!1,null),i._addtoUndoBuffer(),i._setFocusNotIE();break;case it:try{o.queryCommandState(rt)&&(o.execCommand(rt,!1,null),i.$ribbon.wijribbon(E,rt,!1))}catch(d){}o.execCommand(it,!1,null),i._addtoUndoBuffer(),i._setFocusNotIE();break;case ot:i._removeFormat(),i._setFocusNotIE();break;case ut:i.insertHTML("<br/>"),i._setFocusNotIE();break;case at:c=i._getSelectedContent();if(!c||c==="")c="&nbsp;";i.insertHTML("<p>"+c+"</p>"),i._setFocusNotIE();break;case ft:i.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>'),i._setFocusNotIE();break;case yt:i._storeSelectionForIE(),i._toggleFullScreen();break;case bt:i._undoAction(),i._setFocusNotIE();break;case wt:i._redoAction(),i._setFocusNotIE();break;case xt:i._execCut(),i._setFocusNotIE();break;case Tt:i._execCopy();break;case Nt:i._execPaste();break;case At:i.insertDateAndTime(),i._setFocusNotIE();break;case dt:i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(b,gt,!0).wijribbon(E,dt,!0),i.$ribbon.wijribbon("option","disabled",!1),u.wijsplitter("option","panel2",{collapsed:!0}),i._restoreSelectionForIE();break;case vt:i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(b,gt,!0).wijribbon(E,vt,!0),i.$ribbon.wijribbon("option","disabled",!1),u.wijsplitter("option",{splitterDistance:f,panel1:{collapsed:!1},panel2:{collapsed:!1}});break;case mt:i.$modes.data("wijmo-wijribbon")&&i.$modes.wijribbon(b,gt,!1).wijribbon(E,mt,!0),i._storeSelectionForIE(),i.$ribbon.wijribbon("option","disabled",!0),u.wijsplitter("option","panel1",{collapsed:!0}),n.browser.msie&&!s&&i.sourceView.focus();break;case gt:u.wijsplitter("option","panel1").collapsed&&i._toggleWordWrap();break;case G:i._saveSelectionForIE(),i._createDialog(this.localizeString("backColorDialogTitle","Set BackColor"),i._getDialogRes_BackColor(),i.initBackColorDialog);break;case Y:i._saveSelectionForIE(),i._createDialog(this.localizeString("foreColorDialogTitle","Set ForeColor"),i._getDialogRes_ForeColor(),i.initForeColorDialog);break;case ht:i._saveSelectionForIE(),i._createDialog(this.localizeString("insertTableDialogTitle","Insert Table"),i._getDialogRes_Table(),i.initInsertTableDialog);break;case pt:i._getEditableTable()&&i._createDialog(this.localizeString("editTableDialogTitle","Edit Table"),i._getDialogRes_Table(),i.initEditTableDialog);break;case Et:i._createDialog(this.localizeString("previewDialogPreview","Preview"),i._getDialogRes_Preview(),i.initPreviewDialog);break;case St:i._createDialog(this.localizeString("cleanUpDialogTitle","Clean up source HTML document"),i._getDialogRes_CleanUp(),i.initCleanUpDialog);break;case kt:i._saveSelectionForIE(),i._createDialog(this.localizeString("mediaDialogTitle","Insert media"),i._getDialogRes_Media(),i.initMediaDialog);break;case Lt:i._saveSelectionForIE(),i._createDialog(this.localizeString("specialCharacterDialogTitle","Insert special character"),i._getDialogRes_SpecialCharacter(),i.initSpecialCharacterDialog);break;case Ot:i._createDialog(this.localizeString("findAndReplaceTitle","Find and replace"),i._getDialogRes_FindAndReplace(),i.initFindDialog);break;case Mt:y=i._getSelectedElement(),i._createDialog(this.localizeString("tagInspectorDialogTitle","Tag Inspector"),i._getDialogRes_TagInspector(),i.initTagInspectorDialog);break;case st:i._saveSelectionForIE(),i._createDialog(this.localizeString("templateDialogApplyTemplate","Apply Template"),i._getDialogRes_Template(),i.initTemplateDialog);break;case Pt:i._saveSelectionForIE(),i._createDialog(this.localizeString("imageEditorDialogImageBrowser","Image Browser"),i._getDialogRes_ImageBrowser(),i.initImageBrowserDialog);break;case Ht:i._storeSelectionForIE(),i._createDialog(this.localizeString("hyperLinkDialogInserthyperLink","Insert hyperLink"),i._getDialogRes_Link(),i.initHyperLinkDialog);break;case Vt:i._saveSelectionForIE(),i._createDialog("Insert Code",i._getDialogRes_Code(),i.initInsertCodeDialog);break;case U:case z:case W:case X:case K:case Q:case Z:case et:case nt:case $:case J:case tt:case lt:case Ct:o.execCommand(e,!1,null),i.options.mode==="bbcode"&&!n.browser.msie&&i._convertStyleToStandTag(),i._addtoUndoBuffer(),i._setFocusNotIE();break;case _t:i._saveText();break;case Dt:i._doSpellCheck()}i._onDesignViewBlur(null)},t.prototype._createDialog=function(e,t,r){var i=this,s,o=i.dialog;o.html("").undelegate(i.widgetName).undelegate("."+i.widgetName).append(t),i.subDialog&&i.subDialog.html("").undelegate(i.widgetName).undelegate("."+i.widgetName),s={width:"auto",height:"auto",modal:!0,title:e,position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},o.data("wijmo-wijdialog")?(o.wijdialog("reset"),o.wijdialog("option",{width:"auto",height:"auto",title:e})):n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){o.wijdialog(s)},0):o.wijdialog(s),i._adjustDialogLayoutForIE7(),r&&r.call(i),o.wijdialog("open")},t.prototype._adjustDialogLayoutForIE7=function(){var e=this.dialog;n.browser.msie&&(/^7\.[0-9]+/.test(n.browser.version)||document.documentMode===7)&&e.wijdialog("option","width",e.parent().width())},t.prototype._contextMenuItemClick=function(e,t,n){var r=this,i=t.item.element.attr("_c1buttoncmd");switch(i){case xt:r._execCut();break;case Tt:r._execCopy();break;case Nt:r.focus(),r._execPaste()}},t.prototype._execCut=function(){var e=this,t=e._getDesignViewDocument();n.browser.safari?i(this.localizeString("errorMessageCutError","This function is not supported in current browser.  Plesse use (Ctrl + X).")):n.browser.msie?(t.execCommand("Cut",!1,null),e._addtoUndoBuffer()):(e._execCopy(),e._deleteSelectionContent(),e._addtoUndoBuffer())},t.prototype._execCopy=function(){var e=this,t=e._getDesignViewDocument();n.browser.safari?i(this.localizeString("errorMessageCopyError","This function is not supported in current browser. Plesse use (Ctrl + C).")):n.browser.msie?(t.execCommand("Copy",!1,null),e._addtoUndoBuffer()):e._copyToClipboard(e._getSelectedContent())},t.prototype._execPaste=function(){var e=this,t,r=e._getDesignViewDocument();if(n.browser.safari)i(this.localizeString("errorMessagePasteError","This function is not supported in current browser. Plesse use (Ctrl + V)."));else if(n.browser.msie)r.execCommand("Paste",!1,null),e._addtoUndoBuffer();else try{t=e._copyFromClipboard(),t&&t!==""&&e.insertHTML(t)}catch(s){}},t.prototype._getFontSizeCollection=function(){return{"10px":Bt,"13px":jt,"16px":Ft,"18px":It,"24px":qt,"32px":Rt,"48px":Ut,1:Bt,2:jt,3:Ft,4:It,5:qt,6:Rt,7:Ut}},t.prototype._updateButtonStates=function(e){var t=this,r=t._getDesignViewDocument(),i,s,o={},u=[Z,et,tt,nt,rt,it,$,J,U,z,W,X],a,f=e.target,l=n(f);n.each(u,function(e,t){o[t]=r.queryCommandState(t)}),t.$ribbon.wijribbon(S,o),i=t._queryCommandValue(zt)||"",n.each(t.$ribbon.wijribbon("getDropdownList",zt),function(e,t){if(t.toUpperCase()===i.toUpperCase())return s=e,!1}),t.$ribbon.wijribbon(E,s,!0,zt),t._isFontSizeCustomized()?(l.is("span")?s=f.style.fontSize:s="",s===""&&(a=l.parents("span."+ms),n.each(a,function(e,t){s=t.style.fontSize;if(s&&s!=="")return!1})),s===""&&(s=l.css("font-size"))):(i=t._queryCommandValue(Wt)||"",i===""&&(i=l.css("font-size")),n.each(t._getFontSizeCollection(),function(e,t){if(e.toString()===i.toString())return s=t,!1})),t.$ribbon.wijribbon(E,s,!0,Wt)},t.prototype._queryCommandValue=function(e){var t=this._getDesignViewDocument();try{if(!t.queryCommandEnabled(e))return null}catch(n){return null}try{return t.queryCommandValue(e)}catch(r){}return null},t.prototype._escActionAssociated=function(){var e=this,t=e._getDesignViewWindow();t&&t.document&&t.document.selection!==undefined&&t.document.selection.empty(),t&&t.getSelection!==undefined&&t.getSelection().removeAllRanges(),e._hideAllDropdownsMenus()},t.prototype._hideAllDropdownsMenus=function(){var e=this;e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]("hideAllMenus"),e.$ribbon.wijribbon("hideDropdown",zt).wijribbon("hideDropdown",Wt).wijribbon("hideDropdown",ct)},t.prototype._onDesignViewKeyDown=function(e){var t=this,n;t._setSaveBtnEnabled();try{if(e.ctrlKey)n=String.fromCharCode(e.keyCode).toLowerCase();else switch(e.keyCode){case 27:t._escActionAssociated();break;case 13:case 46:t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1;break;default:t._continueSavingInputTextForUndo=!0}}catch(r){}},t.prototype._onDesignViewKeyUp=function(e){var t=this,r;if(e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40||e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36)n.browser.msie&&n.browser.version==="6.0"?(t._keyTimeoutHandlerIE6&&(clearTimeout(t._keyTimeoutHandlerIE6),t._keyTimeoutHandlerIE6=null),t._keyTimeoutHandlerIE6=window.setTimeout(function(){t._updateButtonStates(e)},300)):t._updateButtonStates(e);if(e.ctrlKey){r=String.fromCharCode(e.keyCode).toLowerCase();switch(r){case"y":t._redoAction(),e.preventDefault(),e.stopPropagation();break;case"z":t._undoAction(),e.preventDefault(),e.stopPropagation();break;case"x":case"v":t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1}}},t.prototype._onDesignViewMouseUp=function(e){var t=this,r;if(e.button===2)return;t._updateButtonStates(e),t._refreshPathSelector(),t._hideAllDropdownsMenus(),n(document).mouseup();if(n.browser.msie){r=n(e.target).closest("a");if(e.ctrlKey&&r.length>0)try{r.focus(),s.open(r[0].href,"_blank")}catch(i){}}},t.prototype._onDesignViewBlur=function(e){var t=this,r=t.options,i;i=t._getDesignViewText(),r.mode==="bbcode"&&(i=t._convertHtmlToBBCode(n.trim(i))),t.sourceView.val(i),t._onTextChange(e),r.text=i},t.prototype._onTextChange=function(e){var t=this;t._continueSavingInputTextForUndo&&(t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1),t._trigger("textChanged",e,{text:t.options.text})},t.prototype._onSourceViewBlur=function(){var e=this,t;t=e.sourceView.val(),e._setDesignViewText(t),e.options.text=t},t.prototype._convertBBCodeToHtml=function(e){return e?(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),n.browser.msie&&(e=e.replace(/&lt;p&gt;/gim,"<p>"),e=e.replace(/&lt;\/p&gt;/gim,"</p>")),e=e.replace(/(?:\r\n|\n|\r)/g,"<br>"),e=e.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>'),e=e.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>'),e=e.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>'),e=e.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>'),e=e.replace(/\[B\]/gim,"<b>"),e=e.replace(/\[\/B\]/gim,"</b>"),e=e.replace(/\[I\]/gim,"<i>"),e=e.replace(/\[\/I\]/gim,"</i>"),e=e.replace(/\[S\]/gim,"<strike>"),e=e.replace(/\[\/S\]/gim,"</strike>"),e=e.replace(/\[U\]/gim,"<u>"),e=e.replace(/\[\/U\]/gim,"</u>"),e=e.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>'),e=e.replace(/\[BLOCK\]/gim,"<blockquote>"),e=e.replace(/\[\/BLOCK\]/gim,"</blockquote>"),e=e.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>"),e=e.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>"),e=e.replace(/\[\*\]/gim,"</li><li>"),e=e.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">'),e=e.replace(/\[\/size\]/gim,"</font>"),e=e.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">'),e=e.replace(/\[\/color\]/gim,"</font>"),e):""},t.prototype._replaceComplexHtml=function(e){var t,r,i,s,o=n("<div/>").html(e);t=n("img",o),n.each(t,function(){i="[IMG height="+n(this).height()+" width="+n(this).width()+"]"+n(this).attr("src").toString()+"[/IMG]",n(this).replaceWith(i)}),r=n("font",o);for(s=r.length-1;s>=0;s--)n(r[s]).attr("color")&&n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"]"+"[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size][/Color]":n(n(r[s])).attr("color")&&!n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"] "+n(n(r[s])).html()+"[/Color]":n(n(r[s])).attr("size")&&!n(n(r[s])).attr("color")&&(i="[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size]"),n(n(r[s])).replaceWith(i);return o.html()},t.prototype._convertHtmlToBBCode=function(e){var t=this;if(e==="")return;return e=t._replaceComplexHtml(e),e=e.replace(/<br(?=[ \/>]).*?>/gim,"\r\n"),n.browser.msie&&(e=e.replace(/<p>/gim,"&lt;p&gt;"),e=e.replace(/<\/p>/gim,"&lt;/p&gt;")),e=e.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]"),e=e.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]"),e=e.replace(/<(?:b|strong)>/gim,"[B]"),e=e.replace(/<\/(?:b|strong)>/gim,"[/B]"),e=e.replace(/<(?:i|em)>/gim,"[I]"),e=e.replace(/<\/(?:i|em)>/gim,"[/I]"),e=e.replace(/<(?:strike|s)>/gim,"[S]"),e=e.replace(/<\/(?:strike|s)>/gim,"[/S]"),e=e.replace(/<u>/gim,"[U]"),e=e.replace(/<\/u>/gim,"[/U]"),e=e.replace(/<blockquote.*?\>/gim,"[BLOCK]"),e=e.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]"),e=e.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]"),e=e.replace(/<\/(?:ol)>/gim,"[/LIST]"),e=e.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]"),e=e.replace(/<\/(?:ul)>/gim,"[/LIST]"),e=e.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1"),e=e.replace(/&nbsp;/gi," "),e=e.replace(/(<[^>]+>)/gm,""),e},t.prototype._convertFontStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o=n("[style*='color: ']",r);o.length!==0&&(i=o,s="<font color='"+e._getWebColorFromRgb(o.css("color"))+"'></font>"),i&&n.each(i,function(e){n(this).is("span")?n(this).replaceWith(n(s).html(n(this).html())):n(this).is("font")&&n(this).attr("size")&&n(this).removeAttr("style").html(n(s).html())})},t.prototype._convertStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o,u=n("[style*='font-weight: bold;']",r),a=n("[style*='font-style: italic;']",r),f=n("[style*='text-decoration: line-through;']",r),l=n("[style*='text-decoration: underline;']",r);u.length!==0?(i=u,s="<b></b>",o="font-weight"):a.length!==0?(i=a,s="<i></i>",o="font-style"):f.length!==0?(i=f,s="<strike></strikes>",o="text-decoration"):l.length!==0&&(i=l,s="<u></u>",o="text-decoration"),i&&n.each(i,function(e){n(this).is("span")&&this.style.fontSize===""?n(this).replaceWith(n(s).html(n(this).html())):n(this).removeAttr("style").html(n(s).html())})},t.prototype._getWebColorFromRgb=function(e){var t=this,n;return e.indexOf("rgb(")===0&&(n=e.substring(4,e.length-1).split(","),e=t._convertToWebColor(u(n[0]),u(n[1]),u(n[2]))),e},t.prototype._updateList=function(e,t){var r;n("option",t).remove();for(r in e)e[r]&&t.append("<option>"+r+"</option>")},t.prototype._triggerEvent=function(e,t){var n=this,r=n.options[e];return r&&typeof r=="function"?r.call(n,t):r},t.prototype._closeDialog=function(){this.dialog.wijdialog("close"),g=null,this.focus()},t.prototype._onTemplateList=function(e){return this._triggerEvent("templateList",e)},t.prototype.updateTemplateList=function(e,t){var r=this,i=t||n("select",r.dialog);r._updateList(e,i),r._templateList=e},t.prototype.initTemplateDialog=function(){var e=this,t=e.dialog,r=n("select",t),i=e._onTemplateList();t.delegate("select","change."+e.widgetName,function(){e.templateListOnChanged()}).delegate("."+ei,"click."+e.widgetName,function(){e.deleteTemplate()}).delegate("."+ti,"click."+e.widgetName,function(){e.saveTemplate()}).delegate(gs,"click."+e.widgetName,function(){e.applyTemplate()}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()});if(!i){i=e._templateList;if(!i)return}e.updateTemplateList(i,r)},t.prototype.templateListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=n("iframe",t),s=e._templateList,o;if(!s)return;o=s[r],o.src&&i.attr("src",o.src+"?d="+(new Date).getMilliseconds().toString()),o.text&&i.length>0&&i[0].contentWindow.document.write(o.text),r&&(n("."+Jr,t).html(r),n("."+Gr,t).val(r)),o.desc&&(n("."+Kr,t).html(o.desc),n("."+Yr,t).val(o.desc))},t.prototype._onSaveTemplate=function(e){this._triggerEvent("saveTemplate",e)},t.prototype.saveTemplate=function(){var e=this,t=e.dialog,r=n("."+Gr,t).val(),s=n("."+Yr,t).val(),o=e._templateList,u=this._getDesignViewText();if(n.trim(r)===""){i(this.localizeString("errorMessageTemplateNameError","Please input a template name!"));return}o||(e._templateList=[],o=e._templateList),o[r]||n("select",t).append("<option>"+r+"</option>"),o[r]={desc:s,text:u},e._onSaveTemplate({name:r,desc:s,text:u})},t.prototype._onDeleteTemplate=function(e){this._triggerEvent("deleteTemplate",e)},t.prototype.deleteTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=e._templateList;if(n.trim(s)===""){i(this.localizeString("errorMessageTemplateFileError","Please select a template file."));return}n("option:selected",r).remove(),n("iframe",t).attr("src","about:blank"),n("."+Jr,t).empty(),n("."+Gr,t).val(""),n("."+Kr,t).empty(),n("."+Yr,t).val(""),delete o[s],e._onDeleteTemplate(s)},t.prototype.applyTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=n("iframe",t)[0],u=n("."+Gr,t).val(),a=o.contentWindow.document.body.innerHTML;if(n.trim(u)===""||n.trim(s)===""){i(this.localizeString("errorMessageValidTemplateFileError","Please select a valid template file."));return}e._setDesignViewText(a),e._addtoUndoBuffer(),e._setSaveBtnEnabled(),e._closeDialog()},t.prototype._onImageList=function(){var e=this,t=e.options.imageList;return t&&typeof t=="function"?t.call(e):t},t.prototype.updateImageList=function(e,t){var r=this,i=r.dialog,s=t||n("select",i),o=n("."+Mr,i);r._updateList(e,s),r._imgList=e;if(!e){o.addClass(Ir);return}o.removeClass(Ir)},t.prototype.initImageBrowserDialog=function(){var e=this,t=e.dialog,r=e._onImageList();n("img",t).hide(),t.delegate("select","change."+e.widgetName,function(){e.imageListOnChanged()}).delegate(gs,"click."+e.widgetName,function(t){e.submitInsertImageDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}),n("."+Pr+" input",t).bind("change."+e.widgetName,function(){e.imageUrlChanged(this)});if(!r){r=e._imgList;if(!r){n("."+Mr,t).addClass(Ir);return}}e.updateImageList(r,n("select",t))},t.prototype.imageUrlChanged=function(e){var t=this,r=t.dialog;n("img",this.dialog).attr("src",n(e).val()+"?"+(new Date).getTime()).show().bind("load",function(){n("."+Br+" input",r).val(n("img",r).width().toString()),n("."+jr+" input",r).val(n("img",r).height().toString())})},t.prototype.imageListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=e._imgList,o;if(!i)return;o=i[r],n("img",t).prop("src",o).show(),n("."+Pr+" input",t).prop("value",o),s.setTimeout(function(){n("."+Br+" input",t).val(n("img",t).width().toString()),n("."+jr+" input",t).val(n("img",t).height().toString())},200)},t.prototype.submitInsertImageDialog=function(){var e=this,t,r=e.dialog,s=n("."+Pr+" input",r).val(),o=n("."+Hr+" input",r).val(),u=n("."+Br+" input",r).val(),a=n("."+jr+" input",r).val(),f=n("."+Fr+" input",r).val();if(n.trim(s)===""){i(this.localizeString("errorMessageSelectImageError","Please select a image."));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageImageWidthError","Please input a number for 'Image width' textbox."));return}if(!e._isNumeric(a)){i(this.localizeString("errorMessageImageHeightError","Please input a number for 'Image height' textbox."));return}e.focus(),n.browser.msie?(t='<img src="'+s+'" alt="'+o+'" style="width:'+u+"px;height:"+a+"px",e.options.mode!=="bbcode"&&f!==null&&f!==undefined&&f.length>0&&(t+=";"+f)):(t='<img src="'+s+'" alt="'+o+'" width="'+u+'" height="'+a,e.options.mode!=="bbcode"&&(t+='" style="'+f)),t+='"/>',e.insertHTML(t),e._closeDialog()},t.prototype.initHyperLinkDialog=function(){var e=this,t=e.dialog,r=e.getLinkHrefField(),i=n("."+hi,t),o,u,a,f=n("."+ri+" input",t);t.one("wijdialogclose",function(){e._restoreSelectionForIE()}),t.delegate(gs,"click."+e.widgetName,function(t){e.submitHyperLinkDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+si,"change."+e.widgetName,function(){e.anchorListOnChanged(this)}).delegate("."+ii+">div","click."+e.widgetName,function(){e.radioListOnChanged()}).delegate("."+pi+">div","click."+e.widgetName,function(){e.linkIconTypeOnChanged()}).delegate("."+fi+" input","change."+e.widgetName,function(){e.tempImg=n('<img src="'+n("."+fi+" input",t).val()+'">').appendTo("body"),s.setTimeout(function(){n("."+li+" input",t).val(e.tempImg.width().toString()),n("."+ci+" input",t).val(e.tempImg.height().toString()),e.tempImg.remove(),e.tempImg=undefined},200)});try{f.val(r),u=e._getLinkInnerHTML()}catch(l){}u&&u.substring(0,3)==="<img"?(o=!0,a=n(u)):o=!1,o?(i.show(),n("."+oi+" textarea",t).hide(),n("."+fi+" input",t).val(a.attr("src")),n("."+li+" input",t).val(a.attr("width")),n("."+ci+" input",t).val(a.attr("heigth"))):(n("."+oi+" textarea",t).show(),i.hide(),n("."+oi+" textarea",t).val(u)),n("."+ai+" input",t).val(e._getLinkCssField()),n("."+ui+" select",t).val(e._getLinkTarget()),n("#radAnchor",t).prop("checked",!0),n("#radLinkTypeIsText",t).prop("checked",!0),r.length>6&&(r.substring(0,4)==="http"?n("#radUrl",t).prop("checked",!0):r.substring(0,6)==="mailto"?n("#radMail",t).prop("checked",!0):r.substring(0,1)==="#"?n("#radAnchor",t).prop("checked",!0):n("#radFile",t).prop("checked",!0)),a=undefined},t.prototype._getLinkInnerHTML=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return t.innerHTML||""}catch(n){}return""},t.prototype.getLinkHrefField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return e.fixAbsoluteUrlsIfNeeded(t.href||"")}catch(n){}return""},t.prototype._getLinkTarget=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return t.target||""}catch(n){}return""},t.prototype._getLinkCssField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{t=e._getHyperLinkElement(t);if(t&&t.tagName==="A")return t.style.cssText||""}catch(n){}return""},t.prototype.submitHyperLinkDialog=function(){var e=this,t=e.dialog,r=n("#radUrl",t),s=n("#radAnchor",t),o=n("#radMail",t),u=n("."+ri+" input",t),a=n("."+oi+" textarea",t),f=n("."+ai+" input",t),l=n("."+ui+" select",t),c=u.val(),h=a.val(),p=l.val(),d=n("#radLinkTypeIsImage",t),v=d.prop("checked"),m=n("."+fi+" input",t).val(),g=n("."+li+" input",t).val(),y=n("."+ci+" input",t).val(),b=f.val();if(c===""){i(this.localizeString("errorMessageAddressError","Please input address!"));return}if(h===""&&!v){i(this.localizeString("errorMessageDisplayTextError","Please input display text!"));return}if(m===""&&v){i(this.localizeString("errorMessageHyperLinkImageUrlError","Please input image url!"));return}if(!e._isNumeric(g)&&v){i(this.localizeString("errorMessageHyperLinkImageWidthError","Please input correct image width!"));return}if(!e._isNumeric(y)&&v){i(this.localizeString("errorMessageHyperLinkImageHeightError","Please input correct image height!"));return}if(r.prop("checked")&&!e._isUrl(c)){i(this.localizeString("errorMessageHyperLinkUrl","Please input correct url!"));return}if(s.prop("checked")&&!e._isAnchor(c)){i(this.localizeString("errorMessageHyperLinkAnchor","Please input correct anchor!"));return}if(o.prop("checked")&&!e._isEmail(c)){i(this.localizeString("errorMessageHyperLinkEmail","Please input correct email!"));return}v&&(h='<img src="'+m+'" width="'+g+'" height="'+y,h+='"/>'),e._closeDialog(),e._editLink(h,c,b,p)},t.prototype._editLink=function(e,t,n,r){var i=this,s="",o;i.focus(),o=i._getInspectElement();try{o=i._getHyperLinkElement(o);if(o&&o.tagName==="A"){o.innerHTML=e,o.href=t,o.target=r,n!==o.style.cssText&&(o.style.cssText=n),i._addtoUndoBuffer(),i._setSaveBtnEnabled();return}}catch(u){}s='<a href="'+t+'" target="'+r+'"',n!==""&&(s+=' style="'+n+'"'),s+=">"+e+"</a>",i.insertHTML(s)},t.prototype.anchorListOnChanged=function(e){var t=this,r=t.dialog,i=n(e).val();i!==""&&(n("."+ri+" input",r).val(i),n("#radAnchor",r).attr("checked","checked"))},t.prototype.radioListOnChanged=function(){var e=this,t=e.dialog,r=n("."+si,t),i=n("."+ri+" input",t);i.val(""),n("#radUrl",t).is(":checked")?r.hide():n("#radAnchor",t).is(":checked")?r.show():n("#radMail",t).is(":checked")?(r.hide(),i.val("mailto:")):n("#radFile",t).is(":checked")&&r.hide()},t.prototype.linkIconTypeOnChanged=function(){var e=this,t=e.dialog,r=n("."+hi,t),i=n("."+oi,t);n("#radLinkTypeIsText",t).is(":checked")?(i.show(),r.hide()):n("#radLinkTypeIsImage",t).is(":checked")&&(i.hide(),r.show())},t.prototype._getDialogRes_Code=function(){var e=this,t=e._createDiv(ni);return t.add(e._createElement("div","Enter source code",{"class":mi})),t.add(e._createElement("textarea","",{"class":vi})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype.initInsertCodeDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitCodeDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCodeDialog=function(){var e=this,t=e.dialog,r=n("."+vi,t),i=r.val();if(i==="")return;i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i="<pre>"+i+"</pre>",e._setIESelection(),e.insertHTML(i),e._closeDialog()},t.prototype.initTagInspectorDialog=function(){var e=this,t=e.dialog,r=n("."+Ti);t.delegate(gs,"click."+e.widgetName,function(t){e.submitTagInspectorDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}).delegate("#displayNoEmpty","click."+e.widgetName,function(){e.tagInspectorDialogSwitchAttList(this)}),e._laySelectedElementAttributes(n("."+xi,t),n("."+wi,t)),n("."+Ni+" input",t).val(e._getSelectedElementStyle()),e._selectedElementCanHaveChildren()?(r.show(),n("textarea",r).val(e._getSelectedElementInnerHTML())):r.hide()},t.prototype.submitTagInspectorDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i=n("."+xi,t),s=n("."+Ni+" input").val(),o=n("."+Ti+" textarea").val();try{n.each(n("input:checkbox",i),function(e,t){var i,s,o=n(t);o.is(":checked")&&(i=o.siblings("span").text(),i=i.substring(0,i.length-1),s=o.siblings("input:text").val(),n(r).attr(i,s))}),n.trim(s)!==""&&(r.style.cssText=s),e._selectedElementCanHaveChildren()&&n(r).html(o)}catch(u){}e._closeDialog(),e._addtoUndoBuffer(),e._setSaveBtnEnabled()},t.prototype.tagInspectorDialogSwitchAttList=function(e){var t=n("."+xi,this.dialog),r=!e.checked;n.each(n("input:text",t),function(e,t){n(t).val()===""&&n(t).parent("li")[r?"show":"hide"]()})},t.prototype._laySelectedElementAttributes=function(e,t){var r=this,i=r._getInspectElement(),s,o,u,a=this.localizeString("tagInspectorDialogSave","Save"),f="";if(!i)return;t.html(i.tagName),s=r._getDictionaryDeclare(),o=i.tagName.toLowerCase(),u=s[o];switch(o){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":f+="<ul class='ui-helper-reset'>",n.each(u,function(e,t){var n=i.getAttribute(t)||"";f+="<li><span class='"+kr+"'>",f+=t+":</span>",f+="<input type='text' value='"+n+"'/>",f+="<input type='checkbox' id='save"+e+"'/>",f+="<label for='save"+e+"'>"+a+"</label></li>"})}e.html(f)},t.prototype._getSelectedElementStyle=function(){var e=this._getInspectElement();return e&&e.style?e.style.cssText||"":""},t.prototype._getSelectedElementInnerHTML=function(){var e=this._getInspectElement();return e?e.innerHTML:""},t.prototype._selectedElementCanHaveChildren=function(){return!n(this._getInspectElement()).is("input,hr,br,img")},t.prototype.initBackColorDialog=function(){this._initColorDialog("BackColor")},t.prototype.initForeColorDialog=function(){this._initColorDialog("ForeColor")},t.prototype._initColorDialog=function(e){var t=this,r=t.dialog,i=t._getDesignViewDocument(),s=i.queryCommandValue(e),o,a,f;r.delegate(gs,"click."+t.widgetName,function(n){t.submitColorDialog(e),t._onDesignViewBlur(n)}).delegate(ys,"click."+t.widgetName,function(){t._closeDialog()}),s&&(f=s.toString(),n.browser.mozilla&&f==="transparent"&&(f="#ffffff"),n.browser.msie&&(o=u(f),f="rgb("+(o&255)+", "+((o&65280)>>8)+", "+((o&16711680)>>16)+")"),f.indexOf("rgb(")===0?(a=f.substring(4,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))):f.indexOf("rgba(")===0&&(a=f.substring(5,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))),n("."+Li+" input",r).attr("value",f)),n("."+ki,r).wijeditorcolorcanvas("."+Li+" input",f)},t.prototype.submitColorDialog=function(e){var t=this,r=n("."+Li+" input",t.dialog);t.setColor(e,r.val()),t._closeDialog()},t.prototype.setColor=function(e,t){var r=this,i,s=r._getDesignViewDocument(),o=r._getDesignViewWindow(),u;r._setIESelection(),n.browser.mozilla&&e==="BackColor"?(u=o.getSelection(),r.insertHTML('<span style="background-color:'+t+';">'+u+"</span>")):(s.execCommand(e,!1,t),n.browser.msie&&(i=r._getHtmlTextInIE(s),i.indexOf("<U>")>=0&&i.indexOf("</U>")>=0&&(s.execCommand("Underline",!1,!1),s.execCommand("Underline")),i.indexOf("<STRIKE>")>=0&&i.indexOf("</STRIKE>")>=0&&(s.execCommand("StrikeThrough",!1,!1),s.execCommand("StrikeThrough"))),r.options.mode==="bbcode"&&!n.browser.msie&&r._convertFontStyleToStandTag()),r._addtoUndoBuffer(),r._setSaveBtnEnabled()},t.prototype.initInsertTableDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitInsertTableDialog(),e._onDesignViewBlur(t)}).delegate(ws,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Fi+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)})},t.prototype.submitInsertTableDialog=function(){var e=this,t=e._getValuesFromTableDialog();if(!t)return;e._insertTable(t),e._closeDialog()},t.prototype._insertTable=function(e){var t=this,r="",i,s;if(!e)return!1;t.focus(),r+='<table width="'+e.width+'" height="'+e.height+'" cellspacing="'+e.cspacing+'" cellpadding="'+e.cpadding+'" border="'+e.border+'" bgcolor="'+e.bgcolor+'" style="'+e.css+'">';for(i=0;i<e.rows;i++){r+="<tr>";for(s=0;s<e.cols;s++)r+="<td>Cell "+(i+1)+"-"+(s+1)+"</td>";r+="</tr>"}r+="</table>";if(n.browser.mozilla||n.browser.msie&&u(n.browser.version)>=9)r+="<br />";t.insertHTML(r)},t.prototype.initEditTableDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i,s;t.delegate(gs,"click."+e.widgetName,function(t){e.submitEditTableDialog(),e._onDesignViewBlur(t)}).delegate(ws,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Fi+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)});if(!r)return;try{i=r.rows,i.length>0?s=i[0].cells.length:s=0,i=i.length}catch(o){}n("."+Oi+" input",t).val(i),n("."+Mi+" input",t).val(s),n("."+_i+" input",t).val(r.getAttribute("width")),n("."+Di+" input",t).val(r.getAttribute("height")),n("."+Pi+" input",t).val(r.getAttribute("border")),n("."+Hi+" input",t).val(r.getAttribute("cellPadding")),n("."+Bi+" input",t).val(r.getAttribute("cellSpacing")),n("."+Fi+" input",t).val(r.getAttribute("bgcolor")||"#ffffff"),n("."+ji+" input",t).val(r.style.cssText)},t.prototype.submitEditTableDialog=function(){var e=this,t=e._getInspectElement(),r=n(t),i=e._getValuesFromTableDialog(),s=i&&u(i.rows),o=i&&u(i.cols),a,f;if(!i)return;if(t){r.attr("width",i.width),r.attr("height",i.height),r.attr("bgcolor",i.bgcolor),r.attr("border",i.border),r.attr("cellSpacing",i.cspacing),r.attr("cellPadding",i.cpadding),t.style.cssText=i.css;if(!s||isNaN(s))return;if(!o||isNaN(o))return;while(t.rows.length>s)t.deleteRow(0);while(t.rows.length<s){a=t.insertRow(0);while(a.cells.length<o)f=a.insertCell(0),f.innerHTML="&nbsp;"}n.each(t.rows,function(e,t){while(t.cells.length>o)t.deleteCell(0);while(t.cells.length<o)f=t.insertCell(0),f.innerHTML="&nbsp;"})}e._closeDialog()},t.prototype._getValuesFromTableDialog=function(){var e=this,t=e.dialog,r=n("."+Oi+" input",t).val(),s=n("."+Mi+" input",t).val(),o=n("."+_i+" input",t).val(),a=n("."+Di+" input",t).val(),f=n("."+Pi+" input",t).val(),l=n("."+Hi+" input",t).val(),c=n("."+Bi+" input",t).val(),h=n("."+ji+" input",t).val(),p=n("."+Fi+" input",t).val();return e._isNumeric(r)?e._isNumeric(s)?e._isNumeric(o)?e._isNumeric(a)?e._isNumeric(f)?e._isNumeric(l)?e._isNumeric(c)?{rows:r,cols:s,width:u(o),height:u(a),border:f,cpadding:l,cspacing:c,css:h,bgcolor:p}:(i(this.localizeString("tableDialogCellSpacingError","Please input a number for 'Cell Spacing' textbox.")),!1):(i(this.localizeString("tableDialogCellPaddingError","Please input a number for 'Cell Padding' textbox.")),!1):(i(this.localizeString("tableDialogBorderError","Please input a number for 'Border thickness' textbox.")),!1):(i(this.localizeString("errorMessageTableHeightError","Please input a number for 'Table Height' textbox.")),!1):(i(this.localizeString("errorMessageTableWidthError","Please input a number for 'Table Width ' textbox.")),!1):(i(this.localizeString("errorMessageColumnsError","Please input a number for 'Columns' textbox.")),!1):(i(this.localizeString("errorMessageRowsError","Please input a number for 'Rows' textbox.")),!1)},t.prototype.showTableColorDialog=function(e){var t=this,r,i=t.subDialog,s=n(e).prev().val(),o=t._getDialogRes_Color();r={width:"auto",height:"auto",modal:!0,title:"Set Background Color",position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},i.empty().append(o),n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){i.wijdialog(r)},0):i.wijdialog(r),i.delegate(bs,"click."+t.widgetName,function(){t.submitTableColorDialog()}).delegate(ws,"click."+t.widgetName,function(){t.closeSubDialog()}),s!==""&&n("."+Li+" input",i).val(s),n("."+ki,i).wijeditorcolorcanvas("."+Li+" input",s),i.wijdialog("open")},t.prototype.submitTableColorDialog=function(){var e=this,t=e.subDialog,r=e.dialog,i=n("."+Li+" input",t).val();n("."+Fi+" input:text",r).val(i),e.closeSubDialog()},t.prototype.closeSubDialog=function(){this.subDialog.wijdialog("close")},t.prototype._getEditableTable=function(){var e=this,t,r,s;r=e._getSelectedElement();if(!r)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;s=n(r);if(s.is("td,tr,tbody,th"))r=s.parents("table:first")[0];else if(!s.is("table")){t=s.find("table:only-child");if(!n.browser.msie||!t.length)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;r=t[0]}return y=r,!0},t.prototype.initPreviewDialog=function(){var e=this,t=e.dialog;e._setPreviewContent(0),t.delegate("#rad640_480","click."+e.widgetName,function(){e._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+e.widgetName,function(){e._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+e.widgetName,function(){e._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+e.widgetName,function(){e._splitPreviewPages(this.checked)}).delegate("."+Wi,"click."+e.widgetName,function(){e._printPreviewPage(!0)}).delegate("."+Xi,"click."+e.widgetName,function(){e._printPreviewPage(!1)}).delegate("."+Vi,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Ui,"click."+e.widgetName,function(){e._navigatePreviewPage(!1)}).delegate("."+zi,"click."+e.widgetName,function(){e._navigatePreviewPage(!0)})},t.prototype._setPreviewContent=function(e){var t=this,r=t.dialog,i=n("iframe",r),s=n("."+Ri+" span",r),o=i[0].contentWindow.document;o.open(),e===-1?(o.write(t._getPreviewAllPageContent()),s.html("1 / 1")):(o.write(t._getPreviewPageContent(e)),s.html(e+1+" / "+t._getPreviewPageCount())),o.close()},t.prototype._setPreviewDialogSize=function(e,t){var r=this,i=r.dialog,s=n("iframe",i),o=i.wijdialog("option","width"),u=i.wijdialog("option","height");o==="auto"?o=i.parent(".wijmo-wijdialog").width()-s.width():o-=s.width(),u==="auto"?u=i.parent(".wijmo-wijdialog").height()-s.height():u-=s.height(),s.css("width",e).css("height",t),i.wijdialog("option",{width:e+o,height:t+u})},t.prototype._getPreviewPageCount=function(){return this._getPreviewPages().length},t.prototype._getPreviewPageContent=function(e){var t=this._getPreviewPages();return t.length>e?t[e]:null},t.prototype._getPreviewAllPageContent=function(){return this._getDesignViewText()},t.prototype._getPreviewPages=function(){var e=this._getPreviewAllPageContent(),t=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),n=e.replace(t,"!-~U^n#i@q,P|.a=g~e+br!");return n.split("!-~U^n#i@q,P|.a=g~e+br!")},t.prototype._splitPreviewPages=function(e){var t=this,r=t.dialog,i=n("."+$i,r),s=n("."+Ri,r);e?(t._setPreviewContent(0),s.show(),i.hide()):(t._setPreviewContent(-1),s.hide(),i.show()),t._curPageIdx=0},t.prototype._navigatePreviewPage=function(e){var t=this,r=n("#chkSplit",t.dialog),i=t._curPageIdx,s=t._getPreviewPageCount();r.is(":checked")&&(e?(i++,i<s?t._setPreviewContent(i):i=s-1):(i--,i>=0?t._setPreviewContent(i):i=0),t._curPageIdx=i)},t.prototype._printPreviewPage=function(e){var t=this,r=t.dialog,i=n("#chkSplit",r),s=n("iframe",r)[0].contentWindow;e&&(i.removeAttr("checked"),t._setPreviewContent(-1)),s.focus(),s.print()},t.prototype.initCleanUpDialog=function(){var e=this,t=e.dialog;n("textarea",t).val(e.sourceView.val()),t.delegate(gs,"click."+e.widgetName,function(t){e.submitCleanUpDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCleanUpDialog=function(){var e=this,t=e.dialog,r=e.sourceView,i=r.val(),s;n("#replaceSpans",t).is(":checked")&&(s=new RegExp("<\\/?SPAN[^>]*>","g"),i=i.replace(s,"")),n("#replaceClass",t).is(":checked")&&(s=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3")),n("#replaceStyle",t).is(":checked")&&(s=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g"),i=i.replace(s,"<$1$3"),s=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3"),s=new RegExp("<\\\\?\\?xml[^>]*>","g"),i=i.replace(s,""),s=new RegExp("<\\/?\\w+:[^>]*>","g"),i=i.replace(s,"")),n("#replaceNbsp",t).is(":checked")&&(s=new RegExp("&nbsp;","g"),i=i.replace(s," ")),n("#transformPtoDiv",t).is(":checked")&&(s=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g"),i=i.replace(s,"<div$2</div>")),r.val(i),e._setDesignViewText(i),e._addtoUndoBuffer(),e._closeDialog()},t.prototype.initFindDialog=function(){var e=this,t=e.dialog;e.tRange&&(e.tRange=null),t.delegate(gs,"click."+e.widgetName,function(){e.submitFindAction()}).delegate(ys,"click."+e.widgetName,function(t){e.submitReplaceAction(),e._onDesignViewBlur(t)})},t.prototype.submitFindAction=function(){var e=this,t=n("textarea:first",e.dialog).val();if(n.trim(t)==="")return;e._findAndReplaceString(t)},t.prototype.submitReplaceAction=function(){var e=this,t=e.dialog,r=n("textarea:first",t).val(),s=n("textarea:last",t).val();if(n.trim(r)==="")return;if(n.trim(s)===""){i(this.localizeString("errorMessageReplaceStringError","please input replace string!"));return}e._findAndReplaceString(r,s)},t.prototype._findAndReplaceString=function(e,t){var r=this,s=r._getDesignViewWindow(),o=0,u=!1,a,f=t&&t!==e;t||(t=e);if(n.browser.msie)r.tRange&&(r.txtFoundInIE&&f?(o=r.tRange.findText(e),o&&(r.tRange.pasteHTML(t),r.tRange.collapse(!1),u=!0,r.txtFoundInIE=!1)):(r.tRange.collapse(!1),o=r.tRange.findText(e),o&&r.tRange.select())),!u&&(!r.tRange||!o)&&(r.tRange=s.document.body.createTextRange(),o=r.tRange.findText(e),o&&(r.tRange.select(),f&&(r.tRange.pasteHTML(t),u=!0)));else{if(r.txtFoundInNoneIE&&f)r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1;else{a=s.getSelection(),a.rangeCount>0&&a.collapseToEnd(),o=s.find(e);if(!o){o=s.find(e,0,1);while(s.find(e,0,1))continue}}r.txtFoundInNoneIE=r.txtFoundInNoneIE||o,r.txtFoundInNoneIE&&f&&(r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1)}!o&&!u?(i('"'+e+'"'+this.localizeString("errorMessageFindTextError"," String Not Found!")),r.tRange=null,r.txtFoundInNoneIE=!1,r.txtFoundInIE=!1):r.txtFoundInIE=!0},t.prototype._replaceSelectionForNoneIE=function(e){var t=this._getDesignViewDocument();t.execCommand("inserttext",!1,e)},t.prototype.initMediaDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitMediaDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitMediaDialog=function(){var e=this,t=e.dialog,r=n("select",t).val(),s=n("."+is+" input",t).val(),o=n("."+ss+" input",t).val(),u=n("."+os+" input",t).val();if(s===""){i(this.localizeString("errorMessageUrlEmptyError","URL is empty!"));return}if(!e._isUrl(s)){i(this.localizeString("errorMessageUrlCorrectError","please input correct URL!"));return}if(!e._isNumeric(o)){i(this.localizeString("errorMessageMediaWidthError","please input width of the media!"));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageMediaHeightError","please input height of the media!"));return}e._insertMedia(r,s,o,u),e._closeDialog()},t.prototype._insertMedia=function(e,t,n,r){var i=this,s="";i._setIESelection();switch(e){case"video":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'" '+'type=audio/x-pn-realaudio-plugin console="Clip1" '+'controls="IMAGEWINDOW,ControlPanel,StatusBar" '+'autostart="true"></embed>';break;case"flash":s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+n+'" height="'+r+'">',s+='<param name="movie" value="'+t+'">',s+='<param name="quality" value="high">',s+='<embed src="'+t+'" quality="high" '+'pluginspage="http://www.macromedia.com/go/getflashplayer" '+'type="application/x-shockwave-flash" '+'width="'+n+'" height="'+r+'"></embed>',s+="</object>";break;case"applet":s+='<applet code="'+t+'" width="'+n+'" '+'height="'+r+'"></applet>';break;case"other":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'"></embed>'}i.insertHTML(s)},t.prototype.initSpecialCharacterDialog=function(){var e=this,t=e.dialog,r=n("."+ls+" span",t);t.delegate("label","click."+e.widgetName,function(t){e.submitSpecialCharacterDialog(this),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("label","mouseover."+e.widgetName,function(){r.html(n(this).html())}).delegate("label","mouseout."+e.widgetName,function(){r.empty()})},t.prototype.submitSpecialCharacterDialog=function(e){var t=this;t._setIESelection(),t.insertHTML(n(e).html()),t._closeDialog()},t.prototype._setSaveBtnEnabled=function(){this.$ribbon.wijribbon(b,_t,!1)},t.prototype._undoAction=function(){var e=this._getDesignViewDocument().body,t={};v--,v<=0&&(v=0),e.innerHTML=m[v],v?this.$ribbon.wijribbon(b,wt,!1):(t[bt]=!0,t[wt]=!1,this.$ribbon.wijribbon(w,t))},t.prototype._redoAction=function(){var e=this._getDesignViewDocument().body,t=m.length,n={};v++,v>=t-1&&(v=t-1),e.innerHTML=m[v],v===t-1?(n[bt]=!1,n[wt]=!0,this.$ribbon.wijribbon(w,n)):this.$ribbon.wijribbon(b,bt,!1)},t.prototype._addtoUndoBuffer=function(){var e=m.length-1-v,t;for(t=0;t<e;t++)m.pop();v++,m.push(this._getDesignViewText()),this.$ribbon.wijribbon(b,bt,!1)},t.prototype._deleteSelectionContent=function(){var e=this._getDesignViewWindow(),t,r,i,s="rangeCount";if(n.browser.msie)t=e.document.selection,t.type.toLowerCase()!=="none"&&t.clear();else{t=e.getSelection();for(r=0;r<t[s];r++)i=t.getRangeAt(r),i.deleteContents()}},t.prototype._refreshPathSelector=function(){var e=this,t=e._getParentElement(e._getDesignViewWindow()),r,i=e._getPathSelector(),s=n(t).parents(),o=s.length,u="wijmo-wijeditor-label ui-state-default ui-corner-all",a;if(!t)return;r=t.tagName?t.tagName.toLowerCase():"",i.empty();for(a=o-1;a>=0;a--)i.append("<label class='"+u+"'>&lt;"+s[a].tagName.toLowerCase()+"&gt;</label>");i.append("<label class='"+u+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+r+"&gt;</label>")},t.prototype._toggleTableBorders=function(){var e=this._getDesignViewDocument(),t=n("#__wijStyle",e);d=!d,n.browser.safari?d?t.html("table,td,tr{border: 1px #acacac dashed;}"):t.empty():t.prop("disabled",!d)},t.prototype._tableAction=function(e){var t=this,r=t._getParentElement(t._getDesignViewWindow()),s=n(r).closest("td"),o,u,a,f,l,c,h,p,d,v,m=0;t._setSaveBtnEnabled();if(s.length===0&&e!==F)return!1;e!==F&&(o=s.parent(),u=o.closest("table"),a=s[0],f=o[0],l=u[0],c=f.rowIndex,h=a.cellIndex);try{switch(e){case H:p=f.cells.length,v=l.insertRow(c);for(m=0;m<p;m++)t._insertCell(v,m);break;case q:l.deleteRow(c);break;case P:d=l.rows.length;for(m=0;m<d;m++)t._insertCell(l.rows[m],h);break;case I:t._removeColumn(l,h);break;case B:t._insertCell(f,h+1);break;case R:p=f.cells.length,p===1?l.deleteRow(c):f.deleteCell(h);break;case j:t._splitCell(l,f,c,h);break;case F:t._mergeCell(t._getSelectedCells(r))}this._addtoUndoBuffer()}catch(g){return i(g.message),!1}return!0},t.prototype._removeColumn=function(e,t){var n=e.rows.length,r=0,i,s,o,u,a;while(r<n)i=e.rows[r],s=i.cells,o=s.length,u=t>o-1?o-1:t,a=s[u].colSpan,a>1&&o>1&&(u+1<o?s[u+1].colSpan+=a-1:s[u-1].colSpan+=a+1),o===1?(e.deleteRow(r),n=e.rows.length):(i.deleteCell(u),r++)},t.prototype._splitCell=function(e,t,n,r){var i=e.rows.length,s=0,o=0,u,a,f,l,c;while(s<=r)t.cells[s].colSpan>1&&(o+=t.cells[s].colSpan-1),s++;this._insertCell(t,r+1);if(t.cells[r].colSpan>1)t.cells[r].colSpan--;else for(f=0;f<i;f++){u=e.rows[f];if(f!==n){l=r,s=0,a=0;while(s<=l)u.cells[s].colSpan>1&&(a+=u.cells[s].colSpan-1,l-=a),s++;c=r+o-a,c<0&&(c=0),u.cells[c].colSpan++}}},t.prototype._mergeCell=function(e){var t=e.length,n,r,i,s;if(t<2||e[0].parentNode!==e[t-1].parentNode)return!1;n=e[0].parentNode,r=e[0].cellIndex,i=r+t;for(s=r+1;s<i;s++)n.cells[r].innerHTML+=n.cells[r+1].innerHTML,n.cells[r].colSpan++,n.deleteCell(r+1)},t.prototype._getSelectedCells=function(e){var t=this,r=this._getDesignViewWindow(),i=r.document,s=[],o,u,a,f,l,c,h,p;if(n.browser.msie)u=n(e).closest("tr")[0],u&&(o=t._getIESelectionRange(),n.each(u.cells,function(e,n){t._isIE11?t._checkSelectionIncludeNodeForIE11(r,o,n)&&s.push(n):t._checkSelectionIncludeNodeExceptIE11(r,o,n)&&s.push(n)}));else if(n.browser.mozilla){a=r.getSelection(),l=a.rangeCount;for(f=0;f<l;f++)o=a.getRangeAt(f),c=o.startContainer,h=c.nodeName.toLowerCase(),h==="td"||h==="th"?s.push(c):h==="tr"&&(p=o.startOffset,s.push(c.cells[p]))}else{a=r.getSelection(),u=n(e).closest("tr")[0];if(u){l=u.cells.length;for(f=0;f<l;f++)s.push(u.cells[f])}}return s},t.prototype.insertDateAndTime=function(){var e=new Date;this.options.culture&&this.options.culture!==""?this.insertHTML(Globalize.format(e,"dddd ",Globalize.findClosestCulture(this.options.culture))+Globalize.format(e,"F",Globalize.findClosestCulture(this.options.culture))):this.insertHTML(e.toDateString()+" "+e.toTimeString())},t.prototype._toggleWordWrap=function(){var e=this,t=e.sourceView,r="wrap",i;p=!p,i=p?"soft":"off",t.attr(r,i),t[0].focus(),n.browser.mozilla&&(t.hide(),s.setTimeout(function(){t.show()},40))},t.prototype.insertHTML=function(e){var t=this,r=t._getDesignViewDocument(),i;try{n.browser.msie?(t._isIE11&&r.getSelection?i=t._getRangeForInsertHTML(r,e):(i=r.selection.createRange(),i.pasteHTML(e),i.collapse(!1)),t._setIESelection(i,!0)):r.execCommand("insertHTML",!1,e)}catch(s){n.browser.msie&&n.browser.version&&parseFloat(n.browser.version)>=9&&parseFloat(n.browser.version)<=10&&g&&(i=g,i.pasteHTML(e),i.collapse(!1),t._setIESelection(i,!0))}t._addtoUndoBuffer(),t._setSaveBtnEnabled()},t.prototype._getRangeForInsertHTML=function(e,t){var n,r,i;return e.getSelection&&(n=e.getSelection(),g?(r=g,g=null):n.getRangeAt&&n.rangeCount&&(r=n.getRangeAt(0)),r&&(r.deleteContents(),i=r.createContextualFragment(t),r.insertNode(i),r.collapse(!1))),r},t.prototype._setIEFocus=function(){var e=this._getDesignViewDocument();if(n.browser.msie)try{e.body.focus()}catch(t){}},t.prototype.focus=function(){var e=this._getDesignViewWindow(),t=e.document;n.browser.msie?g?this._setIESelection():t.body?t.body.focus():t.onreadystatechange=function(){t.readyState==="complete"&&t.body.focus()}:e.focus()},t.prototype._setFocusNotIE=function(){var e=this._getDesignViewWindow(),t=e.document;if(n.browser.msie)return;n.browser.mozilla?e.focus():t.body&&t.body.focus()},t.prototype._createElement=function(e,t,n){return new ks(e,t,n)},t.prototype._createDiv=function(e,t){return this._createElement("div",{"class":e})},t.prototype._createSpan=function(e,t){var n=this;return t?e.length===0?n._createElement("span",t):this._createElement("span",t,{"class":e}):n._createElement("span",{"class":e})},t.prototype._createTextBox=function(e,t){var n={"class":e,type:"text",value:undefined};return t&&(n.value=t),this._createElement("input",n)},t.prototype._createLabel=function(e,t){return t?new ks("label",e,{"for":t}):new ks("label",e)},t.prototype._createRadio=function(e,t,n){var r={name:t,id:e,value:n,type:"radio"};return this._createElement("input",r)},t.prototype._createCheckbox=function(e){var t={type:"checkbox",id:e};return this._createElement("input","",t)},t.prototype._createSelect=function(e,t){var r=this,i={"class":e},s=r._createElement("select",i);return e===""&&(s=r._createElement("select")),n.each(t,function(e,t){n.isPlainObject(t)&&t.selected?s.add(r._createElement("option",t.text,{selected:"selected"})):s.add(r._createElement("option",t))}),s},t.prototype._createInputButton=function(e,t){var n={"class":e,type:"button",value:undefined};return t&&(n.value=t),this._createElement("input",n)},t.prototype._createTextField=function(e,t,n,r){var i=this,s=i._createDiv(t),o={type:"text",value:""};return r&&(o.value=r),s.add(i._createSpan(kr,e)),s.add(i._createElement("input",o)),n&&s.add(new Cs(n)),s},t.prototype._createTextAreaField=function(e,t,n,r){var i=this._createDiv(t);return i.add(this._createSpan(kr,e)),i.add(this._createElement("textarea",n)),r&&i.add(new Cs(r)),i},t.prototype._createSeparator=function(){var e=this,t=e._createDiv(Tr);return t.add(e._createElement("hr")),t},t.prototype._createOKCancelButtons=function(){var e=this,t=e._createDiv(Nr);return t.add(e._createElement("input",{type:"button","class":Cr,value:this.localizeString("dialogOK","OK")})),t.add(e._createElement("input",{type:"button","class":Cr,engValue:"Cancel",value:this.localizeString("dialogCancel","Cancel")})),t},t.prototype._getDialogRes_Template=function(){var e=this,t=e._createDiv(qr),n=e._createDiv(Rr),r=e._createDiv(Wr),i=e._createDiv(Xr),s=e._createDiv(Vr),o=e._createDiv($r),u=e._createElement("div",this.localizeString("templateDialogName","Name :")),a=e._createElement("div",this.localizeString("templateDialogDescription","Description :")),f=e._createDiv(Qr),l=e._createDiv(Zr);return n.add(e._createElement("div",this.localizeString("templateDialogSelectTemplate","Select Template:"),{"class":Ur})),n.add(e._createElement("div",this.localizeString("templateDialogTemplatePreview","Template Preview:"),{"class":zr})),t.add(n),i.add(e._createElement("select",{size:8})),s.add(e._createElement("iframe",{frameborder:0})),r.add(i),r.add(s),t.add(r),u.add(e._createSpan(Jr)),a.add(e._createSpan(Kr)),o.add(u),o.add(a),t.add(o),f.add(e._createSpan(kr,this.localizeString("templateDialogName","Name :"))),f.add(e._createTextBox(Gr)),f.add(e._createSpan(kr,this.localizeString("templateDialogDescription","Description :"))),f.add(e._createTextBox(Yr)),t.add(f),l.add(e._createInputButton(Cr+" "+ei,this.localizeString("templateDialogDeleteSelected","Delete selected"))),l.add(e._createInputButton(Cr+" "+ti,this.localizeString("templateDialogSaveCurrentPage","Save current page as template"))),t.add(l),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_ImageBrowser=function(){var e=this,t=e._createDiv(Lr),n=e._createDiv(Ar),r=e._createDiv(Or),i=e._createDiv(Mr),s=e._createDiv(_r),o=e._createDiv(Dr);return r.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),Pr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageAltText","Image alt text:"),Hr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),Br,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),jr,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogCssText","Css text:"),Fr)),n.add(r),i.add(s),s.add(e._createElement("select",{size:8})),i.add(o),o.add(e._createElement("img",{src:"",alt:""})),n.add(i),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),t.add(n),t.render()},t.prototype._getDialogRes_link_address=function(){return this._createTextField(this.localizeString("hyperLinkDialogAddress","Address :"),ri)},t.prototype._getDialogRes_link_linkType_options=function(){return[{id:"radUrl",value:"url",text:this.localizeString("hyperLinkDialogUrl","url")},{id:"radAnchor",value:"anchor",checked:!0,text:this.localizeString("hyperLinkDialogAnchor","anchor")},{id:"radMail",value:"email",text:this.localizeString("hyperLinkDialogEmail","email")}]},t.prototype._getDialogRes_link_linkType=function(){var e=this,t=this._createDiv(ii+" ui-helper-clearfix"),r=this._createElement("div"),i=[],s;t.add(r),n.each(this._getDialogRes_link_linkType_options(),function(t,n){r.add(e._createRadio(n.id,"radioList",n.value)),r.add(e._createLabel(n.text,n.id))});for(s=1;s<8;s++)i.push("#anchor"+s.toString());return t.add(this._createSelect(si,i)),t},t.prototype._getDialogRes_Link_linkIconType=function(){var e=this,t=this._createDiv(pi),r=this._createElement("div"),i=this._createSpan(kr,this.localizeString("hyperLinkDialogIconType","Icon Type :")),s=[{id:"radLinkTypeIsText",value:"text",checked:!0,text:this.localizeString("hyperLinkDialogText","text")},{id:"radLinkTypeIsImage",value:"image",text:this.localizeString("hyperLinkDialogImage","image")}];return n.each(s,function(t,n){r.add(e._createRadio(n.id,"linkIconRadioList",n.value)),r.add(e._createLabel(n.text,n.id))}),t.add(r),r.add(i),t},t.prototype._getDialogRes_Link_text=function(){return this._createTextAreaField(this.localizeString("hyperLinkDialogTextToDisplay","Text to display :"),oi)},t.prototype._getDialogRes_Link_image=function(){var e=this._createDiv(hi);return e.add(this._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),fi)),e.add(this._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),li,this.localizeString("dialogPixel","px"))),e.add(this._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),ci,this.localizeString("dialogPixel","px"))),e},t.prototype._getDialogRes_link_target=function(){var e=this._createDiv(ui),t=this._createSpan(kr,this.localizeString("hyperLinkDialogTarget","Target :")),n=[{text:"_blank",selected:!0},"_parent","_self","_top"],r=this._createSelect(ui,n);return e.add(t),e.add(r),e},t.prototype._getDialogRes_Link_Css=function(){return this._createTextField(this.localizeString("hyperLinkDialogCss","Css :"),ai)},t.prototype._getDialogRes_Link=function(){var e=this,t=e._createDiv(ni);return t.add(e._getDialogRes_link_address()),t.add(e._getDialogRes_link_linkType()),t.add(e._createSeparator()),t.add(e._getDialogRes_Link_linkIconType()),t.add(e._getDialogRes_Link_text()),t.add(e._getDialogRes_Link_image()),t.add(e._getDialogRes_link_target()),t.add(e._getDialogRes_Link_Css()),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_TagInspector=function(){var e=this,t=e._createDiv(gi),n=e._createDiv(yi),r=e._createDiv(Ei),i=e._createDiv(Si),s=e._createDiv(Ti);return t.add(n),n.add(e._createSpan(bi,this.localizeString("tagInspectorDialogSelectedTag","Selected tag :"))),n.add(e._createSpan(wi,"")),t.add(r),r.add(e._createCheckbox("displayNoEmpty")),r.add(e._createLabel(this.localizeString("tagInspectorDialogDisplayNotEmptyAttributes","Display not empty attributes only"),"displayNoEmpty")),t.add(i),i.add(e._createSpan(kr,this.localizeString("tagInspectorDialogAttributes","Attributes:"))),i.add(e._createDiv(xi)),t.add(s),s.add(e._createSpan(kr,this.localizeString("tagInspectorDialogInnerHTML","Inner HTML:"))),s.add(e._createElement("textarea")),t.add(e._createTextField(this.localizeString("tagInspectorDialogCSSText","Css Text:"),Ni)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Color=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_ForeColor=function(){return this._getDialogRes_CommonColor("#000000")},t.prototype._getDialogRes_BackColor=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_CommonColor=function(e){var t=this,n=t._createDiv(Ci),r=t._createDiv(Li);return n.add(t._createDiv(ki)),n.add(r),r.add(t._createSpan(kr,this.localizeString("backColorDialogSelectedColor","Selected Color:"))),r.add(t._createElement("input",{type:"text",value:e})),n.add(t._createSeparator()),n.add(t._createOKCancelButtons()),n.render()},t.prototype._getDialogRes_Table=function(){var e=this,t=e._createDiv(Ai),n=e._createDiv(Fi);return t.add(e._createTextField(this.localizeString("tableDialogRows","Rows :"),Oi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogColumns","Columns :"),Mi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogTableWidth","Table Width :"),_i,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogTableHeight","Table Height :"),Di,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogBorder","Border thickness:"),Pi)),t.add(e._createTextField(this.localizeString("tableDialogCellPadding","Cell Padding :"),Hi)),t.add(e._createTextField(this.localizeString("tableDialogCellSpacing","Cell Spacing :"),Bi)),t.add(e._createTextField(this.localizeString("tableDialogCssText","Css Text :"),ji)),t.add(n),n.add(e._createSpan(kr,this.localizeString("tableDialogBackgroundColor","Background Color:"))),n.add(e._createElement("input",{type:"text"})),n.add(e._createElement("input",{type:"button",value:"..."})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Preview=function(){var e=this,t=e._createDiv(Ii),n=e._createDiv(qi),r=e._createDiv(Nr),i=e._createDiv(Ri),s=e._createDiv(Ji);return t.add(n),n.add(e._createSpan(kr,this.localizeString("previewDialogPreviewSize","Preview Size:"))),n.add(e._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"})),n.add(e._createLabel("640x480","rad640_480")),n.add(e._createElement("input",{id:"rad800_600",name:"preview",type:"radio"})),n.add(e._createLabel("800x600","rad800_600")),n.add(e._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"})),n.add(e._createLabel("1024x768","rad1024_768")),n.add(e._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"})),n.add(e._createLabel(this.localizeString("previewDialogSplit","Split pages"),"chkSplit")),t.add(e._createSeparator()),t.add(r),r.add(e._createInputButton(Cr+" "+Wi,this.localizeString("previewDialogPrintAll","Print All"))),r.add(e._createInputButton(Cr+" "+Xi,this.localizeString("previewDialogPrintPage","Print Page"))),r.add(e._createInputButton(Cr+" "+Vi,this.localizeString("dialogOK","OK"))),t.add(e._createSeparator()),t.add(i),i.add(e._createElement("a",this.localizeString("previewDialogPrevPage","Prev page"),{"class":Ui,href:"#"})),i.add(e._createElement("span","1 / 1")),i.add(e._createElement("a",this.localizeString("previewDialogNextPage","Next page"),{"class":zi,href:"#"})),t.add(e._createDiv($i)),t.add(s),s.add(e._createElement("iframe",{src:"about:blank"})),t.render()},t.prototype._getDialogRes_CleanUp=function(){var e=this,t=e._createDiv(Ki),r=e._createDiv(Qi),i=e._createDiv(Gi),s=e._createDiv(Yi),o=[{id:"replaceSpans",label:this.localizeString("cleanUpDialogStripSpanTag","Strip SPAN tag")},{id:"replaceClass",label:this.localizeString("cleanUpDialogStripClass","Strip CLASS tag")},{id:"replaceStyle",label:this.localizeString("cleanUpDialogStripStyle","Strip STYLE attribute")},{id:"replaceNbsp",label:this.localizeString("cleanUpDialogReplaceSymbol","Replace &amp;nbsp; symbol")},{id:"transformPtoDiv",label:this.localizeString("cleanUpDialogTransformParagraphToDIV","Transform Paragraph to DIV")}];return t.add(r),r.add(e._createSpan(kr,this.localizeString("cleanUpDialogDocumentSource","Document source :"))),t.add(i),i.add(e._createElement("textarea",{readonly:"readonly"})),t.add(s),n.each(o,function(t,n){s.add(e._createCheckbox(n.id)),s.add(e._createLabel(n.label,n.id))}),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_FindAndReplace=function(){var e=this,t=e._createDiv(Zi),n=e._createDiv(es),r=e._createDiv(ts),i=e._createDiv(Nr);return t.add(n),n.add(e._createSpan(kr,this.localizeString("findAndReplaceFind","Find:"))),n.add(e._createElement("textarea","text")),t.add(r),r.add(e._createSpan(kr,this.localizeString("findAndReplaceReplace","Replace:"))),r.add(e._createElement("textarea")),t.add(e._createSeparator()),t.add(i),i.add(e._createInputButton(Cr,this.localizeString("findAndReplaceFindButton","Find"))),i.add(e._createInputButton(Cr,this.localizeString("findAndReplaceReplaceButton","Replace"))),t.render()},t.prototype._getDialogRes_Media=function(){var e=this,t=e._createDiv(ns),n=e._createDiv(rs);return t.add(n),n.add(e._createSpan(kr,this.localizeString("mediaDialogMediaType","Media Type :"))),n.add(e._createSelect("",["flash","video","applet","other"])),t.add(e._createTextField(this.localizeString("mediaDialogMediaUrl","Media Url :"),is)),t.add(e._createTextField(this.localizeString("mediaDialogWidth","Width :"),ss,this.localizeString("dialogPixel","px"),200)),t.add(e._createTextField(this.localizeString("mediaDialogHeight","Height :"),os,this.localizeString("dialogPixel","px"),200)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_SpecialCharacter=function(){var e=this,t=e._createDiv(us),r=e._createDiv(as),i=e._createDiv(fs),s=e._createDiv(ls),o=e._createDiv(cs),u=e._createDiv(hs,"Punctuation"),a=e._createDiv(ps),f=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],l=e._createDiv(hs,"Symbols"),c=e._createDiv(ds),h=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],p=e._createDiv(hs,"Diacritics"),d=e._createDiv(vs),v=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],m=e._createDiv(Nr);return t.add(r),r.add(i),i.add(s),s.add(new ks("span")),r.add(o),o.add(u),u.add(a),n.each(f,function(t,n){a.add(e._createLabel(n))}),o.add(l),l.add(c),n.each(h,function(t,n){c.add(e._createLabel(n))}),o.add(p),p.add(d),n.each(v,function(t,n){d.add(e._createLabel(n))}),t.add(e._createSeparator()),m.add(e._createInputButton(Cr,"Cancel")),t.add(m),t.render()},t.prototype._copyFromClipboard=function(){var e,t,r,i;if(s.clipboardData)return s.clipboardData.getData("Text");if(n.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(o){}return e=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),e?(t=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),t?(t.addDataFlavor("text/unicode"),e.getData(t,e.kGlobalClipboard),t.getTransferData("text/unicode",r,i),r&&(r=r.value.QueryInterface(Components.interfaces.nsISupportsString)),r?r.data.substring(0,i.value/2):""):!1):!1}},t.prototype._copyToClipboard=function(e){var t,r,o,u={},a={};if(s.clipboardData&&e)s.clipboardData.setData("Text",e);else if(n.browser.mozilla)try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return;r=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!r)return;r.addDataFlavor("text/unicode"),a={},u=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),u.data=e,r.setTransferData("text/unicode",u,e.length*2),o=Components.interfaces.nsIClipboard;if(!t)return!1;t.setData(r,null,o.kGlobalClipboard)}catch(f){u="Copy text to Clipboard \n",u+="If you are using firefox please do the following :\n ",u+="1. Write in your url box : 'about:config'\n",u+="2. Change signed.applets.codebase_principal_support = true\n",i(this.localizeString("errorMessageCopyToClipboardError",u))}},t.prototype.fixAbsoluteUrlsIfNeeded=function(e){var t=this,n=o.URL,r=o.URL,i=o.URL,s=!1,u=r.length,a=e,f,l,c,h,p,d,v,m;for(v=u-1;v>0;v--){f=r.charAt(v),l=r.charAt(v-1);if(f==="/"||f==="\\"){if(f===l)break;i=r.substring(0,v)+f,s||(r=i,s=!0)}}return c=t._prepareLiteralRegexText(n+"?"),h=new RegExp(c,"g"),a=a.replace(h,"?"),p=t._prepareLiteralRegexText(r),h=new RegExp(p,"g"),a=a.replace(h,""),d=t._prepareLiteralRegexText(i),h=new RegExp(d,"g"),a=a.replace(h,"/"),m=a.indexOf("#"),m>-1&&(a=a.substr(m)),a},t.prototype._insertCell=function(e,t){var n=e.insertCell(t);return n.innerHTML="&nbsp;",n},t.prototype._getDictionaryDeclare=function(){var e={};return e.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"],e.b=["class","dir","id","lang","title"],e.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"],e.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"],e.code=["class","dir","id","lang","title"],e.div=["align","class","dir","id","lang","title"],e.em=["class","dir","id","lang","title"],e.font=["class","color","dir","face","id","lang","pointsize","size","title"],e.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"],e.hr=["align","class","color","id","noshade","size","title","width"],e.i=["class","dir","id","lang","title"],e.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"],e.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"],e.label=["accesskey","class","dir","for","id","lang","title"],e.li=["class","dir","id","lang","title","type","value"],e.ol=["class","compact","dir","id","lang","start","title","type"],e.option=["class","dir","disabled","id","label","lang","selected","title","value"],e.p=["align","class","dir","id","lang","title"],e.span=["class","dir","id","lang","title"],e.strong=["class","dir","id","lang","title"],e.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"],e.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"],e.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"],e.tbody=["align","bgColor","class","dir","id","lang","title","valign"],e.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"],e.u=["class","id","xml:lang"],e.ul=["class","compact","dir","id","lang","title","type"],e},t.prototype._generateUniqueName=function(e){var t=c[e];return t||(t=0),c[e]=++t,e+t},t.prototype._setContentEditable=function(e,t){var r="designMode",i="contentEditable";try{e.body[i]&&(e.body[i]=t.toString()),e[r]&&(!t&&e[r]!=="off"?e[r]="off":t&&e[r]!=="on"&&(n.browser.msie&&u(n.browser.version)>=9||(e[r]="on"))),t&&!n.browser.msie&&e.execCommand("useCSS",!1,!0)}catch(s){}},t.prototype._setContentSpellCheck=function(e,t){var n="spellcheck";try{e.body[n]!==undefined&&(e.body[n]=t)}catch(r){}},t.prototype._formatString=function(e,t){var n=e.length,r;for(r=0;r<t-n;r++)e="0"+e;return e},t.prototype._convertToWebColor=function(e,t,n){var r=this,i,s,o,a;if(isNaN(e)||255-e<0)e=0;if(isNaN(t)||255-t<0)t=0;if(isNaN(n)||255-n<0)n=0;return i=r._formatString(u(e).toString(16),2),s=r._formatString(u(t).toString(16),2),o=r._formatString(u(n).toString(16),2),a="#"+i+s+o,a},t.prototype._prepareLiteralRegexText=function(e){var t=e;return t=t.replace(/\\/g,"\\\\"),t=t.replace(/\./g,"\\."),t=t.replace(/\?/g,"\\?"),t},t.prototype._isNumeric=function(e){return(new RegExp("^\\d+$")).test(e)},t.prototype._isEmail=function(e){return(new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+")).test(e)},t.prototype._isUrl=function(e){return(new RegExp("[a-zA-z]+://[^s]+")).test(e)},t.prototype._isAnchor=function(e){return(new RegExp("#[^s]+")).test(e)?!0:(new RegExp("[a-zA-z]+://[^s]+#[^s]+")).test(e)?!0:!1},t.prototype.refresh=function(){var e=this,t=e._getDesignViewDocument(),r=e.element,i=e._getHeader(),s=e._getFooter(),o=e._oriEleWidth,u=e._oriEleHeight,a=e._getContent(),f;e.editor.width(o).height(u),this.$ribbon.wijribbon("updateRibbonSize"),window.setTimeout(function(){f=e.editor.height()-i.outerHeight(!0)-s.outerHeight(!0),a.height(f),a.data("wijmo-wijsplitter")&&a.wijsplitter("refresh")},0),n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(t,!0)},t.prototype.getText=function(){var e=this;return e._getDesignViewText()},t.prototype.setText=function(e){var t=this;e&&(t._setDesignViewText(e),t.sourceView.val(e))},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._getParentElement=function(e){var t=this,n=t._getRange(e),r,i,s,o,u;if(!n)return null;if(n.commonAncestorContainer)return r=e.getSelection(),i=n.startContainer||r.baseNode,s=n.endContainer||r.extentNode,o=n.startOffset,o===null&&(o=r.baseOffset),u=n.endOffset,u===null&&(u=r.extentOffset),i===s&&u-o===1?r.anchorNode.childNodes[r.anchorOffset]:n.commonAncestorContainer.tagName?n.commonAncestorContainer:e.document===n.commonAncestorContainer&&r.baseNode?r.baseNode.parentNode:n.commonAncestorContainer.parentNode;return n.length?n.item(0):n.parentElement?n.parentElement():null},t.prototype._getRange=function(e){var t,n;if(e.document.selection&&!s.opera)return e.document.selection.createRange();if(e.getSelection)return t=e.getSelection(),!t||t.rangeCount<1?null:(t.getRangeAt?n=t.getRangeAt(0):n=e.document.createRange(),n)},t.prototype._getInspectElement=function(){return y||this._getSelectedElement()},t.prototype._getSelectedElement=function(){return this._getParentElement(this._getDesignViewWindow())},t.prototype._checkSelectionIncludeNodeForIE11=function(e,t,n){var r=e.document,i;if(t){i=r.createRange(),i.selectNode(n);if(t.compareBoundaryPoints(Range.START_TO_END,i)<=0||t.compareBoundaryPoints(Range.END_TO_START,i)>=0)return!1}return!0},t.prototype._checkSelectionIncludeNodeExceptIE11=function(e,t,n){var r=e.document,i=r.selection.createRange(),s="compareEndPoints";if(t){i.moveToElementText(n);if(t.inRange(i)||t[s]("StartToStart",i)>=0&&t[s]("StartToEnd",i)<=0||t[s]("EndToStart",i)>=0&&t[s]("EndToEnd",i)<=0)return!0}return!1},t.prototype._getIESelectionRange=function(){var e=this,t=this._getDesignViewWindow(),n=t.document,r,i;return e._isIE11?(r=t.getSelection(),r&&r.rangeCount>0&&(i=r.getRangeAt(0))):i=n.selection.createRange(),i},t.prototype._setIESelection=function(e,t){var r=this._getDesignViewDocument();!e&&!t&&(e=g);if(n.browser.msie&&e)try{this._isIE11&&r.getSelection?r.getSelection().addRange(e):e.select()}catch(i){}},t.prototype._getSelectedContent=function(){var e=this._getDesignViewWindow(),t=e.document,n="",r="cloneContents",i,s,o;return t.selection?(i=t.selection.createRange(),i.htmlText):(i=e.getSelection().getRangeAt(0),i&&i[r]&&(s=i[r](),o=document.createElement("div"),o.appendChild(s),n=o.innerHTML,o=null),n||"")},t.prototype._getHtmlTextInIE=function(e){if(!n.browser.msie||!e)return"";var t="",r;return this._isIE11&&e.getSelection?(r=e.getSelection(),t=r.getRangeAt&&r.rangeCount?r.getRangeAt(0).toString():""):t=e.selection.createRange().htmlText,t},t.prototype._saveSelectionForIE=function(){var e=this._getDesignViewWindow().document,t;if(!n.browser.msie)return;if(this._isIE11&&e.getSelection){t=e.getSelection(),g=t.getRangeAt&&t.rangeCount?t.getRangeAt(0):null;return}t=e.selection,g=t.createRange()},t.prototype._storeSelectionForIE=function(){var e=this._getDesignViewWindow().document,t,r,i;if(!n.browser.msie)return;e.selection?(t=e.selection.createRange(),this.bookmark=t.getBookmark()):e.getSelection&&e.getSelection().rangeCount&&(t=e.getSelection().getRangeAt(0),r=t.cloneRange(),r.selectNode(e.body),r.setEnd(t.startContainer,t.startOffset),i=r.toString().length,this.bookmark={startContainerText:n(t.startContainer).text(),start:i,end:i+t.toString().length})},t.prototype._restoreSelectionForIE=function(){var e=this._getDesignViewWindow(),t=e.document,r,i,s,o,u,a,f,l,c,h,p,d;if(!this.bookmark||!n.browser.msie)return;if(t.selection)r=t.body.createTextRange(),r.moveToBookmark(this.bookmark),r.select();else if(t.getSelection){i=this.bookmark.start,h=this.bookmark.end,s=this.bookmark.startContainerText,r=t.createRange(),r.setStart(t.body,0),o=[t.body],f=0;while(!u&&(a=o.pop()))if(a.nodeType==3)l=f+a.length,!c&&a.nodeValue===s&&i>=f&&i<=l&&(r.setStart(a,i-f),c=!0),c&&h>=f&&h<=l&&(r.setEnd(a,h-f),u=!0),f=l;else{d=a.childNodes.length;while(d--)o.push(a.childNodes[d])}p=e.getSelection(),p.removeAllRanges(),p.addRange(r),g=null}this.bookmark=null},t.prototype._setSelection=function(e,t,r){var i=this._getDesignViewWindow(),s=i.document,o,u,a,f,l=0;try{window.getSelection?(f=i.getSelection(),o=s.createRange(),u=e[0][0],a=e[e.length-1][0],o.setStart(u,0),o.setEnd(a,a.childNodes.length),f.removeAllRanges(),f.addRange(o)):(o=s.selection.createRange(),e?(n.each(e,function(e,t){l+=t.text().length}),o.moveToElementText(e[0][0]),o.collapse(!0),o.moveEnd("character",l)):(o.moveStart("textedit",-1),o.collapse(!0),o.moveStart("character",t),o.moveEnd("character",r)),o.select())}catch(c){}},t.prototype._getHyperLinkElement=function(e){while(e&&e.tagName!=="A"){if(e.tagName==="BODY"||e.tagName==="HTML")break;e=e.parentElement}return e},t}(e.wijmoWidget);t.wijeditor=Ls;var As=function(){function e(){this.initSelector=":jqmData(role='wijeditor')",this.fullScreenContainerSelector="",this.editorMode="wysiwyg",this.fullScreenMode=!1,this.fontSizes=[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],this.fontNames=[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],this.showPathSelector=!0,this.mode="ribbon",this.commandButtonClick=null,this.simpleModeCommands=null,this.showFooter=!0,this.customContextMenu=!0,this.text=null,this.textChanged=null,this.localization=null}return e}();Ls.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new As),n.wijmo.registerWidget("wijeditor",Ls.prototype);var Os=mr+"-colorcanvas",Ms=mr+"-color",_s=mr+"-wheel",Ds=mr+"-overlay",Ps=mr+"-marker";n.fn.wijeditorcolorcanvas=function(e,t){var n=this.get(0);return n.wijeditorcolorcanvas||(n.wijeditorcolorcanvas=new Hs(n,e,t))};var Hs=function(){function e(e,t,r){var i=this,s="",a,f;f="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ",s+="<div class='"+Os+"'>",s+="<div class='"+Ms+"'></div>",s+="<div class='"+_s+"'></div>",s+="<div class='"+Ds+"'></div>",s+="<div class='h-marker "+Ps+"'></div>",s+="<div class='sl-marker "+Ps+"'></div></div>",n(e).html(s),a=n("."+Os,e),i.wheel=n("."+_s,e).get(0),i.radius=84,i.square=100,i.width=194,n.browser.msie&&parseInt(n.browser.version,10)<7&&n("*",a).each(function(){var e=this,t=e.currentStyle.backgroundImage;return t!=="none"&&(t=t.substring(5,t.length-2),n(e).css({backgroundImage:"none",filter:f+"src='"+t+"')"})),this}),i.linkTo=function(e){typeof i.callback=="object"&&n(i.callback).unbind("keyup",i.updateValue),i.color=null;if(typeof e=="function")i.callback=e;else if(typeof e=="object"||typeof e=="string")i.callback=n(e),i.callback.bind("keyup",i.updateValue),i.callback.get(0).value&&i.setColor(i.callback.get(0).value);return this},i.updateValue=function(e){var t=this;t.value&&t.value!==i.color&&i.setColor(t.value)},i.setColor=function(e){var t=i.unpack(e);return i.color!==e&&t&&(i.color=e,i.rgb=t,i.hsl=i.RGBToHSL(i.rgb),i.updateDisplay()),this},i.setHSL=function(e){return i.hsl=e,i.rgb=i.HSLToRGB(e),i.color=i.pack(i.rgb),i.updateDisplay(),this},i.widgetCoords=function(e){var t,r,s,o,u;return s=e.target||e.srcElement,o=i.wheel,u=i.absolutePosition(o),t=(e.pageX||0*(e.clientX+n("html").get(0).scrollLeft))-u.x,r=(e.pageY||0*(e.clientY+n("html").get(0).scrollTop))-u.y,{x:t-i.width/2,y:r-i.width/2}},i.mousedown=function(e){o.dragging||(n(o).bind("mousemove",i.mousemove).bind("mouseup",i.mouseup),o.dragging=!0);var t=i.widgetCoords(e);return i.circleDrag=Math.max(Math.abs(t.x),Math.abs(t.y))*2>i.square,i.mousemove(e),!1},i.mousemove=function(e){var t=i.widgetCoords(e),n,r,s;return i.circleDrag?(n=Math.atan2(t.x,-t.y)/6.28,n<0&&(n+=1),i.setHSL([n,i.hsl[1],i.hsl[2]])):(r=Math.max(0,Math.min(1,-(t.x/i.square)+.5)),s=Math.max(0,Math.min(1,-(t.y/i.square)+.5)),i.setHSL([i.hsl[0],r,s])),!1},i.mouseup=function(){n(o).unbind("mousemove",i.mousemove).unbind("mouseup",i.mouseup),o.dragging=!1},i.updateDisplay=function(){var e=i.hsl[0]*6.28,t;n(".h-marker",a).css({left:Math.round(Math.sin(e)*i.radius+i.width/2)+"px",top:Math.round(-Math.cos(e)*i.radius+i.width/2)+"px"}),n(".sl-marker",a).css({left:Math.round(i.square*(.5-i.hsl[1])+i.width/2)+"px",top:Math.round(i.square*(.5-i.hsl[2])+i.width/2)+"px"}),n("."+Ms,a).css("backgroundColor",i.pack(i.HSLToRGB([i.hsl[0],1,.5]))),typeof i.callback=="object"?(n(i.callback).css({backgroundColor:i.color,color:i.hsl[2]>.5?"#000":"#fff"}),n(i.callback).each(function(){return t=this,t.value&&t.value!==i.color&&(t.value=i.color),this})):typeof i.callback=="function"&&i.callback.call(i,i.color)},i.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop},n;return e.offsetParent&&(n=i.absolutePosition(e.offsetParent),t.x+=n.x,t.y+=n.y),t},i.pack=function(e){var t=Math.round(e[0]*255),n,r;return n=Math.round(e[1]*255),r=Math.round(e[2]*255),"#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(r<16?"0":"")+r.toString(16)},i.unpack=function(e){if(e.length===7)return[u("0x"+e.substring(1,3))/255,u("0x"+e.substring(3,5))/255,u("0x"+e.substring(5,7))/255];if(e.length===4)return[u("0x"+e.substring(1,2))/15,u("0x"+e.substring(2,3))/15,u("0x"+e.substring(3,4))/15]},i.HSLToRGB=function(e){var t,n,r,i,s,o=this;return r=e[0],i=e[1],s=e[2],n=s<=.5?s*(i+1):s+i-s*i,t=s*2-n,[o.hueToRGB(t,n,r+.33333),o.hueToRGB(t,n,r),o.hueToRGB(t,n,r-.33333)]},i.hueToRGB=function(e,t,n){return n=n<0?n+1:n>1?n-1:n,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(.66666-n)*6:e},i.RGBToHSL=function(e){var t,n,r,i,s,o,u,a,f;return u=e[0],a=e[1],f=e[2],t=Math.min(u,Math.min(a,f)),n=Math.max(u,Math.max(a,f)),r=n-t,o=(t+n)/2,s=0,o>0&&o<1&&(s=r/(o<.5?2*o:2-2*o)),i=0,r>0&&(n===u&&n!==a&&(i+=(a-f)/r),n===a&&n!==f&&(i+=2+(f-u)/r),n===f&&n!==u&&(i+=4+(u-a)/r),i/=6),[i,s,o]},n("*",a).mousedown(i.mousedown),i.setColor(r||"#000000"),t&&i.linkTo(t)}return e}();t._wijeditorcolorcanvas=Hs})(e.editor||(e.editor={}));var t=e.editor})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=this;"use strict";var r=jQuery,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(t,n){var i=this.options,s=r("."+i.wijCSS.wijratingResetButton,this.ratingElement[0]),o=r("."+i.wijCSS.wijratingStarContainer,this.ratingElement[0]),u=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]);if(r.isPlainObject(i[t])){switch(t){case"resetButton":typeof n.disabled!="undefined"&&n.disabled!==i[t].disabled&&(n.disabled?(s.hide(),s.attr("aria-hidden",!0)):i.disabled||(s.show(),s.attr("aria-hidden",!1))),typeof n.hint!="undefined"&&n.hint!==i[t].hint&&(n.hint===null?s.attr("title",""):s.attr("title",n.hint)),n.position&&n.position.length&&n.position!==i[t].position&&(n.position==="rightOrBottom"?s.parent().append(s):s.parent().prepend(s)),typeof n.customizedClass!="undefined"&&n.customizedClass!==i[t].customizedClass&&(i[t].customizedClass.length&&s.removeClass(i[t].customizedClass),n.customizedClass.length&&s.addClass(n.customizedClass));break;case"hint":typeof n.disabled!="undefined"&&n.disabled!==i[t].disabled&&(n.disabled?u.removeAttr("title"):this._resetHint(i.hint.content)),typeof n.content!="undefined"&&n.content!==i[t].content&&(i[t].disabled||this._resetHint(n.content));break;case"icons":typeof n.iconsClass!="undefined"&&(i[t].iconsClass&&i[t].iconsClass.length&&this._removeCustomizedIconsClass(i[t].iconsClass),this._addCustomizedIconsClass(n.iconsClass,i.split)),typeof n.hoverIconsClass!="undefined"&&i[t].hoverIconsClass&&i[t].hoverIconsClass.length&&this._removeCustomizedIconsClass(i[t].hoverIconsClass),typeof n.ratedIconsClass!="undefined"&&(i[t].ratedIconsClass&&i[t].ratedIconsClass.length&&this._removeCustomizedIconsClass(i[t].ratedIconsClass),this._resetValue(i.value,i.ratingMode,n.ratedIconsClass));break;default:}r.extend(!0,i[t],n)}else{if(n===i[t])return;switch(t){case"disabled":n?(this._unbindLiveEvents(),s.hide(),s.attr("aria-hidden",!0)):(this._bindLiveEvents(),i.resetButton.disabled||(s.show(),s.attr("aria-hidden",!1)));break;case"count":this._createStars(i.split,n,o);break;case"split":this._createStars(n,i.count,o);break;case"totalValue":this._resetTotalValue(n);break;case"orientation":n==="vertical"?this.ratingElement.addClass(i.wijCSS.wijvRating):this.ratingElement.removeClass(i.wijCSS.wijvRating),i.split>1&&(i[t]=n,this._createStars(i.split,i.count,o));break;case"direction":i[t]=n,this._createStars(i.split,i.count,o);break;case"ratingMode":this._resetValue(i.value,n,i.icons.ratedIconsClass);break;case"value":if(i.min&&n<i.min)return;if(i.max&&n>i.max)return;this._resetValue(n,i.ratingMode,i.icons.ratedIconsClass);break;case"iconWidth":i[t]=n,this._createStars(i.split,i.count,o);break;case"iconHeight":i[t]=n,this._createStars(i.split,i.count,o);break;default:}e.prototype._setOption.call(this,t,n)}},t.prototype._create=function(){var t=this.options,n;if(this.element.is("select"))this._parseSelect(),this.element.hide(),n=r("<div></div>"),this.element.after(n);else{if(!this.element.is("div"))return;this.element.children("input[type='radio']").length>0?(this._parseRadio(),this.element.hide(),n=r("<div></div>"),this.element.after(n)):n=this.element}this.ratingElement=n,this._createRating(),t.disabled||this._bindLiveEvents(),e.prototype._create.call(this)},t.prototype.destroy=function(){var t=this.options;this._unbindLiveEvents(),this.element!==this.ratingElement?(this.ratingElement.remove(),this.element.show()):this.element.removeClass(t.wijCSS.widget).removeClass(t.wijCSS.wijrating).removeClass(t.wijCSS.wijvRating).empty(),e.prototype.destroy.call(this)},t.prototype._unbindLiveEvents=function(){var e=this.options;this.ratingElement.off(".wijrating","."+e.wijCSS.wijratingNormalStar).off(".wijrating","."+e.wijCSS.wijratingResetButton)},t.prototype._bindLiveEvents=function(){var e=this,t=e.options,n="."+t.wijCSS.wijratingNormalStar,i="."+t.wijCSS.wijratingResetButton,s,o={element:e.ratingElement,mouseover:function(i){var o=r(i.target),u=r(n,e.ratingElement[0]);o.is(n)&&(u.removeClass(t.wijCSS.wijratingHoverStar),o.addClass(t.wijCSS.wijratingHoverStar),t.ratingMode==="continuous"&&(t.direction==="reversed"?o.parent().nextAll().children().addClass(t.wijCSS.wijratingHoverStar):o.parent().prevAll().children().addClass(t.wijCSS.wijratingHoverStar)),e._addCustomizedHoverIconsClass(t.icons.hoverIconsClass,t.split,o),s={value:parseFloat(o.html()),target:o},e._trigger("hover",i,s))},mouseout:function(i){var s=r(i.target),o=r(n,e.ratingElement[0]);s.is(n)&&(o.removeClass(t.wijCSS.wijratingHoverStar),e._removeCustomizedIconsClass(t.icons.hoverIconsClass))},click:function(i){var o=r(i.target),u=parseFloat(o.html()),a=r(n,e.ratingElement[0]),f={duration:500,easing:null,delay:250,animated:null},l=r.wijmo.wijrating.animations,c;r.extend(!0,f,t.animation),c=f.animated;if(!o.is(n))return;if(t.max&&u>t.max)return;if(t.min&&u<t.min)return;s={oldValue:t.value,newValue:u,target:o};if(e._trigger("rating",i,s)===!1)return!1;t.value=u,e._resetValue(u,t.ratingMode,t.icons.ratedIconsClass),a.removeClass(t.wijCSS.wijratingHoverStar),e._removeCustomizedIconsClass(t.icons.hoverIconsClass),s={value:u,target:o},c?l&&l[c]?l[c](t,a,function(){e._trigger("rated",i,s)}):r.effects&&(r.effects[c]||r.effects.effect&&r.effects.effect[c])?e._playJqueryAnimation(f,a,function(){r.browser.msie&&parseInt(r.browser.version)<9&&a.css("filter",""),e._trigger("rated",i,s)}):e._trigger("rated",i,s):e._trigger("rated",i,s)}},u={element:e.ratingElement,mouseover:function(e){var n=r(e.target);n=n.closest("."+t.wijCSS.wijratingResetButton),n.addClass(t.wijCSS.wijratingHoverResetButton).addClass(t.wijCSS.stateHover),t.resetButton.customizedHoverClass&&t.resetButton.customizedHoverClass.length&&n.addClass(t.resetButton.customizedHoverClass)},mouseout:function(e){var n=r(e.target);n=n.closest("."+t.wijCSS.wijratingResetButton),n.removeClass(t.wijCSS.wijratingHoverResetButton).removeClass(t.wijCSS.stateHover),t.resetButton.customizedHoverClass&&t.resetButton.customizedHoverClass.length&&n.removeClass(t.resetButton.customizedHoverClass)},click:function(t){var n=r(t.target);e._setOption("value",0),s={target:n},e._trigger("reset",t,s)}};this.ratingElement.on("mouseover.wijrating",n,r.proxy(o.mouseover,o)).on("mouseout.wijrating",n,r.proxy(o.mouseout,o)).on("click.wijrating",n,r.proxy(o.click,o)).on("mouseover.wijrating",i,r.proxy(u.mouseover,u)).on("mouseout.wijrating",i,r.proxy(u.mouseout,u)).on("click.wijrating",i,r.proxy(u.click,u))},t.prototype._createRating=function(){var e=this.ratingElement,t=this.options,n,i,s;e.addClass(t.wijCSS.wijrating).addClass(t.wijCSS.widget),t.orientation==="vertical"&&e.addClass(t.wijCSS.wijvRating),n=r("<div></div>").addClass(t.wijCSS.wijratingResetButton).addClass(t.wijCSS.cornerAll).addClass(t.wijCSS.stateDefault),t.resetButton.customizedClass&&t.resetButton.customizedClass.length&&n.addClass(t.resetButton.customizedClass),n.appendTo(e),n.attr("role","button").attr("aria-label","reset").attr("aria-hidden",!1),t.resetButton.hint&&t.resetButton.hint.length&&n.attr("title",t.resetButton.hint);if(t.resetButton.disabled||t.disabled)n.hide(),n.attr("aria-hidden",!0);i=r("<span></span>"),i.addClass(t.wijCSS.icon).addClass(t.wijCSS.iconClose),n.append(i),s=r("<div></div>"),s.attr("role","radiogroup").addClass(t.wijCSS.wijratingStarContainer),t.resetButton.position==="leftOrTop"?s.appendTo(e):s.prependTo(e),this._createStars(t.split,t.count,s)},t.prototype._createStars=function(e,t,n){var i=this.options,s=i.hint,o,u,a,f=0,l=0,c=0,h=Math.ceil(i.iconWidth/e),p=Math.ceil(i.iconHeight/e),d=i.icons.ratedIconsClass,v,m,g=d&&d.length;n.empty();for(l;l<t*e;l++,c++)a=Math.round((l+1)*i.totalValue*100/t/e)/100,f=Math.round((l+2)*i.totalValue*100/t/e)/100,c===e&&(c=0),u=r("<div></div>"),u.attr("role","radio").attr("aria-checked",!1),i.orientation==="vertical"?u.width(i.iconWidth).height(p):u.width(h).height(i.iconHeight),u.addClass(i.wijCSS.wijratingStar),o=r("<div>"+a+"</div>"),o.addClass(i.wijCSS.wijratingNormalStar).width(i.iconWidth).height(i.iconHeight),u.attr("aria-label",a),c>0&&i.direction==="normal"?i.orientation==="vertical"?o.css({"margin-top":"-"+c*p+"px"}):o.css({"margin-left":"-"+c*h+"px"}):c<e-1&&i.direction==="reversed"&&(i.orientation==="vertical"?o.css({"margin-top":"-"+(e-1-c)*p+"px"}):o.css({"margin-left":"-"+(e-1-c)*h+"px"})),s.disabled||(s.content&&s.content.length?l<=s.content.length&&(o.attr("title",s.content[l]),u.attr("aria-label",s.content[l])):o.attr("title",a)),g&&(typeof d=="string"?m=d:r.isArray(d)&&(v=Math.floor(l/e),d.length>v&&(m=d[v]))),a===i.value||f>i.value&&a<i.value&&i.ratingMode==="single"?(o.addClass(i.wijCSS.wijratingRatedStar),g&&o.addClass(m),u.attr("aria-checked",!0)):a<i.value&&i.ratingMode==="continuous"&&(o.addClass(i.wijCSS.wijratingRatedStar),g&&o.addClass(m)),o.appendTo(u),i.direction==="reversed"?u.prependTo(n):u.appendTo(n);this._addCustomizedIconsClass(i.icons.iconsClass,e)},t.prototype._resetValue=function(e,t,n){var i=this.options,s=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]),o=t||i.ratingMode,u=n&&n.length,a=0,f;r.each(s,function(t,l){var c=r(l),h=parseFloat(c.html()),p;t<s.length-1?p=parseFloat(r(s[t+1]).html()):p=i.direction==="normal"?i.totalValue+1:-1,c.removeClass(i.wijCSS.wijratingRatedStar),c.parent().attr("aria-checked",!1),u&&(typeof n=="string"?(c.removeClass(n),f=n):r.isArray(n)&&(r.each(n,function(e,t){c.removeClass(t)}),i.direction==="reversed"?a=Math.floor((s.length-1-t)/i.split):a=Math.floor(t/i.split),n.length>a&&(f=n[a]))),h===e||p>e&&h<e&&o==="single"?(c.addClass(i.wijCSS.wijratingRatedStar),u&&c.addClass(f),c.parent().attr("aria-checked",!0)):o==="continuous"&&h<e&&(c.addClass(i.wijCSS.wijratingRatedStar),u&&c.addClass(f))})},t.prototype._resetTotalValue=function(e){var t=this.options,n=t.hint,i=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]),s=i.length;r.each(i,function(i,u){var a=r(u),f=Math.round((i+1)*e*100/s)/100,l=parseFloat(a.html());l===t.value&&(t.value=f),a.html(f.toString()),n&&n.length&&n.length>=i&&n[i]&&n[i].length?a.attr("title",n[i]):a.attr("title",f)})},t.prototype._resetHint=function(e){var t=this.options,n=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]);r.each(n,function(t,n){var i=r(n),s=parseFloat(i.html());e&&e.length&&e.length>=t&&e[t]&&e[t].length?i.attr("title",e[t]):i.attr("title",s)})},t.prototype._clearIntentTimer=function(){this.intentTimers&&this.intentTimers.length&&r.each(this.intentTimers,function(e,t){t&&(window.clearTimeout(t),t=null)}),this.intentTimers=[]},t.prototype._playJqueryAnimation=function(e,t,n){var i=this,s=this,o=s.options,u={easing:e.easing},a=e.animated;s._clearIntentTimer(),r.each(t,function(f,l){var c=Math.floor(f/o.split)*e.delay,h;h=window.setTimeout(function(){r(l).hide(a,u,e.duration,function(){if(f!==t.length-1)return;r.each(t,function(f,l){var c=Math.floor(f/o.split)*e.delay,h;h=window.setTimeout(function(){r(l).show(a,u,e.duration,function(){f===t.length-1&&n&&r.isFunction(n)&&n.call(i)})},c),s.intentTimers.push(h)})})},c),s.intentTimers.push(h)})},t.prototype._addCustomizedIconsClass=function(e,t){var n=this,i=n.options,s,o=0,u=0;e&&e.length&&(s=r("."+i.wijCSS.wijratingNormalStar,n.ratingElement[0]),r.each(s,function(i,s){o===t&&(o=0,u++);if(typeof e=="string")r(s).addClass(e);else if(r.isArray(e)){var a=e.length;u<a&&(n.options.direction==="reversed"?r(s).addClass(e[a-u-1]):r(s).addClass(e[u]))}o++}))},t.prototype._addCustomizedHoverIconsClass=function(e,t,n){var i=this.options,s=i.direction,o=i.ratingMode,u=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]),a=u.index(n),f=0,l;if(e&&e.length)if(typeof e=="string")n.addClass(e),o!=="single"&&(s==="reversed"?n.parent().nextAll().children().addClass(e):n.parent().prevAll().children().addClass(e));else if(r.isArray(e))if(o==="single")s==="reversed"?l=u.length-1-a:l=a,f=Math.floor(l/t),e.length>f&&n.addClass(e[f]);else if(s==="reversed")for(l=u.length-1;l>=a;l--)f=Math.floor((u.length-1-l)/t),e.length>f&&r(u[l]).addClass(e[f]);else for(l=0;l<=a;l++)f=Math.floor(l/t),e.length>f&&r(u[l]).addClass(e[f])},t.prototype._removeCustomizedIconsClass=function(e){var t=this.options,n=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]);e&&e.length&&(typeof e=="string"?n.removeClass(e):r.isArray(e)&&r.each(e,function(e,t){n.removeClass(t)}))},t.prototype._parseSelect=function(){var e=this.options,t=[],n=r("option",this.element);n.length&&(e.count=n.length,e.totalValue=n.length,r.each(n,function(n,i){var s=r(i);t.push(s.html()),s.is(":selected")&&(e.value=n+1)}),e.hint.content=t)},t.prototype._parseRadio=function(){var e=this,t=e.options,n=[],i=r("input[type='radio']",e.element);i.length&&(t.count=i.length,t.totalValue=i.length,r.each(i,function(i,s){var u=r(s),a=u.attr("id"),f;a&&a.length>0?(f=r("label[for='"+a+"']",e.element),f.length?n.push(f.html()):n.push("")):n.push(""),u.is(":checked")&&(t.value=i+1)}),t.hint.content=n)},t}(e.wijmoWidget);t.wijrating=i;var s=function(){function e(){this.wijCSS={wijrating:"wijmo-wijrating",wijratingStarContainer:"wijmo-wijrating-starcontainer",wijratingResetButton:"wijmo-wijrating-reset",wijratingHoverResetButton:"wijmo-wijrating-resethover",wijratingStar:"wijmo-wijrating-star",wijratingNormalStar:"wijmo-wijrating-normal",wijratingHoverStar:"wijmo-wijrating-hover",wijratingRatedStar:"wijmo-wijrating-rated",wijvRating:"wijmo-wijrating-vertical"},this.wijMobileCSS={iconClose:"ui-icon-delete"},this.disabled=!1,this.count=5,this.split=1,this.totalValue=5,this.value=0,this.min=null,this.max=null,this.resetButton={disabled:!1,hint:"cancel this rating!",position:"leftOrTop",customizedClass:"",customizedHoverClass:""},this.hint={disabled:!1,content:null},this.orientation="horizontal",this.direction="normal",this.ratingMode="continuous",this.icons={iconsClass:null,hoverIconsClass:null,ratedIconsClass:null},this.iconWidth=16,this.iconHeight=16,this.animation=null,this.rating=null,this.rated=null,this.reset=null,this.hover=null}return e}();i.prototype.options=r.extend(!0,{},e.wijmoWidget.prototype.options,new s),r.wijmo.registerWidget("wijrating",i.prototype),r.mobile&&(r.mobile.selectmenu.initSelector=r.mobile.selectmenu.initSelector+":not( :jqmData(role='wijrating') )"),r.extend(r.wijmo.wijrating,{animations:{scroll:function(e,t,i){var s=e,o=i,u=250,a=500,f="linear",l=250,c=jQuery.makeArray(t);c.reverse(),r.each(c,function(e,n){var i=Math.floor(e/s.split)*l,c={width:0},h,p;h=window.setTimeout(function(){r(n).animate(c,u,f,function(){window.clearTimeout(h);if(e!==t.length-1)return;p=window.setTimeout(function(){r.each(t,function(e,n){var i=Math.floor(e/s.split)*l,a={width:s.iconWidth},c;c=window.setTimeout(function(){var i=this;r(n).animate(a,u,f,function(){window.clearTimeout(c),e===t.length-1&&o&&r.isFunction(o)&&o.call(i)})},i)}),window.clearTimeout(p)},a)})},i)}),i&&r.isFunction(i)&&i.call(n)}}})})(e.rating||(e.rating={}));var t=e.rating})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this;t._handleChartStyles(),e.prototype._create.call(this),t.chartElement.addClass(t.options.wijCSS.scatter)},t.prototype.destroy=function(){var t=this;t.chartElement.removeClass(t.options.wijCSS.scatter),e.prototype.destroy.call(this)},t.prototype.getScatter=function(e,t){var n=this,r=n.chartElement.data("fields"),i,s,o,u;if(r&&r.chartElements){o=r.chartElements.scatters;if(o&&o.length){s=o.length;if(e<0||e>=s)return i;u=o[e];if(typeof t=="undefined")return u;s=u.length;if(u&&s)return t<0||t>=s?i:u[t]}return i}},t.prototype._paintLegendIcon=function(e,t,n,r,i,s,o,u,a,f){var l=this,c=Math.min(n,r),h,p=a.markerType,d;return h=a.markerStyle,h=$.extend({fill:i.stroke,stroke:i.stroke,opacity:1},h),p||(p="circle"),d=l.canvas.paintMarker(p,e+n/2,t+r/2,3),$(d.node).data("legendIndex",s).data("index",o),l.legendIcons.push(d),d.attr(h),$.wijraphael.addClass($(d.node),u),a.visible===!1&&($(f.node).data("dotOpacity",d.attr("opacity")||1),d.attr("opacity",.3)),d},t.prototype._paintLegend=function(){var t=this,n=t.options,r=[].concat(n.seriesList),i=n.seriesStyles,s=0;$.extend(!0,n,{legend:{size:{width:20,height:10}}}),e.prototype._paintLegend.call(this)},t.prototype._showSerieEles=function(e){$.each(e,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)})},t.prototype._hideSerieEles=function(e){$.each(e,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)})},t.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.dot&&(t.dot.attr(t.hoverStyle),t.dot.scale(1.5,1.5))})},t.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.dot&&(t.dot.attr(t.style),t.dot.scale(1,1))})},t.prototype._paintTooltip=function(){var t=this,n=t.chartElement,r=n.data("fields");e.prototype._paintTooltip.call(this),t.tooltip&&r&&r.chartElements&&r.chartElements.tooltipTars&&(t.tooltip.setTargets(r.chartElements.tooltipTars),t.tooltip.setOptions({mouseTrailing:!1}))},t.prototype._getTooltipText=function(e,t){var n=$(t).data("wijchartDataObj"),r={data:n,label:n.label,x:n.x,y:n.y,type:n.markerType,target:t,fmt:e};return $.proxy(e,r)()},t.prototype._onBeforeTooltipShowing=function(t){var n=this,r=t.options,i=n.options.hint.style,s=t.target,o,u;s&&($.browser.msie&&parseInt($.browser.version)<9?(o=$(s).data().wijchartDataObj,u=o.style,r.style.stroke=i.stroke||u.stroke||u.fill||"#ffffff"):r.style.stroke=i.stroke||s.getAttribute("stroke")||s.getAttribute("fill")||"#ffffff",s.attrs={stroke:r.style.stroke}),e.prototype._onBeforeTooltipShowing.call(this,t)},t.prototype._clearChartElement=function(){var e=this,t=e.chartElement.data("fields");e.headerEles.length&&($.each(e.headerEles,function(e,t){t.wijRemove(),t=null}),e.headerEles=[]),e.footerEles.length&&($.each(e.footerEles,function(e,t){t.wijRemove(),t=null}),e.footerEles=[]),e.legendEles.length&&($.each(e.legendEles,function(e,t){t.wijRemove(),t=null}),e.legendEles=[]),e.legends.length&&($.each(e.legends,function(e,t){t.wijRemove(),t=null}),e.legends=[]),e.legendIcons.length&&($.each(e.legendIcons,function(e,t){t.wijRemove(),t=null}),e.legendIcons=[]),e.legendDots.length&&($.each(e.legendDots,function(e,t){t=null}),e.legendDots=[]),e.axisEles.length&&($.each(e.axisEles,function(e,t){t.wijRemove(),t=null}),e.axisEles=[]),e.chartLabelEles.length&&($.each(e.chartLabelEles,function(e,t){t.wijRemove(),t=null}),e.chartLabelEles=[]),t&&t.chartElements&&($.each(t.chartElements,function(e,n){n.length&&$.each(n,function(e,t){t[0]!==null&&(t.remove&&t.remove(),n[e]=null)}),t.chartElements[e]=null}),t.chartElements={},$(t.clipRect.element).stop().remove(),t.render.destroy(),t.clipRect.destroy()),e.dataPoints=null,e.pointXs=null,e.canvas.clear(),e.innerState={}},t.prototype._paintPlotArea=function(){var e=this,t=e.options,n;n=new r(this.chartElement,{bounds:e.canvasBounds,widgetName:e.widgetName,canvas:e.canvas,tooltip:e.tooltip,axis:t.axis,animation:t.animation,seriesTransition:t.seriesTransition,seriesList:t.seriesList,seriesStyles:t.seriesStyles,seriesHoverStyles:t.seriesHoverStyles,hint:t.hint,disabled:t.disabled,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,zoomOnHover:t.zoomOnHover,mouseDown:$.proxy(e._mouseDown,e),mouseUp:$.proxy(e._mouseUp,e),mouseOver:$.proxy(e._mouseOver,e),mouseOut:$.proxy(e._mouseOut,e),mouseMove:$.proxy(e._mouseMove,e),click:$.proxy(e._click,e),showChartLabels:t.showChartLabels,chartLabelStyle:t.chartLabelStyle,chartLabelFormatString:t.chartLabelFormatString,culture:e._getCulture(),wijCSS:t.wijCSS,widget:this}),n.render()},t}(e.wijchartcore);e.wijscatterchart=t,t.prototype.widgetEventPrefix="wijscatterchart";var n=function(){function e(){this.initSelector=":jqmData(role='wijscatterchart')",this.wijCSS={scatter:"wijmo-wijscatterchart",scatterElement:"wijscatterchart"},this.animation={enabled:!0,duration:2e3,easing:">"},this.showChartLabels=!1,this.seriesTransition={enabled:!0,duration:2e3,easing:">"},this.zoomOnHover=!0,this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijscatterchart",t.prototype);var r=function(){function t(e,t){this.scatters=[],this.chartLabels=[],this.tooltipTars=[],this.seriesEles=[],this.element=e,this.options=t,this._init()}return t.prototype._init=function(){var t=this.element,n=this.options,r=n.bounds,i=n.axis.x.min,s=n.axis.y.min,o=n.axis.x.max,u=n.axis.y.max;this.width=r.endX-r.startX,this.height=r.endY-r.startY,this.plotInfo={minX:i,minY:s,maxX:o,maxY:u,width:this.width,height:this.height,kx:this.width/(o-i),ky:this.height/(u-s)},this.fields=t.data("fields")||{},t.find("svg").length>0?this.chartRender=e.render.createRender(t.find("svg").get(0),t.width(),t.height()):this.chartRender=e.render.createRender(t.children(":first").addClass("vmlcontainer").get(0),t.width(),t.height()),this.clipRect=this.chartRender.clipRect(0,0,0,t.height()),this.g=this.chartRender.g(),this.g.clip(this.clipRect),this.g.add(),this.fields.render=this.chartRender,this.fields.clipRect=this.clipRect},t.prototype.bindLiveEvents=function(){var e=$.isFunction,t=this.options,n=t.wijCSS,r=this.element,i=t.widgetName,s=t.mouseDown,o=t.mouseUp,u=t.mouseOver,a=t.mouseOut,f=t.mouseMove,l=t.click,c=t.zoomOnHover,h=t.seriesHoverStyles,p=t.seriesStyles,d=t.disabled,v="";$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(v="wij"),$("."+n.scatterElement,r[0]).on(v+"mousedown."+i,function(t){if(d)return;if(e(s)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),s.call(r,t,n)}}).on(v+"mouseup."+i,function(t){if(d)return;if(e(o)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),o.call(r,t,n)}}).on(v+"mouseover."+i,function(t){if(d)return;var n=$(t.target).data("wijchartDataObj"),i,s,o;n||(n=$(t.target.parentNode).data("wijchartDataObj")),o=n.dot,c&&(i=n.seriesIndex,o.attr&&(s=$.extend(!0,{},h[i]),o.attr(s)),document.createElementNS?o.scale(1.5,1.5):o.attr("stroke-width",5)),e(u)&&u.call(r,t,n)}).on(v+"mouseout."+i,function(t){if(d)return;var n=$(t.target).data("wijchartDataObj"),i,s;n||(n=$(t.target.parentNode).data("wijchartDataObj")),s=n.dot,c&&(i=n.seriesIndex,s.attr&&s.attr($.extend(!0,{},p[i]))),document.createElementNS&&s.scale(1,1),e(a)&&a.call(r,t,n)}).on(v+"mousemove."+i,function(t){if(d)return;if(e(f)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),f.call(r,t,n)}}).on(v+"click."+i,function(t){if(d)return;if(e(l)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),l.call(r,t,n)}})},t.prototype.unbindLiveEvents=function(){var e=this.options,t=e.widgetName,n=e.wijCSS;$("."+n.scatterElement,this.element).off(t).off("."+t)},t.prototype.paintDefaultChartLabel=function(e,t,n){var r=this.options,i=$.extend(!0,{},r.textStyle,r.chartLabelStyle),s,o=r.chartLabelFormatString,u;return r.isYTime?s=Globalize.format(n,"f",r.culture):s=$.round(n,2),o&&o.length&&(s=Globalize.format(s,o,r.culture)),u=this.chartRender.text(e,t,s),u},t.prototype.paintScatters=function(){var e=this,t=e.options,n=t.seriesList,r=t.seriesStyles,i=t.seriesHoverStyles,s=t.isXTime,o=t.isYTime,u=t.bounds,a=this.plotInfo,f=t.wijCSS,l=t.showChartLabels,c=t.chartLabelStyle,h=t.widget;$.each(n,function(t,n){var p=n.data,d,v=n.markerWidth||5,m=r[t],g=i[t],y=p.x,b=p.y,w=[],E=[],S;n=$.extend(!0,{visible:!0,markerType:"circle"},n),d=n.markerType;if(n.display==="exclude")return!0;!m.fill&&m.stroke&&(m.fill=m.stroke);if(y===undefined)return!0;$.each(b,function(r,i){var p=y[r],x=0,T=0,N,C,k,L={};s&&(p=$.toOADate(p)),o&&(i=$.toOADate(i));if(typeof p=="undefined")return!1;isNaN(p)||typeof p=="string"?N=r:N=p,x=u.startX+(N-a.minX)*a.kx,T=u.endY-(i-a.minY)*a.ky,m.opacity&&(m["fill-opacity"]=m.opacity,m["stroke-opacity"]=m.opacity,delete m.opacity),d==="cross"&&m["stroke-width"]!==undefined&&m["stroke-width"]===0&&(m["stroke-width"]=1),C=e.chartRender.symbol(d,x,T,v),C.attr(m),C.add(e.g),C.attr({"class":f.canvasObject+" "+f.scatterElement}),L=$.extend(!1,{dot:C,x:y[r],y:b[r],seriesIndex:t,index:r,markerType:d,type:"scatter",style:m,hoverStyle:g,visible:!0},n),l&&(k=e.paintDefaultChartLabel(x,T-6,b[r]),k.add(e.g),c=$.extend({"font-size":"10px",fill:"#888","font-family":"Arial"},c),k.attr(c),C.label=k,e.chartLabels.push(k)),h.dataPoints=h.dataPoints||{},h.pointXs=h.pointXs||[],S=$.round(x,2),h.dataPoints[S.toString()]||(h.dataPoints[S.toString()]=[],h.pointXs.push(S)),h.dataPoints[S.toString()].push(L),$(C.element).data("wijchartDataObj",L),w.push(C),e.tooltipTars.push($.extend({},C,{node:C.element})),E.push(C),n.visible===!1&&C.hide()}),e.scatters.push(w),e.seriesEles.push(E)})},t.prototype.playAnimation=function(){var e=this,t=e.options,n=t.animation,r=e.element,i=r.css("background-color");n.enabled?(i==="transparent"&&(i="white"),e.clipRect.getCSS?$(e.clipRect.members[0].element).animate({width:r.width()},{duration:n.duration,step:function(t){e.clipRect.width=t;var n=e.clipRect.getCSS();$(this).css(n)}}):$(e.clipRect.element).animate({width:r.width()},{duration:n.duration,step:function(t){e.clipRect.attr("width",t)}})):e.clipRect.getCSS?($(e.clipRect.members[0].element).css({width:r.width()}),e.clipRect.width=r.width(),$(e.clipRect.members[0].element).css(e.clipRect.getCSS())):($(e.clipRect.element).css({width:r.width()}),e.clipRect.attr("width",r.width()))},t.prototype.render=function(){this.paintScatters(),this.playAnimation(),this.unbindLiveEvents(),this.bindLiveEvents(),this.chartEles={animationSet:this.animationSet,tooltipTars:this.tooltipTars,scatters:this.scatters,labels:this.chartLabels},this.fields.chartElements||(this.fields.chartElements={}),this.fields.seriesEles=this.seriesEles,$.extend(!0,this.fields.chartElements,this.chartEles),this.element.data("fields",this.fields)},t}();e.ScatterChartRender=r})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(e){function w(e){return typeof e=="string"}function E(e){return typeof e=="number"}function S(e){return e!==undefined&&e!==null}function x(e,t,n){var r="setAttribute",i;return w(t)?S(n)?e[r](t,n):e&&e.getAttribute&&(i=e.getAttribute(t)):S(t)&&$.isPlainObject(t)&&$.each(t,function(t,n){e[r](t,n)}),i}function T(e,t){r&&t&&t.opacity!==undefined&&(t.filter="alpha(opacity="+t.opacity*100+")"),$.extend(e.style,t)}function N(e,n,r){var i=t.createElement(e);return n&&$.extend(i,n),r&&T(i,r),i}function C(e){$.each(e,function(t,n){e[t]&&e[t].destroy&&e[t].destroy(),delete e[t]})}function D(e,t,n){return o?new O(e,t,n):new _(e,t,n)}var t=document,n=$.each,r=$.browser.msie,i=t.documentMode===8,s="http://www.w3.org/2000/svg",o=!!t.createElementNS&&!!t.createElementNS(s,"svg").createSVGRect,u=0,a="div",f="absolute",l="hidden",c="scatterchart-",h="visible",p="visibility",d="px",v="none",m="M",g="L",y=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,b=/^(\d{1,3})\-(?:((?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))\-)(?:(?:((?:(?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))(?:\:\d{1,3})?)\-)?)*((?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))$/,k=function(){function e(){}return e.prototype.attr=function(e,t){},e.prototype.scale=function(e,t){},e.prototype.symbolAttr=function(e){},e.prototype.clip=function(e){},e.prototype.crisp=function(e,t,n,r,i){},e.prototype.css=function(e){},e.prototype.getBBox=function(){},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.add=function(e){},e.prototype.destroy=function(){},e.prototype.empty=function(){},e.prototype.remove=function(){},e}();e.ChartElement=k;var L=function(){function e(e,t,n){}return e.prototype.destroy=function(){},e.prototype.createElement=function(e){},e.prototype.path=function(e){return this._element},e.prototype.circle=function(e,t,n){return this._element},e.prototype.rect=function(e,t,n,r,i,s){return this._element},e.prototype.setSize=function(e,t){},e.prototype.g=function(e){return this._element},e.prototype.text=function(e,t,n){return this._element},e.prototype.symbol=function(e,t,n,r,i){return this._element},e.prototype.clipRect=function(e,t,n,r){return this._element},e}();e.ChartRender=L;var A=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e,n){this.element=t.createElementNS(s,n),this.renderer=e},i.prototype.attr=function(e,t){var n,r,i=this.element,s=this.renderer,o=i.nodeName,u,a=this;if(e===undefined)return;return w(e)&&S(t)&&(n=e,e={},e[n]=t),w(e)?(n=e,o==="circle"&&(n={x:"cx",y:"cy"}[n]||n),a=x(i,n)||this[n]||0,n!=="d"&&n!==p&&(a=parseFloat(a))):e&&$.each(e,function(t,n){u=!1,r=e[t],t==="d"?(r&&r.join&&(r=r.join(" ")),/(NaN| {2}|^$)/.test(r)&&(r="M 0 0"),this.d=r):t==="fill"?r=s._color(r,i,t):o==="circle"&&(t==="x"||t==="y")&&(t={x:"cx",y:"cy"}[t]||t),jQuery.browser.safari&&t==="stroke-width"&&r===0&&(r=1e-6),u||x(i,t,r),i.attrs=i.attrs||{},i.attrs[t]=r}),a},i.prototype.scale=function(e,t){var n=this,r=n.getBBox(),i=-(r.x+r.width/2)/2,s=-(r.y+r.height/2)/2;e===1&&(i=0),t===1&&(s=0),n.attr("transform","matrix("+e+",0,0, "+t+","+i+","+s+")")},i.prototype.symbolAttr=function(e){var t=this;n(["x","y","r","start","end","width","height","innerR"],function(n,r){e[r]?t[r]=e[r]:t[r]=t[r]}),t.attr({d:t.renderer.symbols[t.symbolName](Math.round(t.x*2)/2,Math.round(t.y*2)/2,t.r,{start:t.start,end:t.end,width:t.width,height:t.height,innerR:t.innerR})})},i.prototype.clip=function(e){return this.attr("clip-path","url("+this.renderer.url+"#"+e.id+")")},i.prototype.crisp=function(e,t,n,r,i){var s=this,o,u={},a={},f;e=e||s.strokeWidth||0,f=e%2/2,a.x=Math.floor(t||s.x||0)+f,a.y=Math.floor(n||s.y||0)+f,a.width=Math.floor((r||s.width||0)-2*f),a.height=Math.floor((i||s.height||0)-2*f),a.strokeWidth=e;for(o in a)s[o]!==a[o]&&(s[o]=u[o]=a[o]);return u},i.prototype.css=function(e){var t=this,n=t.element,i=e&&e.width&&n.nodeName==="text",s="",u=function(e,t){return"-"+t.toLowerCase()};return e&&e.color&&(e.fill=e.color),e=$.extend(t.styles,e),t.styles=e,r&&!o?(i&&delete e.width,T(t.element,e)):($.each(e,function(t,n){s+=n.replace(/([A-Z])/g,u)+":"+e[n]+";"}),t.attr({style:s})),t},i.prototype.getBBox=function(){var e,t,n,r=this.rotation,i=r*Math.PI*2/360;try{e=$.extend({},this.element.getBBox())}catch(s){e={width:0,height:0}}return t=e.width,n=e.height,r&&(e.width=Math.abs(n*Math.sin(i))+Math.abs(t*Math.cos(i)),e.height=Math.abs(n*Math.cos(i))+Math.abs(t*Math.sin(i))),e},i.prototype.show=function(){return this.attr({visibility:h})},i.prototype.hide=function(){return this.attr({visibility:l})},i.prototype.add=function(e){var t=this,n=t.renderer,r=e||n,i=r.element||n.box,s=i.childNodes,o=t.element,u=x(o,"zIndex"),a,f,l;e&&t.htmlNode&&(e.htmlNode||(e.htmlNode=[]),e.htmlNode.push(t)),u&&(r.handleZ=!0,u=parseInt(u,10));if(r.handleZ)for(l=0;l<s.length;l++){a=s[l],f=x(a,"zIndex");if(a!==o&&(parseInt(f,10)>u||!S(u)&&S(f)))return i.insertBefore(o,a),t}return i.appendChild(o),t.added=!0,t},i.prototype._safeRemoveChild=function(e){var t=e.parentNode;t&&t.removeChild(e)},i.prototype.destroy=function(){var e=this,t=e.element||{},r=e.shadows,i=e.box,s;t.onclick=t.onmouseout=t.onmouseover=t.onmousemove=null,e.clipPath&&(e.clipPath=e.clipPath.destroy());if(e.stops){for(s=0;s<e.stops.length;s++)e.stops[s]=e.stops[s].destroy();e.stops=null}return e._safeRemoveChild(t),r&&n(r,function(t){e._safeRemoveChild(t)}),i&&i.destroy(),$.each(e,function(t,n){delete e[t]}),null},i.prototype.empty=function(){var e=this.element,t=e.childNodes,n=t.length;while(n--)e.removeChild(t[n]),$(t[n]).remove()},i.prototype.remove=function(){var e=this.element,t=e.parentNode;t.removeChild(e),$(e).remove()},i}(k),O=function(e){function n(t,n,r){e.call(this,t,n,r),this.gradientCache={},this.init(t,n,r)}return __extends(n,e),n.prototype.init=function(e,i,o){var u=this,a=t.location,f;this.symbols=n._symbols,this.Element=A,$(e).is("svg")?(u.box=e,f=new u.Element,f.element=e,f.render=u,u.defs=$("defs",e).get(0),u.gradients={}):(f=u.createElement("svg").attr({xmlns:s,version:"1.1"}),e.appendChild(f.element),u.box=f.element,u.boxWrapper=f,u.defs=this.createElement("defs").add(),u.gradients={},u.setSize(i,o)),u.url=r?"":a.href.replace(/#.*?$/,"")},n.prototype.destroy=function(){var e=this;return e.box=null,C(e.gradients||{}),e.gradients=null,null},n.prototype.createElement=function(e){var t=new this.Element;return t.init(this,e),t},n.prototype.path=function(e){var t=this.createElement("path");return t.attr({d:e,fill:v}),t},n.prototype.circle=function(e,t,n){var r=$.isPlainObject(e)?e:{x:e,y:t,r:n},i=this.createElement("circle");return i.attr(r),i},n.prototype.rect=function(e,t,n,r,i,s){$.isPlainObject(e)&&(t=e.y,n=e.width,r=e.height,i=e.r,s=e.strokeWidth,e=e.x);var o=this.createElement("rect");return o.attr({rx:i,ry:i,fill:v}),o.attr(o.crisp(s,e,t,Math.max(n,0),Math.max(r,0))),o},n.prototype.setSize=function(e,t){var n=this;n.width=e,n.height=t,n.boxWrapper.attr({width:e,height:t})},n.prototype.g=function(e){var t=this.createElement("g");return S(e)&&t.attr({"class":c+e}),t},n.prototype.text=function(e,t,n){$.isPlainObject(e)&&(t=e.y,n=e.text,e=e.x);var r=this.createElement("text");return r.attr({x:e,y:t,"text-anchor":"middle"}),r.element.textContent=n,r},n.prototype.symbol=function(e,t,n,r,i){var s,o=this,u=o.symbols[e],a=u&&u(Math.round(t),Math.round(n),r,i);return a?(s=o.path(a),$.extend(s,{symbolName:e,x:t,y:n,r:r}),i&&$.extend(s,i)):s=o.circle(t,n,r),s},n._symbols={box:function(e,t,n){var r=.707*n;return[m,e-r,t-r,g,e+r,t-r,e+r,t+r,e-r,t+r,"Z"]},tri:function(e,t,n){return[m,e,t-1.33*n,g,e+n,t+.67*n,e-n,t+.67*n,"Z"]},invertedTri:function(e,t,n){return[m,e,t+1.33*n,g,e-n,t-.67*n,e+n,t-.67*n,"Z"]},diamond:function(e,t,n){return[m,e,t-n,g,e+n,t,e,t+n,e-n,t,"Z"]},cross:function(e,t,n){var r=.707*n;return[m,e-r,t-r,g,e+r,t+r,m,e-r,t+r,g,e+r,t-r]},arc:function(e,t,n,r){var i=r.start,s=r.end-1e-6,o=r.innerR,u=Math.cos(i),a=Math.sin(i),f=Math.cos(s),l=Math.sin(s),c=r.end-i<Math.PI?0:1;return[m,e+n*u,t+n*a,"A",n,n,0,c,1,e+n*f,t+n*l,g,e+o*f,t+o*l,"A",o,o,0,c,0,e+o*u,t+o*a,"Z"]}},n.prototype.clipRect=function(e,t,n,r){var i,s=c+u++,o=this.createElement("clipPath");return o.attr({id:s}),$(this.defs).append(o.element),i=this.rect(e,t,n,r,0).add(o),i.id=s,i.clipPath=o,i},n.prototype._parsegradientcolor=function(e){var t=this,n=[],r,i,s,o,u,a,f,l;if(t.gradientCache[e])return t.gradientCache[e];for(s=0,a=e.length;s<a;s++){r={},i=e[s].match(/^([^:]*):?([\d\.]*)/),r.color=Raphael.getRGB(i[1]);if(r.color.error)return null;r.color=r.color.hex,i[2]&&(r.offset=i[2]+"%"),n.push(r)}for(s=1,a=n.length-1;s<a;s++)if(!n[s].offset){o=parseFloat(n[s-1].offset||0),u=0;for(f=s+1;f<a;f++)if(n[f].offset){u=n[f].offset;break}u||(u=100,f=a),u=parseFloat(u),l=(u-o)/(f-s+1);for(;s<f;s++)o+=l,n[s].offset=o+"%"}return t.gradientCache[e]=n,n},n.prototype._color=function(e,t,n){var r=this,i="color",s=.5,o=.5,a=r.gradients,f,l,h,p,d,v,m,g,w,E,S=e,T,N,C;b.test(e)?i="linear":e=e.replace(y,function(e,t,n){i="radial";if(t&&n){s=parseFloat(t),o=parseFloat(n);var r=o>.5?1:-1;Math.pow(s-.5,2)+Math.pow(o-.5,2)>.25&&(o=Math.sqrt(.25-Math.pow(s-.5,2))*r+.5)&&o!==.5&&(o=parseFloat(o.toFixed(5))-1e-5*r)}return""});if(i==="linear"||i==="radial"){l=e.split(/\s*\-\s*/);if(i==="linear"){N=l.shift(),N=-parseFloat(N);if(isNaN(N))return e;g=[0,0,Math.cos(Raphael.rad(N)),Math.sin(Raphael.rad(N))],w=1/(Math.max(Math.abs(g[2]),Math.abs(g[3]))||1),g[2]*=w,g[3]*=w,g[2]<0&&(g[0]=-g[2],g[2]=0),g[3]<0&&(g[1]=-g[3],g[3]=0),h=g[0],p=g[1],d=g[2],v=g[3]}return a[S]?T=x(a[S].element,"id"):(C=this._parsegradientcolor(l),$.each(C,function(e,t){t.offset=t.offset?t.offset:e?"100%":"0%"}),T=c+u++,f=r.createElement(i+"Gradient"),i==="radial"?f.attr({id:T,fx:s,fy:o}):f.attr({id:T,x1:h,y1:p,x2:d,y2:v}),$(this.defs).append(f.element),f.stops=[],$.each(C,function(e,t){var n;m=t.color,E=1,n=r.createElement("stop"),n.attr({offset:t.offset,"stop-color":m,"stop-opacity":E}).add(f),f.stops.push(n)}),a[S]=f),"url(#"+T+")"}return t.removeAttribute(n+"-opacity"),e},n}(L),M=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.init=function(e,t){var n=["<",t,' filled="f" stroked="f"'],r=["position: ",f,";"];(t==="shape"||t===a)&&r.push("left:0;top:0;width:10px;height:10px;"),i&&r.push("visibility: ",t===a?l:h),n.push(' style="',r.join(""),'"/>'),t&&(n=t===a||t==="span"||t==="img"?n.join(""):e.prepVML(n),this.element=N(n)),this.renderer=e},t.prototype.add=function(e){var t=this,n=t.renderer,r=t.element,s=n.box,o=e&&e.inverted,u=e?e.element||e:s;return o,i&&u.gVis===l&&T(r,{visibility:l}),u.appendChild(r),t.added=!0,t},t.prototype.attr=function(e,t){var n,r,s,o=this,u=o.element||{},f=u.style,l=u.nodeName,c=o.symbolName,m=o.renderer,g,y,b=o.shadows,N,C,k=o;return e===undefined?k:(w(e)&&S(t)&&(n=e,e={},e[n]=t),w(e)?(n=e,n==="strokeWidth"||n==="stroke-width"?k=o.strokeweight:k=o[n]):e&&$.each(e,function(t,n){r=n,N=!1;if(c&&/^(x|y|r|start|end|width|height|innerR)/.test(t))y||(o.symbolAttr(e),y=!0),N=!0;else if(t==="d"){r=r||[],o.d=r.join(" "),s=r.length,C=[];while(s--)E(r[s])?C[s]=Math.round(r[s]*10)-5:r[s]==="Z"?C[s]="x":C[s]=r[s];r=C.join(" ")||"x",u.path=r;if(b){s=b.length;while(s--)b[s].path=r}N=!0}else if(t==="zIndex"||t===p){if(i&&t===p&&l===a){u.gVis=r,g=u.childNodes,s=g.length;while(s--)T(g[s],{visibility:r});r===h&&(r=null)}r&&(f[t]=r),N=!0}else t==="class"?u.className=r:t==="stroke"?t="strokecolor":t==="stroke-width"||t==="strokeWidth"?(u.stroked=r?!0:!1,t="strokeweight",o[t]=r,E(r)&&(r+=d)):t==="fill"&&(l==="SPAN"?f.color=r:(u.filled=r!==v?!0:!1,r=m.color(r,u,t),t="fillcolor"));N||(t==="opacity"&&(t="fill-opacity"),i?u[t]=r:x(u,t,r)),u.attrs=u.attrs||{},u.attrs[t]=r}),k)},t.prototype.scale=function(e,t){var n=this,r=n.attr("stroke-width")||0;n.css({filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+e+","+", M12=0, M21=0, M22="+t+", Dx=0, Dy=0, sizingmethod='auto expand')"}).attr("stroke-width",r)},t.prototype.clip=function(e){var t=this,n=e.members;return n.push(t),t.css(e.getCSS(t.inverted))},t.prototype.css=function(e){var t=this,n=t.element,r=e&&n.tagName==="SPAN"&&e.width;return r&&(delete e.width,t.textWidth=r),t.styles=$.extend(t.styles,e),T(t.element,e),t},t.prototype.destroy=function(){var e=this;return e.destroyClip&&e.destroyClip(),A.prototype.destroy.apply(e)},t.prototype.empty=function(){var e=this.element,t=e.childNodes,n=t.length,r;while(n--)r=t[n],r.parentNode.removeChild(r),$(r).remove()},t.prototype.getBBox=function(){var e=this,t=e.element,n=e.bBox;return n||(t.nodeName==="text"&&(t.style.position=f),n=e.bBox={x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}),n},t}(A),_=function(e){function r(){e.apply(this,arguments),this.isIE8=$.browser.msie&&parseInt($.browser.version)===8}return __extends(r,e),r.prototype.init=function(e,n,i){var s=this,o;this.Element=M,this.symbols=r._symbols,$(e).hasClass("vmlcontainer")?(s.box=e,o=new this.Element,o.element=e,o.render=this,s.boxWrapper=o):(o=s.createElement(a),e.appendChild(o.element),s.box=o.element,s.boxWrapper=o,s.setSize(n,i)),t.namespaces.v||(t.namespaces.add("v","urn:schemas-microsoft-com:vml"),t.createStyleSheet().cssText="v\\:fill, v\\:path, v\\:shape, v\\:stroke{ behavior:url(#default#VML); display: inline-block; } ")},r.prototype.clipRect=function(e,t,r,s){var o=this.createElement();return $.extend(o,{members:[],left:e,top:t,width:r,height:s,getCSS:function(e){var t=this,n=t.top,r=t.left,s=r+t.width,o=n+t.height,u={clip:"rect("+Math.round(e?r:n)+"px,"+Math.round(e?o:s)+"px,"+Math.round(e?s:o)+"px,"+Math.round(e?n:r)+"px)"};return!e&&i&&$.extend(u,{width:s+d,height:o+d}),u},updateClipping:function(){n(o.members,function(e,t){t.css(o.getCSS(t.inverted))})}}),o},r.prototype.color=function(e,t,n){var r,i=this,s="color",o,u,a,f,l=[],c,h,p,d,v=0;b.test(e)?s="linear":e=e.replace(y,function(e,t,n){return s="radial",t&&n&&(t=parseFloat(t),n=parseFloat(n),Math.pow(t-.5,2)+Math.pow(n-.5,2)>.25&&(n=Math.sqrt(.25-Math.pow(t-.5,2))*((n>.5?1:0)*2-1)+.5),p=t+" "+n),""});if(s!=="linear"&&s!=="radial")return h=t.getElementsByTagName(n),h.length&&(h[0].opacity=1),e;o=e.split(/\s*\-\s*/),s==="linear"&&(v=o.shift(),v=-parseFloat(v.toString())),d=i._parsegradientcolor(o),$.each(d,function(e,t){t.offset=t.offset?t.offset:e?"100%":"0%",l.push(t.offset+" "+t.color),u=t.color,e?f=u:a=u}),s==="radial"?r=['<fill colors="',l.join(),'" angle="0"','" focusposition="',p,'" color="',a,'" color2="',f,'" focussize="0 0"',' type="gradientTitle" focus="100%" method="none" />']:r=['<fill colors="',l.join(),'" angle="',v.toString(),'" type="gradient" focus="100%" method="sigma" />'],c=N(i.prepVML(r)),$(t).append(c)},r.prototype.prepVML=function(e){var t="display:inline-block;behavior:url(#default#VML);",n=this.isIE8;return e=e.join(""),n?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e.indexOf('style="')===-1?e=e.replace("/>",' style="'+t+'" />'):e=e.replace('style="','style="'+t)):e=e.replace("<","<v:"),e},r.prototype.path=function(e){var t=this.createElement("shape");return t.attr({coordsize:"100 100",d:e}),t},r.prototype.g=function(e){var t,n;return e&&(n={className:c+e,"class":c+e}),t=this.createElement(a).attr(n),t},r.prototype.text=function(e,t,n){var r=this.createElement("span"),i=r.element,s,o;return i.innerHTML=n,$(i).appendTo("body"),s=$(i).width(),o=$(i).height(),e-=s/2,t-=o/2,r.x=e,r.y=t,$(i).css({position:"absolute","white-space":"nowrap","font-family":"Arial","font-size":"10",left:e+"px",top:t+"px"}),r},r._symbols=$.extend({},O._symbols,{arc:function(e,t,n,r){var i=r.start,s=r.end,o=Math.cos(i),u=Math.sin(i),a=Math.cos(s),f=Math.sin(s),l=r.innerR,c=.07/n,h=l&&.1/l||0;return s-i===0?["x"]:(2*Math.PI-s+i<c?a=-c:s-i<h&&(a=Math.cos(i+h)),["wa",e-n,t-n,e+n,t+n,e+n*o,t+n*u,e+n*a,t+n*f,"at",e-l,t-l,e+l,t+l,e+l*a,t+l*f,e+l*o,t+l*u,"x","e"])},circle:function(e,t,n){return["wa",e-n,t-n,e+n,t+n,e+n,t,e+n,t,"e"]},rect:function(e,t,n,r){if(!S(r))return[];var i=r.width,s=r.height,o=e+i,u=t+s;return n=Math.min(n,i,s),[m,e+n,t,g,o-n,t,"wa",o-2*n,t,o,t+2*n,o-n,t,o,t+n,g,o,u-n,"wa",o-2*n,u-2*n,o,u,o,u-n,o-n,u,g,e+n,u,"wa",e,u-2*n,e+2*n,u,e+n,u,e,u-n,g,e,t+n,"wa",e,t,e+2*n,t+2*n,e,t+n,e+n,t,"x","e"]}}),r}(O);e.createRender=D})(e.render||(e.render={}));var t=e.render})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=1e4,n=function(){function e(e){this.bubMax=0,this.bubMin=0,this.bubDiff=0,this.y1Array=[],this.y1ValueGroup={},this.bubbleRadius={},this.chartDatas=[];var t=e.options;this.widget=e,this.seriesList=t.seriesList,this.maximumSize=t.maximumSize||20,this.minimumSize=t.minimumSize||5,this.sizingMethod=t.sizingMethod||"diameter",this._init(),this._calculateMaxMin()}return e.prototype._init=function(){var e=this,t,n,r;$.each(this.seriesList,function(i,s){n=s.markers||{},r=n.type||"circle",t=s.data,t&&t.y1&&t.x&&t.y&&$.each(t.y1,function(n,i){e.y1Array.push(i),e.y1ValueGroup[r]||(e.y1ValueGroup[r]=[]),e.y1ValueGroup[r].push(i),e.chartDatas.push({x:t.x[n],y:t.y[n],y1:t.y1[n]})})})},e.prototype._calculateMaxMin=function(){this.bubMax=Math.max.apply(null,this.y1Array),this.bubMin=Math.min.apply(null,this.y1Array),this.bubDiff=this.bubMax-this.bubMin},e.prototype._calculateRadius=function(e,t,n,r,i,s,o,u){var a,f=e,l=t-n,c=r.endX-r.startX,h=r.endY-r.startY;return f<0&&(f=0),s===0?f=1:f/=i,f=this._calculateRadiusByArea(f,o,u),f*=l,f+=n,a=Math.min(c,h),f*=a/200,f},e.prototype._calculateRadiusByArea=function(e,t,n){var r=e;if(t==="area")switch(n){case"circle":r=Math.sqrt(r/Math.PI);break;case"tri":case"invertedTri":r=Math.sqrt(r/(3*Math.sin(Math.PI/6)*Math.cos(Math.PI/6)));break;case"box":r=Math.sqrt(r/2);break;case"diamond":case"cross":r=Math.sqrt(r/2);break;default:r=Math.sqrt(4*r/Math.PI)}return r},e.prototype.calculateRadius=function(){var e=this,t=this.widget.canvasBounds;this.bubbleRadius={},$.each(this.y1ValueGroup,function(n,r){$.each(r,function(r,i){e.bubbleRadius[i]=e._calculateRadius(i,e.maximumSize,e.minimumSize,t,e.bubMax,e.bubDiff,e.sizingMethod,n)})})},e.prototype.getAdjust=function(e,t){var n=this,r=this.widget.canvasBounds,i=e.max,s=e.min,o=[],u=[],a=0,f=t.unitMinor,l=t.origin,c=r.endX-r.startX,h=r.endY-r.startY,p,d,v,m=[],g={};return this.calculateRadius(),$.each(this.chartDatas,function(e,t){var r=t.x;isNaN(r)&&!n.widget._isDate(r)&&$.inArray(r,m)===-1&&m.push(r)}),$.each(m,function(e,t){g[t]=e}),$.each(this.chartDatas,function(t,r){var f=r.x,l=r.y,p=r.y1,d=n.bubbleRadius[p];n.widget._isDate(f)?f=$.toOADate(f):isNaN(f)&&(f=g[f]),n.widget._isDate(l)&&(l=$.toOADate(l)),e.id==="x"?(v=c,a=d*(i-s)/v,o.push(f-a),u.push(f+a)):(v=h,a=d*(i-s)/v,o.push(l-a),u.push(l+a))}),p=Math.max.apply(null,u),d=Math.min.apply(null,o),(p-s)*v/(i-s)>v&&(i+=Math.ceil((p-i)/f)*f),d<s&&(s-=Math.ceil((s-d)/f)*f),l!==null&&l!==undefined&&(l<s?s=l:l>i&&(i=l)),{max:i,min:s}},e.prototype.dispose=function(){this.y1Array=[],this.bubbleRadius=null,this.y1ValueGroup=null},e}();e.BubbleAxisAdjust=n;var r=function(e){function r(){e.apply(this,arguments)}return __extends(r,e),r.prototype._setOption=function(n,r){var i=this,s=i.options;if(n==="minimumSize"||n==="minimumSize")isNaN(r)||r<0?r=0:r>t&&(r=t),s[n]=r,i.redraw();else if(n==="chartLabel")$.extend(s.chartLabel,r),i.redraw();else{if(n==="showChartLabels"||n==="chartLabelStyle")s[n]=r,i._setLabelOption();e.prototype._setOption.call(this,n,r)}n==="seriesList"&&(i.indexs=null)},r.prototype._create=function(){var t=this,n=t.options,r=t._getDefFill();this._handleChartStyles(),t._setLabelOption(),e.prototype._create.call(this),t.chartElement.addClass(n.wijCSS.bubbleChart)},r.prototype._paintChartArea=function(){this.bubbleAxisAdjust&&this.bubbleAxisAdjust.dispose(),this.bubbleAxisAdjust=new n(this),e.prototype._paintChartArea.call(this)},r.prototype._bindSeriesData=function(t,n,r){var i=n.data,s=i.y1;e.prototype._bindSeriesData.call(this,t,n,r),s&&s.bind&&(i.y1=this._getBindData(t,s.bind))},r.prototype._checkSeriesDataEmpty=function(t){var n=t.data;return!n||this._checkEmptyData(n.y1)?!0:e.prototype._checkSeriesDataEmpty.call(this,t)},r.prototype._setLabelOption=function(){var e=this.options;e.showChartLabels!==!0&&e.chartLabel.visible===!0&&(e.chartLabel.visible=!1),!$.isPlainObject(e.chartLabel.style)&&$.isPlainObject(e.chartLabelStyle)&&(e.chartLabel.style=e.chartLabelStyle)},r.prototype._clearChartElement=function(){var t=this,n=t.options,r=t.chartElement.data("fields");e.prototype._clearChartElement.call(this),r&&r.bubbleInfos&&$.each(r.bubbleInfos,function(e,t){t.bubble&&t.bubble.wijRemove(),t.dcl&&t.dcl.wijRemove(),t.symbol&&t.symbol.wijRemove()}),r&&r.bubbles&&t._destroyRaphaelArray(r.bubbles),t.element.removeData("plotInfos"),n.seriesTransition.enabled||r&&r.bubblesAnimationInfos&&(r.bubblesAnimationInfos=null)},r.prototype.destroy=function(){var t=this;t.chartElement.removeClass(t.options.wijCSS.bubbleChart+" ui-helper-reset"),t._destroyEles(),this.bubbleAxisAdjust&&(this.bubbleAxisAdjust.dispose(),this.bubbleAxisAdjust=null),e.prototype.destroy.call(this)},r.prototype.getBubble=function(e){return this.chartElement.data("fields").bubbles[e]},r.prototype.redraw=function(t){e.prototype.redraw.call(this,t)},r.prototype._destroyEles=function(){var e=this,t=e.element,n=t.data("fields");n.bubbleInfos&&$.each(n.bubbleInfos,function(t,n){e._removeEle(n.bubble),e._removeEle(n.dcl),e._removeEle(n.symbol),n=null}),t.removeData("fields")},r.prototype._removeEle=function(e){e&&(e.node&&$(e.node).removeData(),e.wijRemove(),e=null)},r.prototype._paintPlotArea=function(){var e=this,t=this.chartElement,n=e.options,r=n.seriesList,i=r.length,o=[].concat(n.seriesStyles.slice(0,i)),u=[].concat(n.seriesHoverStyles.slice(0,i)),a=e.canvasBounds,f=e.axisInfo.x,l=e.axisInfo.y[0];if(i===0)return;this.bubbleAxisAdjust.calculateRadius(),this.bubbleChartRender=new s(this.chartElement,{seriesList:r,seriesStyles:o,seriesHoverStyles:u,canvas:e.canvas,bounds:a,xAxisInfo:f,yAxisInfo:l,chartLabel:n.chartLabel,textStyle:n.textStyle,chartLabelStyle:n.chartLabelStyle,chartLabelFormatString:n.chartLabelFormatString,bubbleRadius:e.bubbleAxisAdjust.bubbleRadius,animation:n.animation,seriesTransition:n.seriesTransition,sizingMethod:n.sizingMethod,minimumSize:n.minimumSize,maximumSize:n.maximumSize,mouseDown:$.proxy(e._mouseDown,e),mouseUp:$.proxy(e._mouseUp,e),mouseOver:$.proxy(e._mouseOver,e),mouseOut:$.proxy(e._mouseOut,e),mouseMove:$.proxy(e._mouseMove,e),click:$.proxy(e._click,e),disabled:n.disabled,culture:e._getCulture(),wijCSS:n.wijCSS,shadow:n.shadow,widget:this}),this.bubbleChartRender.render(),e.tooltipbubbles=[],$.each(t.data("fields").bubbleInfos,function(t,n){e.tooltipbubbles.push(n.bubble),n.dcl&&e.tooltipbubbles.push(n.dcl),n.symbol&&e.tooltipbubbles.push(n.symbol)}),e.tooltip&&e.tooltip.setTargets(e.tooltipbubbles)},r.prototype._paintLegendIcon=function(e,t,n,r,i,s,o,u,a,f){var l=this,c=Math.min(n,r),h,p,d;return h=a.markerStyle,h=$.extend({fill:i.fill,stroke:i.stroke,opacity:1},h),a.markers&&(p=a.markers.type),p||(p="circle"),d=l.canvas.paintMarker(p,e+n/2,t+r/2,c/2),$(d.node).data("legendIndex",s).data("index",o),l.legendIcons.push(d),d.attr(h),$.wijraphael.addClass($(d.node),u),d},r.prototype._calculateParameters=function(t,n){e.prototype._calculateParameters.call(this,t,n);if(!n.autoMax&&!n.autoMin)return;this._adjust(n,t)},r.prototype._adjust=function(e,t){var n=e.unitMinor,r=this,i=e.autoMin,s=e.autoMax,o=r.canvasBounds,u={x:o.startX,y:o.startY},a=o.endX-u.x,f=o.endY-u.y,l=t.max,c=t.min,h=e.origin,p=this.bubbleAxisAdjust.getAdjust(t,e);l=p.max,c=p.min;if(l!==t.max||c!==t.min)t.min=c,t.max=l,this._calculateMajorMinor(e,t)},r.prototype._showSerieEles=function(e){$.each(e,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.shadow&&t.bubble.shadow.show(),t.bubble.tracker&&t.bubble.tracker.show(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()})},r.prototype._hideSerieEles=function(e){$.each(e,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.shadow&&t.bubble.shadow.hide(),t.bubble.tracker&&t.bubble.tracker.hide(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})},r.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.bubble&&t.bubble.attr(t.hoverStyle)})},r.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.bubble&&t.bubble.attr(t.style)})},r.prototype._parseTable=function(){if(!this.element.is("table"))return;var e=this,t=e.element,n=e.options,r=$("caption",t),i=$("thead th",t),s=[],o=$("tbody tr",t),u=null,a=null,f=[],l=[],c=[],h=function(e){var t=$.trim(e);return isNaN(e)||(t=parseFloat(e.toString())),t};r.length&&(n.header=$.extend({visible:!0,text:$.trim($(r[0]).text())},n.header),r.length>1&&(n.footer=$.extend({visibel:!0,text:$.trim($(r[1]).text())},n.footer))),n.legend=$.extend({visible:!0},n.legend),u=$.trim(i.eq(1).text()),o.each(function(e,t){var n=$("td",t);return n.length>=3&&(f.push(h(n.eq(0).text())),l.push(h(n.eq(1).text())),c.push(h(n.eq(2).text()))),this}),a={label:u,legendEntry:!0,data:{x:f,y:l,y1:c}},s.push(a),e.options.seriesList=s},r.prototype._unbindLiveEvents=function(){var e=this;$("."+e.options.wijCSS.bubbleElement,e.chartElement[0]).off(".wijbubblechart").off("wijbubblechart"),e.tooltip&&(e.tooltip.destroy(),e.tooltip=null)},r.prototype._paintTooltip=function(){var t=this,n=t.chartElement.data("fields");e.prototype._paintTooltip.call(this),t.tooltip&&n&&n.trackers&&n.trackers.length&&(t.tooltip.setTargets(n.trackers),t.tooltip.setOptions({relatedElement:n.trackers[0]}))},r.prototype._getTooltipText=function(e,t){var n=$(t.node),r,i;return n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),i={data:r,value:r.value,label:r.label,total:r.total,target:t,fmt:e,x:r.x,y:r.y,y1:r.y1},$.proxy(e,i)()},r}(e.wijchartcore);e.wijbubblechart=r,r.prototype.widgetEventPrefix="wijbubblechart";var i=function(){function e(){this.initSelector=":jqmData(role='wijbubblechart')",this.wijCSS={bubbleChart:"wijmo-wijbubblechart",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol"},this.minimumSize=5,this.maximumSize=20,this.sizingMethod="diameter",this.animation={enabled:!0,duration:1e3,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.seriesList=[],this.seriesHoverStyles=[{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5}],this.chartLabel={position:"inside",compass:"north",visible:!0,style:{},chartLabelFormatString:""},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();r.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new i),$.wijmo.registerWidget("wijbubblechart",r.prototype);var s=function(){function t(e,t){this.element=e,this.options=t,this._init()}return t.prototype._init=function(){var e=this.options,t=e.bounds;this.fields=this.element.data("fields")||{},this.canvas=e.canvas,this.seriesList=$.arrayClone(e.seriesList),this.seriesStyles=e.seriesStyles,this.seriesHoverStyles=e.seriesHoverStyles,this.startLocation={x:t.startX,y:t.startY},this.width=t.endX-this.startLocation.x,this.height=t.endY-this.startLocation.y,this.seriesEles=[],this.bubbles=[],this.bubbleInfos=[],this.trackers=this.canvas.set()},t.prototype.initAnimationState=function(e,t){var n=e.bubble,r=e.symbol,i;n.type==="circle"?n.attr({r:1e-4,cx:t.startX,cy:t.endY}):(i=n.wijGetBBox(),n.transform("t"+(t.startX-i.x)+","+(t.endY-i.y)+"s0.001..."),n.shadow&&n.shadow.transform("t"+(t.startX-i.x)+","+(t.endY-i.y)+"s0.001...")),r&&r.hide()},t.prototype.playAnimation=function(){var e=this,t=e.options,n=t.animation,r=t.bounds,i=e.fields.bubblesAnimationInfos,s=[],o=e.fields.bubbleInfos,u=t.seriesTransition,a,f,l;n&&n.enabled?(a=n.duration||400,f=n.easing,$.each(o,function(t,n){var o=n.bubble,c,h,p=o.wijGetBBox();o.type==="circle"?c={r:o.attr("r"),cx:o.attr("cx"),cy:o.attr("cy")}:c={transform:o.matrix.toTransformString(),"stroke-width":o.attr("stroke-width"),width:p.width,x:p.x,y:p.y},o.shadow&&o.shadow.hide(),i&&u.enabled?(h=i[t],h?(o.type==="circle"?o.attr({cx:h.cx,cy:h.cy,r:h.r}):(p=o.wijGetBBox(),l=h.width/p.width,c.transform=o.matrix.toTransformString(),o.transform(Raphael.format("s{0}t{1}{2}...",l,h.x-p.x,h.y-p.y)),o.shadow&&o.shadow.transform(Raphael.format("s{0}t{1}{2}...",l,h.x-p.x,h.y-p.y))),a=u.duration,f=u.easing):e.initAnimationState(n,r)):e.initAnimationState(n,r),s.push(c),o.wijAnimate(c,a,f,function(){$(n.bubble.node).data("wijchartDataObj")&&$(n.bubble.node).data("wijchartDataObj").visible&&(n.dcl&&n.dcl.show(),n.symbol&&(n.symbol.show(),n.bubble.wijAttr("opacity",.1)),o.shadow&&o.shadow.show())})}),e.fields.bubblesAnimationInfos=s):$.each(o,function(e,t){$(t.bubble.node).data("wijchartDataObj")&&$(t.bubble.node).data("wijchartDataObj").visible&&(t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show())})},t.prototype.getSymbol=function(e,t){var n;return $.each(e,function(e,r){if(r.index===t)return n=r,!1}),n},t.prototype.getLabelVisible=function(e,t){var n=!0;return $.each(e,function(e,r){if(t===r)return n=!1,!1}),n},t.prototype.paintMarker=function(e,t,n,r){var i;return this.canvas[e]&&(i=this.canvas[e](t,n,r)),i},t.prototype.getLabelBox=function(e){var t=this.canvas.text(0,0,e),n=t.wijGetBBox(),r;return r={width:n.width,height:n.height},t.remove(),r},t.prototype.applyLabelCompass=function(e,t){var n=this.options.chartLabel.compass||"north",r=this.getLabelBox(t),i=e.r;switch(n){case"north":e.y-=i+r.height/2;break;case"south":e.y+=i+r.height/2;break;case"east":e.x+=i+r.width/2;break;case"west":e.x-=i+r.width/2}},t.prototype.paintDefaultChartLabel=function(e,t){var n=this.options,r=n.chartLabel,i=n.culture,s=$.extend(!0,{},n.textStyle,n.chartLabelStyle,r.style),o=$.round(t,2),u=r.chartLabelFormatString===""?n.chartLabelFormatString:r.chartLabelFormatString,a=this.options.widget,f;return u&&u.length&&(o=Globalize.format(o,u,i)),f=a._text.call(a,e.x,e.y,o).attr(s),f},t.prototype.paintbubble=function(t,n,r,i,s,o,u,a){var f=t.data,l=i.min,c=s.min,h=i.max,p=s.max,d=o/(h-l),v=u/(p-c),m=[],g=this.options,y=this,b=g.bounds,w=g.wijCSS,E=g.widget,S=g.chartLabel,x=g.bubbleRadius,T,N,C,k;if(f.y1===undefined)return;$.each(f.y1,function(o,u){if(f.x===undefined||f.y===undefined)return!0;var a=f.x[o],c=f.y[o],h=t.markers||{},g=h.type||"circle",L=h.symbol,A=t.invisibleMarkLabels||[],O=x[u],M,_,D,P,H,B,j,F,I;i.isTime?a=$.toOADate(a):isNaN(a)&&(a=o),s.isTime&&(c=$.toOADate(c)),H=b.startX+(a-l)*d,B=b.startY+(p-c)*v,L&&(j=y.getSymbol(L,o)),P=y.paintMarker(g,H,B,O),P.attr(n),j&&(N=j.width||O*2,C=j.height||O*2,F=y.canvas.image(j.url,H-O,B-O,N,C)),y.options.shadow&&e.ChartUtil.paintShadow(P,2,null),$.wijraphael.addClass($(P.node),w.canvasObject+" "+w.bubbleElement),j&&P.attr("opacity",.1),D=$.extend(!1,{index:o,bubble:P,style:n,y1:u,x:a,y:c,type:"bubble",hoverStyle:r,visible:!0},t),j&&(D.symbol=!0,D.hoverStyle=$.extend({},r,{opacity:.1}),$(F.node).data("wijchartDataObj",D),$.wijraphael.addClass($(F.node),w.bubbleSymbol)),$(P.node).data("wijchartDataObj",D),E.dataPoints=E.dataPoints||{},E.pointXs=E.pointXs||[],k=$.round(H,2),E.dataPoints[k.toString()]||(E.dataPoints[k.toString()]=[],E.pointXs.push(k)),E.dataPoints[k.toString()].push(D),I=P.clone(),$.browser.msie&&parseInt($.browser.version)<9?I.attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}):I.attr({opacity:.01,fill:"white","fill-opacity":.01}),$(I.node).data("owner",$(P.node)),$.wijraphael.addClass($(I.node),w.canvasObject+" "+w.bubbleElement+" "+w.bubbleTracker),P.tracker=I,y.trackers.push(I),y.bubbles.push(P),y.fields.bubbles=y.bubbles,M={x:H,y:B,r:O},S.visible&&y.getLabelVisible(A,o)&&(S.position==="outside"&&y.applyLabelCompass(M,u),T=y.paintDefaultChartLabel(M,u),T.hide(),$(T.node).data("wijchartDataObj",D),$.wijraphael.addClass($(T.node),w.bubbleLabel)),_={bubble:P,dcl:T,symbol:F},y.bubbleInfos.push(_),m.push(_),t.visible===!1&&(P.hide(),T&&T.hide(),I.hide(),F&&F.hide())}),y.fields.bubbleInfos=y.bubbleInfos,y.seriesEles.push(m)},t.prototype.paintBubbles=function(){var e=this,t=e.options,n=t.xAxisInfo,r=t.yAxisInfo;$.each(e.seriesList,function(t,i){var s=e.seriesStyles[t],o=e.seriesHoverStyles[t];e.paintbubble(i,s,o,n,r,e.width,e.height,e.startLocation)})},t.prototype.bindLiveEvents=function(e,t,n,r,i,s,o,u){var a=this.options,f=a.wijCSS,l="",c={mousedown:function(n){if(u)return;var r=$(n.target),i;r.data("owner")&&(r=r.data("owner")),i=r.data("wijchartDataObj"),t.call(e,n,i)},mouseup:function(t){if(u)return;var r=$(t.target),i;r.data("owner")&&(r=r.data("owner")),i=r.data("wijchartDataObj"),n.call(e,t,i)},mouseover:function(t){if(u)return;var n=$(t.target),i,s;n.data("owner")&&(n=n.data("owner")),i=n.data("wijchartDataObj"),s=i.bubble,i.hoverStyle?(s.attr(i.hoverStyle),s.shadow&&s.shadow.attr(i.hoverStyle)):s&&s.attr({opacity:"0.8"}),r.call(e,t,i)},mouseout:function(t){if(u)return;var n=$(t.target),r,s;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),s=r.bubble;if(r.symbol)return;r.hoverStyle?(r.hoverStyle["stroke-width"]&&!r.style["stroke-width"]&&(s.attr("stroke-width",""),s.shadow&&s.shadow.attr("stroke-width","")),s.wijAttr({transform:""}),s.wijAttr(r.style),r.style.opacity&&(s.attr("opacity",r.style.opacity),s.shadow&&s.shadow.attr("opacity",r.style.opacity))):s&&s.attr({opacity:"1"}),i.call(e,t,r)},mousemove:function(t){if(u)return;var n=$(t.target),r,i;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),s.call(e,t,r)},click:function(t){if(u)return;var n=$(t.target),r;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),o.call(e,t,r)}};$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(l="wij"),$.each(["click","mouseover","mouseout","mousemove","mousedown","mouseup"],function(t,n){$("."+f.bubbleTracker,e).on(l+n+".wijbubblechart",c[n])})},t.prototype.render=function(){var e=this.options,t=e.mouseDown,n=e.mouseUp,r=e.mouseOver,i=e.mouseOut,s=e.mouseMove,o=e.click,u=e.disabled;this.paintBubbles(),this.fields.seriesEles=this.seriesEles,this.playAnimation(),this.trackers.toFront(),this.fields.trackers=this.trackers,this.bindLiveEvents(this.element,t,n,r,i,s,o,u),this.element.data("fields",this.fields)},t}();e.BubbleChartRender=s})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijcarousel",i="wijmo-wijcarousel-",s="wijmo-wijcarousel ",o=i+"list",u=i+"item ",a=i+"clip",f=i+"current",l=i+"horizontal-multi",c=i+"horizontal",h=i+"button",p=i+"vertical-multi",d=i+"vertical",v=i+"button-next",m=i+"button-previous",g=i+"preview",y="<a><span></span></a>",b=".wijmo-wijcarousel-pager,."+h+",."+v+",."+m,w="<div></div>",E='<li class="wijmo-wijcarousel-page"><a></a></li>',S="li.wijmo-wijcarousel-page",x=".wijmo-wijcarousel-text,.wijmo-wijcarousel-caption",T=1,N=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._handleDisabledOption=function(e,t){var n=this,r=n.options;n.pager&&!n.pager.is(":hidden")&&r.pagerType==="numbers"&&n.pager.wijpager("option","disabled",e),n._applyBtnClass()},t.prototype._initStates=function(e,t){var n=this;n.count=0,n.currentIdx=e.start,n.timeout=null,n.isHorizontal=e.orientation==="horizontal",n.width=t.width()||640,n.height=t.height()||480,n.offset=0},t.prototype._set_showControlsOnHover=function(e){var t=this;t.container.unbind("mouseenter."+t.widgetName),t.container.unbind("mouseleave."+t.widgetName),e&&t.container.bind("mouseenter."+t.widgetName,function(){if(t.options.disabled)return;t._showControls()}).bind("mouseleave."+t.widgetName,function(){if(t.options.disabled)return;t._hideControls()}),t.container.find(b).stop(!0,!0)[e?"hide":"show"]()},t.prototype._create=function(){var e=this,t=e.options,r=e.element;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._initStates(t,r),e._createDom(e.isHorizontal),e.list.bind("click."+e.widgetName,n.proxy(e._itemClick,e)),t.showControlsOnHover&&(e.container.bind("mouseenter."+e.widgetName,function(){if(e.options.disabled)return;e._showControls()}).bind("mouseleave."+e.widgetName,function(){if(e.options.disabled)return;e._hideControls()}),e.container.find(b).hide()),t.loadCallback&&n.isFunction(t.loadCallback)&&e._trigger("loadCallback",null,e);if(t.disabledState){var i=t.disabled;e.disable(),t.disabled=i}else t.auto&&e.play();t.disabled&&e.disable();try{t.display=parseFloat(t.display)}catch(s){t.display=1}e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcarousel")},t.prototype._showControls=function(){this.container.find(b).stop(!0,!0).fadeIn(600,function(){n(this).css("opacity","")})},t.prototype._hideControls=function(){this.container.find(b).stop(!0,!0).fadeOut(600)},t.prototype._applyContainerStyle=function(e,t){var n=this,r=n.options,i={},s=n.list,o=0,u,a=0,f=e?"left":"top",l=0,c,h=e?"width":"height";u=n.itemBound[e?"w":"h"],n.count=n.list.children("li").length,o=n.count*u,n.list[h](o),n.clip[h](r.display*u),n.clip[e?"height":"width"](n.itemBound[e?"h":"w"]);if(!r.loop)i[f]=-u*n.currentIdx,s.css(i);else{c=s.find(">li:first"),r.preview&&!!t&&(c=c.next()),l=c.data("itemIndex");for(l;l<n.currentIdx;l++)s.children("li:first").appendTo(s);if(r.preview){if(!t)for(l=0;l<T;l++)s.children("li:last").prependTo(s);a=-u*T}i[f]=a,s.css(i)}},t.prototype._applyListStyle=function(){var e=this,t=e.options,n=t.orientation==="horizontal",r=0,i,s=n?"width":"height";e.itemBound=e._getItemBound(),i=e.itemBound[n?"w":"h"],r=e.count*i,e.list[s](r)},t.prototype._createButtons=function(e,t){var r=this,i=r.options,s,o=i.wijCSS.stateDisabled;n.each(["prevBtn","nextBtn"],function(u,a){var f=i[a+"Class"],l=a==="nextBtn",c=l?"next":"previous",h=l?v:m,p=l?t:e;f&&f.defaultClass?(o=f.disableClass||o,s=f.hoverClass,r[a]=n('<a class="'+i.wijCSS.stateDefault+'"></a>').addClass(f.defaultClass).mouseover(function(){n(this).hasAllClasses(o)||n(this).addClass(s)}).mouseout(function(){n(this).hasAllClasses(o)||n(this).removeClass(s)})):r[a]=n(r._createBtn(h,p)),r[a].bind("click."+r.widgetName,function(e){if(r.options.disabled)return;var t=n(this);if(t.hasAllClasses(i.wijCSS.stateDisabled))return;r[c].call(r)}).appendTo(r.container);if(n.browser.msie&&r.clip.find("iframe").length>0){var d=r.element.children("iframe.bgiframe."+a+"Frame");d.length===0&&(d=n('<iframe class="bgiframe '+a+'Frame" frameborder="0" tabindex="-1" src="javascript: false;" style="position:absolute;top:0px;left:0px;opacity:0;" />'),d.width(r[a].outerWidth()),d.height(r[a].outerHeight()),r.container.append(d))}})},t.prototype._applyBtnClass=function(){var e=this,t=e.options,r=t.wijCSS.stateDisabled,i=t.wijCSS.stateHover;n.each(["prevBtn","nextBtn"],function(n,s){var o=t[s+"Class"],u,a=e[s];o&&(r=o.disableClass||r,i=o.hoverClass||i),u=s==="prevBtn"?e.currentIdx<=0:e.currentIdx+t.display>=e.count,u&&!t.loop||t.disabled?a.removeClass(i).addClass(r):a.hasAllClasses(r)&&a.removeClass(r)})},t.prototype._applyBtnStyle=function(e){var t=this,r=0,i,s=t.options.wijCSS,o={collision:"none",of:t.container,my:e?"right{offset} center":"center bottom{offset}",at:e?"right center":"center bottom"},u={collision:"none",of:t.container,my:e?"left{offset} center":"center top{offset}",at:e?"left center":"center top"},a=t.options.buttonPosition==="inside",f,l,c=["cornerBottom","cornerTop","cornerRight","cornerLeft"],h=(e?1:0)*2+(a?1:0),p=(e?1:0)*2+(a?0:1),d=function(e,t,r,i,s){var o="";e.removeClass(t).addClass(r),!isNaN(i)&&i!==0&&(i>0?o="+"+i:o="-"+ -i),s.my=s.my.replace(/\{offset\}/,o),e.position(s);if(n.browser.msie){var u=e.next("iframe.bgiframe");u.length&&(u.css("left",e.css("left")),u.css("top",e.css("top")))}};r=e?t.prevBtn.width():t.prevBtn.height(),i=a?0:r,f=s[c[h]],l=s[c[p]],d(t.nextBtn,l,f,i,o),d(t.prevBtn,f,l,-i,u),t._applyBtnClass()},t.prototype._createDom=function(e){var t=this,r=t.options,i=t.element,u,a,f,h;if(i.is("div"))t.list=i.children("ul:eq(0)"),t.container=t.element,t.list.length||(t.list=n("<ul></ul>").appendTo(t.container));else{if(!i.is("ul"))return;t.list=i,t.container=i.parent()}t.itemBound=t._getItemBound(),e?(u=r.display>1&&!r.preview?l:c,a=r.wijCSS.iconArrowRight,f=r.wijCSS.iconArrowLeft):(u=r.display>1&&!r.preview?p:d,a=r.wijCSS.iconArrowDown,f=r.wijCSS.iconArrowUp),t.list.addClass(o).addClass(r.wijCSS.helperClearFix),h=s+r.wijCSS.widget+" "+u+" "+(r.preview?g+" ":"")+(r.display>1?r.wijCSS.content+" "+r.wijCSS.cornerAll:""),t.container.addClass(h),t.container.attr("dir","ltr"),t._createItems(e),t._createClip(e),t._applyContainerStyle(e),t._createButtons(f,a),t._applyBtnStyle(e),r.preview&&t._createPreview(),r.showTimer&&t._createTimer(),r.showPager&&t._createPager(),r.showControls&&t._createControls()},t.prototype._createPreview=function(){var e=this,t=e.options,n,r,i=t.orientation==="horizontal",s=i?"left":"top",o=i?"right":"bottom",u,a;r=e.itemBound[i?"w":"h"],n=e.offset=Math.round(r/4),u=t.display*r+n*2,e.clip[i?"width":"height"](u),e.list.css(s,function(e,t){return parseFloat(t)+n}),e.clip.css(s,function(e,t){return-n}),e.container.css("margin-"+s,n+"px").css("margin-"+o,n+"px"),e.list.find(x).hide();for(a=0;a<t.display;a++)e._getItemByIndex(e.currentIdx+a).find(x).show()},t.prototype._createItemsFromData=function(e){var t=this;if(!n.isArray(e)||!e.length||!n.isPlainObject(e[0])||n.isEmptyObject(e[0]))return;t.list.empty(),n.each(e,function(e,r){var i;if(!n.isPlainObject(r))return!0;i=t._generateMarkup(r),t.list.append(i)})},t.prototype._generateMarkup=function(e){var t,r;if(!n.isPlainObject(e))return;return t=n("<li></li>"),typeof e.linkUrl=="string"&&e.linkUrl&&(r=n("<a>").attr("href",e.linkUrl),r.appendTo(t)),typeof e.imageUrl=="string"&&e.imageUrl&&n("<img>").attr("src",e.imageUrl).appendTo(r||t),typeof e.caption=="string"&&e.caption&&n("<span>").html(e.caption).appendTo(t),t},t.prototype._createItems=function(e){var t=this,r,i,s=t.options,o,u;if(t.list){t._createItemsFromData(s.data),t.list.children("li").each(function(e,r){var i=n(r);t._createItem(i,e)}),o=t.list.children("li").eq(t.currentIdx).addClass(f);if(s.preview&&s.display>1){r=u=o;for(i=0;i<s.display-1;i++)u=u.next(),r=r.add(u);r.find("div.wijmo-wijcarousel-mask").css({opacity:0})}}},t.prototype._createItem=function(e,t){var r=this,i=r.options,s,o;return s=e.addClass(u).addClass(i.wijCSS.helperClearFix).find("img:eq(0)").attr("role","img").addClass("wijmo-wijcarousel-image"),r._applyItemBound(e),o=e.children("span:eq(0)").hide(),r._createCaption(e,s,o),i.preview&&n('<div class="wijmo-wijcarousel-mask">').appendTo(e),e.data("itemIndex",t),e},t.prototype._applyItemBound=function(e){var t=this,n=t.itemBound.w,r=t.itemBound.h;if(!t.itemWidth||!t.itemHeight)e.width(n).height(r),t.itemWidth=n-(e.outerWidth(!0)-n),t.itemHeight=r-(e.outerHeight(!0)-r);e.width(t.itemWidth).height(t.itemHeight)},t.prototype._createCaption=function(e,t,r){var i=this,s=i.options,o,u,a,f,l;s.showCaption&&(o=r.html()||t.attr("title"),o&&o.length&&(a=n("<span></span>").html(o),f=n(w).addClass([s.wijCSS.helperClearFix,"wijmo-wijcarousel-caption"].join(" ")).appendTo(e),u=n(w).addClass([s.wijCSS.helperClearFix,s.wijCSS.content,"wijmo-wijcarousel-text"].join(" ")).append(a).appendTo(e),i._applyCaptionStyle(f,u)))},t.prototype._applyCaptionStyle=function(e,t){var r=e.add(t),i;r.width(this.itemWidth),n.browser.webkit?(i=t.children("span").css("display","inline-block").height(),t.children("span").css("display","")):i=t.children("span").height(),r.height(i)},t.prototype._showCaption=function(e,t){var n=this,r=n._getItemByIndex(e),i=r.find(".wijmo-wijcarousel-text"),s=r.find(".wijmo-wijcarousel-caption");i.length&&i.fadeIn(300,function(){e<t&&n._showCaption(e+1,t)}),s.length&&(s.show(),s.animate({opacity:.5},300))},t.prototype._hideCaption=function(){this.element.find(x).hide()},t.prototype._createClip=function(e){this.clip=this.list.wrap("<div></div>").parent().addClass(a)},t.prototype._createBtn=function(e,t){var r=n(y),i=this.options;return r.addClass(i.wijCSS.stateDefault+" "+e).attr("role","button").mouseover(function(){n(this).hasAllClasses(i.wijCSS.stateDisabled)||n(this).addClass(i.wijCSS.stateHover)}).mouseout(function(){n(this).hasAllClasses(i.wijCSS.stateDisabled)||n(this).removeClass(i.wijCSS.stateHover)}).children("span:eq(0)").addClass(i.wijCSS.icon+" "+t),r},t.prototype._createControls=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"center bottom",at:"center bottom"};t.control&&(e.controls=n(t.control).css({position:"absolute"}).appendTo(e.container),n.extend(r,t.controlPosition),e.controls.position(r))},t.prototype._createTimer=function(){var e=this,t=e.options;e._createPausePlay(),e.progressBar=n("<div></div>").addClass("wijmo-wijcarousel-timerbar-inner "+t.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),e.timer=n("<div></div>").addClass("wijmo-wijcarousel-timerbar "+t.wijCSS.cornerAll).appendTo(e.container).append(e.progressBar).append(e.playPauseBtn)},t.prototype._createPausePlay=function(){var e=this,t=e.options;e.playPauseBtn=n(e._createBtn(h,t.auto?t.wijCSS.iconPause:t.wijCSS.iconPlay)).bind("click."+e.widgetName,function(){if(e.options.disabled)return;var r=n(this).children("span:eq(0)");e[r.hasAllClasses(t.wijCSS.iconPlay)?"play":"pause"]()})},t.prototype._createPagingItem=function(e,t,r,i){var s=n(E).attr({role:"tab","aria-label":i+1,title:i+1}).addClass(this.options.wijCSS.stateDefault),o,u;if(e)s.addClass("wijmo-wijcarousel-dot");else{if(!(t&&t.images&&t.images[i]))return;o=t.imageWidth,u=t.imageHeight,o&&u&&s.width(o).height(u),s.children("a").append(n("<img>").attr("src",t.images[i]))}r.append(s)},t.prototype._createPaging=function(e){var t=this,r=t.options,i,s,o,u=r.thumbnails,a=e==="dots";t.container.append(t.pager=n('<div><ul class="wijmo-list '+r.wijCSS.cornerAll+" "+r.wijCSS.helperClearFix+' role="tablist"></ul></div>')),a||t.pager.addClass("wijmo-wijcarousel-thumbnails"),s=t.pager.children("ul.wijmo-list");for(i=0;i<t.count;i++)t._createPagingItem(a,u,s,i);o=t.pager.find("li").eq(t.currentIdx),o.length&&t._activePagerItem(o),u&&n.each(["mousedown","mouseup","mouseover","mouseout","click"],function(e,t){var n=u[t];n&&typeof n=="string"&&window[n]&&(u[t]=window[n])}),t.pager.bind("mouseover."+t.widgetName,function(e){if(t.options.disabled)return;t._pageingEvents(e,"mouseover",u,a,function(e){e.addClass(r.wijCSS.stateHover)})}).bind("mouseout."+t.widgetName,function(e){if(t.options.disabled)return;t._pageingEvents(e,"mouseout",u,a,function(e){e.removeClass(r.wijCSS.stateHover)})}).bind("click."+t.widgetName,function(e){if(t.options.disabled)return;t._pageingEvents(e,"click",u,a,function(e){t.scrollTo(e.index()),t._activePagerItem(e)})}),a||n.each(["mousedown","mouseup"],function(e,r){n.isFunction(u[r])&&t.pager.bind(r,function(e){if(t.options.disabled)return;var i=n(e.target).closest(S);i.length&&u[r].call(i,e)})})},t.prototype._pageingEvents=function(e,t,r,i,s){var o=n(e.target).closest(S);o.length&&(n.isFunction(s)&&s.call(e,o),!i&&n.isFunction(r[t])&&r[t].call(o,e))},t.prototype._activePagerItem=function(e){var t=this.options.wijCSS.stateActive;e.addClass(t).attr("aria-selected","true").siblings("li").removeClass(t).removeAttr("aria-selected")},t.prototype._createWijSlider=function(){var e=this,t=e.options.sliderOrientation,r={orientation:t,range:!1,min:0,max:e.count-1,step:1,value:e.currentIdx,buttonClick:function(t,n){var r=n.value;e.scrollTo(r)},slide:function(t,n){var r=n.value;e.scrollTo(r)}},i=n("<div></div>").css("margin-bottom","10px").css(t==="horizontal"?"width":"height","200px").appendTo(e.container);e.pager=i.wijslider(r).parent().wrap("<div>").parent().addClass("wijmo-wijcarousel-slider-wrapper")},t.prototype._createWijPager=function(){var e=this,t={pageCount:e.count,pageIndex:e.currentIdx,pageButtonCount:e.count,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;e.scrollTo(r)}},r=n("<div></div>").appendTo(e.container);e.pager=r.wijpager(t).css({position:"absolute"})},t.prototype._createPager=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"right top",at:"right bottom"};if(t.pagerType==="numbers")e._createWijPager();else if(t.pagerType==="dots"||t.pagerType==="thumbnails")e._createPaging(t.pagerType),e.pager.css({position:"absolute"});else{if(!n.wijmo.wijslider||t.pagerType!=="slider")return;e._createWijSlider(),t.sliderOrientation!=="horizontal"&&(r.my="left center",r.at="right center")}e.pager.width(e.pager.width()+1),n.extend(r,t.pagerPosition),t.pagerPosition=r,e.pager.addClass("wijmo-wijcarousel-pager").position(r)},t.prototype._setOption=function(e,t){var r=this,i=r.options,s,o,u,a=i.orientation==="horizontal";if(e==="pagerPosition"||e==="animation"||e==="controlPosition")n.extend(!0,i[e],t);else{u=i[e],n.Widget.prototype._setOption.apply(r,arguments);switch(e){case"showControls":case"showPager":case"showTimer":if(t===u)break;s=e.replace(/show/i,"").toLowerCase(),o=e.replace(/show/i,"_create"),t===!0?r[s]?r[s].jquery&&r[s].show():r[o]():r[s].hide();break;case"loop":case"orientation":case"display":case"preview":t!==u&&(r._wijdestroy(),r._create());break;case"data":r._createItems(a),r._applyContainerStyle(a),r._applyBtnClass(),i.showPager&&r._createPager();break;case"showCaption":t?r._createItems(a):r.element.find(x).remove();break;case"buttonPosition":r._applyBtnStyle(a);break;case"pagerType":t!==u&&r._reCreatePager();break;case"disabled":r._handleDisabledOption(t,r.element);break;case"showControlsOnHover":r._set_showControlsOnHover(t);break;case"thumbnails":r._reCreatePager();break;default:}}},t.prototype._reCreatePager=function(){var e=this;e.pager&&e.pager.jquery&&(e.pager.remove(),e.pager=null),e.options.showPager&&e._createPager()},t.prototype._getItemBound=function(){var e={},t=this,n=t.options;return n.orientation==="horizontal"?e={w:Math.round(t.width/n.display),h:t.height}:e={w:t.width,h:Math.round(t.height/n.display)},e},t.prototype._stopAnimation=function(){var e=this;e.isPlaying&&e.progressBar&&e.progressBar.stop().css({width:"0%"}),e.list.stop(!0,!0)},t.prototype._itemClick=function(e){var t=n(e.target),r=this,i=r.options,s=r.currentIdx,o=t.closest("li."+u),a=o.data("itemIndex"),f,l;if(r.options.disabled){e.preventDefault();return}if(o.length>0){if(i.preview&&a<s||a>s+i.display-1)f=r._getItemByIndex(s).index(),l=o.index()>f?"next":"previous",r[l]();r._trigger("itemClick",e,{index:a,el:o})}},t.prototype._wijdestroy=function(){var e=this,t=e.options.wijCSS;e.container.removeClass("wijmo-wijcarousel "+t.widget).removeClass("wijmo-wijcarousel-horizontal").removeClass("wijmo-wijcarousel-vertical"),e.timeout&&(e.list.stop(!0),window.clearTimeout(e.timeout),e.timeout=null),e.options.showTimer&&e.progressBar&&e.progressBar.stop(!0),e.list.unwrap().removeClass("wijmo-wijcarousel-list").removeClass(t.helperClearFix).unbind("."+e.widgetName).removeAttr("style").children("li").each(function(e,r){var i=n(r);i.removeClass("wijmo-wijcarousel-item").removeClass(t.helperClearFix).removeClass(f),i.children("img").removeClass("wijmo-wijcarousel-image"),i.children(x).remove(),i.css({width:"",height:""}),i.removeData("itemIndex")}),e.itemWidth=e.itemHeight=undefined,e.element.find(b+",.wijmo-wijcarousel-timerbar").remove(),e.pager&&(e.pager.remove(),e.pager=null),e.timer&&(e.timer.remove(),e.timer=null),e.element.find("li>span").css("display","")},t.prototype.destroy=function(){this._wijdestroy(),n.Widget.prototype.destroy.apply(this)},t.prototype._resetDom=function(){var e=this;e._applyListStyle(),e.list.children("li").each(function(t,r){var i=n(r),s=i.children("div.wijmo-wijcarousel-caption"),o=i.children("div.wijmo-wijcarousel-text");e._applyItemBound(i),e._setStyle(s.add(o),function(){e._applyCaptionStyle(s,o)})}),e._applyContainerStyle(e.isHorizontal,!0),e.options.preview&&e._createPreview(),e._setStyle(e.prevBtn.add(e.nextBtn),function(){e._applyBtnStyle(e.isHorizontal)}),e._setStyle(e.pager,function(){e.pager.position(e.options.pagerPosition)}),e._setStyle(e.controls,function(){e.controls.position(e.options.controlPosition)})},t.prototype._setStyle=function(e,t){var n=!0;if(!e||e.length===0)return;e.css("display")=="none"&&(n=!1,e.css("display","")),t.call(this),n||e.css("display","none")},t.prototype.refresh=function(){var e=this,t=e.options,n=e.element;e.width=n.width()||640,e.height=n.height()||480,e.itemWidth=e.itemHeight=0,e._resetDom(),e.pause()},t.prototype.play=function(){var e=this,t=e.options;if(e.isPlaying||t.disabled)return;if(t.interval===0)return e.pause();if(t.showTimer&&e.progressBar)e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPlay).addClass(t.wijCSS.iconPause),e.progressBar.animate({width:"100%"},t.interval,null,function(){e._scroll("next",t.step)});else{if(e.timeout)return;e.timeout=window.setTimeout(function(){e.next()},t.interval)}e.isPlaying=!0},t.prototype.pause=function(){var e=this,t=e.options;if(t.showTimer&&e.progressBar)e.progressBar.stop(!0).css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPause).addClass(t.wijCSS.iconPlay);else{if(e.timeout===null)return;window.clearTimeout(e.timeout),e.timeout=null}e.isPlaying=!1},t.prototype.next=function(){var e=this,t=e.options.step;if(typeof t!="number"||t<1)return;e._stopAnimation(),e._scroll("next",t)},t.prototype.previous=function(){var e=this,t=e.options.step;if(typeof t!="number"||t<1)return;e._stopAnimation(),e._scroll("previous",t)},t.prototype.scrollTo=function(e){var t=this,n,r;t._stopAnimation(),n=e>t.currentIdx?"next":"previous",r=Math.abs(e-t.currentIdx),e!==t.currentIdx&&t._scroll(n,r)},t.prototype._scroll=function(e,t){var r=this,i=r.options,s=r.list,o=0,u,a,l=i.orientation==="horizontal",c={},h=r.itemBound[l?"w":"h"],p=l?"left":"top",d=t,v={},m=0,g=r.currentIdx*h;if(!i.loop){if(e==="next")if(r.currentIdx+i.display+t<=r.count)o=-g-h*d;else{if(!(r.currentIdx+i.display<r.count))return;d=r.count-r.currentIdx-i.display,o=-g-h*d}else r.currentIdx-t>=0?o=-g+h*d:r.currentIdx>0&&(d=r.currentIdx,o=0);o!==undefined&&(c[p]=o+r.offset,r._doAnimation(e,c,d))}else{i.preview&&(o=m=-h*T+r.offset);if(e==="next")o+=-h*d,c[p]=o;else{for(a=0;a<t;a++)o-=h,s.children("li:last").prependTo(s);v[p]=o,c[p]=m,s.css(v)}r._doAnimation(e,c,t,p,h)}if(i.preview){u=n();for(a=0;a<i.display;a++)u=u.add(r._getItemByIndex(r.currentIdx+a).find("div.wijmo-wijcarousel-mask:eq(0)"));u.stop(!0).animate({opacity:.6},i.animation.duration/2,function(){r._getItemByIndex(r.currentIdx).removeClass(f)})}},t.prototype._doAnimation=function(e,t,r,i,s){var o=this,u=o.list,a=o.options,f,l,c={complete:null},h,p={},d;if(!o.list.children().length)return;e==="next"?d=o.currentIdx+r:d=o.currentIdx-r,a.loop?(d=d%o.count+(d<0?o.count:0),h=function(){var t=0;a.preview&&(t=o.offset-T*s);if(e==="next"){for(l=0;l<r;l++)u.children("li:first").appendTo(u);i&&(p[i]=t,u.css(p))}o.currentIdx=d,o._setCurrentState(o.currentIdx)}):h=function(){o.currentIdx=d,o._setCurrentState(o.currentIdx)},c.complete=h,f={index:o.currentIdx,to:d,el:o._getItemByIndex(o.currentIdx)};if(!o._trigger("beforeScroll",null,f))return;a.animation&&a.animation.complete&&(a.animation.complete=undefined),n.extend(c,a.animation),o._hideCaption(),u.animate(t,c)},t.prototype._setCurrentState=function(e){var t=this,r=t.options,i,s,o,u=e+r.display-1,a,l,c;r.loop?t.isPlaying&&(window.clearTimeout(t.timeout),t.timeout=null,t.isPlaying=!1,t.play()):(o=e+r.display<t.count,t.isPlaying&&o?(window.clearTimeout(t.timeout),t.timeout=null,t.isPlaying=!1,t.play()):t.progressBar&&t.pause(),t._applyBtnClass());if(r.preview){l=n(),a=t._getItemByIndex(e);for(c=0;c<r.display;c++)l=l.add(t._getItemByIndex(e+c).find("div.wijmo-wijcarousel-mask:eq(0)"));l.animate({opacity:0},r.animation.duration/2,function(){a.addClass(f),t._showCaption(e,u)})}else t._showCaption(e,u);t.pager&&(n.wijmo.wijslider&&t.pager.find(":wijmo-wijslider").length?t.pager.find(":wijmo-wijslider:eq(0)").wijslider("value",e):n.wijmo.wijpager&&t.pager.is(":wijmo-wijpager")?t.pager.wijpager("option","pageIndex",e):t.pager.jquery&&(i=t.pager.find(">ul:eq(0)>li").eq(e),i.length&&t._activePagerItem(i))),s={firstIndex:e,lastIndex:u},t._trigger("afterScroll",null,s)},t.prototype._getItemByIndex=function(e){var t=this,r=t.list,i,s=e%t.count;return t.options.loop?(r.children("li").each(function(e){var t=n(this);if(t.data("itemIndex")===s)return i=t,!1}),i):r.children("li").eq(s)},t.prototype._collectionChanged=function(e){var t=this;t.count=t.count+(e==="add"?1:-1),t._applyListStyle(),t.pager&&t.pager.jquery&&(t.pager.remove(),t.pager=null,t._createPager()),t._applyBtnClass()},t.prototype.add=function(e,t){var r=this,i,s;if(typeof e=="string")i=n(e);else if(e.jquery)i=e;else{if(!n.isPlainObject(e))return;i=r._generateMarkup(e)}i.is("li")||(i=i.wrap("<li></li>").parent()),s=i,typeof t=="number"&&t>=0&&t<r.count?(s.insertBefore(r._getItemByIndex(t)),r.list.children("li").each(function(e,r){var i=n(r);i.data("itemIndex")>=t&&i.data("itemIndex",i.data("itemIndex")+1)})):(t==0&&s.appendTo(r.list),s.insertAfter(r._getItemByIndex(r.count-1))),r._createItem(i,t!==undefined?t:r.count),r._collectionChanged("add")},t.prototype.remove=function(e){var t=this,r;typeof e=="number"&&e>=0&&e<t.count?(r=t._getItemByIndex(e),t.list.children("li").each(function(t,r){var i=n(r);i.data("itemIndex")>e&&i.data("itemIndex",i.data("itemIndex")-1)})):r=t._getItemByIndex(t.count-1),r&&r.remove(),t._collectionChanged("remove")},t}(e.wijmoWidget);t.wijcarousel=N;var C=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn ui-btn-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijcarousel')",this.data=[],this.auto=!1,this.interval=5e3,this.showTimer=!1,this.buttonPosition="inside",this.showPager=!1,this.prevBtnClass={defaultClass:"",hoverClass:"",disableClass:""},this.nextBtnClass={defaultClass:"",hoverClass:"",disableClass:""},this.pagerType="numbers",this.thumbnails={mouseover:null,mouseout:null,mousedown:null,mouseup:null,click:null,imageWidth:58,imageHeight:74,images:[]},this.pagerPosition={},this.orientation="horizontal",this.sliderOrientation="horizontal",this.loop=!0,this.animation={queue:!0,disable:!1,duration:1e3,easing:"linear"},this.start=0,this.display=1,this.preview=!1,this.step=1,this.showControls=!1,this.control="",this.controlPosition={},this.showCaption=!0,this.showControlsOnHover=!1,this.itemClick=null,this.beforeScroll=null,this.afterScroll=null,this.loadCallback=null}return e}();N.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new C),n.wijmo.registerWidget("wijcarousel",N.prototype)})(e.carousel||(e.carousel={}));var t=e.carousel})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijgallery",i="wijmo-wijgallery",s="wijmo-wijgallery-",o=s+"selected",u=s+"button-",a=s+"button",f="wijmo-wijgallery-thumbs-pointer-{0}",l="wijmo-wijgallery-flashwrapper",c='<div class="wijmo-wijgallery-frame"><div class="wijmo-wijgallery-content"></div></div>',h='<div class="wijmo-wijgallery-thumbs"></div>',p="<a><span></span></a>",d='<div class="wijmo-wijgallery-frame-{0}"><a href="#" class="wijmo-wijgallery-frame-link"></a></div>',v="<div></div>",m="li.wijmo-wijcarousel-item";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var g=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(e,t){var r=this,i=r.options,s,o,u,a;if(e==="framePosition"||e==="thumbnailPosition"||e==="transitions"||e==="pagingPosition")n.extend(!0,i[e],t);else{u=i[e],n.Widget.prototype._setOption.apply(r,arguments);switch(e){case"disabled":r._handleDisabledOption(t,r.element);break;case"thumbnailOrientation":r.thumbs[r.thumbWidgetName]({orientation:t});break;case"thumbsDisplay":r.thumbs[r.thumbWidgetName]({display:t});break;case"autoPlay":r[t?"play":"pause"]();break;case"showCounter":case"showTimer":case"showControls":s=e.replace(/show/i,"").toLowerCase(),o=e.replace(/show/i,"_create"),t!==u&&(t===!0?r[s]?r[s].jquery&&r[s].show():r[o]():r[s].hide());break;case"showCaption":t?(r._createCaption(r.size),a=r._loadCaption(r.images[r.currentIdx]),a.show()):r.element.find(".wijmo-wijgallery-caption,.wijmo-wijgallery-text").remove();break;case"showPager":case"thumbsLength":case"thumbnailDirection":case"showControlsOnHover":case"mode":case"data":r._wijdestroy(),r._create();break;default:}}},t.prototype._handleDisabledOption=function(e,t){var n=this;n.pager&&!n.pager.is(":hidden")?n.pager.wijpager("option","disabled",e):n.thumbs&&!n.thumbs.is(":hidden")&&n.thumbs[n.thumbWidgetName]({disabled:e})},t.prototype._initLi=function(e){var t=e.children("a:eq(0)"),r=e.find("img:eq(0)"),i=e.find("span:eq(0)"),s={url:null,thumbUrl:null,title:r.attr("alt"),caption:undefined};return t.length&&t.attr("href")?(s.url=t.attr("href"),s.title||(s.title=t.attr("title"))):r.length&&(s.url=r.attr("src")),i.length?s.caption=i:r.attr("title")&&(s.caption=n("<span>").html(r.attr("title"))),s.thumbUrl=r.attr("src"),s},t.prototype._initStatus=function(){var e=this,t;e.images=[],e.ul=e.element.children("ul"),t=e.ul.children("li"),e._count=t.length,t.each(function(t){var r=e._initLi(n(this));e.images.push(r)})},t.prototype._createMarkupFromData=function(){var e=this,t=e.options,r=t.data,i=e.element,s=i.children("ul:eq(0)");e.images=r,s.length?s.empty():s=n("<ul>").appendTo(i),e.ul=s,n.each(r,function(e,t){var r=n("<a>"),i=n("<li>"),o=n("<img>");t.url&&r.attr("href",t.url),t.thumbUrl&&o.attr("src",t.thumbUrl),t.title&&o.attr("alt"),r.append(o).appendTo(i),i.appendTo(s)}),e._count=r.length},t.prototype._create=function(){var e=this,t=e.options;e.container=e.element,e.container.addClass([i,t.wijCSS.widget].join(" ")),e.currentThumbIdx=0,e.currentIdx=-1,e.timerCount=0,window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),t.showPager?(t.pagingPosition=!0,t.thumbnails=!1):t.thumbnails=!0,t.data&&t.data.length?e._createMarkupFromData():e._initStatus(),t.loadCallback&&n.isFunction(t.loadCallback)&&e._trigger("loadCallback",null,e),e._createDom(),t.autoPlay&&e._play(!0),t.showControlsOnHover&&(e.frame.find(".wijmo-wijpager,.wijmo-wijgallery-button-next,.wijmo-wijgallery-counter,.wijmo-wijgallery-button-previous").hide(),!e.isPlaying&&e.timer&&e.timer.hide()),t.disabled&&e.disable(),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgallery")},t.prototype._createDom=function(){var e=this,t=e.options;t.thumbnails?e._createThumbnails():e.ul.hide(),e._createFrame(),t.control&&e._createControls(),t.showCounter&&e._createCounter(),t.showTimer&&e._createTimer(),t.showPager&&e._createPager()},t.prototype._getFrameSize=function(){var e=this,t=e.options.thumbnailOrientation==="horizontal",n=e.element.height()-(t?e.thumbs?e.thumbs.outerHeight(!0):0:0),r=e.element.width()-(t?0:e.thumbs?e.thumbs.outerWidth(!0):0);return{w:r<2||!r?750:r,h:n<2||!n?300:n}},t.prototype._createFrame=function(){var e=this,t=e.options,r,i,s=e._getFrameSize(),o=t.thumbnailDirection==="after";e.frame=n(c).addClass(t.wijCSS.content+" "+t.wijCSS.helperClearFix)[o?"prependTo":"appendTo"](e.container).setOutWidth(s.w-1).setOutHeight(s.h).wrap('<div class="wijmo-wijgallery-framewrapper">'),e.size=s,r=e.frame.width(),i=e.frame.height(),e.frameWrapper=e.frame.parent(),t.thumbnailOrientation==="vertical"&&e.frameWrapper.addClass("wijmo-wijgallery-framewrapper-vertical"),t.showControlsOnHover&&e.frame.bind("mouseenter."+e.widgetName,function(){if(e.options.disabled)return;e._showControls("controls")}).bind("mouseleave."+e.widgetName,function(){if(e.options.disabled)return;e._hideControls("controls")}),e.content=e.frame.children("div.wijmo-wijgallery-content"),t.mode==="img"&&e._createFrameMask(),e._createPrevNextBtn(),e._createCaption(s),e._createLoading(),e.last=n('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-last"></div>').appendTo(e.content).width(r).height(i).css({"line-height":s.h+"px"}),e.current=n('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-current"></div>').appendTo(e.content).width(r).height(i).css({"line-height":s.h+"px"}),e._show(0)},t.prototype._createControls=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"center bottom",at:"center bottom"};t.control&&(e.controls=n(t.control).css({position:"absolute"}).appendTo(e.container),n.extend(r,t.controlPosition),e.controls.position(r))},t.prototype._createLoading=function(){var e=this;e.loading=n("<div></div>").addClass("wijmo-wijgallery-loading").appendTo(e.content),e.loading.css({left:(e.content.width()-e.loading.width())/2,top:(e.content.height()-e.loading.height())/2}),e.loading.hide()},t.prototype._createFrameMask=function(){var e=this,t=e.options;n.each(["previous","next"],function(r,i){var s=n(d.replace(/\{0\}/,i)).appendTo(e.frame),o=s.children("a");n.browser.msie&&parseInt(n.browser.version)<=9&&s.css({"background-color":"#fff"}),t.showControlsOnHover&&s.bind("mouseenter."+e.widgetName,function(){if(e.options.disabled)return;e._showControls(i)}).bind("mouseleave."+e.widgetName,function(){if(e.options.disabled)return;e._hideControls(i)}),o.bind("click."+e.widgetName,function(t){if(e.options.disabled)return;e[i](),t.preventDefault()})})},t.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter){e.counter&&(e.counter.remove(),e.counter=undefined);return}e.counter||(e.counter=n("<div></div>").addClass("wijmo-wijgallery-counter "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerTL).appendTo(e.frame)),e._refreshCounter()},t.prototype._refreshCounter=function(){var e=this,t=e.options,r;if(!e.counter)return;e.counter.empty(),t.counter&&(r=t.counter.replace(/\[i\]/,e.currentIdx+1),r=r.replace(/\[n\]/,e._count),n("<span></span>").text(r).appendTo(e.counter))},t.prototype._createPrevNextBtn=function(){var e=this,t=e.options.wijCSS;n.each(["next","previous"],function(r,i){var s=i==="next"?t.iconArrowRight:t.iconArrowLeft,o;o=e.frame.find(".wijmo-wijgallery-frame-"+i);if(!o.length||e.options.mode!=="img")o=e.frame;e[i+"Btn"]=n(e._createBtn(u+i,s)).bind("click."+e.widgetName,n.proxy(e[i],e)).appendTo(o),e._applyBtnStyle(i)})},t.prototype._applyBtnStyle=function(e){var t=this,n=t.options,r=e==="next",i=t[e+"Btn"],s=r?"right center":"left center",o=s,u=n.wijCSS,a=r?u.cornerLeft:u.cornerRight,f=e==="next"?t.currentIdx>=t._count:t.currentIdx<=0,l={collision:"none",of:t.frame,my:o,at:s};i.addClass(a).position(l),f?i.removeClass(u.stateHover).addClass(u.stateDisabled):i.hasAllClasses(u.stateDisabled)&&i.removeClass(u.stateDisabled)},t.prototype._createCaption=function(e){var t=this,r=t.options,i=r.wijCSS;r.showCaption&&(t.overlay=n(v).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-caption"].join(" ")).width(e.w).appendTo(t.content),t.caption=n(v).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-text"].join(" ")).width(e.w).appendTo(t.content))},t.prototype._loadCaption=function(e){var t=this,r=e.caption,i,s=n("<span></span>"),o=t.element.find(".wijmo-wijgallery-text,.wijmo-wijgallery-caption");return r&&(o.show(),r.jquery&&r.show(),s.html(r),t.caption.empty().append(s),i=s.outerHeight(!0),o.height(i),n.browser.msie&&o.height(s.css("display","block").outerHeight(!0))),o.hide(),o},t.prototype._showCaption=function(e){var t=this;e&&e.caption&&(t.caption.length&&t.caption.fadeIn(500),t.overlay.length&&t.overlay.show().animate({opacity:.5},500))},t.prototype._createTooltip=function(e){var t=this,r=t.options.wijCSS,i=e||"bottom";t.pointer=n("<div>").addClass([r.content,r.stateDefault,f.replace(/\{0\}/,i)].join(" ")),t.pointer.appendTo(t.thumbsWrapper).hide()},t.prototype._createThumbnails=function(){var e=this,t=e.options,r=t.thumbnailDirection==="after",i="wijmo-wijgallery-thumbs-{0}",s=t.thumbnailOrientation==="horizontal",o=r?s?"bottom":"right":s?"top":"left";e.thumbPosition=o,e.thumbs=n(h).appendTo(e.container).addClass(t.wijCSS.content).addClass(s?"wijmo-wijcarousel-horizontal-multi":"wijmo-wijcarousel-vertical-multi"),s?e.thumbs.css({height:t.thumbsLength+"px"}).setOutWidth(e.element.width()):e.thumbs.css({width:t.thumbsLength+"px"}).setOutHeight(e.element.height()),e.ul.appendTo(e.thumbs),e.ul.children("li").each(function(t,r){var i=n(r).children("a"),s=e.images[t],o=s.thumbUrl;i.length||(i=n(r).wrapInner("<a>").children("a"),i.attr("href",o))}),n[e.namespace][e.thumbWidgetName]&&(e.thumbs.addClass(i.replace(/\{0\}/,o)).find("li").addClass(t.wijCSS.stateDefault).hover(function(){n(this).addClass(t.wijCSS.stateHover)},function(){n(this).removeClass(t.wijCSS.stateHover)}),e.thumbsWrapper=e.thumbs[e.thumbWidgetName]({display:t.thumbsDisplay,step:t.thumbsDisplay-1,itemPadding:"0 10px",showCaption:t.showThumbnailCaptions,orientation:t.thumbnailOrientation,loop:!1,itemClick:function(t,n){var r=n.index;e.show(r),t.preventDefault()},afterScroll:function(t,n){e.currentThumbIdx=n.firstIndex,e.activeLi&&e.activeLi.is("li")&&e.activeLi.index()>=n.firstIndex&&e.activeLi.index()<=n.lastIndex&&e._highlightThumb(e.activeLi),e.isScrolling=!1},beforeScroll:function(n,r){e.isScrolling=!0,t.mode==="swf"||t.mode==="flv"?e.pointer.hide():e.pointer.fadeOut(100)}}).wrap('<div class="wijmo-wijgallery-thumbswrapper">').parent(),s||e.thumbsWrapper.addClass("wijmo-wijgallery-thumbswrapper-vertical"),e._createTooltip(o))},t.prototype._calculatePosition=function(e,t,n,r,i,s){var o=this;o.thumbPosition==="bottom"?(e.left=e.left+(r-t)/2+s,e.top=e.top-n):o.thumbPosition==="top"?(e.left=e.left+(r-t)/2+s,e.top=e.top+i+2*s):o.thumbPosition==="left"?(e.left=e.left+r+2*s,e.top=e.top+(i-n)/2+s):o.thumbPosition==="right"&&(e.left=e.left-t,e.top=e.top+(i-n)/2+s)},t.prototype._highlightThumb=function(e){var t=this,n,r,i,s,u,a,f=[o,t.options.wijCSS.stateActive].join(" ");e&&e.length&&(e.siblings("li."+o).removeClass(f),e.addClass(f),n=t.pointer.outerWidth(!0),r=t.pointer.outerHeight(!0),i=e.width(),s=e.height(),u=e.offset(),a=5,t._calculatePosition(u,n,r,i,s,a),t.pointer.fadeIn(100),t.pointer.offset(u))},t.prototype._getSelector=function(e,t){var n,r=".wijmo-wijgallery-button-",i=".wijmo-wijpager,.wijmo-wijgallery-counter";return t&&(i+=",.wijmo-wijgallery-timerbar"),e==="next"||e==="previous"?n=r+e:e==="controls"?n=i:n=i+","+r+"next,"+r+"previous",n},t.prototype._showControls=function(e){var t=this,r;r=t._getSelector(e,!t.isPlaying&&t.timer),t.frame.find(r).stop(!0,!0).fadeIn(400,function(){n(this).css("opacity","")})},t.prototype._hideControls=function(e){var t=this,n;n=t._getSelector(e,!t.isPlaying&&t.timer),this.frame.find(n).stop(!0,!0).fadeOut(600)},t.prototype._createPager=function(){var e=this,t=e.options,r,i=t.thumbsDisplay,s=1,o=e.currentIdx,u=e.currentIdx,a={collision:"none",of:e.container,my:"right top",at:"right bottom"};t.thumbnails?(r=n("<div></div>").appendTo(e.thumbs),i!==0&&(s=Math.ceil(e._count/i),o=Math.ceil(e.currentIdx/i)),e.pager=r.wijpager({pageCount:s,pageIndex:o,pageButtonCount:s,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;(u<r*i||u>=(r+1)*i)&&e.thumbs[e.thumbWidgetName]("scrollTo",r*i),t.preventDefault()}}).css({position:"absolute"})):(r=n("<div></div>").appendTo(e.container),e.pager=r.wijpager({pageCount:e._count,pageIndex:e.currentIdx,pageButtonCount:e._count,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;e._show(r)}}).css({position:"absolute"}),n.extend(a,t.pagingPosition),e.pager.addClass("wijmo-wijgallery-pager").position(a))},t.prototype._createBtn=function(e,t){var r=n(p),i=this.options;return r.addClass(i.wijCSS.stateDefault+" "+e).attr("role","button").bind("mouseover"+this.widgetName,function(){if(n(this).hasAllClasses(i.wijCSS.stateDisabled))return;n(this).addClass(i.wijCSS.stateHover)}).bind("mouseout"+this.widgetName,function(){if(n(this).hasAllClasses(i.wijCSS.stateDisabled))return;n(this).removeClass(i.wijCSS.stateHover)}),r.children("span:eq(0)").addClass(i.wijCSS.icon+" "+t),r},t.prototype._createTimer=function(){var e=this,t=e.options;e._createPausePlay(),e.progressBar=n("<div></div>").addClass("wijmo-wijgallery-timerbar-inner "+t.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),e.timer=n("<div></div>").addClass("wijmo-wijgallery-timerbar "+t.wijCSS.cornerAll).appendTo(e.frame).append(e.progressBar).append(e.playPauseBtn)},t.prototype._createPausePlay=function(){var e=this,t=e.options;e.playPauseBtn=n(e._createBtn(a,t.autoPlay?t.wijCSS.iconPause:t.wijCSS.iconPlay)).bind("wijclick."+e.widgetName,function(){if(!n(this).hasAllClasses(t.wijCSS.stateDisabled)){var r=n(this).children("span:eq(0)");e[r.hasAllClasses(t.wijCSS.iconPlay)?"play":"pause"]()}})},t.prototype._show=function(e){var t=this,r=t.images[e],i,s,o,u=t._getFrameSize(),a=t.options,f=a.mode;if(t.currentIdx===e)return;r&&n.isPlainObject(r)&&(t.loading.delay(500).fadeIn(100),o=t.last.children("img,div."+l),o.length&&o.remove(),f==="swf"||f==="flv"?(t.last.hide(),t.current.empty(),t._wrapFlash(t.current,f,r.url),t.picture=t.current.children("div."+l),t._setCurrentStates(e),t.loading.stop().hide(),t._thumbsScroll(e)):f==="img"?(t.picture&&t.picture.length&&t.last.append(t.picture),t.current.addClass("ui-helper-hidden-accessible"),t.last.show(),t.picture=n("<img>"),t.picture.one("load",function(){t.picture.data("itemIndex",e).appendTo(t.current),t._imageLoaded(t,u)}).attr({src:r.url,alt:r.title})):f==="iframe"&&(t.current.is(":hidden")?(i=t.current,s=t.last):(i=t.last,s=t.current),t.picture=n("<iframe></iframe>").addClass("wijmo-wijgallery-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true",src:r.url}).hide().appendTo(i).data("itemIndex",e).bind("load",function(){var e=n(this),r=e.data("itemIndex");t.loading.stop().hide(),t.pointer&&t.pointer.fadeOut(100),t._setCurrentStates(r),r!==undefined&&(a.showCaption,e.show(),s.fadeOut(function(){s.empty()}),i.fadeIn())})))},t.prototype._imageLoaded=function(e,t){var n=e.picture.attr("role","img"),r=n.data("itemIndex"),i=n[0].naturalWidth||n.width(),s=n[0].naturalHeight||n.height(),o=e.images[r];e.loading.stop().hide(),e.current.removeClass("ui-helper-hidden-accessible"),e.current.hide(),e.pointer&&e.pointer.fadeOut(100),i>=t.w||s>=t.h?i/s>t.w/t.h?n.css({width:"100%"}):n.css({height:"100%"}):i<t.w&&s<t.h&&n.addClass(e.options.wijCSS.stateDefault).addClass("wijmo-wijgallery-small-image"),r!==undefined&&o!==undefined&&(e.options.showCaption&&e.caption&&e._loadCaption(o),e._animate(r))},t.prototype._animate=function(e){var t=this,r=t.options,i=r.transitions,s=r.thumbnailOrientation==="horizontal",o,u,a,f,l,c,h=i.animated,p=i.duration;if(!t.last.children().length){t._setCurrentStates(e),t.last.hide(),t.current.show();return}l={index:t.currentIdx,to:e,toImg:t.images[e]};if(!t._trigger("beforeTransition",null,l))return;h?h==="slide"?(o=t.size.w,u=t.size.h,t.current.show(),c=t.currentIdx>e?!0:!1,a=n.createWrapper(t.last).css({overflow:"hidden",width:s?o*2:o,height:s?u:u*2,left:s?c?-o:0:0,top:s?0:c?-u:0}),a[c?"prepend":"append"](t.current),a.animate({left:s?c?0:-o:0,top:s?0:c?0:-u},p,function(){t.last.parent().is(".ui-effects-wrapper")&&t.last.unwrap(),t.last.hide(),t._setCurrentStates(e)})):n.mobile?(f=p/2,t.last.fadeOut(f,function(){t.current.stop(!0,!0).fadeIn(f,function(){t._setCurrentStates(e)})})):h==="explode"||h==="scale"||h==="blind"||h==="fold"?(t.current.css({position:"absolute"}),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):h==="size"?(t.last.hide(),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):(f=p/2,t.last.hide(h,f,function(){t.last.hide(),t.current.stop(!0,!0).show(h,f,function(){t._setCurrentStates(e)})})):(t.last.hide(),t.current.show(),t._setCurrentStates(e)),t._thumbsScroll(e)},t.prototype._thumbsScroll=function(e){var t,n=this,r=n.options;n.thumbs&&n.thumbs[n.thumbWidgetName]&&(r.scrollWithSelection?(t=e-Math.ceil(r.thumbsDisplay/2)+1,e>0&&e<n._count-1&&n.thumbs[n.thumbWidgetName]("scrollTo",t)):e>r.thumbsDisplay+n.currentThumbIdx-1?n.thumbs[n.thumbWidgetName]("scrollTo",e-r.thumbsDisplay+1):e<n.currentThumbIdx&&n.thumbs[n.thumbWidgetName]("scrollTo",e))},t.prototype._setCurrentStates=function(e){var t=this,n=t.options,r,i,s;s=t.currentIdx,t.currentIdx=e,r=e+1<t._count,t.isPlaying&&r?(t.timeout=null,t.isPlaying=!1,t._play()):t.progressBar&&t.pause(),e+1>=t._count?t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateDisabled),e<=0?t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.previousBtn.removeClass(n.wijCSS.stateDisabled),n.showCaption&&t._showCaption(t.images[e]),t.thumbs&&t.thumbs[t.thumbWidgetName]?(t.activeLi=t.thumbs.find(m).eq(e),t.isScrolling||t._highlightThumb(t.activeLi)):t.pager&&t.pager.is(":wijmo-wijpager")&&t.pager.wijpager("option","pageIndex",e),t._refreshCounter(),t._clearCss(),i={last:s,index:t.currentIdx,toImg:t.images[t.currentIdx]},t._trigger("afterTransition",null,i)},t.prototype._clearCss=function(){this.current.css({position:"",visibility:""})},t.prototype._resetState=function(){var e=this;e._stopAnimation(),e.isPlaying&&e.progressBar&&(e.progressBar.stop(),e.progressBar.css({width:"0%"}))},t.prototype._stopAnimation=function(){var e=this,t;t=e.content.find(".ui-effects-wrapper"),t.length&&t.stop(!0,!0),e.current.stop(!0,!0),e.last.stop(!0,!0)},t.prototype.count=function(){return this._count},t.prototype._wijdestroy=function(){var e=this,t=e.options.wijCSS;e.frame.unwrap().remove(),e.options.thumbnails?n[e.namespace][e.thumbWidgetName]&&(e.thumbs[e.thumbWidgetName]("destroy"),e.element.find("li").unbind().removeClass(t.stateActive).filter("."+o).removeClass(o),e.thumbs.children("ul").unwrap().unwrap()):(e.pager&&e.pager.length&&e.pager.remove(),e.element.find("ul").css({display:""})),e.pointer&&e.pointer.remove(),e.element.removeClass([i,t.widget,t.content,t.cornerAll].join(" "))},t.prototype.destroy=function(){this._wijdestroy(),n.Widget.prototype.destroy.apply(this)},t.prototype.show=function(e){var t=this;t._resetState(),t._show(e)},t.prototype.next=function(){var e=this,t;if(e.options.disabled)return;e._resetState(),t=e.currentIdx+1,t<e._count&&e._show(t)},t.prototype.previous=function(){var e=this,t;if(e.options.disabled)return;e._resetState(),t=e.currentIdx-1,t>=0&&e._show(t)},t.prototype.play=function(){this._play()},t.prototype._play=function(e){var t=this,n=t.options;if(t.isPlaying||n.disabled)return;if(n.interval===0)return t.pause();if(e){t.isPlaying=!0;return}if(n.showTimer&&t.progressBar)t.progressBar.css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(n.wijCSS.iconPlay).addClass(n.wijCSS.iconPause),t.progressBar.animate({width:"100%"},n.interval,null,function(){t._show(t.currentIdx+1)});else{if(t.timeout)return;t.timeout=window.setTimeout(function(){t.timerCount<=1&&t.next(),t.timerCount--},n.interval),t.timerCount++}t.isPlaying=!0},t.prototype.pause=function(){var e=this,t=e.options;if(t.showTimer&&e.progressBar)e.progressBar.stop(),e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPause).addClass(t.wijCSS.iconPlay);else{if(e.timeout===null)return;window.clearTimeout(e.timeout),e.timeout=null}e.isPlaying=!1},t.prototype.add=function(e,t){var r=this,i,s,o;if(typeof e=="string")i=n(e),o=r._initLi(i);else if(e.jquery)i=e,o=r._initLi(i);else{if(!n.isPlainObject(e))return;o=e}!t||t>r._count?s=r._count:t<0?s=0:s=t,r.images.splice(s,0,o),r._count++,r.thumbs&&r.thumbs[r.thumbWidgetName]&&(r.pointer&&r.pointer.is(":hidden")&&r.pointer.show(),r.thumbs[r.thumbWidgetName]("add",i,s)),r._count===1&&r.show(0),r._refreshStateWithItemsChanged(s)},t.prototype.remove=function(e){var t=this,n;isNaN(e)||e>=t._count?n=t._count-1:e<0?n=0:n=e;if(n>=0){t.images.splice(n,1),t._count--,t.thumbs&&t.thumbs[t.thumbWidgetName]&&t.thumbs[t.thumbWidgetName]("remove",n);if(t.currentIdx==n)t.current.children("img").remove(),t.last.children("img").remove(),t.picture=null,t.currentIdx=-1,t._count>0&&(n===t._count?t.show(n-1):t.show(n));else if(t.currentIdx>n){var r=t.currentIdx;t.currentIdx=-1,t.show(r)}t._refreshStateWithItemsChanged(n)}},t.prototype._refreshStateWithItemsChanged=function(e){var t=this,n=t.options;t._count===0?(t.nextBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.playPauseBtn&&t.playPauseBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.pointer&&t.pointer.hide()):t.currentIdx<=0?t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.currentIdx>=t._count-1?(t.nextBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled),t.playPauseBtn&&t.playPauseBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled)):(t.nextBtn.removeClass(n.wijCSS.stateDisabled),t.previousBtn.removeClass(n.wijCSS.stateDisabled),t.playPauseBtn&&t.playPauseBtn.removeClass(n.wijCSS.stateDisabled),t.pointer&&t.pointer.is(":hidden")&&t.pointer.show()),t._refreshCounter()},t.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},t.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],r=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=this._getExt(e);if(u){if(n.inArray(u,t)>=0)return"img";if(n.inArray(u,r)>=0)return"swf";if(n.inArray(u,i)>=0)return"flv";if(n.inArray(u,o)>=0)return"wmp";if(n.inArray(u,s)>=0)return"qt"}return"unknown"},t.prototype._wrapFlash=function(e,t,r){var i=this,s=i.options,o=r,u,a="100%",f="100%",c=s.flashInstall,h=s.flashVersion,p=s.flashVars,d=s.flashParams,v=i._newId();t==="flv"&&(o=s.flvPlayer,p=n.extend({file:r,width:a,height:f,autostart:s.autoPlayMovies?"true":"false",controlbar:s.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},s.flashVars),d=n.extend({autostart:s.autoPlayMovies?"true":"false",allowscriptaccess:"always"},s.flashParams)),u=n("<div/>").addClass(l).appendTo(e),n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",v).appendTo(u),S.flash.embedSWF(o,v,a,f,h,c,p,d)},t.prototype._newId=function(){var e="a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z",t=[],n="",r;t=e.split("|");for(r=0;r<16;r++)n+=t[Math.round(Math.random()*25)];return n},t}(e.wijmoWidget);t.wijgallery=g,g.prototype.thumbWidgetName="wijcarousel";var y=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijgallery')",this.autoPlay=!1,this.scrollWithSelection=!1,this.showTimer=!0,this.interval=5e3,this.showCaption=!0,this.showThumbnailCaptions=!1,this.data=[],this.showControls=!1,this.control="",this.controlPosition={},this.showCounter=!0,this.counter="[i] of [n]",this.showPager=!1,this.pagingPosition={},this.thumbnailOrientation="horizontal",this.thumbnailDirection="after",this.transitions={animated:"slide",duration:1e3,easing:null},this.showControlsOnHover=!0,this.thumbsDisplay=5,this.thumbsLength=100,this.beforeTransition=null,this.afterTransition=null,this.loadCallback=null,this.showMovieControls=!1,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0,wmode:"transparent"},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.mode="img"}return e}();g.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new y),n.wijmo.registerWidget("wijgallery",g.prototype)})(e.gallery||(e.gallery={}));var t=e.gallery})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=jQuery;(function(e){e._map=[],e._map[0]="east",e.east=0,e._map[1]="west",e.west=1,e._map[2]="south",e.south=2,e._map[3]="north",e.north=3})(t.Compass||(t.Compass={}));var r=t.Compass,i=function(){function e(){}return e.mod360=function(t){var n=t%360;return t<0&&(n+=360),n},e.getAngle=function(t,n,r){var i=this,s=i.distance(n,r),o=i.distance(n,t),u=i.distance(r,t),a=s*s,f=o*o,l=u*u,c=Math.acos((l-f-a)/(-2*o*s));return Math.round(180/Math.PI*c)},e.distance=function(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},e.log=function(t,n){return t<=0?NaN:n===1||n<0?NaN:Math.log(t)/Math.log(n)},e.generateValues=function(t,n,r){var i=[],s,o;if(n>t&&r>0){s=parseInt(((n-t)/r+1).toString(),10);for(o=0;o<s;o++)i.push(t+o*r)}else r===0&&i.push(t);return i},e.isInRange=function(t,n,r){return t>=n&&t<=r||t<=n&&t>=r},e.paintMarker=function(t,n,r,i,s,o,u){var a;return n==="rect"?t.rect(r-s/2,i-o/2,s,o):(u?n==="tri"?a=t.isoTri(r,i,s,o):a=t.paintMarker(n,r,i,o):a=t.paintMarker(n,r,i,s),a)},e.formatString=function(t,r){if(n.isFunction(r))return r.call(this,t);if(r!==""){var i=/\{0(?::((?:n|d|p|c)\d?))?\}/gi,s,o;if(i.test(r))return s=r.match(i),o="$1",r.replace(/\{0(?::(?:(?:n|d|p|c)\d?))?\}/gi,Globalize.format(t,o))}return t},e.getPositionByAngle=function(t,n,r,i){var s={x:0,y:0},o=Raphael.rad(i);return s.x=t-r*Math.cos(o),s.y=n-r*Math.sin(o),s},e.donut=function(t,n,r,i,s,o,u){var a=this.getPositionByAngle,f=a(n,r,i,o),l=a(n,r,i,u),c=a(n,r,s,o),h=a(n,r,s,u),p=u-o>180,d;(u-o)%360!==0?(d=["M",f.x,f.y,"A",i,i,0,+p,1,l.x,l.y,"L",h.x,h.y,"A",s,s,0,+p,1,c.x,c.y,"L",f.x,f.y,"z"],t.path(d)):t.circle(n,r,i)},e}();t.GaugeUtil=i,Raphael.fn.isoTri=function(e,t,n,i,s){var o=e,u=t+i/2,a=e+n,f=t,l=e+n,c=t+i,h;return s==r.north?(o=e,u=t,a=e-n/2,f=t+i,l=e+n/2,c=t+i):s===r.east?(o=e-n/2,u=t-i/2,a=e-n/2,f=t+i/2,l=e+n/2,c=t):s===r.west&&(o=e-n/2,u=t,a=e+n/2,f=t-i/2,l=e+n/2,c=t+i/2),h=["M",o,u,"L",a,f,"L",l,c,"z"],this.path(h.join(" "))};var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this,t=e.options,r;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.redraw(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgauge"),isNaN(t.width)&&e._setDefaultWidth(),isNaN(t.height)&&e._setDefaultHeight(),e._setDefaultWidthHeight(),t.disabled&&e.disable(),t.face&&t.face.template&&typeof t.face.template=="string"&&window[t.face.template]&&(t.face.template=window[t.face.template]),t.pointer&&t.pointer.template&&typeof t.pointer.template=="string"&&window[t.pointer.template]&&(t.pointer.template=window[t.pointer.template]),t.cap&&t.cap.template&&typeof t.cap.template=="string"&&window[t.cap.template]&&(t.cap.template=window[t.cap.template]),e.element.addClass(t.wijCSS.widget).toggleClass(t.wijCSS.stateDisabled,t.disabled);try{e.canvas=Raphael(e.element[0],t.width,t.height)}catch(i){var s=e.element.css("display");r=n("<div></div>").insertBefore(e.element).append(e.element),e.element.addClass("ui-helper-hidden-accessible").appendTo(n("body")),s==="none"&&e.element.css("display","block"),e.canvas=Raphael(e.element[0],t.width,t.height),e.element.appendTo(r).unwrap().removeClass("ui-helper-hidden-accessible"),s==="none"&&e.element.css("display","none")}e._autoCalculate(),e._draw(),e._bindResizeEvent()},t.prototype._setDefaultWidth=function(){},t.prototype._setDefaultHeight=function(){},t.prototype._setDefaultWidthHeight=function(){var e=this,t=e.element,n=e.options,r=t.get(0).style,i=r.width,s=r.height;i!==""&&(n.width=t.width()),s!==""&&(n.height=t.height())},t.prototype._autoCalculate=function(){},t.prototype._setOption=function(t,r){var i=this,s=i.options,o=s[t];if(t==="disabled")i._handleDisabledOption(r,i.element),e.prototype._setOption.call(this,t,r);else if(t==="value")i._trigger("beforeValueChanged",null,{newValue:r,oldValue:o})&&(e.prototype._setOption.call(this,t,r),i._set_value(r,o)),i._trigger("valueChanged",null,{newValue:r,oldValue:o});else{e.prototype._setOption.call(this,t,r),n.isPlainObject(r)&&(s[t]=n.extend({},o,r));if(s.radius==="auto"){i._autoCalculate(),i.redraw();return}i["_set_"+t]&&i["_set_"+t](r,o)}},t.prototype._set_value=function(e,t){this._setPointer()},t.prototype._set_autoResize=function(){this._unbindResizeEvent(),this._bindResizeEvent()},t.prototype._set_max=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},t.prototype._set_min=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},t.prototype._set_width=function(){this.redraw()},t.prototype._set_height=function(){this.redraw()},t.prototype._set_isInverted=function(){this.redraw()},t.prototype._set_tickMajor=function(){this._redrawMarksAndLabels()},t.prototype._set_tickMinor=function(){this._redrawMarksAndLabels()},t.prototype._set_pointer=function(){var e=this;e.pointer&&(e.pointer.wijRemove(),e.pointer=null),e._paintPointer(),e._setPointer()},t.prototype._set_islogarithmic=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},t.prototype._set_logarithmicBase=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},t.prototype._set_labels=function(){this._redrawMarksAndLabels()},t.prototype._set_margin=function(e,t){e!==t&&this.redraw()},t.prototype._set_marginTop=function(e,t){this._set_margin(e,t)},t.prototype._set_marginBottom=function(e,t){this._set_margin(e,t)},t.prototype._set_marginLeft=function(e,t){this._set_margin(e,t)},t.prototype._set_marginRight=function(e,t){this._set_margin(e,t)},t.prototype._set_ranges=function(){var e=this;e._removeRanges(),e._paintRanges(),e._resetElementPosition()},t.prototype._set_face=function(){var e=this;e.face&&(e.face.wijRemove(),e.face=null,e._paintFace(),e._resetElementPosition(!0))},t.prototype._clearState=function(){var e=this;e.labels=[],e.majorMarks=[],e.minorMarks=[],e.face=null,e.pointer=null},t.prototype._resetElementPosition=function(e){var t=this;e&&t.ranges&&n.each(t.ranges,function(e,t){t.toFront()}),t.majorMarks&&n.each(t.majorMarks,function(e,t){t.toFront()}),t.minorMarks&&n.each(t.minorMarks,function(e,t){t.toFront()}),t.labels&&n.each(t.labels,function(e,t){t.toFront()}),t.pointer&&t.pointer.toFront(),t.cap&&t.cap.toFront()},t.prototype._redrawMarksAndLabels=function(){var e=this;e._removeMarksAndLabels(),e._drawMarksAndLabels()},t.prototype._removeMarksAndLabels=function(){var e=this;n.each(e.labels,function(t,n){n.wijRemove(),e.labels[t]=null}),n.each(e.majorMarks,function(t,n){n.wijRemove(),e.majorMarks[t]=null}),n.each(e.minorMarks,function(t,n){n.wijRemove(),e.minorMarks[t]=null})},t.prototype._drawMarksAndLabels=function(){var e=this;e.labels=[],e.majorMarks=[],e.minorMarks=[],e._paintMarks()},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=t.options,i=e||t.element,s=i.offset(),o=r.width||i.outerWidth(),u=r.height||i.outerHeight(),a;return a=n("<div></div>").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),Raphael.vml&&a.addClass(r.stateDisabled).css("background-color","#fff"),a},t.prototype._triggerPainted=function(){return this._trigger("painted")},t.prototype._draw=function(){var e=this,t=e.options;e.pointer=null,e._innerBbox={width:t.width-t.marginLeft-t.marginRight,height:t.height-t.marginTop-t.marginBottom,left:t.marginLeft,top:t.marginTop},e.face=e._paintFace(),e.ranges&&e._removeRanges(),e._paintRanges(),e._drawMarksAndLabels(),e._paintPointer(),e.pointer&&(e._setOffPointerValue(),e._setPointer()),n.wijraphael.clearRaphaelCache(),e._triggerPainted()},t.prototype.redraw=function(){var e=this,t=e.options;e.element.empty(),this._clearState(),e.canvas=Raphael(e.element[0],t.width,t.height),e._draw()},t.prototype.destroy=function(){var t=this;t._unbindEvents(t.majorMarks),t._unbindEvents(t.minorMarks),t._unbindEvents(t.labels),t._unbindResizeEvent(),t.element.removeClass("ui-widget").empty(),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null),e.prototype.destroy.call(this)},t.prototype.getCanvas=function(){return this.canvas},t.prototype._percentage=function(){var e=this,t=e.options,n=t.max,r=t.min,i=t.value;return isNaN(i)?0:n===r?1:(i-r)/(n-r)},t.prototype._valueToLogical=function(e){var t=this,n=t.options,r=n.min,s=n.max,o=n.logarithmicBase,u,a;return e<r?0:s<e?1:(u=(e-r)/(s-r),n.islogarithmic?a=i.log(1+(o-1)*u,n.logarithmicBase):a=u,a)},t.prototype._logicalToValue=function(e){var t=this,n=t.options,r=n.max,i=n.min,s;if(e<0)return i;if(1<=e)return r;if(!n.islogarithmic)s=e;else{if(n.logarithmicBase<=1)return n.min;s=(Math.pow(n.logarithmicBase,e)-1)/(n.logarithmicBase-1)}return i+(r-i)*s},t.prototype._bindResizeEvent=function(){var e=this;this.resizeIntent=250,this.options.autoResize&&this.element.on("resize."+this.widgetName,function(){clearTimeout(e.resizeTimer),e.resizeTimer=setTimeout(function(){e.redraw()},e.resizeIntent)})},t.prototype._unbindResizeEvent=function(){this.element.off("resize."+this.widgetName)},t.prototype._bindClickEvents=function(e){var t=this;n.each(e,function(e,r){n(r.node).bind("click."+t.widgetName,function(e){t._trigger("click",e,{ele:r})})})},t.prototype._unbindEvents=function(e){var t=this;n.each(e,function(e,r){n(r.node).unbind("."+t.widgetName)})},t.prototype._setOffPointerValue=function(){},t.prototype._setPointer=function(){},t.prototype._paintPointer=function(){},t.prototype._paintFace=function(){},t.prototype._paintRanges=function(){var e=this,t=e.options,r=t.ranges||[];e.ranges=[],n.each(r,function(t,n){e._paintRange(n)})},t.prototype._paintRange=function(e){},t.prototype._removeRanges=function(){var e=this;n.each(e.ranges,function(t,n){n.wijRemove(),e.ranges[t]=null})},t.prototype._paintMarks=function(){var e=this,t=e.options,r=i.generateValues,s=r(t.min,t.max,t.tickMajor.interval),o=r(t.min,t.max,t.tickMinor.interval),u=t.labels,a=u.visible;t.tickMajor.visible&&n.each(s,function(n,r){e.majorMarks.push(e._paintMark(r,t.tickMajor,!0)),a&&e.labels.push(e._paintLabel(r,u))}),t.tickMinor.visible&&n.each(o,function(r,i){var o=!1;n.each(s,function(e,t){if(i===t)return o=!0,!1}),o||e.minorMarks.push(e._paintMark(i,t.tickMinor,!1))}),e._bindClickEvents(e.majorMarks),e._bindClickEvents(e.minorMarks),e._bindClickEvents(e.labels)},t.prototype._paintMark=function(e,t,n){},t.prototype._paintLabel=function(e,t){},t}(e.wijmoWidget);t.wijgauge=s;var o=function(){function e(){this.value=0,this.max=100,this.min=0,this.width=600,this.height=400,this.autoResize=!0,this.tickMajor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:2,visible:!0,marker:"rect",offset:0,interval:10},this.tickMinor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:1,visible:!1,marker:"rect",offset:0,interval:5},this.pointer={length:1,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:0,shape:"tri",visible:!0,template:null},this.islogarithmic=!1,this.logarithmicBase=10,this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},visible:!0,offset:0},this.animation={enabled:!0,duration:2e3,easing:">"},this.face={style:{fill:"270-#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null},this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.ranges=[],this.isInverted=!1,this.beforeValueChanged=null,this.valueChanged=null,this.painted=null}return e}();s.prototype.options=n.extend({},e.wijmoWidget.prototype.options,new o)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._setDefaultWidth=function(){var e=this.options;e.width=e.orientation==="horizontal"?310:70},n.prototype._setDefaultHeight=function(){var e=this.options;e.height=e.orientation==="horizontal"?70:310},n.prototype._set_orientation=function(){var e=this;e._setDefaultWidth(),e._setDefaultHeight(),e.markBbox=null,e.redraw()},n.prototype._set_xAxisLocation=function(){this.redraw()},n.prototype._set_xAxisLength=function(){this.redraw()},n.prototype._set_yAxisLocation=function(){this.redraw()},n.prototype._clearState=function(){t.prototype._clearState.call(this),this.markBbox&&(this.markBbox=null)},n.prototype._create=function(){t.prototype._create.call(this),this.element.addClass(this.options.wijCSS.linearGauge)},n.prototype._paintLabel=function(t,n){var r=this,i=r.options,s=n.format,o=n.style,u=n.offset,a=t,f=r.options.tickMajor,l=f.position||"inside",c,h,p,d;return s!==""&&(a=e.GaugeUtil.formatString(t,s)),p=r._getMarkerBbox(),d=r._getLabelBBox(a),c=r._valueToPoint(t,0),i.orientation==="horizontal"?(l==="inside"?c.y=p.y-d.height:c.y=p.y+p.height+d.height/2,c.y+=u):(l==="inside"?c.x=p.x-d.width/2:c.x=p.x+p.width+d.width/2,c.x+=u),h=r.canvas.text(c.x,c.y,a),h.attr(o),$.wijraphael.addClass($(h.node),i.wijCSS.linearGaugeLabel),h},n.prototype._getLabelBBox=function(e){var t=this,n=t.options,r,i;return r=t.canvas.text(0,0,e),r.attr(n.gaugeLableStyle),i=r.wijGetBBox(),r.remove(),i},n.prototype._getMarkerBbox=function(){var e=this,t=e.options,n=t.tickMajor,r;return e.markBbox||(r=e._paintMark(0,n),e.markBbox=r.wijGetBBox(),r.remove()),e.markBbox},n.prototype._paintMark=function(t,n,r){var i=this,s=i.options,o=n.marker||"rect",u=o==="rect"?5:2,a=i._valueToPoint(t,0),f=n.position||"inside",l=n.offset||0,c=r?2:1,h,p,d=$.extend({},n.style);return h=u*n.factor,$.isFunction(o)?o.call(i,i.canvas,a,s):(o==="cross"&&(d.stroke=d.fill),s.orientation==="horizontal"?p=e.GaugeUtil.paintMarker(i.canvas,o,a.x,a.y,c,h,!0):p=e.GaugeUtil.paintMarker(i.canvas,o,a.x,a.y,h,c),p.attr(d),$.wijraphael.addClass($(p.node),s.wijCSS.linearGaugeMarker),i._applyPosition(p,f,l,t),p)},n.prototype._applyPosition=function(e,t,n,r){var i=0,s=0,o=this,u=o.options.orientation==="horizontal",a=e.wijGetBBox();switch(t){case"inside":u?s-=a.width/2+n:i-=a.width/2+n;break;case"outside":u?s+=a.width/2+n:i+=a.width/2+n;break;case"center":u?s-=n:i-=n;break;default:}e.attr("transform","t"+i+","+s)},n.prototype._paintFace=function(){var e=this,t,n=e.options,r=e._innerBbox.width,i=e._innerBbox.height,s=e._innerBbox.left,o=e._innerBbox.top,u={width:r,height:i,x:s,y:o,canvas:e.canvas};return n.face&&n.face.template&&$.isFunction(n.face.template)?n.face.template.call(e,u):(t=e.canvas.rect(s,o,r,i,5),n.face&&n.face.style&&t.attr(n.face.style),$.wijraphael.addClass($(t.node),n.wijCSS.linearGaugeFace),t)},n.prototype._paintPointer=function(){var t=this,n=t.options,r=t._valueToPoint(n.min,0),i=t._innerBbox.width,s=t._innerBbox.height,o=t._innerBbox.left,u=t._innerBbox.top,a=n.pointer,f,l,c,h;if(!a.visible)return;h=n.orientation==="horizontal"?s:i,c=h*a.offset,l=h*a.length,a.template&&$.isFunction(a.template)?f=a.template.call(t.canvas,r,$.extend({},n.pointer,{offset:c,length:l,gaugeBBox:t._innerBbox})):(n.orientation==="horizontal"?a.shape==="rect"?f=t.canvas.rect(r.x-a.width/2,s-l-c+u,a.width,l):f=t.canvas.isoTri(r.x,s-l-c+u,a.width,l,e.Compass.north):a.shape==="rect"?f=t.canvas.rect(i-l-c+o,r.y-a.width/2,l,a.width):f=t.canvas.isoTri(i-l-c+o,r.y-a.width/2,l,a.width),f.attr(a.style)),$.wijraphael.addClass($(f.node),n.wijCSS.linearGaugePointer),t.pointer=f},n.prototype._setPointer=function(){var e=this,n=e.options;if(!e.pointer)return;t.prototype._setPointer.call(this),e._setLinearPointer(n.value)},n.prototype._setLinearPointer=function(e){var t=this,n=t.options,r=t._valueToPoint(n.min,0),i=t._valueToPoint(e,0),s=n.animation,o={x:0,y:0};n.orientation==="horizontal"?o.x=i.x-r.x:o.y=i.y-r.y,s.enabled?t.pointer.stop().wijAnimate({transform:"t"+o.x+","+o.y},s.duration,s.easing):t.pointer.attr("transform","t"+o.x+","+o.y)},n.prototype._minScreenPoint=function(e){var t=this,n=t.options,r=t._innerBbox.width,i=t._innerBbox.height,s=t._innerBbox.left,o=t._innerBbox.top,u=n.yAxisLocation+e;return n.orientation==="horizontal"?{x:r*n.xAxisLocation+s,y:i*u+o}:{x:r*u+s,y:i*(1-n.xAxisLocation)+o}},n.prototype._maxScreenPoint=function(e){var t=this,n=t.options,r=t._innerBbox.width,i=t._innerBbox.height,s=t._innerBbox.left,o=t._innerBbox.top,u=n.yAxisLocation+e,a=n.xAxisLocation+n.xAxisLength;return n.orientation==="horizontal"?{x:r*a+s,y:i*u+o}:{x:r*u+s,y:i*(1-a)+o}},n.prototype._paintRange=function(e){var t=this,n=t.options,r=isNaN(e.startValue)?0:e.startValue,i=isNaN(e.endValue)?0:e.endValue,s=isNaN(e.startWidth)?isNaN(e.width)?0:e.width:e.startWidth,o=isNaN(e.endWidth)?isNaN(e.width)?0:e.width:e.endWidth,u=e.startDistance||0,a=e.endDistance||0,f,l;r!==i&&(i>r?(f=Math.max(r,n.min),l=Math.min(n.max,i)):(f=Math.max(n.min,i),l=Math.min(n.max,r)),t._drawRange(f,l,u,a,s,o,e))},n.prototype._drawRange=function(e,t,n,r,i,s,o){var u=this,a=u.options,f=a.orientation,l=u._innerBbox.width,c=u._innerBbox.height,h=u._innerBbox.left,p=u._innerBbox.top,d=u._valueToPoint(e,0),v=u._valueToPoint(t,0),m,g,y,b,w,E;f==="horizontal"?(w=i*c,E=s*c,n!==0&&(d.y=n*c+p),r!==0&&(v.y=r*c+p),m={x:d.x,y:d.y-w},g={x:v.x,y:v.y-E}):(w=i*l,E=s*l,n!==0&&(d.x=n*l+h),r!==0&&(v.x=r*l+h),m={x:d.x-w,y:d.y},g={x:v.x-E,y:v.y}),y=["M",d.x,d.y,"L",v.x,v.y,"L",g.x,g.y,"L",m.x,m.y,"Z"],b=u.canvas.path(y.concat(" ")),b.attr(o.style),$.wijraphael.addClass($(b.node),a.wijCSS.linearGaugeRange),u.ranges.push(b)},n.prototype._valueToPoint=function(e,t){var n=this,r=n.options,i=r.isInverted,s,o,u;return r.max===r.min?{x:0,y:0}:(s=n._valueToLogical(e),o=n._minScreenPoint(t),u=n._maxScreenPoint(t),i?{x:o.x*s+u.x*(1-s),y:o.y*s+u.y*(1-s)}:{x:o.x*(1-s)+u.x*s,y:o.y*(1-s)+u.y*s})},n}(e.wijgauge);e.wijlineargauge=t,t.prototype.widgetEventPrefix="wijlineargauge";var n=function(){function e(){this.initSelector=":jqmData(role='wijlineargauge')",this.wijCSS={linearGauge:"wijmo-wijlineargauge",linearGaugeLabel:"wijmo-wijlineargauge-label",linearGaugeMarker:"wijmo-wijlineargauge-mark",linearGaugeFace:"wijmo-wijlineargauge-face",linearGaugePointer:"wijmo-wijlineargauge-pointer",linearGaugeRange:"wijmo-wijlineargauge-range"},this.orientation="horizontal",this.xAxisLocation=.1,this.xAxisLength=.8,this.yAxisLocation=.5,this.width="auto",this.height="auto",this.pointer={length:.5,width:4,offset:0,visible:!0,template:null,shape:"tri",style:{fill:"#1E395B",stroke:"#1E395B"}},this.marginLeft=5,this.marginTop=5,this.marginRight=5,this.marginBottom=5}return e}();t.prototype.options=$.extend(!0,{},e.wijgauge.prototype.options,new n),$.wijmo.registerWidget("wijlineargauge",t.prototype)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=180,n=9,r=5,i=function(i){function s(){i.apply(this,arguments)}return __extends(s,i),s.prototype._create=function(){var e=this;i.prototype._create.call(this),e.element.addClass(this.options.wijCSS.radialGauge)},s.prototype._set_radius=function(){var e=this;e._autoCalculate(),e.redraw()},s.prototype._set_startAngle=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},s.prototype._set_sweepAngle=function(e){var t=this;e>360&&(t.options.endAngle=360),t._redrawMarksAndLabels(),t._setPointer()},s.prototype._set_width=function(){var e=this;e._autoCalculate(),i.prototype._set_width.call(this)},s.prototype._set_height=function(){var e=this;e._autoCalculate(),i.prototype._set_height.call(this)},s.prototype._set_origin=function(){var e=this;e._autoCalculate()},s.prototype._set_cap=function(){var e=this;e.cap&&(e.cap.wijRemove(),e.cap=null),e._paintCap(),e._positionCapWithBehindPointer()},s.prototype._set_pointer=function(){var e=this;e.pointer&&(e.pointer.wijRemove(),e.pointer=null),e._paintPointerExcludeCap(),e._setPointer(),e._positionCapWithBehindPointer()},s.prototype._clearState=function(){i.prototype._clearState.call(this),this.markBbox=null},s.prototype._valueToAngleIncludeOffset=function(n){return e.GaugeUtil.mod360(this._valueToAngle(n)+t)},s.prototype._valueToAngle=function(e){var t=this,n=t._valueToLogical(e);return t._logicalToAngle(n)},s.prototype._angleToValue=function(e){var t=this,n=t._angleToLogical(e);return t._logicalToValue(n)},s.prototype._logicalToAngle=function(e){var t=this,n=t.options,r=n.startAngle,i=n.sweepAngle,s=n.isInverted;return s?r*e+(r+i)*(1-e):r*(1-e)+(r+i)*e},s.prototype._angleToLogical=function(t){var n=this,r=n.options,i=r.startAngle,s=r.isInverted,o=e.GaugeUtil.mod360(t-i),u=r.sweepAngle,a,f;return u===0||o===0?s?1:0:(u<0&&(o=360-o,u=-u),a=o-u,a>0?(f=360-o,a<f?1:0):s?1-o/u:o/u)},s.prototype._generatePoints=function(e,t,i,s){var o=this,u=o.options.isInverted,a=parseInt((n+n*(Math.abs(parseInt((t-e).toString(),10))/(n*r))).toString(),10),f=[],l,c,h,p,d;for(d=0;d<a;d++)l=d/(a-1),c=i+(s-i)*l,p=e+(t-e)*l,h=o._angleToValue(p),f.push(o._valueToPoint(h,c));return f},s.prototype._valueToPoint=function(e,t){var n=this,r=n._valueToAngleIncludeOffset(e)*Math.PI/180,i=t;return{x:i*Math.cos(r),y:i*Math.sin(r)}},s.prototype._pointToValue=function(t){var n=e.GaugeUtil.mod360(Math.atan2(t.x,-t.y)*180/Math.PI);return this._angleToValue(n)},s.prototype._radiusScreen=function(e){var t=this,n=t.options;return Math.max(n.radius*e,0)},s.prototype._autoCalculate=function(){var t=this,n=t.options,r=n.width,i=n.height,s,o,u,a=e.GaugeUtil.formatString(n.max,n.labels.format),f=0,l,c=i-n.marginTop-n.marginBottom,h=r-n.marginLeft-n.marginRight;t.centerPoint={x:n.marginLeft+h*n.origin.x,y:n.marginTop+c*n.origin.y},t.radius=n.radius,n.radius==="auto"&&(t.faceRadius=Math.min(h,c)/2,l=t._getFaceBorder(),t.faceRadius-=l,s=t._getMarkerbbox(n.tickMajor).width,o=t._getMarkerbbox(n.tickMinor).width,u=t._getLabelBBox(a).width,n.tickMajor.position==="center"?(f-=s/2,f-=u):n.tickMajor.position==="outside"&&(f-=s,f-=u),n.tickMinor.position==="center"?f=Math.min(f,-o/2):n.tickMinor.position==="outside"&&(f=Math.min(f,-o)),t.radius=t.faceRadius+f,n.tickMajor.position!=="inside"&&(t.faceRadius+=f))},s.prototype._getFaceBorder=function(){var e=this,t=e._paintFace(),n=t.attr("stroke-width")||1;return t.type==="set"&&(n=t[0].attr("stroke-width")||1),t.wijRemove(),n},s.prototype._getMaxRangeWidth=function(){var e=this,t=e.options,n=0;return $.each(t.ranges,function(e,t){n=Math.max(n,t.width||0),n=Math.max(n,t.startWidth||0),n=Math.max(n,t.endWidth||0)}),n},s.prototype._getMarkerbbox=function(e){var t=this,n=t._paintMarkEle(e),r=n.wijGetBBox();return n.wijRemove(),{width:r.width,height:r.height}},s.prototype._paintMark=function(e,t,n){var r=this,i,s=t.position||"inside",o=t.offset||0;return i=r._paintMarkEle(t),i.attr(t.style),$.wijraphael.addClass($(i.node),r.options.wijCSS.radialGaugeMarker),$(i.node).data("value",e),r._applyAlignment(i,s,o),r._setMarkValue(e,i),i},s.prototype._applyAlignment=function(e,t,n){if(!e)return;var r=e.wijGetBBox(),i=r.width/2,s=0;switch(t){case"outside":s-=i+n;break;case"inside":s+=i+n}e.transform("t"+s+","+0)},s.prototype._paintMarkEle=function(t){var n=this,r=n.options,i={x:n.centerPoint.x-n.radius,y:n.centerPoint.y},s=t.marker||"circle",o=s==="rect"?5:2,u=2,a,f=t.style["stroke-width"]||0;if(s==="tri"||s==="invertedTri")o=5,u=3;return s==="cross"&&(t.style.fill=t.style.stroke||t.style.fill),isNaN(i.x)&&(i.x=0),a=o*t.factor,u+=f*2,a+=f*2,$.isFunction(s)?s.call(n,n.canvas,i,r):e.GaugeUtil.paintMarker(n.canvas,s,i.x,i.y,a,u)},s.prototype._setMarkValue=function(e,t){var n=this,r=n._valueToAngle(e);t.transform(Raphael.format("r{0},{1},{2}...",r,n.centerPoint.x,n.centerPoint.y))},s.prototype._paintLabel=function(t,n){var r=this,i=r._valueToAngle(t),s=n.format,o=n.style,u=n.offset,a=t.toString(),f=r.options.tickMajor,l=f.position||"inside",c,h,p,d,v;s!==""&&(a=e.GaugeUtil.formatString(t,s)),p=r._getMarkerBbox(),v=r._getLabelBBox(a);switch(l){case"inside":d=p.x+p.width+v.width/2;break;case"outside":d=p.x-v.width/2;break;default:d=p.x-v.width/2}return d=r.centerPoint.x-d+u,c=e.GaugeUtil.getPositionByAngle(r.centerPoint.x,r.centerPoint.y,d,i),h=r.canvas.text(c.x,c.y,a),h.attr(o),$.wijraphael.addClass($(h.node),r.options.wijCSS.radialGaugeLabel),h},s.prototype._getLabelBBox=function(e){var t=this,n=t.options,r,i;return r=t.canvas.text(0,0,e),r.attr(n.gaugeLableStyle),i=r.wijGetBBox(),r.wijRemove(),i},s.prototype._getMarkerBbox=function(){var e=this,t=e.options,n=t.tickMajor,r;return e.markBbox||(r=e._paintMarkEle(n),e._applyAlignment(r,n.position,n.offset||0),e.markBbox=r.wijGetBBox(),r.wijRemove()),e.markBbox},s.prototype._paintFace=function(){var e=this,t=e.options,n=Math.min(t.width,t.height)/2,r,i;return e.faceRadius&&(n=e.faceRadius),t.face&&t.face.template&&$.isFunction(t.face.template)?(i={canvas:e.canvas,r:n,origin:{x:e.centerPoint.x,y:e.centerPoint.y}},t.face.template.call(e,i)):(r=e.canvas.circle(e.centerPoint.x,e.centerPoint.y,n),t.face&&t.face.style&&r.attr(t.face.style),$.wijraphael.addClass($(r.node),t.wijCSS.radialGaugeFace),r)},s.prototype._paintPointer=function(){var e=this,t=e.options;e._paintPointerExcludeCap(),t.cap&&t.cap.visible&&(e._paintCap(),e._positionCapWithBehindPointer())},s.prototype._paintPointerExcludeCap=function(){var e=this,t=e.options,n=t.pointer,r=e.radius*n.length,i={x:e.centerPoint.x-r+n.offset*e.radius,y:e.centerPoint.y-n.width/2},s;if(!n.visible)return;n.template&&$.isFunction(n.template)?s=n.template.call(e.canvas,i,$.extend({},n,{length:r})):(n.shape==="rect"?s=e.canvas.rect(i.x-n.width/2,i.y,r,n.width):s=e.canvas.isoTri(i.x-n.width/2,i.y,r,n.width),s.attr(n.style)),e.pointer=s,$.wijraphael.addClass($(s.node),t.wijCSS.radialGaugePointer)},s.prototype._paintCap=function(){var e=this,t=e.options,n=t.cap,r;return n&&n.template&&$.isFunction(n.template)?(r={canvas:e.canvas,origin:{x:e.centerPoint.x,y:e.centerPoint.y}},e.cap=n.template.call(e,r),e.cap):(e.cap=e.canvas.circle(e.centerPoint.x,e.centerPoint.y,n.radius),n&&n.style&&e.cap.attr(n.style),$.wijraphael.addClass($(e.cap.node),t.wijCSS.radialGaugeCap),e.cap)},s.prototype._positionCapWithBehindPointer=function(){var e=this,t=e.options;t.cap&&t.cap.visible&&(t.cap.behindPointer?e.pointer&&e.pointer.toFront():e.cap&&e.cap.toFront())},s.prototype._paintRange=function(e){var t=this,n=t.options,r=isNaN(e.startValue)?0:e.startValue,i=isNaN(e.endValue)?0:e.endValue,s=isNaN(e.startWidth)?isNaN(e.width)?0:e.width:e.startWidth,o=isNaN(e.endWidth)?isNaN(e.width)?0:e.width:e.endWidth,u=e.startDistance||1,a=e.endDistance||1,f,l;r!==i&&(i>r?(f=Math.max(r,n.min),l=Math.min(n.max,i)):(f=Math.max(n.min,i),l=Math.min(n.max,r)),u*=t.radius,a*=t.radius,t._drawRange(f,l,u,a,s,o,e))},s.prototype._drawRange=function(e,t,n,r,i,s,o){var u=this,a=u._valueToAngle(e),f=u._valueToAngle(t),l=u._generatePoints(a,f,i+n,s+r),c=u._generatePoints(a,f,n,r),h,p,d="";$.each(l,function(e,t){e===0?d+="M"+$.round(t.x+u.centerPoint.x)+" "+$.round(t.y+u.centerPoint.y):d+="L"+$.round(t.x+u.centerPoint.x)+" "+$.round(t.y+u.centerPoint.y)});for(h=c.length-1;h>=0;h--)d+="L"+$.round(c[h].x+u.centerPoint.x)+" "+$.round(c[h].y+u.centerPoint.y);d+="Z",p=u.canvas.path(d),p.attr(o.style),u.ranges.push(p),$.wijraphael.addClass($(p.node),u.options.wijCSS.radialGaugeRange)},s.prototype._setOffPointerValue=function(){var e=this,t=e._valueToAngle(0);e.pointer.transform(Raphael.format("r{0},{1},{2}",t,e.centerPoint.x,e.centerPoint.y))},s.prototype._setPointer=function(){var e=this,t=e.options,n=e._valueToAngle(t.value),r=t.animation;if(!e.pointer)return;i.prototype._setPointer.call(this),r.enabled?e.pointer.stop().wijAnimate({transform:"r"+n+","+e.centerPoint.x+","+e.centerPoint.y},r.duration,r.easing):e.pointer.transform(Raphael.format("r{0},{1},{2}",n,e.centerPoint.x,e.centerPoint.y))},s}(e.wijgauge);e.wijradialgauge=i,i.prototype.widgetEventPrefix="wijradialgauge";var s=function(){function e(){this.initSelector=":jqmData(role='wijradialgauge')",this.wijCSS={radialGauge:"wijmo-wijradialgauge",radialGaugeLabel:"wijmo-wijradialgauge-label",radialGaugeMarker:"wijmo-wijradialgauge-mark",radialGaugeFace:"wijmo-wijradialgauge-face",radialGaugePointer:"wijmo-wijradialgauge-pointer",radialGaugeCap:"wijmo-wijradialgauge-cap",radialGaugeRange:"wijmo-wijradialgauge-range"},this.radius="auto",this.startAngle=0,this.sweepAngle=180,this.pointer={length:.8,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:.15,shape:"tri",visible:!0,template:null},this.origin={x:.5,y:.5},this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},offset:30,visible:!0},this.tickMinor={position:"inside",offset:30,style:{fill:"#1E395B"},visible:!0,factor:1,marker:"rect",interval:5},this.tickMajor={position:"inside",offset:27,style:{fill:"#1E395B",stroke:"#1E395B","stroke-width":1},visible:!0,interval:10,factor:2,marker:"rect"},this.cap={radius:15,style:{fill:"#1E395B",stroke:"#1E395B"},behindPointer:!1,visible:!0,template:null},this.face={style:{fill:"r(0.9, 0.60)#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null}}return e}();i.prototype.options=$.extend(!0,{},e.wijgauge.prototype.options,new s),$.wijmo.registerWidget("wijradialgauge",i.prototype)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijlightbox";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var i=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._keyDownHandler=function(t){var n=this.options,r=this,i=e.getKeyCodeEnum();if(t.keyCode&&t.keyCode===i.ESCAPE){r._isFullSize()?r._toggleFullSize():n.closeOnEscape&&r._close(),t.preventDefault();return}if(n.keyNav&&t.keyCode)switch(t.keyCode){case i.LEFT:case i.DOWN:r.back(),t.preventDefault();break;case i.RIGHT:case i.UP:r.next(),t.preventDefault();break;case i.HOME:n.groupItems.length>0&&r.show(0),t.preventDefault();break;case i.END:n.groupItems.length>0&&r.show(n.groupItems.length-1),t.preventDefault()}},r.prototype._create=function(){var e=this.options,t=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.groupItems||(e.groupItems=[]),this._defaults={transAnimation:{animated:"fade",duration:400,easing:"linear"},resizeAnimation:{animated:"sync",duration:400},textShowOption:{duration:300,easing:"linear"},textHideOption:{duration:300,easing:"linear"}},this._parse(),this.container=n("<div/>").addClass("wijmo-wijlightbox "+e.wijCSS.widget+" wijmo-wijlightbox-controls-"+e.controlsPosition).css("z-index",e.zIndex).attr({tabIndex:-1,role:"dialog"}).bind("keydown.wijlightbox",n.proxy(t,"_keyDownHandler")).appendTo(document.body).hide(),this.frame=n("<div></div>").addClass(["wijmo-wijlightbox-frame",e.wijCSS.content,e.wijCSS.cornerAll,e.wijCSS.helperClearFix].join(" ")).appendTo(this.container),this.content=n("<div></div>").addClass("wijmo-wijlightbox-content").appendTo(this.frame),e.activeIndex===undefined?(typeof e.activeIndex!="number"&&e.cookie&&(e.activeIndex=parseInt(t._cookie(),10)),e.activeIndex=e.activeIndex||(e.groupItems.length?0:-1)):e.activeIndex===null&&(e.activeIndex=-1),e.activeIndex=e.activeIndex>=0&&e.groupItems[e.activeIndex]||e.activeIndex<0?e.activeIndex:0,this._initClickBehavior(),this._createTimerBar(),this._createDialogButtons(),this._createCtrlButtons(),this._createText(),this._createCounter(),this._refreshCounter(),this.toolBox&&this.toolBox.find(".wijmo-wijlightbox-toolbox-button").bind({mouseover:function(){t._addState("hover",n(this))},mouseout:function(){t._removeState("hover",n(this))},mousedown:function(){t._addState("active",n(this))},mouseup:function(){t._removeState("active",n(this))}}),this._groupMode()&&this._createNavButtons(),this._initHoverBehavior(),this.container.width(this.frame.outerWidth())},r.prototype.destroy=function(){var e=this.options,t=this;return this._hideWaiting(),this._hideOverlay(),e.cookie&&this._cookie(null,e.cookie),this.container.remove(),n.Widget.prototype.destroy.apply(t,arguments),t},r.prototype._setOption=function(e,t){var r=this.options[e];n.Widget.prototype._setOption.apply(this,arguments);switch(e){case"groupItems":this.options.activeIndex>=t.length?this.show(t.length-1):this.options.activeIndex<0&&t.length?this.show(0):this.show(this.options.activeIndex);break;case"activeIndex":this.show(t);break;case"textPosition":this._resetText();break;case"clickPause":this._initClickBehavior();break;case"showNavButtons":this._createNavButtons();break;case"showControlsOnHover":this._initHoverBehavior();break;case"controlsPosition":this._set_controlsPosition(r,t)}},r.prototype._set_controlsPosition=function(e,t){e!==t&&(this._removeCounter(),this._removeNavButtons(),this.container.removeClass("wijmo-wijlightbox-controls-outside wijmo-wijlightbox-controls-inside").addClass("wijmo-wijlightbox-controls-"+t),this._createCounter(),this._createNavButtons())},r.prototype._initClickBehavior=function(){var e=this.options,t=this;this.content.unbind("click"),e.clickPause?this._groupMode()&&this.content.click(function(){t[t.isPlaying()?"stop":"play"]()}):this._groupMode()&&this.content.click(function(r){if(t.isPlaying())return!1;var i=n.extend({},n(this).offset(),{width:n(this).outerWidth(!0),height:n(this).outerHeight(!0)});r.pageX>=i.left&&r.pageX<i.left+i.width/2?t.backBtn.hasAllClasses(e.wijCSS.stateDisabled)||t.back():t.nextBtn.hasAllClasses(e.wijCSS.stateDisabled)||t.next()})},r.prototype._initHoverBehavior=function(){var e=this.options,t=this;this.frame.unbind(".wijlightbox"),e.showControlsOnHover&&this.frame.bind({"mouseenter.wijlightbox":function(){if(t.container.data("moving.wijlightbox"))return!1;t._showAccessories(!0)},"mouseleave.wijlightbox":function(){if(t.container.data("moving.wijlightbox"))return!1;t._hideAccessories(!0)},"mousemove.wijlightbox":function(){t.container.data("moving.wijlightbox")===!1&&t.container.data("accessvisible.wijlightbox")===!1&&t.frame.trigger("mouseenter")}})},r.prototype._getPlugins=function(){var e=this.container.data("plugins.wijlightbox"),t,r,i;return e||(e={},window.navigator.plugins&&window.navigator.plugins.length?(t=[],n.each(window.navigator.plugins,function(e,n){t.push(n.name)}),t=t.join(","),i=t.indexOf("Flip4Mac")>-1,e={fla:t.indexOf("Shockwave Flash")>-1,qt:t.indexOf("QuickTime")>-1,wmp:!i&&t.indexOf("Windows Media")>-1,f4m:i}):(r=function(e){var t;try{t=new ActiveXObject(e)}catch(n){}return!!t},e={fla:r("ShockwaveFlash.ShockwaveFlash"),qt:r("QuickTime.QuickTime"),wmp:r("wmplayer.ocx"),f4m:!1}),this.container.data("plugins.wijlightbox",e)),e},r.prototype._sanitizeSelector=function(e){return e.replace(/:/g,"\\:")},r.prototype._getFragmentId=function(e){var t=/^#.+/,r=n(e).attr("href")||"",i=r.split("#")[0],s=n("base")[0];return i&&(i===window.location.toString().split("#")[0]||s&&i===s.attributes.href)&&(r=e.hash,e.href=r),t.test(r)?this._sanitizeSelector(r):""},r.prototype._parseLink=function(e){var t=this,r=this.options,i=n(e),s={href:undefined,player:undefined,img:undefined,gallery:undefined},o,u,a,f,l=["href","player","title","alt","height","width","gallery","wijvideosrc"];if(i.length>0&&i[0].tagName.toLowerCase()==="a"){o=i.attr("rel"),n.each(l,function(e,t){s[t]=i.attr(t)||""});if(!s.href)return;s.player||(s.player=r.player||t._getPlayerName(s.href)),u=i.find("img"),u&&u.length===0&&(u=i),u&&u.length>=1&&(n.each(["title","alt"],function(e,t){s[t]=u.attr(t)||s[t]}),s.img=u),o&&(a=o.match(/\[(.*?)\]/),a&&(s.gallery=a[1]||s.gallery),n.each(o.split(";"),function(e,t){var n=t.match(/\s*([a-z_]*?)\s*=\s*(.+)\s*/);n&&(s[n[1]]=n[2])})),s.player==="inline"&&(s.href=t._getFragmentId(e)),s.gallery?(f=r.groupItems.length,r.groupItems[f]=s,i.bind({click:function(e){return e.stopPropagation(),e.preventDefault(),r.disabled||t._open(u,f),!1}})):i.bind({click:function(e){return e.stopPropagation(),e.preventDefault(),r.disabled||t._open(u,s),!1}})}},r.prototype._parse=function(){var e=this;this._parseLink(this.element),this.element.find('a[rel^="wijlightbox"], a[rel^="lightbox"]').each(function(t,n){e._parseLink(n)})},r.prototype._showAccessories=function(e){this.container.data("accessvisible.wijlightbox",!0),this._showNavButtons(e),this._showToolboxButtons(e),this._showCounter(e)},r.prototype._hideAccessories=function(e){this.container.data("accessvisible.wijlightbox",!1),this._hideNavButtons(e),this._hideToolboxButtons(e),this._hideCounter(e)},r.prototype._groupMode=function(){var e=this.options;return e.groupItems&&e.groupItems.length>1},r.prototype._resetText=function(){this._removeText(),this._createText()},r.prototype._createText=function(e){var t=this,r=t.options,i,s,o,u,a;if(r.textPosition==="none")return;if(this.container.find(".wijmo-wijlightbox-text").length)return;i=r.textPosition.toLowerCase(),s=n("<div></div>").addClass("wijmo-wijlightbox-text wijmo-wijlightbox-text-"+i+" "+r.wijCSS.content+" "+r.wijCSS.helperClearFix),u=n("<h3></h3>").addClass("wijmo-wijlightbox-title wijmo-wijlightbox-title-"+i+" "+r.wijCSS.helperClearFix).appendTo(s),a=n("<p></p>").addClass("wijmo-wijlightbox-detail wijmo-wijlightbox-detail-"+i+" "+r.wijCSS.helperClearFix).appendTo(s);if(r.textPosition==="inside")s.addClass(r.wijCSS.content+" "+r.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame);else if(r.textPosition==="outside")s.addClass([r.wijCSS.content,r.wijCSS.cornerAll,r.wijCSS.helperClearFix].join(" ")).width(this.frame.width()).appendTo(this.container);else if(r.textPosition==="overlay"||r.textPosition==="titleOverlay")o=n("<div></div>").addClass("wijmo-wijlightbox-mask wijmo-wijlightbox-mask-"+i+" "+r.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame),s.width(this.frame.width()).appendTo(this.frame),r.textPosition==="titleOverlay"&&s.bind({mouseenter:function(){o.stop(),s.stop();var e=u.outerHeight(!0)+a.outerHeight(!0),i=n.extend({},t._defaults.textShowOption,r.textShowOption,{queue:!1});o.animate({height:e},i),s.animate({height:e},i)},mouseleave:function(){o.stop(),s.stop();var e=u.height(),i=n.extend({},t._defaults.textHideOption,r.textHideOption,{queue:!1});o.animate({height:e},i),s.animate({height:e},i)}});this._refreshText(e)},r.prototype._removeText=function(){this.container.find(".wijmo-wijlightbox-text,.wijmo-wijlightbox-mask").remove()},r.prototype._getActiveItem=function(){var e=this.options;return e.groupItems&&e.groupItems.length&&e.activeIndex>=0&&e.activeIndex<e.groupItems.length?e.groupItems[e.activeIndex]:null},r.prototype._refreshText=function(e){var t=this,r=this.options,i,s,o,u,a;if(r.textPosition==="none")return;i=this.container.data("item.wijlightbox")||this._getActiveItem();if(!i)return;s=this.container.find(".wijmo-wijlightbox-text"),o=this.container.find(".wijmo-wijlightbox-title"),u=this.container.find(".wijmo-wijlightbox-detail"),a=this.container.find(".wijmo-wijlightbox-mask"),a.stop(),s.stop(),o.html(i.title),u.html(i.alt),r.textPosition==="outside"&&s.width(this.frame.width());var f=o.outerHeight(!0),l=u.outerHeight(!0),c=n.extend({},t._defaults.textShowOption,r.textShowOption,{queue:!1});if(r.textPosition==="overlay"||r.textPosition==="titleOverlay"){var h=f+(r.textPosition==="overlay"?l:0);s.height(0),a.height(0),s.animate({height:h},c),a.animate({height:h},c)}else e?s.height(f+l):(s.height(0),s.animate({height:f+l},c))},r.prototype._addState=function(e,t){t.is(":not(."+this.options.wijCSS.stateDisabled+")")&&t.addClass("ui-state-"+e)},r.prototype._removeState=function(e,t){t.removeClass("ui-state-"+e)},r.prototype._createNavButtons=function(){var e=this,t=this.options;if(!t.showNavButtons||!this._groupMode()){this._removeNavButtons();return}this.backBtn||(this.backBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-prev "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerRight:t.wijCSS.cornerLeft)).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrowLeft+"'></span>").hide().appendTo(this.frame).bind({click:function(){return n(this).hasAllClasses(t.wijCSS.stateDisabled)||e.back(),!1},mouseover:function(){e._addState("hover",n(this))},mouseout:function(){e._removeState("hover",n(this))},mousedown:function(){e._addState("active",n(this))},mouseup:function(){e._removeState("active",n(this))}})),this.nextBtn||(this.nextBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-next "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerLeft:t.wijCSS.cornerRight)).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrowRight+"'></span>").hide().appendTo(this.frame).bind({click:function(){return n(this).hasAllClasses(t.wijCSS.stateDisabled)||e.next(),!1},mouseover:function(){e._addState("hover",n(this))},mouseout:function(){e._removeState("hover",n(this))},mousedown:function(){e._addState("active",n(this))},mouseup:function(){e._removeState("active",n(this))}}))},r.prototype._removeNavButtons=function(){this.backBtn&&(this.backBtn.remove(),this.backBtn=undefined),this.nextBtn&&(this.nextBtn.remove(),this.nextBtn=undefined)},r.prototype._refreshNavButtons=function(){var e=this.options,t;this.backBtn&&(t=e.activeIndex===0?"addClass":"removeClass",this.backBtn[t](e.wijCSS.stateDisabled)),this.nextBtn&&(t=e.activeIndex>=e.groupItems.length-1?"addClass":"removeClass",this.nextBtn[t](e.wijCSS.stateDisabled))},r.prototype._showNavButtons=function(e){if(this.isPlaying())return;this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeIn(e?600:0,function(){n(this).css("opacity","")})},r.prototype._hideNavButtons=function(e){this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeOut(e?600:0)},r.prototype._createToolbox=function(){this.toolBox||(this.toolBox=n("<div></div>").addClass("wijmo-wijlightbox-toolbox").appendTo(this.frame))},r.prototype._showToolboxButtons=function(e){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeIn(e?600:0,function(){n(this).css("opacity","")})},r.prototype._hideToolboxButtons=function(e){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeOut(e?600:0)},r.prototype._createCtrlButtons=function(){var e=this,t=this.options,r=t.wijCSS;if(!t.ctrlButtons||t.ctrlButtons.length===0||!this._groupMode()){this._removeCtrlButtons();return}this._createToolbox();var i=t.ctrlButtons.split("|");i.length===1&&i[0]===t.ctrlButtons&&(i=t.ctrlButtons.split(",")),n.each(i,function(i,s){s=n.trim(s),s==="play"&&!this.playBtn?e.playBtn=n("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button"," wijmo-wijlightbox-toolbox-button-play ",r.stateDefault,r.cornerAll].join(" ")).append("<span class='"+r.icon+" "+r.iconPlay+"'></span>").hide().click(function(){return e.isPlaying()?e.stop():(t.activeIndex>=t.groupItems.length-1&&e.show(0),e.play()),!1}):s==="stop"&&!this.stopBtn&&(e.stopBtn=n("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button","wijmo-wijlightbox-toolbox-button-stop",r.stateDefault,r.stateDisabled,r.cornerAll].join(" ")).append("<span class='"+r.icon+" "+r.iconStop+"'></span>").hide().click(function(){return e.isPlaying()&&(e.stop(),e.show(0)),!1}))}),this.stopBtn&&this.stopBtn.appendTo(this.toolBox),this.playBtn&&this.playBtn.appendTo(this.toolBox)},r.prototype._removeCtrlButtons=function(){this.playBtn&&(this.playBtn.remove(),this.playBtn=undefined),this.stopBtn&&(this.stopBtn.remove(),this.stopBtn=undefined)},r.prototype._refreshCtrlButtons=function(){var e=this.options.wijCSS;if(this.playBtn){var t=this.playBtn.find("."+e.icon);t&&(t.removeClass(e.iconPause+" "+e.iconPlay),t.addClass(this.isPlaying()?e.iconPause:e.iconPlay))}this.stopBtn&&this.stopBtn[this.isPlaying()?"removeClass":"addClass"](e.stateDisabled)},r.prototype._createDialogButtons=function(){var e=this,t=this.options,r;if(!t.dialogButtons||t.dialogButtons.length===0){this._removeDialogButtons();return}this._createToolbox(),r=t.dialogButtons.split("|"),r.length===1&&r[0]===t.dialogButtons&&(r=t.dialogButtons.split(",")),n.each(r,function(r,i){i=n.trim(i),i==="close"&&!this.closeBtn?e.closeBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-close "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerAll).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconClose+"'></span>").hide().click(function(){return e._close(),!1}):i==="fullSize"&&!this.fullBtn&&(e.fullBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-fullsize "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerAll).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrow4Diag+"'></span>").hide().click(function(){return e._toggleFullSize(),!1}))}),this.closeBtn&&this.closeBtn.appendTo(this.toolBox),this.fullBtn&&this.fullBtn.appendTo(this.toolBox),this.btnSep||(this.btnSep=n("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-separator").appendTo(this.toolBox))},r.prototype._removeDialogButtons=function(){this.closeBtn&&(this.closeBtn.remove(),this.closeBtn=undefined),this.fullBtn&&(this.fullBtn.remove(),this.fullBtn=undefined)},r.prototype._refreshDialogButtons=function(){var e=this.options.wijCSS;if(this.fullBtn){var t=this.fullBtn.find("."+e.icon);t&&(t.removeClass(e.iconArrow4Diag+" "+e.iconNewWin),t.addClass(this._isFullSize()?e.iconNewWin:e.iconArrow4Diag))}},r.prototype._createTimerBar=function(){var e=this,t=e.options;if(!t.showTimer||!e._groupMode()){e._removeTimerBar();return}e._createToolbox(),e.timerBar||(e.timerBar=n("<div></div>").addClass("wijmo-wijlightbox-timerbar "+t.wijCSS.content+" ui-priority-secondary "+t.wijCSS.cornerAll).appendTo(e.toolBox),e.timerMeter=n("<div></div>").addClass("wijmo-wijlightbox-timermeter ui-progressbar-value "+t.wijCSS.content+" "+t.wijCSS.cornerAll).appendTo(e.toolBox))},r.prototype._removeTimerBar=function(){this.timerMeter&&(this.timerMeter.remove(),this.timerMeter=undefined),this.timerBar&&(this.timerBar.remove(),this.timerBar=undefined)},r.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter||!e._groupMode()){e._removeCounter();return}e.counter||(e.counter=n("<div></div>").addClass("wijmo-wijlightbox-counter "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerTL:t.wijCSS.cornerAll)).hide().appendTo(e.frame))},r.prototype._removeCounter=function(){this.counter&&(this.counter.remove(),this.counter=undefined)},r.prototype._refreshCounter=function(e){var t=this,r=this.options,i="";if(!this.counter||!this._groupMode())return;this.counter.empty();if(r.showCounter&&r.groupItems.length>1&&this.counter){e===undefined&&(e=r.activeIndex);var s=r.groupItems.length;if(r.counterType==="sequence"){var o=0,u=s,a=parseInt(r.counterLimit,10)||0;if(a>=2&&a<s){var f=Math.floor(a/2);o=Math.min(u-a,Math.max(o,e-f)),u=Math.min(u,o+a)}while(o!==u)n("<a></a>").addClass("wijmo-wijlightbox-counter-item "+r.wijCSS.content+" "+r.wijCSS.stateDefault+(o===e?" wijmo-wijlightbox-counter-active "+r.wijCSS.stateActive:"")).text((++o).toString()).appendTo(this.counter);this.counter.find("a").click(function(e,r){return n(this).hasClass("wijmo-wijlightbox-counter-active")?!1:(t.show(parseInt(n(this).text(),10)-1),!1)})}else{var l=r.counterFormat||"[i] of [n]";i=l.replace("[i]",e+1),i=i.replace("[n]",s),n("<span></span>").text(i).appendTo(this.counter)}}},r.prototype._showCounter=function(e){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeIn(e?600:0,function(){n(this).css("opacity","")})},r.prototype._hideCounter=function(e){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeOut(e?600:0)},r.prototype._cookie=function(e,t){var r=this.cookie||(this.cookie=this.options.cookie.name);return n.cookie.apply(null,[r].concat(n.makeArray(arguments)))},r.prototype._showOverlay=function(){if(this.container.data("overlay.wijlightbox"))return;this.container.data("overlay.wijlightbox",new n.wijmo.wijlightbox.overlay(this))},r.prototype._hideOverlay=function(){var e=this.container.data("overlay.wijlightbox");if(!e)return;e.close(),this.container.removeData("overlay.wijlightbox")},r.prototype._hasOverlay=function(){return this.container.hasData("overlay.wijlightbox")},r.prototype._showWaiting=function(){if(this.container.data("waiting.wijlightbox"))return;this.container.data("waiting.wijlightbox",new n.wijmo.wijlightbox.overlay(this,!0))},r.prototype._hideWaiting=function(){var e=this.container.data("waiting.wijlightbox");if(!e)return;e.close(),this.container.removeData("waiting.wijlightbox")},r.prototype._hasWaiting=function(){return this.container.hasData("waiting.wijlightbox")},r.prototype._getUrl=function(e){var t=this.options,n=typeof e=="string"?e:e.href,r=t.rootUrl;return r&&r.length>0&&(r.indexOf("//")===-1&&(r=window.location.protocol+"//"+window.location.host+(r.startsWith("/")?"":"/")+r),r.substr(r.length-1,1)!=="/"&&(r+="/"),n=r+(n.substr(0,1)==="/"?n.substr(1):n)),n},r.prototype._preload=function(){var e=this.options,t;for(t=Math.max(0,e.activeIndex);t<Math.min(e.activeIndex+5,e.groupItems.length);t++)e.groupItems[t].image||(e.groupItems[t].image=new Image,e.groupItems[t].image.src=this._getUrl(e.groupItems[t]))},r.prototype._slideAnimate=function(e,t,r){var i=["position","top","bottom","left","right","width","height"],s=n.setMode(t,e.mode||"show"),o=s==="show",u=e.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};n.save(t,i),t.show(),l=e.distance||t[a==="top"?"outerHeight":"outerWidth"](!0),n.createWrapper(t).css({overflow:"hidden"}),o&&t.css(a,f?isNaN(l)?parseInt("-"+l):-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,t.animate(c,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){s==="hide"&&t.hide(),n.restore(t,i),n.removeWrapper(t),r()}})},r.prototype._slideTo=function(e,t,r,i,s){var o=this.options,u=this,a=e.getElement(),f,l,c,h,p,d,v,m;a.parent().is(".wijmo-wijlightbox-aniwrapper")?f=a.parent():(f=n.createWrapper(a).css({overflow:"hidden"}),f.removeClass("ui-effects-wrapper"),f.addClass("wijmo-wijlightbox-aniwrapper")),f.parent().is(".wijmo-wijlightbox-aniwrapper")?l=f.parent():(l=n.createWrapper(f).css({overflow:"hidden"}),l.removeClass("ui-effects-wrapper"),l.addClass("wijmo-wijlightbox-aniwrapper")),c=o.slideDirection||"horizontal",h=a.outerWidth(),p=a.outerHeight(),c==="horizontal"?(a.width(h).css("float",i?"left":"right"),f.width(2*h).css({left:i?0:-1*h,position:"absolute"})):(a.height(p),f.width(h).css({top:i?0:-1*p,position:"absolute"}).height(2*p)),t.appendTo(f),d=t.getElement(),c==="horizontal"?d.width(h).css("float",i?"left":"right"):d.height(p),this.container.data("animating.wijlightbox",!0),v=function(){a=f.children(":last");while(a.parent().is(".wijmo-wijlightbox-aniwrapper"))a.parent().replaceWith(a);a.css({"float":"",width:"",height:""}),o.autoSize&&!u._isFullSize()?u._resize(s):(n.isFunction(s)&&s.apply(u),u._refreshText())},m={mode:"hide",direction:c==="horizontal"?i?"left":"right":i?"up":"down",easing:r.easing,distance:c==="horizontal"?h:p,duration:r.duration},n.effects?f.effect("slide",m,v):u._slideAnimate(m,f,v)},r.prototype._moveFrom=function(e,t,r){var i=this,s=this.options,o;n.isFunction(t)?(r=t,t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation)):t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation,t),i._removeText();if(t.animated==="none"||t.duration<=0){i._createText(),n.isFunction(r)&&r.apply(i),this.container.data("moving.wijlightbox",!1);return}o=n.extend({width:i.frame.width(),height:i.frame.height()},i.container.offset()),i.frame.width(e.width).height(e.height),i.container.css({left:e.left,top:e.top,width:i.frame.outerWidth(),position:"absolute",opacity:""}),i._moveTo(o,t,function(){i.frame.width(o.width),i.container.width(i.frame.outerWidth()),i._createText(),i.container.data("moving.wijlightbox",!1),n.isFunction(r)&&r.apply(i)})},r.prototype._moveTo=function(e,t,r){var i=this,s=this.options;n.isFunction(t)?(r=t,t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation)):t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation,t);var o=t.duration/2,u=t.animated,a=i._isOpen(),f=u==="wh"?{left:e.left,top:undefined}:{top:e.top},l=u==="wh"?{top:e.top,left:undefined}:{left:e.left},c=u==="wh"?{width:e.width,height:undefined}:{height:e.height},h=u==="wh"?{height:e.height,width:undefined}:{width:e.width};if(u==="wh"||u==="hw"){a&&i.container.animate(f,{duration:o,easing:t.easing,queue:!0}),i.frame.animate(c,{duration:o,easing:t.easing,complete:function(){a&&i.container.animate(l,{duration:o,easing:t.easing,queue:!0}),i.frame.animate(h,{duration:o,easing:t.easing,complete:function(){i.container.data("moving.wijlightbox",!1),n.isFunction(r)&&r.apply(i)}})}});return}a&&i.container.animate({left:e.left,top:e.top},{duration:t.duration,easing:t.easing,queue:!0}),i.frame.animate({width:e.width,height:e.height,opacity:1},{duration:t.duration,easing:t.easing,complete:function(){i.container.data("moving.wijlightbox",!1),n.isFunction(r)&&r.apply(i)}})},r.prototype.show=function(e){return this._show(e),this},r.prototype._resize=function(e){var t=this,r=n.extend({},t.container.offset(),{width:t.frame.width(),height:t.frame.height()});t._size(),t._isOpen()&&t._position(),t._moveFrom(r,e)},r.prototype._onAfterShow=function(){var e=this,t=this.options,n;e._refreshNavButtons(),e.container.data("animating.wijlightbox",!1),t.modal||e._hideOverlay(),n={index:t.activeIndex,item:t.groupItems[t.activeIndex]},e._trigger("show",null,n),e._startTimer()},r.prototype._show=function(e,t,r){var i=this,s=this.options,o,u;if(this.container.data("showing.wijlightbox"))return o=[function(){i._show(e,t,r)}],this.container.queue("showqueue",o),this;u=s.activeIndex;if(!n.isPlainObject(e)){u=e;if(u<0||u>=s.groupItems.length)return this;e=s.groupItems[u]}e&&this.container.data("item.wijlightbox",e),this._groupMode()&&this._preload(),n.isFunction(t)&&(r=t,t=undefined),r||(r=i._onAfterShow);var a={index:u,item:e};if(i._trigger("beforeShow",null,a)===!1)return this;this.container.data("showing.wijlightbox",!0);var f=function(){n.isFunction(r)&&r.apply(i),i.container.data("showing.wijlightbox",!1),i.container.dequeue("showqueue"),i.container.clearQueue("showqueue")};i._refreshCounter(u);var l=this.container.data("player.wijlightbox"),c,h=function(){i.container.data("playerwidth.wijlightbox",c.width),i.container.data("playerheight.wijlightbox",c.height);var e=n.extend({},i._defaults.transAnimation,s.transAnimation);if(s.activeIndex===u||e.animated==="none"||e.duration<=0||!i._isOpen()){s.activeIndex=u,l&&l.remove(),c.appendTo(i.content),i._refreshText(),f();return}s.cookie&&i._cookie(s.activeIndex,s.cookie);if(e.animated==="slide")t=t===undefined?u>s.activeIndex:t,i._slideTo(l,c,e,t,f),s.activeIndex=u;else{s.activeIndex=u;var r=function(){c&&(c.appendTo(i.content,!0),c.fadeIn(e.duration,f))};n.browser.msie&&i.frame.trigger("mouseleave");var o=function(){l&&l.remove(),s.autoSize&&!i._isFullSize()?i._resize(r):(r(),i._refreshText())};l?l.fadeOut(e.duration*.4,o):o()}};return c=this._createPlayer(e,h),this},r.prototype.next=function(){var e=this.options;if(!this._groupMode())return!1;var t=e.activeIndex+1;return e.loop&&(t%=e.groupItems.length),t<e.groupItems.length?(this._show(t,!0),!0):!1},r.prototype.back=function(){var e=this.options;if(!this._groupMode())return!1;var t=e.activeIndex-1;return e.loop&&(t=t<0?e.groupItems.length-1:t),t>=0?(this._show(t,!1),!0):!1},r.prototype.adjustPosition=function(){this._position()},r.prototype.isPlaying=function(){return!!this.container.data("playing.wijlightbox")},r.prototype._startTimer=function(){if(!this.isPlaying()||!this._groupMode())return;var e=this.options,t=this,n;e.showTimer===!0?(this.timerMeter||this._createTimerBar(),n=this.timerBar.width(),t.timerMeter.width("0"),t.timerMeter.animate({width:n},e.delay,null,function(){t.isPlaying()&&!t.next()&&t.stop()})):window.setTimeout(function(){t.isPlaying()&&!t.next()&&t.stop()},e.delay)},r.prototype.play=function(){if(!this._groupMode())return!1;this.container.data("playing.wijlightbox")||this.container.data("playing.wijlightbox",!0),this._refreshCtrlButtons(),this._hideNavButtons(),this._startTimer()},r.prototype.stop=function(){this.container.removeData("playing.wijlightbox"),this._refreshCtrlButtons(),this._removeTimerBar()},r.prototype._size=function(e,t){var r=this.options,i=r.width,s=r.height,o=r.autoSize?this.container.data("playerwidth.wijlightbox")||i:i,u=r.autoSize?this.container.data("playerheight.wijlightbox")||s:s,a,f=u/o;if(typeof e=="boolean")t=e;else if(n.isPlainObject(e)&&"width"in e&&"height"in e)i=e.width,s=e.height;else{a=this.container.data("player.wijlightbox"),r.autoSize&&a&&a.name==="img"&&(o>i&&(o=i,u=Math.round(i*f)),u>s&&(u=s,o=Math.round(s/f))),i=o,s=u;if(t)return{width:i,height:s}}this.frame.width(i).height(s),this.container.width(this.frame.outerWidth(!0))},r.prototype._position=function(){var e=this.options,t=[],r=[0,0],i,s=e.position;if(s){if(typeof s=="string"||typeof s=="object"&&"0"in s)t=s.split?s.split(" "):[s[0],s[1]],t.length===1&&(t[1]=t[0]),n.each(["left","top"],function(e,n){+t[e]===t[e]&&(r[e]=t[e],t[e]=n)}),s={my:t.join(" "),at:t.join(" "),offset:r.join(" ")};s=n.extend({},e.position,s)}i=this.container.is(":visible"),i||this.container.show(),this.container.css({top:0,left:0}).position(s),i||this.container.hide()},r.prototype._getRelRect=function(e){var t;return e&&(n.isPlainObject(e)&&"left"in e&&"top"in e&&"width"in e&&"height"in e?t=n.merge({},e):e=n(e),e.jquery&&e.length&&(t=n.extend({},e.offset(),{width:e.width(),height:e.height()}))),t},r.prototype._close=function(e){var t=this.options,r=this,i,s,o;if(!this._isOpen())return;s={rel:e};if(!1===this._trigger("beforeClose",null,s))return;e=s.rel,!e&&this._groupMode()&&(e=t.groupItems[t.activeIndex].img),this.container.data("moving.wijlightbox",!0),this._hideAccessories(!1),this._hideWaiting(),this._hideOverlay(),this.stop(),o=function(){r._removePlayer(),r.container.hide(),r._trigger("close"),r.container.unbind("keypress.wijlightbox"),r.container.removeData("open.wijlightbox").removeData("rect.wijlightbox").removeData("moving.wijlightbox").removeData("fullsize.wijlightbox"),n(document).unbind("keydown.wijlightbox").unbind("click.wijlightbox")},i=this._getRelRect(e),i||this.container.data("rect.wijlightbox")&&(i=this.container.data("rect.wijlightbox")),this._removeText();if(i){this._moveTo(i,{animated:"sync",duration:200},o);return}return o.call(),this},r.prototype._isOpen=function(){return!!this.container.data("open.wijlightbox")},r.prototype._open=function(e,t){if(this._isOpen())return;var r=this.options,i=this;this.toolBox&&(this._isFullSize()?this.toolBox.css({top:"2px",right:"4px"}):this.toolBox.css({top:"",right:""}));var s=function(){r.modal&&i._showOverlay(),r.showControlsOnHover?this._hideAccessories(!1):this._showAccessories(!1);var t=i._getRelRect(e);i.container.css("opacity",0),i.container.show(),i._size(),i._createText(!0),i._refreshText(!0),i._position(),i.container.data("open.wijlightbox",!0);if(e&&t)i.container.data("rect.wijlightbox",t),i._moveFrom(t,{animated:"sync"});else{var s=n.extend({},i._defaults.transAnimation,r.transAnimation);s.animated==="fade"?(i.container.hide(),i.container.fadeIn(s.duration,function(){i._createText()})):i._createText(),this.container.data("moving.wijlightbox",!1)}n(document).bind("keydown.wijlightbox",n.proxy(i,"_keyDownHandler")).bind("click.wijlightbox",function(e){var t=e.target||e.srcElement;i._isOpen()&&!!r.closeOnOuterClick&&t!==i.container.get(0)&&n(t).parents().index(i.container)<0&&i._close()}),r.autoPlay&&this.play(),i._refreshNavButtons(),i._refreshDialogButtons();var u={index:r.activeIndex,item:r.groupItems[r.activeIndex]};i._trigger("show",null,u),i._trigger("open")};return this.container.data("moving.wijlightbox",!0),this._show(t,!0,s),this},r.prototype._getWinRect=function(){var e=n(window);return n.extend({width:e.width(),height:e.height()},e.offset()||{left:2,top:2})},r.prototype._resizeHandler=function(){var e=this;e._removeText(),e._size(e._getWinRect()),e._createText()},r.prototype._isFullSize=function(){return!!this.container.data("fullsize.wijlightbox")},r.prototype._toggleFullSize=function(){var e=this,t=n(window);if(!e._isOpen())return;if(this._isFullSize())e.toolBox&&e.toolBox.css({top:"",right:""}),this.container.data("fullsize.wijlightbox",!1),t.unbind("resize.wijlightbox",n.proxy(this,"_resizeHandler")),e._resize(function(){e._adjustPlayerSize(e.content.innerWidth(),e.content.innerHeight())});else{this.container.data("fullsize.wijlightbox",!0),t.bind("resize.wijlightbox",n.proxy(this,"_resizeHandler"));var r=e._getWinRect(),i=this.frame.borderSize();r.width-=i.width,r.height-=i.height,e._removeText(),e._moveTo(r,{animated:"sync"},function(){e.toolBox&&e.toolBox.css({top:"2px",right:"4px"}),e.frame.width(r.width),e.container.width(e.frame.outerWidth()),e._createText(),e._adjustPlayerSize(e.content.innerWidth(),e.content.innerHeight())})}this._refreshDialogButtons()},r.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},r.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],r=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=["mp4","mpg","mpeg","ogg","ogv"],a=this._getExt(e);if(a){if(n.inArray(a,t)>=0)return"img";if(n.inArray(a,r)>=0)return"swf";if(n.inArray(a,i)>=0)return"flv";if(n.inArray(a,o)>=0)return"wmp";if(n.inArray(a,s)>=0)return"qt";if(n.inArray(a,u)>=0)return"wijvideo"}return"iframe"},r.prototype._adjustPlayerSize=function(e,t){var n=this.container.data("player.wijlightbox");n&&n.adjustSize&&n.adjustSize(e,t)},r.prototype._removePlayer=function(){var e=this.container.data("player.wijlightbox");e&&(e.remove(),this.container.data("player.wijlightbox",null))},r.prototype._createPlayer=function(e,t,r){var i=e.player;if(!n.isFunction(n.wijmo.wijlightbox[i]))throw"unknown player "+i;var s=this,o=!1,u,a=function(){o=!0,this._hideWaiting(),n.isFunction(t)&&window.setTimeout(function(){t.apply(s)},1)},f=function(){this._hideWaiting(),n.isFunction(r)&&r.apply(s)};return u=new n.wijmo.wijlightbox[i](this,e,a,f),this.container.data("player.wijlightbox",u),window.setTimeout(function(){o===!1&&s._showWaiting()},200),u},r}(e.wijmoWidget);t.wijlightbox=i;var s=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn ui-btn-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijlightbox')",this.textPosition="overlay",this.width=600,this.height=400,this.autoSize=!0,this.player="",this.groupItems=null,this.rootUrl="",this.ctrlButtons="",this.dialogButtons="close",this.counterType="default",this.counterFormat="[i] of [n]",this.counterLimit=10,this.showCounter=!0,this.showNavButtons=!0,this.showTimer=!1,this.controlsPosition="inside",this.showControlsOnHover=!0,this.clickPause=!1,this.keyNav=!1,this.modal=!1,this.position={my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=n(this).css(e).offset().top;t<0&&n(this).css("top",e.top-t)}},this.zIndex=1e3,this.closeOnEscape=!0,this.closeOnOuterClick=!0,this.autoPlay=!1,this.delay=2e3,this.loop=!0,this.cookie=null,this.transAnimation={animated:"fade",duration:400,easing:"linear"},this.slideDirection="horizontal",this.resizeAnimation={animated:"sync",duration:400},this.textShowOption={duration:300,easing:"linear"},this.textHideOption={duration:300,easing:"linear"},this.showMovieControls=!0,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.beforeShow=null,this.show=null,this.open=null,this.beforeClose=null,this.close=null}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijlightbox",i.prototype),n.extend(n.wijmo.wijlightbox,{img:function(e,t,r,i){this.name="img",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t);var s=this;n("<img></img>").css({width:"auto",height:"auto",display:"none"}).appendTo(document.body).bind({load:function(){var i=n(this);s.width=t.width?parseInt(t.width,10):i.width(),s.height=t.height?parseInt(t.height,10):i.height(),i.remove(),r&&n.isFunction(r)&&r.apply(e)},error:function(){n(this).remove(),i&&n.isFunction(i)&&i.apply(e)}}).attr("src",this.url)},swf:function(e,t,r,i){this.name="swf";var s=e.options;this.id="flashhost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,r&&n.isFunction(r)&&r.apply(e)},iframe:function(e,t,r,i){this.name="swf",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),t.width&&(this.width=parseInt(t.width,10)),t.height&&(this.height=parseInt(t.height,10)),this.$iframe=n("<iframe></iframe>").addClass("wijmo-wijlightbox-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true"}).hide().appendTo(e.content).bind("load",function(){r&&n.isFunction(r)&&r.apply(e)}).attr("src",this.url)},inline:function(e,t,r,i){this.name="inline";var s=e.options,o=s.wijCSS,u="wijmo-wijlightbox-frame "+o.content;" "+o.cornerAll+" "+o.helperClearFix,this.lightbox=e,this.item=t,this.width=t.width?parseInt(t.width,10):s.width;if(t.height)this.height=parseInt(t.height,10);else{var a=n(this.item.href).clone().show().append('<br clear="all" />').wrap('<div class="wijmo-wijlightbox '+o.widget+'">'+'<div class="'+u+'">'+'<div class="'+u+'">'+'<div class="wijmo-wijlightbox-content"> '+"</div></div></div></div>").appendTo(document.body).width(this.width);this.height=a.outerHeight(!0)+10,a.unwrap(),a.remove()}r&&n.isFunction(r)&&r.apply(e)},flv:function(e,t,r,i){this.name="flv";var s=e.options;this.id="flvhost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t);var o=20;this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),r&&n.isFunction(r)&&r.apply(e)},wmp:function(e,t,r,i){var s=e.options,o;this.name="wmp",this.id="wmphost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),o=n.browser.msie?70:45,this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),r&&n.isFunction(r)&&r.apply(e)},qt:function(e,t,r,i){var s=e.options,o=16;this.name="qt",this.id="qthost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),r&&n.isFunction(r)&&r.apply(e)},wijvideo:function(e,t,r,i){var s=e.options;this.name="wijvideo",this.id="wijvideohost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.wijvideosrc=!t.wijvideosrc||t.wijvideosrc===""?null:this.lightbox._getUrl(t.wijvideosrc),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,r&&n.isFunction(r)&&r.apply(e)}}),n.extend(n.wijmo.wijlightbox.img.prototype,{appendTo:function(e,t){this.$element=n("<img></img>").addClass("wijmo-wijlightbox-image").attr("src",this.url),t&&this.$element.hide(),this.lightbox.options.transAnimation&&this.lightbox.options.transAnimation.animated=="fade"?(e.children().length&&e.empty(),this.$element.prependTo(e)):this.$element.appendTo(e)},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(e,t){this.$element&&this.$element.fadeOut(e,t)},fadeIn:function(e,t){this.$element&&this.$element.fadeIn(e,t)},getElement:function(){return this.$element}}),n.extend(n.wijmo.wijlightbox.swf.prototype,{appendTo:function(e){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(e);var t=this.lightbox.options,r=t.flashInstall,i=t.flashVersion,s=t.flashVars,o=t.flashParams;S.flash.embedSWF(this.item.href,this.id,"100%","100%",i,r,s,o)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.iframe.prototype,{appendTo:function(e,t){t||this.$iframe.show()},remove:function(){this.$iframe&&this.$iframe.remove()},fadeOut:function(e,t){this.$iframe&&this.$iframe.fadeOut(e,t)},fadeIn:function(e,t){this.$iframe&&this.$iframe.fadeIn(e,t)},getElement:function(){return this.$iframe}}),n.extend(n.wijmo.wijlightbox.inline.prototype,{appendTo:function(e,t){this.$element=n(this.item.href).clone().appendTo(e),t||this.$element.show()},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(e,t){this.$element&&this.$element.fadeOut(e,t)},fadeIn:function(e,t){this.$element&&this.$element.fadeIn(e,t)},getElement:function(){return this.$element}}),n.extend(n.wijmo.wijlightbox.flv.prototype,{appendTo:function(e){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(e);var t=this.lightbox.options,r="100%",i="100%",s=t.flvPlayer,o=t.flashInstall,u=t.flashVersion,a=n.extend({file:this.url,width:r,height:i,autostart:t.autoPlayMovies?"true":"false",controlbar:t.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},t.flashVars),f=n.extend({autostart:t.autoPlayMovies?"true":"false",allowscriptaccess:"always"},t.flashParams);S.flash.embedSWF(s,this.id,r,i,u,o,a,f)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.wmp.prototype,{appendTo:function(e){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(e);var t=this.lightbox.options,r='<object id="'+this.id+'" name="'+this.id+'" height="'+this.height+'" width="'+this.width+'"',i={autostart:t.autoPlayMovies?1:0,url:undefined,uimode:undefined,showcontrols:undefined},s;n.browser.msie?(r+=' classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"',i.url=this.url,i.uimode=t.showMovieControls?"full":"none"):(r+=' type="video/x-ms-wmv"',r+=' data="'+this.url+'"',i.showcontrols=t.showMovieControls?1:0),r+=">";for(s in i)r+='<param name="'+s+'" value="'+i[s]+'">';r+="</object>",this.$container.html(r)},remove:function(){if(n.browser.msie)try{window[this.id].controls.stop(),window[this.id].URL="movie"+now()+".wmv",window[this.id]=function(){}}catch(e){}this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.qt.prototype,{appendTo:function(e,t){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(e);var r=this.lightbox.options,i=r.autoPlayMovies?"true":"false",s=r.showMovieControls?"true":"false",o=n.browser.msie?"<object":"<embed",u={id:this.id,name:this.id,width:this.width,height:this.height,kioskmode:"true",classid:undefined,codebase:undefined,type:undefined,src:undefined,autoplay:undefined,controller:undefined},a,f;n.browser.msie?(u.classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",u.codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"):(u.type="video/quicktime",u.src=this.url,u.autoplay=i,u.controller=s);for(a in u)u[a]&&(o+=" "+a+'="'+u[a]+'"');o+=">";if(n.browser.msie){var l={src:this.url,scale:"aspect",controller:s,autoplay:i};for(f in l)o+='<param name="'+f+'" value="'+l[f]+'">'}o+=n.browser.msie?"</object>":"</embed>",t&&e.hide(),this.$container.html(o),t&&e.show()},remove:function(){try{document[this.id].Stop(),document[this.id]=null}catch(e){}this.$container.remove()},fadeOut:function(e,t){t.call();return},fadeIn:function(e,t){t.call();return},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.wijvideo.prototype,{appendTo:function(e){var t=this.lightbox.options;this.$container=n("<video/>").css({overflow:"hidden"}).attr({width:this.width,height:this.height,autoPlay:t.autoPlayMovies?"true":"false",controls:t.showMovieControls?"controls":""}).appendTo(e),!this.url||n("<source/>").attr({src:this.url}).appendTo(this.$container),!this.wijvideosrc||n("<source/>").attr({src:this.wijvideosrc}).appendTo(this.$container),this.$container.wijvideo({fullScreenButtonVisible:!1})},remove:function(){this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container},adjustSize:function(e,t){this.$container.wijvideo("setWidth",e),this.$container.wijvideo("setHeight",t)}}),n.extend(n.wijmo.wijlightbox,{overlay:function(e,t){this.mask=n("<div></div>").addClass(e.options.wijCSS.overlay+" wijmo-wijlightbox-overlay"+(t?" wijmo-wijlightbox-waitingoverlay":"")).appendTo(document.body).css({width:this.width(),height:this.height()}).bind("click",function(){return e.options.closeOnOuterClick&&e._close(),!1}),n.fn.bgiframe&&this.mask.bgiframe();if(t){this.mask.css("z-index",this.zIndex);var r=n("<div></div>").addClass("wijmo-wijlightbox-waiting").css("z-index",this.zIndex+1).appendTo(this.mask);r.css({left:(this.mask.width()-r.width())/2,top:(this.mask.height()-r.height())/2})}n(window).bind("resize.wijlightbox-overlay",n.proxy(this,"resize")),window.setTimeout(function(){var e;this.mask&&(e=n.wijmo.wijlightbox.overlay,n(document).bind(e.events,function(t){if(n(t.target).zIndex()<e.zIndex)return!1}))},1)}}),n.extend(n.wijmo.wijlightbox.overlay.prototype,{mask:null,zIndex:1e3,events:n.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".wijlightbox-overlay"}).join(" "),close:function(){n(document).unbind(".wijlightbox-overlay"),n(window).unbind(".wijlightbox-overlay"),this.mask.remove(),this.mask=undefined},height:function(){var e,t;return n.browser.msie&&parseInt(n.browser.version)<7?(e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),t=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),e<t?n(window).height():e):n(document).height()},width:function(){var e,t;return n.browser.msie&&parseInt(n.browser.version)<7?(e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),t=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),e<t?n(window).width():e):n(document).width()},resize:function(){this.mask&&this.mask.css({width:this.width(),height:this.height()})}})})(e.lightbox||(e.lightbox={}));var t=e.lightbox})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=$.wijmo.wijcandlestickchart,r=function(r){function i(){r.apply(this,arguments)}return __extends(i,r),i.prototype._create=function(){var e=this,t=e.options,n=e._getDefFill(),i,s;$.each(t.seriesList,function(e,n){if(n.type==="bar")return $.extend(!0,t.axis,{x:{compass:"west"},y:{compass:"south"}}),!0;n.type==="pie"&&n.pieSeriesList?n.data=n.pieSeriesList:n.candlestickSeries&&n.candlestickSeries.data&&$.inArray(n.type,["hl","ohlc","candlestick"])!=-1&&(n.data=n.candlestickSeries.data)}),$.extend(!0,{compass:"east"},t.hint),t.is100Percent&&(t.is100Percent=!1),t.yAxes&&$.isArray(t.yAxes)&&t.yAxes.length>0&&(s=[],$.each(t.yAxes,function(e,n){s.push($.extend({},t.axis.y,n))}),t.axis.y=s),e._handleChartStyles(),e._checkChartType(),e.isContainsCandlestick&&(e.bindXData=!1,e._handleXDataForCandlestick()),r.prototype._create.call(this),e.chartElement.addClass(t.wijCSS.compositechart)},i.prototype._setOption=function(e,t){e!=="is100Percent"&&(e==="axis"&&this.isContainsCandlestick&&n&&n.prototype._handleMaxMinInAxis.apply(this,[t]),r.prototype._setOption.call(this,e,t))},i.prototype._seriesListSeted=function(){this._checkChartType(),this.isContainsCandlestick&&(this.timeUtil.dispose(),this.timeUtil=null,this._handleXDataForCandlestick())},i.prototype._supportStacked=function(){return!0},i.prototype.destroy=function(){var e=this,t=e.chartElement,n=t.data("fields"),i=n&&n.aniBarsAttr;t.removeClass(e.options.wijCSS.compositechart),this.timeUtil&&this.timeUtil.dispose(),r.prototype.destroy.call(this),e._destroyRaphaelArray(i),e.aniPathsAttr=null,t.data("fields",null)},i.prototype._isBarChart=function(){return!0},i.prototype._clearChartElement=function(){var e=this,t=e.options,n=e.chartElement,i=n.data("fields");i&&i.allElements&&($.each(i.allElements,function(t,n){t==="scatters"&&n.length&&$.each(n,function(e,t){t.length&&($.each(t,function(e,n){n&&n.remove&&n.remove(),t[e]=null}),n[e]=null)}),e._destroyRaphaelArray(n)}),i.allElements=null),r.prototype._clearChartElement.call(this),i&&i.ctracers&&(i.ctracers=null),e.element.removeData("plotInfos"),t.seriesTransition.enabled||i&&i.aniBarsAttr&&(i.aniBarsAttr=null)},i.prototype._bindSeriesData=function(e,t,n){var i=this,s=t.data,o=t.type,u,a,f,l=[];o==="pie"?(u=s.label,a=s.value,f=s.offset,u&&u.bind&&(u=this._getBindData(e,u.bind)),a&&a.bind&&(a=this._getBindData(e,a.bind)),f&&f.bind&&(f=this._getBindData(e,f.bind)),u&&$.isArray(u)&&u.length&&a&&$.isArray(a)&&a.length&&($.each(a,function(e,t){var n,r=0;e>=0&&e<u.length&&(n=u[e]),f&&$.isArray(a)&&f.length&&e>=0&&e<f.length&&(r=typeof f[e]=="undefined"?0:f[e]),l.push({data:t,label:n,offset:r,legendEntry:!0})}),t.data=l)):(r.prototype._bindSeriesData.call(this,e,t,n),s.x&&$.isArray(s.x)&&(this.bindXData=!0),$.each(["high","low","open","close","y1"],function(t,n){var r=s[n];r&&r.bind&&(s[n]=i._getBindData(e,r.bind))}))},i.prototype.getElement=function(e,t,n){var r=this.chartElement,i=r.data("fields"),s=i.chartElements;switch(e){case"bar":case"column":return s.bars[t];case"line":case"area":return s.paths[t];case"linemarkers":return s.markersSet[t];case"pie":return this._getPie(s,t,n)}return null},i.prototype._getPie=function(e,t,n){if(n!==undefined)return e["sectors"+n]?e["sectors"+n][t]:null;var r=[];return $.each(e,function(e,t){/sectors/.test(e)&&e!=="sectors"&&$.each(t,function(e,t){r.push(t)})}),r.length===0&&(r=e.sectors),r[t]},i.prototype._paintLegendIcon=function(e,t,n,i,s,o,u,a,f,l){var c=this,h=this.options,p=f.type,d,v,m=3,g=!1,y,b;return p==="line"||p==="area"||p==="spline"||p==="bezier"?(d=c.canvas.path(Raphael.format("M{0},{1}L{2},{3}",e,t+i/2,e+n,t+i/2)),s&&(h.legend.size&&h.legend.size.height&&(m=h.legend.size.height),d.attr($.extend(!0,{},s,{"stroke-width":m}))),g=!0,f.markers&&f.markers.visible&&(y=f.markers.type,b=f.markerStyle,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),s["stroke-dasharray"]&&d.attr({"stroke-width":1,"stroke-dasharray":s["stroke-dasharray"]}),y||(y="circle"),v=this.canvas.paintMarker(y,e+n/2,t+i/2,3),$.wijraphael.addClass($(v.node),Raphael.format("{0} {1} {2}",h.wijCSS.legend,h.wijCSS.legendDot,h.wijCSS.canvasObject)),v.attr(b),$(v.node).data("index",u).data("legendIndex",o),this.legendDots[o]=v)):p==="scatter"?(b=f.markerStyle,y=f.markerType,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),y||(y="circle"),d=c.canvas.paintMarker(y,e+n/2,t+i/2,3),d.attr(b),f.visible===!1&&($(l.node).data("dotOpacity",d.attr("opacity")||1),d.attr("opacity",.3)),g=!0):p==="bubble"?(b=f.markerStyle,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),f.markers&&(y=f.markers.type),y||(y="circle"),d=c.canvas.paintMarker(y,e+n/2,t+i/2,Math.min(n,i)/2),d.attr(b),g=!0):d=r.prototype._paintLegendIcon.call(this,e,t,n,i,s,o,u,a,f,l),g&&($.wijraphael.addClass($(d.node),a),$(d.node).data("legendIndex",o).data("index",u),c.legendIcons.push(d)),d},i.prototype._showHideCandlestickSeries=function(e,t){n&&n.prototype._showHideSeries.apply(this,arguments)},i.prototype._showSerieEles=function(e){var t=e.type,n=e.eles,r=this.options.showChartLabels,i;switch(t){case"pie":n.sector&&(n.sector.show(),n.sector.shadow&&n.sector.shadow.show(),n.sector.tracker&&n.sector.tracker.show()),n.label&&n.label.show();break;case"line":case"spline":case"bezier":case"area":n.markers&&$.each(n.markers,function(e,t){i=$(t.node).data("wijchartDataObj");if(i&&i.lineSeries&&i.lineSeries.markers&&!i.lineSeries.markers.visible)return!0;t.show()}),n.dcl&&$.each(n.dcl,function(e,t){r&&t.show()});if(n.path){i=$(n.path.node).data("wijchartDataObj");if(i.visible||!(!i.visible&&i.markers&&i.markers.visible))n.path.show(),n.path.shadow&&n.path.shadow.show(),n.path.area&&n.path.area.show(),n.path.tracker&&n.path.tracker.show(),$(n.path.node).data("wijchartDataObj")&&$(n.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(n.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0})}break;case"bar":case"column":$.each(n,function(e,t){t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show()});break;case"scatter":$.each(n,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)});break;case"ohlc":case"hl":case"candlestick":this._showHideCandlestickSeries(n,"show");break;case"bubble":$.each(n,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.shadow&&t.bubble.shadow.show(),t.bubble.tracker&&t.bubble.tracker.show(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()})}},i.prototype._hideSerieEles=function(e){var t=e.type,n=e.eles;switch(t){case"pie":n.sector&&(n.sector.hide(),n.sector.shadow&&n.sector.shadow.hide(),n.sector.tracker&&n.sector.tracker.hide()),n.label&&n.label.hide();break;case"line":case"spline":case"bezier":case"area":n.markers&&$.each(n.markers,function(e,t){t.hide()}),n.dcl&&$.each(n.dcl,function(e,t){t.hide()}),n.path&&(n.path.hide(),n.path.shadow&&n.path.shadow.hide(),n.path.area&&n.path.area.hide(),n.path.tracker&&n.path.tracker.hide(),$(n.path.node).data("wijchartDataObj")&&$(n.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(n.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}));break;case"bar":case"column":$.each(n,function(e,t){t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide()});break;case"scatter":$.each(n,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)});break;case"ohlc":case"hl":case"candlestick":this._showHideCandlestickSeries(n,"hide");break;case"bubble":$.each(n,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.shadow&&t.bubble.shadow.hide(),t.bubble.tracker&&t.bubble.tracker.hide(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})}},i.prototype._indicatorLineShowing=function(e){var t;r.prototype._indicatorLineShowing.call(this,e),$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar.attr(n.hoverStyle):t==="marker"?n.marker.attr(n.markerHoverStyle):t==="scatter"&&(n.dot.attr(n.hoverStyle),n.dot.scale(1.5,1.5))})},i.prototype._removeIndicatorStyles=function(e){var t;$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar.attr(n.style):t==="marker"?(n.marker.attr(n.markerStyle),n.marker.transform("s1")):t==="scatter"&&(n.dot.attr(n.style),n.dot.scale(1,1))})},i.prototype._paintTooltip=function(){var e=this,t=e.chartElement,n=t.data("fields")||{},i=n.ctracers||[];r.prototype._paintTooltip.call(this),e.tooltip&&$.each(i,function(t,n){n.trackers&&n.trackers.length&&t===0&&e.tooltip.setOptions({relatedElement:n.trackers[0]})})},i.prototype._setDefaultTooltipText=function(e){return e.type==="candlestick"&&n?n.prototype._setDefaultTooltipText.apply(this,arguments):r.prototype._setDefaultTooltipText.call(this,e)},i.prototype._checkChartType=function(){var e=this;this.isContainsBubble=!1,this.isContainsCandlestick=!1,$.each(this.options.seriesList,function(t,n){var r=n.type;!!e.isContainsCandlestick||r!=="ohlc"&&r!=="hl"&&r!=="candlestick"?!e.isContainsBubble&&r==="bubble"&&(e.isContainsBubble=!0):e.isContainsCandlestick=!0})},i.prototype._handleXDataForCandlestick=function(){n&&n.prototype._handleXData.apply(this,arguments)},i.prototype._isCandlestickSeries=function(e){var t=e.type;return t==="ohlc"||t==="hl"||t==="candlestick"},i.prototype._paintChartArea=function(){var e=this,n=e.options.seriesList;if(e._isSeriesListDataEmpty())return;$.each(n,function(t,n){var r=n.data;e._isCandlestickSeries(n)&&(r.y=[].concat(r.high).concat(r.low))}),this.bubbleAxisAdjust&&this.bubbleAxisAdjust.dispose(),this.bubbleAxisAdjust=new t.BubbleAxisAdjust(this),r.prototype._paintChartArea.call(this),$.each(n,function(t,n){e._isCandlestickSeries(n)&&delete n.data.y})},i.prototype._checkSeriesDataEmpty=function(e){var t=e.type,n=e.data,i=this._checkEmptyData;if(this._isCandlestickSeries(e)){if(!n||i(n.x)||i(n.high)||i(n.low))return!0;if(t==="ohlc"||t==="candlestick")if(i(n.open)||i(n.low))return!0;return!1}if(t==="pie")return!n||!$.isArray(n)?!0:!1;if(t==="bubble")if(!n||i(n.y1))return!0;return r.prototype._checkSeriesDataEmpty.call(this,e)},i.prototype._calculateMajorMinor=function(e,t){this.isContainsCandlestick&&t.id==="x"?n.prototype._calculateMajorMinor.apply(this,arguments):r.prototype._calculateMajorMinor.call(this,e,t)},i.prototype._getXTickText=function(e){var t=this,r=t.formatString;return t.isContainsCandlestick&&n?n.prototype._getXTickText.apply(this,arguments):e},i.prototype._adjustTickValuesForCandlestickChart=function(e){return this.isContainsCandlestick&&n?n.prototype._adjustTickValuesForCandlestickChart.apply(this,arguments):r.prototype._adjustTickValuesForCandlestickChart.call(this,e)},i.prototype._getTickTextForCalculateUnit=function(e,t,i){return t.id==="x"&&this.isContainsCandlestick?n.prototype._getTickTextForCalculateUnit.apply(this,arguments):r.prototype._getTickTextForCalculateUnit.call(this,e,t,i)},i.prototype._AdjustAxisBounds=function(e,n){var r=this,i=r.options,s,o,u,a,f=e.max,l=e.min,c=f-l,h=t.ChartDataUtil.nicePrecision(c),p=h+1,d=e.bounds,v=$.extend(!0,{},i.textStyle,n.textStyle,n.labels.style);s=r._text(-1e3,-1e3,$.round(f,p).toString()).attr(v),o=r._text(-1e3,-1e3,$.round(l,p).toString()).attr(v),u=s.wijGetBBox(),a=o.wijGetBBox(),e.isStartAxis||(d.startY+=a.height),e.isLastAxis||(d.endY-=u.height)},i.prototype._initYAxisHeight=function(){var e=this,t=e.options,n=t.axis,r=n.y,i=e.canvasBounds,s=i.endX-i.startX,o=i.endY-i.startY,u=e.axisInfo,a=u.y,f=0,l=-1,c=0,h;$.isArray(r)&&($.each(r,function(e,t){t.height&&!isNaN(t.height)?f+=t.height:t.height==="auto"&&(l=e),a[e].height=t.height}),l>-1&&(a[l].height=o-f),$.each(a,function(t,n){var s=n.height;if(s===undefined)return!0;s>0&&(n.isPartAxis=!0,n.isLastAxis=parseInt(t)===r.length-1,n.isStartAxis=parseInt(t)===0),h?n.bounds={startY:h.endY,endY:h.endY+s}:n.bounds={startY:i.startY,endY:i.startY+s},n.bounds.startX=i.startX,n.bounds.endX=i.endX,e._AdjustAxisBounds(n,r[t]),n.bounds&&(h=$.extend({},n.bounds))}))},i.prototype._getDataExtreme=function(e){var t=this;return t._initYAxisHeight(),r.prototype._getDataExtreme.call(this,e)},i.prototype._paintPlotArea=function(){var t=this,r=t.options,i="seriesList",s="seriesStyles",o="seriesHoverStyles",u=r[s],a=r[o],f=t.canvasBounds,l={},c=0,h=-1,p=[],d=$.isArray(r.axis.y),v={canvas:t.canvas,tooltip:t.tooltip,bounds:f,widgetName:t.widgetName,seriesTransition:r.seriesTransition,showChartLabels:r.showChartLabels,textStyle:r.textStyle,chartLabelStyle:r.chartLabelStyle,chartLabelFormatString:r.chartLabelFormatString,shadow:r.shadow,hint:r.hint,animation:r.animation,disabled:r.disabled,culture:t._getCulture(),widget:this,wijCSS:r.wijCSS,mouseDown:function(e,n){t._trigger("mouseDown",e,n)},mouseUp:function(e,n){t._trigger("mouseUp",e,n)},mouseOver:function(e,n){t._trigger("mouseOver",e,n)},mouseOut:function(e,n){t._trigger("mouseOut",e,n)},mouseMove:function(e,n){t._trigger("mouseMove",e,n)},click:function(e,n){t._trigger("click",e,n)}},m=t.chartElement.data("fields"),g,y,b;m&&(m.ctracers=[]),$.each(r[i],function(e,t){var n=t.type,f={},p=n,v={},m=$.extend({},u[c]),g=$.extend({},a[c]),y=t.yAxis;if(!n||n.length===0)return!0;if(p==="spline"||p==="bezier")p="line";f=l[p],f||(n==="pie"?f=[]:f={},l[p]=f,t.hint&&(f.hint=t.hint,r.hint.content||(r.hint.content=t.hint.content),r.hint.title||(r.hint.title=t.hint.title)));if(n==="pie")return $.each(t.data,function(t,n){m=$.extend({},u[c]),g=$.extend({},a[c]),v[i]||(v[i]=[]),v[s]||(v[s]=[]),v[o]||(v[o]=[]),n.pieID=e+1,v[i].push(n),v[s].push(m),v[o].push(g),h===-1&&(h=c),c++}),v.sIndex=h,v.radius=t.radius,v.center=t.center,v.label=t.label,h=-1,f.push(v),!0;n==="column"?f.horizontal=!1:n==="bar"?f.horizontal=!0:n==="spline"?t.fitType="spline":n==="bezier"&&(t.fitType="bezier"),d&&(f.yAxis=y||0);if(n==="line"||n==="spline"||n==="bezier")delete m.fill,delete g.fill;f[i]||(f[i]=[]),f[s]||(f[s]=[]),f[o]||(f[o]=[]),n==="scatter"&&(f.showChartLabels=r.showChartLabels,t.showChartLabels!==undefined&&(f.showChartLabels=t.showChartLabels)),t.sIndex=c,f[i].push(t),f[s].push(m),f[o].push(g),c++}),$.each(l,function(i,s){var o=e.chart,u=s.yAxis,a=r.chartLabel;u!==undefined&&t.axisInfo.y[u].bounds&&(v.bounds=t.axisInfo.y[u].bounds);switch(i){case"pie":var l;$.each(s,function(e,n){var r=n.center,s=n.radius||50,u,a=f.endX-f.startX,l=f.endY-f.startY;a<2*s&&(s=a/2),l<2*s&&(s=l/2),n.radius=s,u=r?{startX:r.x-s,startY:r.y-s,endX:r.x+s,endY:r.y+s}:{startX:f.startX+a/2-s,startY:f.startY+l/2-s,endX:f.startX+2*s,endY:f.startY+2*s},g=$.extend(!0,{},v,{bounds:u,radius:s,isTouchBehaviorEnable:!1},n),b=new o.PieChartRender(t.chartElement,g),b.render(),t.chartElement.data("fields").aniSectorAttrs=null,t.chartElement.data("fields").aniLabelAttrs=null,t._savechartData(i,n.sIndex)});break;case"bar":case"column":g=$.extend(!0,{},v,{stacked:r.stacked,axis:r.axis,clusterOverlap:r.clusterOverlap,clusterWidth:r.clusterWidth,clusterSpacing:r.clusterSpacing,is100Percent:r.is100Percent,clusterRadius:r.clusterRadius,isYTime:t.axisInfo.y[0].isTime,isXTime:t.axisInfo.x.isTime,yAxisInfo:t.axisInfo.y,yAxisIndex:u},s),b=new o.BarChartRender(t.chartElement,g),b.render(),p=[],$.each(s.seriesList,function(e,t){p.push(t.sIndex)}),t._savechartData(i,p);break;case"line":case"spline":case"bezier":case"area":y=t._getyAxisGroup(s),t.aniPathsAttr||(t.aniPathsAttr={}),$.each(y,function(e,n){t.aniPathsAttr[i]||(t.aniPathsAttr[i]=[]),g=$.extend(!0,{},v,{axis:r.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,type:i==="area"?"area":"line",hole:r.hole},n),g.aniPathsAttr=t.aniPathsAttr[i],g.chartLabelEles=t.chartLabelEles,g.axis.y=r.axis.y[e]||r.axis.y,g.extremeValue={txx:t.extremeValue.txx,txn:t.extremeValue.txn,tyx:t.extremeValue.y[e].tyx,tyn:t.extremeValue.y[e].tyn},b=new o.LineChartRender(t.chartElement,g),b.render(),p=[],$.each(n.seriesList,function(e,t){p.push(t.sIndex)}),t._savechartData(i,p,!0)});break;case"scatter":y=t._getyAxisGroup(s),$.each(y,function(e,n){g=$.extend(!0,{},v,{axis:r.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,zoomOnHover:r.zoomOnHover},n),g.axis.y=r.axis.y[e]||r.axis.y,b=new o.ScatterChartRender(t.chartElement,g),b.render(),p=[],$.each(n.seriesList,function(e,t){p.push(t.sIndex)}),t._savechartData(i,p)});break;case"ohlc":case"hl":case"candlestick":y=t._getyAxisGroup(s),$.each(y,function(e,s){g=$.extend(!0,{},v,{axis:r.axis,timeUtil:t.timeUtil,type:i},s),g.axis.y=r.axis.y[e]||r.axis.y,$.each(g.seriesStyles,function(e,t){n.prototype._setDefaultFill(i,t)}),b=new o.CandlestickChartRender(t.chartElement,g),b.render(),p=[],$.each(s.seriesList,function(e,t){p.push(t.sIndex)}),t._savechartData(i,p)});break;case"bubble":y=t._getyAxisGroup(s),a||(a={visible:r.showChartLabels,style:r.chartLabelStyle}),$.each(y,function(e,n){g=$.extend(!0,{},v,{axis:r.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,xAxisInfo:t.axisInfo.x,yAxisInfo:t.axisInfo.y,chartLabel:a,minimumSize:r.minimumSize||5,maximumSize:r.maximumSize||20,sizingMethod:r.sizingMethod||"diameter",bubbleRadius:t.bubbleAxisAdjust.bubbleRadius},n),g.axis.y=r.axis.y[e]||r.axis.y,g.yAxisInfo=t.axisInfo.y[e]||t.axisInfo.y[0],b=new o.BubbleChartRender(t.chartElement,g),b.render(),p=[],$.each(n.seriesList,function(e,t){p.push(t.sIndex)}),t._savechartData(i,p)})}}),t.chartElement.data("fields").seriesEles=null,t._bindtooltip()},i.prototype._savechartData=function(e,t,n){var r=this,i=r.chartElement.data("fields"),s=i.seriesEles,o=i.allElements||{},u,a=t;$.isArray(a)&&(a=0),$.each(s,function(n,i){$.isArray(t)?(r.seriesEles[t[a]]={eles:i,type:e},a++):(r.seriesEles[a]={eles:i,type:e},a++)}),n||(u=i.ctracers||[],u.push({trackers:i.trackers,type:e}),i.ctracers=u),i&&i.chartElements&&$.each(i.chartElements,function(e,t){r._copyElements(o,e,t)}),i.allElements=o},i.prototype._copyElements=function(e,t,n){var r;n&&$.isArray(n)?(r=e[t]||[],e[t]=r.concat(n)):n&&(r=e[t]||[],r.concat([n]))},i.prototype._getyAxisGroup=function(e){var t={};return $.each(e.seriesList,function(n,r){var i=r.yAxis||0;t[i]||(t[i]={seriesList:[],seriesStyles:[],seriesHoverStyles:[]}),t[i].seriesList.push(r),t[i].seriesStyles.push(e.seriesStyles[n]),t[i].seriesHoverStyles.push(e.seriesHoverStyles[n])}),t},i.prototype._bindtooltip=function(){var e=this,t=e.widgetName,n=e.chartElement.data("fields");n&&n.ctracers&&$.each(n.ctracers,function(e,t){var n=t.type;t.trackers&&t.trackers.toFront()}),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker","mouseover."+t,$.proxy(e._tooltipMouseOver,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker","mouseout."+t,$.proxy(e._tooltipMouseOut,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker, .candlesticktracker","mousemove."+t,$.proxy(e._tooltipMouseMove,e))},i.prototype._tooltipMouseOver=function(e){var t=e.target,n=this,r=n.tooltip,i=n.options.hint,s=null,o=i.title,u=i.content,a=i.style,f=$.isFunction(o),l=$.isFunction(u),c,h,p,d;p=$(n.canvas.canvas.parentNode).offset();if(n.indicatorLine)return;$(t).data("owner")&&(t=$(t).data("owner")),t=$(t),c=t.data("wijchartDataObj");if(n.tooltip){s=r.getOptions();if(f||l)f&&(s.title=$.proxy(o,c)),l&&(s.content=$.proxy(u,c));if(c.type==="line"||c.type==="marker"){c.type==="marker"&&(c=c.lineSeries);if(c.path.removed)return;if(n.hoverLine!==c||n.hoverLine===null)n.isNewLine=!0,n.hoverLine&&(n.hoverLine.path.removed||(n.hoverLine.path.wijAttr(n.hoverLine.lineStyle),n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1")))),c.lineHoverStyle&&c.path.wijAttr(c.lineHoverStyle),n.hoverLine=c,n.hoverPoint=null,n.hoverVirtualPoint=null}else c.type==="scatter"||i.relativeTo==="element"?(n._clearHoverState(),c.type==="scatter"?h=c.dot.getBBox():t[0]&&t[0].raphael&&t[0].raphaelid&&(d=n.canvas.getById(t[0].raphaelid),d&&(h=d.getBBox())),s.style.stroke=a.stroke||t.attr("stroke"),h&&n.tooltip.showAt({x:h.x+h.width/2,y:h.y},e)):(n._clearHoverState(),s.style.stroke=a.stroke||t.attr("stroke"),n.tooltip.showAt({x:e.pageX-p.left,y:e.pageY-p.top},e))}},i.prototype._tooltipMouseMove=function(e){var t=this,n=e.target,r,i=t.options.hint,s=$(t.canvas.canvas.parentNode).offset();$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),t.tooltip&&!this.indicatorLine&&r.type!=="line"&&r.type!=="marker"&&r.type!=="scatter"&&i.relativeTo!=="element"&&t.tooltip.showAt({x:e.pageX-s.left,y:e.pageY-s.top},e)},i.prototype._tooltipMouseOut=function(e){var t=this,n=e.target,r;$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),r.type!=="line"&&r.type!=="marker"&&!t.indicatorLine&&t.tooltip&&t.tooltip.hide()},i.prototype._mouseMoveInsidePlotArea=function(e,t){var n=this,i=n.tooltip,s=n.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0,E;i&&(v=i.getOptions());if(n.hoverLine&&!n.indicatorLine){E=n.hoverLine,n.isNewLine&&(s.enable&&i&&i.hide(),n.isNewLine=!1),o=E.lineMarkers,u=E.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,n){if(n.removed)return!0;var r=n.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-t.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(n.hoverPoint&&n.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.removed||(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),n.hoverPoint=l,n.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,n){var r=Math.abs(n.x-t.left);if(e===0||r<w)w=r,a=e,f={x:n.x,y:n.y}});if(n.hoverVirtualPoint&&n.hoverVirtualPoint.index===a)return;a>-1&&(n.hoverPoint=null,n.hoverVirtualPoint=u[a])}if(i){d=n.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:E.path.attr("stroke")},s.style),v.style.stroke=p.stroke,i.showAt(f)}}r.prototype._mouseMoveInsidePlotArea.call(this,e,t)},i.prototype._mouseDownInsidePlotArea=function(e,t){r.prototype._mouseDownInsidePlotArea.call(this,e,t),this._clearHoverState(!0)},i.prototype._mouseMoveOutsidePlotArea=function(e,t){var n=this;n._clearHoverState(),r.prototype._mouseMoveOutsidePlotArea.call(this,e,t)},i.prototype._clearHoverState=function(e){var t=this,n=t.tooltip,r=t.options.hint;t.hoverLine&&(r.enable&&n&&!e&&n.hide(),t.hoverLine.path.removed||(t.hoverLine.path.wijAttr(t.hoverLine.lineStyle),t.hoverPoint&&!t.hoverPoint.isSymbol&&(t.hoverPoint.marker.wijAttr(t.hoverPoint.markerStyle),t.hoverPoint.marker.transform("s1")))),t.hoverLine=null,t.hoverPoint=null,t.hoverVirtualPoint=null},i.prototype._getTooltipText=function(e,t){return""},i.prototype._calculateParameters=function(e,t){var i=this,s=!1,o,u=0,a=0,f,l=e.max,c=e.min;r.prototype._calculateParameters.call(this,e,t),e.max=Math.max(l,e.max),c!==0&&(e.min=Math.min(c,e.min)),$.each(i.options.seriesList,function(e,t){if(t.type==="column"||t.type==="bar")return s=!0,!1}),e.id==="x"&&(o=t.unitMinor,s&&(u=a=Math.max(u,i._getBarAdjustment(e,o))),i.isContainsCandlestick&&n&&(u=a=Math.max(u,n.prototype._getCandlestickAdjustment.apply(this,[e,o])))),i.isContainsBubble&&$.wijmo.wijbubblechart&&(f=this.bubbleAxisAdjust.getAdjust(e,t),u=Math.max(u,f.max-e.max),a=Math.max(a,e.min-f.min)),a&&(e.min-=a),u&&(e.max+=u),(u||a)&&i._calculateMajorMinor(t,e)},i.prototype._getBarAdjustment=function(e,t){var n=0,r=this.options,i=e.max,s=e.min,o=0,u;return $.each(r.seriesList,function(e,t){if(t.type==="pie")return!0;if(t.data.x===undefined||t.data.y===undefined)return!0;o=t.data.x.length,n<o&&(n=o)}),n>1?u=(i-s)/n*r.clusterWidth*.0125:n===1?(s===0&&i===1&&(s=-1,e.min=s),u=(i-s)*.0125):u=0,u===0?u=t:t<u&&t!==0&&(u=Math.floor(u/t)*t),u},i}(t.wijchartcore);t.wijcompositechart=r,r.prototype.widgetEventPrefix="wijcompositechart";var i=function(){function e(){this.initSelector=":jqmData(role='wijcompositechart')",this.wijCSS={compositechart:"wijmo-wijcompositechart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol",scatterElement:"wijscatterchart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker",wijCandlestickChart:"wijmo-wijcandlestickchart",candlestickChart:"wijcandlestickchart",candlestickChartTracker:"candlesticktracker"},this.stacked=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.seriesList=[],this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();r.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new i),$.wijmo.registerWidget("wijcompositechart",r.prototype)})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijdatepager",i="wijmo-wijdatepager",s="wijmo-wijdatepager-increment",o="wijmo-wijdatepager-decrement",u="wijmo-wijdatepager-container",a="wijmo-wijdatepager-pages",f="wijmo-wijdatepager-pagelabel",l="wijmo-wijdatepager-pagelabel-first",c="wijmo-wijdatepager-pagelabel-last",h="wijmo-wijdatepager-pageheader",p="wijmo-wijdatepager-pagerange",d="wijmo-wijdatepager-tooltip",v="wijmo-wijdatepager-tooltip-inner",m="wijmo-wijdatepager-triangle",g="wijmo-wijdatepager-width-smallest",y="wijmo-wijdatepager-width-small",b="wijmo-wijdatepager-width-medium",w="wijmo-wijdatepager-width-normal",E=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(e,t){n.wijmo.widget.prototype._setOption.apply(this,arguments);switch(e){case"culture":this.options.culture=t,this._initBackground();break;case"selectedDate":this.options.selectedDate=t,this._initBackground();break;case"disabled":t?this._disable():this._enable();break;case"viewType":this.options.viewType=t,this._initBackground();break;case"nextTooltip":this.element.find("."+s).attr("title",t);break;case"prevTooltip":this.element.find("."+o).attr("title",t);break;case"firstDayOfWeek":this.options.firstDayOfWeek=t,this.options.viewType==="week"&&this._initBackground()}return this},t.prototype._disable=function(){this.element.addClass(this.options.wijCSS.stateDisabled),n.mobile==null?(this.element.find("."+o).button("option","disabled",!0),this.element.find("."+s).button("option","disabled",!0)):(this.element.find("."+o).addClass(this.options.wijCSS.stateDisabled),this.element.find("."+s).addClass(this.options.wijCSS.stateDisabled))},t.prototype._enable=function(){this.element.removeClass(this.options.wijCSS.stateDisabled),n.mobile==null?(this.element.find("."+o).button("option","disabled",!1),this.element.find("."+s).button("option","disabled",!1)):(this.element.find("."+o).removeClass(this.options.wijCSS.stateDisabled),this.element.find("."+s).removeClass(this.options.wijCSS.stateDisabled))},t.prototype._create=function(){var e=this.options,t,r,f;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.selectedDate||(e.selectedDate=new Date),this._dtpagernamespacekey="dtpager"+(new Date).getTime(),this.element.addClass(i).addClass(e.wijCSS.wijdatepager).addClass(e.wijCSS.widget).addClass(e.wijCSS.helperClearFix),t=n.proxy(this.invalidate,this),n(window).bind("resize."+this._dtpagernamespacekey,t),this.element.disableSelection&&this.element.disableSelection(),this.element.append(n("<a></a>").addClass(o).addClass(e.wijCSS.wijdatepagerDecButton).append(n("<span>"+e.prevTooltip+"</span>"))).append(n("<div></div>").addClass(u).addClass(e.wijCSS.wijdatepagerContainer).addClass(e.wijCSS.content).append(n("<div></div>").addClass(a).addClass(e.wijCSS.wijdatepagerPages))).append(n("<a></a>").addClass(s).addClass(e.wijCSS.wijdatepagerIncButton).append(n("<span>"+e.nextTooltip+"</span>"))),n.wijmo.widget.prototype._create.apply(this,arguments),r=this.element.find("."+o),f=this.element.find("."+s),n.mobile==null?(r.button({icons:{primary:e.wijCSS.iconArrowLeft},text:!1}),f.button({icons:{primary:e.wijCSS.iconArrowRight},text:!1})):(r.html(""),r.addClass(e.wijCSS.iconArrowLeft+" "+e.wijCSS.icon+" ui-btn"),f.html(""),f.addClass(e.wijCSS.iconArrowRight+" "+e.wijCSS.icon+" ui-btn")),r.click(n.proxy(this.goLeft,this)),f.click(n.proxy(this.goRight,this)),this._initBackground(),e.disabled&&this._disable()},t.prototype.destroy=function(){this.element.removeClass(i).removeClass(this.options.wijCSS.wijdatepager),n(window).unbind("."+this._dtpagernamespacekey)},t.prototype.refresh=function(){this.invalidate()},t.prototype.invalidate=function(){var e,t=this.options,r=t.selectedDate,i,l=this.element.find("."+u),c=this.element.find("."+o),h=this.element.find("."+s),p=this.element.innerWidth(),d=c.is(":visible")?c.outerWidth(!0):0,v=h.is(":visible")?h.outerWidth(!0):0,m,E,S,x,T;e=this.element.find("."+f+"."+this._getDateClass(r)),e.length!==1?e=n(this.element.find("."+f)[this._index]):(i=this.element.find("."+f).index(e),this._index=i),T="."+f,x=t.wijCSS.stateActive.split(" "),n.each(x,function(e){T+="."+x[e]}),this.element.find(T).removeClass(t.wijCSS.stateActive),e.addClass(this.options.wijCSS.stateActive),l.css("left",d),this.element.removeClass(g).removeClass(t.wijCSS.wijdatepagerWidthSmallest).removeClass(y).removeClass(t.wijCSS.wijdatepagerWidthSmall).removeClass(b).removeClass(t.wijCSS.wijdatepagerWidthMedium).removeClass(w).removeClass(t.wijCSS.wijdatepagerWidthNormal),p<300?this.element.addClass(g).addClass(t.wijCSS.wijdatepagerWidthSmallest):p<475?this.element.addClass(y).addClass(t.wijCSS.wijdatepagerWidthSmall):p<600?this.element.addClass(b).addClass(t.wijCSS.wijdatepagerWidthMedium):this.element.addClass(w).addClass(t.wijCSS.wijdatepagerWidthNormal),l.outerWidth(p-d-v),n.browser.msie&&parseInt(n.browser.version,10)<=7&&(m=this.element.find("."+a),E=m.find("."+f),S=Math.round(m.width()/this._datesDef.length)-(E.outerWidth(!0)-E.width()),E.width(S))},t.prototype.goLeft=function(e){var t=this.options;if(t.disabled)return;this._setSelectedIndex(this._index-1,!0);if(e)return e.preventDefault(),!1},t.prototype.goRight=function(){var e=this.options;if(e.disabled)return;this._setSelectedIndex(this._index+1)},t.prototype._getCulture=function(e){return typeof e=="undefined"&&(e=null),Globalize.findClosestCulture(e||this.options.culture)},t.prototype._isRTL=function(){return!!this._getCulture().isRTL},t.prototype._initBackground=function(e,t){typeof e=="undefined"&&(e=!1),typeof t=="undefined"&&(t=!1);var r=this,i,s,o,u,d,v=this,m=v.options,g,y=n("<div></div>");if(this._isInAnimate)return;this._index=0,this._datesDef=this._getDatesDefinition(),this._min=0,this._max=this._datesDef.length-1,n.each(this._datesDef,function(e,t){var i=n("<div>"+r._datesDef[e].l+"</div>").addClass(f).addClass(m.wijCSS.wijdatepagerPageLabel).addClass(r._getDateClass(t.d));e===0&&i.addClass(l).addClass(m.wijCSS.wijdatepagerPageLabelFirst),t.range&&i.addClass(p).addClass(m.wijCSS.wijdatepagerPageRange),t.header&&i.addClass(h).addClass(m.wijCSS.wijdatepagerPageHeader).addClass(m.wijCSS.stateHighlight),e===r._max&&i.addClass(c).addClass(m.wijCSS.wijdatepagerPageLabelLast),y.append(i)}),i=y.html(),o=this.element.find("."+a),e?(this._isInAnimate=!0,s=o.clone(!0),o.html(i),u=o.find("."+f),t?(s.insertAfter(o),d=n(u[this._index]).offset().left,o.css("opacity",0).css("left",-s.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),s.css("left",0).stop().animate({left:s.outerWidth(!0)+"px",opacity:0},function(){s.remove(),v._isInAnimate=!1,v.invalidate()})):(s.insertBefore(o),d=n(u[this._index]).offset().left,o.css("opacity",0).css("left",s.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),s.stop().animate({left:"-"+s.outerWidth(!0)+"px",opacity:0},function(){s.remove(),v._isInAnimate=!1,v.invalidate()}))):(o.html(i),this.invalidate()),u=o.find("."+f),u.hover(n.proxy(this._pagelabelHover,this),n.proxy(this._pagelabelHout,this)),u.bind("mousedown",n.proxy(this._pagelabelMouseDown,this)),u.click(n.proxy(function(e){var t=n(e.target),r;r=this.element.find("."+f).index(t),this._setSelectedIndex(r)},this))},t.prototype._getDateClass=function(e){return"c1dt"+e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()},t.prototype._addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},t.prototype._getDatesDefinition=function(){var e=this.options,t=e.viewType.toLowerCase(),n,r,i,s,o,u=[],a=e.selectedDate;switch(t){case"week":i=new Date(a.getFullYear(),a.getMonth(),-6),n=e.firstDayOfWeek-i.getDay(),Math.abs(n)>6&&(n=i.getDay()-e.firstDayOfWeek),i=this._addDays(i,n),o=new Date(a.getFullYear(),a.getMonth()+1,7),n=0;while(i<o||i.getMonth()===a.getMonth())s=this._addDays(i,7),u.push({l:this._formatString(this.localizeString("weekViewLabelFormat","{0:MMM dd}-{1:dd}"),i,this._addDays(i,6)),d:i,d2:this._addDays(i,6)}),a>=i&&a<=s&&(this._index=n),i=s,n+=1;break;case"month":r=new Date(a.getFullYear()-1,0,1),u.push({l:r.getFullYear(),d:r,range:!0}),r=new Date(a.getFullYear(),0,1),u.push({l:r.getFullYear(),d:r,header:!0});for(n=0;n<12;n+=1)r=new Date(a.getFullYear(),n,1),u.push({l:this._formatString(this.localizeString("monthViewLabelFormat","{0:MMM}"),r),d:r}),s=new Date(a.getFullYear(),n+1,1),a>=r&&a<=s&&(this._index=n+2);r=new Date(a.getFullYear()+1,0,1),u.push({l:r.getFullYear(),d:r,range:!0});break;default:r=new Date(a.getFullYear(),a.getMonth(),0),u.push({l:Globalize.format(r,"MMM",this._getCulture()),d:r,range:!0}),r=new Date(a.getFullYear(),a.getMonth(),1),u.push({l:Globalize.format(r,"MMM",this._getCulture()),d:r,header:!0}),i=r,n=2;while(i.getMonth()===a.getMonth())s=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1),u.push({l:this._formatString(this.localizeString("dayViewLabelFormat","{0:d }"),i),d:i}),a>=i&&a<=s&&(this._index=n),i=s,n+=1;r=new Date(a.getFullYear(),a.getMonth()+1,1),u.push({l:Globalize.format(r,"MMM",this._getCulture()),d:r,range:!0})}return u},t.prototype._setSelectedIndex=function(e,t){typeof t=="undefined"&&(t=!1);var n=this.options,r;if(n.disabled)return;if(e>=this._min&&e<=this._max){this._dragActivated&&this._showTooltip(e);if(this._index!==e){if(this._datesDef[e].header){if(!t)return;e-=1}this._index=e,r=this._datesDef[e].d,n.selectedDate=r,this._max>2&&this._index===0?this._initBackground(!0,!0):this._index===this._max?(n.viewType==="week"&&(n.selectedDate=new Date(n.selectedDate.getFullYear(),n.selectedDate.getMonth(),n.selectedDate.getDate()+7)),this._initBackground(!0,!1),n.selectedDate=r):this.invalidate(),this._trigger("selectedDateChanged",null,{selectedDate:n.selectedDate})}}},t.prototype._pagelabelHover=function(e){var t=n(e.target),r=this.options;if(t.hasClass(h))return;t.addClass(r.wijCSS.stateHover)},t.prototype._showTooltip=function(e){var t=this.options,r=this._datesDef[e],i=t.viewType,s,o=this.element.find("."+f)[e];this._tooltip||(this._tooltip=n("<div></div>").addClass(d).addClass(t.wijCSS.wijdatepagerTooltip).append(n("<div></div>").addClass(v).addClass(t.wijCSS.wijdatepagerTooltipInner)).append(n("<div></div>").addClass(m).addClass(t.wijCSS.wijdatepagerTriangle)),this.element.append(this._tooltip),this._tooltip.wijpopup()),s="";switch(i){case"week":r.d.getMonth()!==r.d2.getMonth()?s=this._formatString(this.localizeString("weekViewTooltip2MonthesFormat","{0:MMMM d} - {1:MMMM d, yyyy}"),r.d,r.d2):s=this._formatString(this.localizeString("weekViewTooltipFormat","{0:MMMM d} - {1:d, yyyy}"),r.d,r.d2);break;case"month":s=this._formatString(this.localizeString("monthViewTooltipFormat","{0:MMMM yyyy}"),r.d);break;default:s=this._formatString(this.localizeString("dayViewTooltipFormat","{0:dddd, MMMM d, yyyy}"),r.d)}n.ui&&(this._tooltip.wijpopup("show",{of:o,my:"center bottom",at:"center top",offset:"-10 -10"}),this._tooltip.find("."+v).html(s))},t.prototype._hideTooltip=function(){this._tooltip.wijpopup("hide")},t.prototype._pagelabelHout=function(e){n(e.target).removeClass(this.options.wijCSS.stateHover)},t.prototype._pagelabelMouseDown=function(e){this._dragActivated=!1;if(this.options.disabled)return;e.preventDefault();var t=n(e.target),r;if(t.hasClass(h))return;r=this.element.find("."+f).index(t),this._dragActivated=!0,this._setSelectedIndex(r),this._mouseDownTimeFix20555=(new Date).getTime(),this._startClientX=e.pageX,this._startInd=r,n(document).bind("mousemove."+this._dtpagernamespacekey,n.proxy(this._pageindicatorMouseMove,this)),n(document).bind("mouseup."+this._dtpagernamespacekey,n.proxy(this._pageindicatorMouseUp,this))},t.prototype._detectLeftButton=function(e){return e.originalEvent&&(e=e.originalEvent),"buttons"in e?e.buttons===1:"which"in e?e.which===1:e.button===1},t.prototype._pageindicatorMouseMove=function(e){if(!this._detectLeftButton(e)){this._pageindicatorMouseUp();return}e.preventDefault();if(this._isInAnimate)return;var t=this.element.find("."+f)[this._startInd],n,r;if(!t)return;n=t.offsetLeft+Math.round(t.offsetWidth/2)+(e.pageX-this._startClientX),r=this._findClosesPageIndexByPos(n);if(this._prevMoveInd===r)return;this._prevMoveInd=r;if(this._mouseDownTimeFix20555+150>(new Date).getTime())return;r!==-1&&r!==this._index&&this._setSelectedIndex(r)},t.prototype._pageindicatorMouseUp=function(){this._dragActivated=!1,n(document).unbind("."+this._dtpagernamespacekey),this._hideTooltip()},t.prototype._findClosesPageIndexByPos=function(e){var t=this.element.find("."+a).find("."+f),n;for(n=0;n<t.length;n+=1)if(t[n].offsetLeft<e&&t[n].offsetLeft+t[n].offsetWidth>e)return n;return-1},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._formatString=function(e,t,n,r){var i,s=arguments,o,u,a=this;if(s.length<=1)return Globalize.format(s);typeof e=="string"&&typeof window[e]=="function"&&(e=window[e]);if(typeof e=="function"){u=[];for(o=1;o<s.length;o+=1)u[o-1]=s[o];return e.apply(this,u)}return i=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),e.replace(i,function(e,t,n,r,i){return e=s[Number(t)+1],r?Globalize.format(e,r,a._getCulture()):e})},t}(e.wijmoWidget);t.wijdatepager=E;var S=function(){function e(){this.wijCSS={wijdatepager:"",wijdatepagerIncButton:"",wijdatepagerDecButton:"",wijdatepagerContainer:"",wijdatepagerPages:"",wijdatepagerPageLabel:"",wijdatepagerPageLabelFirst:"",wijdatepagerPageLabelLast:"",wijdatepagerPageHeader:"",wijdatepagerPageRange:"",wijdatepagerTooltip:"",wijdatepagerTooltipInner:"",wijdatepagerTriangle:"",wijdatepagerWidthSmallest:"",wijdatepagerWidthSmall:"",wijdatepagerWidthMedium:"",wijdatepagerWidthNormal:""},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-b",stateDefault:"ui-btn ui-btn-b"},this.initSelector=":jqmData(role='wijdatepager')",this.culture="",this.localization=null,this.firstDayOfWeek=0,this.selectedDate=null,this.viewType="day",this.nextTooltip="right",this.prevTooltip="left",this.selectedDateChanged=null}return e}();E.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new S),n.wijmo.registerWidget(r,E.prototype)})(e.datepager||(e.datepager={}));var t=e.datepager})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function i(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function s(){var e,t,n;e="";for(n=0;n<32;n+=1){if(n===8||n===12||n===16||n===20)e+="-";t=Math.floor(Math.random()*16).toString(16).toUpperCase(),e+=t}return e}function c(e,t,n){f?(l=amplify.store("wijevcal_tables1"),l||(l={}),l[e]||(l[e]={fields:t},amplify.store("wijevcal_tables1",l),amplify.store("wijevcal_tbl_"+e,{})),n&&n()):o&&o.transaction(function(r){r.executeSql("SELECT COUNT(*) FROM "+e,[],function(){n&&n()},function(r,i){r.executeSql("CREATE TABLE "+e+" "+t,[],n,n)})})}function h(e,t,n,r){var i={rowsAffected:0,rows:new Array},s,u,a,c,h,p,d,v,m,g,y,b,w,E;t||(t=[]),i.rows.item||(i.rows.item=function(e){return this[e]});if(f)try{a=new RegExp("(SELECT) *(.*) *FROM (\\w+)"),c=new RegExp("(INSERT OR REPLACE|INSERT) *(.*) *INTO *(\\w*) *\\(([\\w|,| ]*)\\)"),h=new RegExp("(DELETE) *(.*) *FROM (\\w+) *(\\w*)WHERE (\\w+)='*([^']+)");if(e.match(c)){p=c.exec(e);if(p&&p.length>1){d=p[3],v=l[d],m=amplify.store("wijevcal_tbl_"+d);if(m){y=p[4].split(","),s={};for(u=0;u<y.length;u+=1)y[u]&&(u===0&&(m[t[u]]=s),b=y[u].replace(" ",""),s[b]=t[u])}amplify.store("wijevcal_tbl_"+d,m)}}else if(e.match(a)){p=a.exec(e);if(p&&p.length>1){d=p[3],v=l[d],m=amplify.store("wijevcal_tbl_"+d);if(m){w=e.replace(a,"");if(w.toUpperCase().indexOf(" WHERE ")===0){w=w.substr(7),E=w.split(" OR ");for(u=0;u<E.length;u+=1)E[u]=E[u].split("="),w=E[u][1],w.indexOf("'")===0?(w=w.substring(1,w.length-1),E[u][1]=w):E[u][1]=parseFloat(w)}for(g in m)if(m.hasOwnProperty(g)){s=m[g];if(s)if(E)for(u=0;u<E.length;u+=1)s[E[u][0]]===E[u][1]&&i.rows.push(s);else i.rows.push(s)}}}}else e.match(h)&&(p=h.exec(e),p&&p.length>1&&(d=p[3],v=l[d],m=amplify.store("wijevcal_tbl_"+d),m&&m[p[6]]&&delete m[p[6]],amplify.store("wijevcal_tbl_"+d,m)));n&&n(i)}catch(S){r&&r(S)}else{if(!o){r("Local data storage not found.");return}o.transaction(function(i){i.executeSql(e,t,function(e,t){n&&n(t)},function(e,t){r&&r(t.message);return})})}}var n=jQuery,r="wijevcal",o,u="C1EventsCalendarDB",a="1.1",f=!1,l,p=function(e){function t(){e.apply(this,arguments),this._dynIdCounter=0}return __extends(t,e),t.prototype._setOption=function(e,t){var r=this,i=n.when.apply(this,r._defferObjs),s;i.always(function(){r._setOptionCallbacks.fire(),r._setOptionCallbacks.empty(),r._defferObjs=[]}),i.state()==="pending"?this._setOptionCallbacks.add(function(){n.isPlainObject(t)?s=n.extend(!0,{},t):n.isArray(t)?s=[].concat(t):s=t,r._setOptionInternal(e,s)}):this._setOptionInternal(e,t)},t.prototype._setOptionInternal=function(e,t){var r=this.options,s;switch(e){case"dataSource":r.dataSource=t,this._needLoadLocalStorage=!1,r.eventsData=[],this._bindDataView();break;case"eventsData":r.eventsData=t,r.appointments=t,this._needLoadLocalStorage=!1,this._onEventsDataChanged(),this._bindEvents();break;case"appointments":r.eventsData=t,r.appointments=t,this._needLoadLocalStorage=!1,this._onEventsDataChanged(),this._bindEvents();break;case"localization":this._setLocalization(t);break;case"culture":r.culture=t,this.element.find(".wijmo-wijdatepager").wijdatepager("option","culture",r.culture),this._editEventDialog&&this._editEventDialog.find(".wijmo-wijinput-date").wijinputdate("option","culture",r.culture),this.element.find(".wijmo-wijcalendar").wijcalendar("option","culture",r.culture),this._redrawActiveView();break;case"disabled":r.disabled!==t&&(r.disabled=t,this._ensureDisabled());break;case"enableLogs":r.enableLogs=t,this._initLogPanel();break;case"selectedDate":t&&(t=i(t),r.selectedDates[0].getTime()!==t.getTime()&&(r.selectedDates[0]=t,this._onSelectedDatesChanged()));return;case"selectedDates":t&&(r.selectedDates=t,this._onSelectedDatesChanged());return;case"statusBarVisible":r.statusBarVisible=t,this._initStatusbar(),this.invalidate();return;case"headerBarVisible":r.headerBarVisible=t,this._initHeaderbar(),this.invalidate();return;case"navigationBarVisible":r.navigationBarVisible=t,this._initNavigationbar(),this.invalidate();return;case"rightPaneVisible":r.rightPaneVisible=t,this._initRightPane(),this.invalidate();return;case"timeInterval":case"timeIntervalHeight":case"timeRulerInterval":case"timeRulerFormat":r[e]!==t&&(r[e]=t,this._redrawActiveView());break;case"firstDayOfWeek":r[e]!==t&&(r[e]=t,this._redrawActiveView(),s=this._getCulture(),s&&s.calendar&&(s.calendar.firstDay=t,this.element.find(".wijmo-wijcalendar").wijcalendar("refresh")));break;case"viewType":if(r.viewType!==t){r.viewType=t;if(t.toLowerCase()==="day"||t.toLowerCase()==="list")r.selectedDates=[r.selectedDate];this._onViewTypeChanged()}break;default:}n.wijmo.widget.prototype._setOption.apply(this,arguments)},t.prototype._setLocalization=function(e){this._destroyInternal(),this.options.localization=e,this._create(),this._init()},t.prototype._ensureDisabled=function(){var e=this.options;if(e.disabled){this.element.addClass(e.wijCSS.stateDisabled);try{this.element.find(".wijmo-wijcalendar").wijcalendar("option","disabled",!0),this.element.find(".wijmo-wijsuperpanel").wijsuperpanel("option","disabled",!0),this.element.find(".wijmo-wijdatepager").wijdatepager("option","disabled",!0),n().buttonset&&this.element.find(".ui-buttonset").buttonset("option","disabled",!0),this.element.find(".wijmo-wijev-today.ui-button").button("option","disabled",!0)}catch(t){this.log(t,"error")}this._unbindEvents()}else{this.element.removeClass(e.wijCSS.stateDisabled);try{this.element.find(".wijmo-wijcalendar").wijcalendar("option","disabled",!1),this.element.find(".wijmo-wijsuperpanel").wijsuperpanel("option","disabled",!1),this.element.find(".wijmo-wijdatepager").wijdatepager("option","disabled",!1),n().buttonset&&this.element.find(".ui-buttonset").buttonset("option","disabled",!1),this.element.find(".wijmo-wijev-today.ui-button").button("option","disabled",!1)}catch(t){this.log(t,"error")}this._bindEvents(),this._updateTitleText()}},t.prototype._onViewTypeChanged=function(){this._renderActiveView(),this._updateTitleText(),this._trigger("viewTypeChanged",null,this.options.viewType),this.element.find(".wijmo-wijev-datepager").wijdatepager("option","viewType",this.options.viewType)},t.prototype._onSelectedDatesChanged=function(){var e=this.options;e.selectedDate=e.selectedDates[0],this.element.find(".wijmo-wijev-datepager").wijdatepager("option","selectedDate",e.selectedDate),this._trigger("selectedDatesChanged",null,{selectedDates:e.selectedDates}),this._renderActiveView(),this._updateTitleText()},t.prototype._updateHeaderTitleText=function(){var e=this.options,t=e.titleFormat,n=e.selectedDates[0],r=e.selectedDates[e.selectedDates.length-1];if(t[e.viewType])t=t[e.viewType];else{if(t[e.viewType]===!1){this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title").hide();return}t=t.toString()}e.viewType==="list"&&(r=this._addDays(n,14)),this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title").show().html(this._formatString(t,n,r))},t.prototype._updateTitleText=function(){var e=this.options,t=e.selectedDates[0],r=e.selectedDates[e.selectedDates.length-1],i=new Date,s=!1;s=this._compareDayDates(t,i)===0||t<i&&r>i,n.mobile==null&&this.element.find(".wijmo-wijev-navigationbar .wijmo-wijev-today").button("option","disabled",s),this._updateHeaderTitleText()},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._defferObjs=[],this._chromeLoadDataDeffer=n.Deferred(),this._defferObjs.push(this._chromeLoadDataDeffer),this._setOptionCallbacks=n.Callbacks("once"),this._needLoadLocalStorage=!0;if(this.options.appointments&&this.options.appointments.length||this.options.eventsData&&this.options.eventsData.length)this._needLoadLocalStorage=!1;n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options);var t,r,i=this.options;i.colors||(i.colors=["red","darkorchid","green","blue","cornflowerblue","yellow","bronze"]),this.wijevcalnamespacekey||(this.wijevcalnamespacekey="wijevcal"+(new Date).getTime()),this.element[0].id||(this.element[0].id="wijevcal_dynid_"+(new Date).getTime()),this._uidPref=this.element[0].id+"evcdynid",this.element.addClass("wijmo-wijevcal wijmo-wijev "+i.wijCSS.widget+" "+i.wijCSS.helperReset+" "+i.wijCSS.stateDefault),n('<div class="wijmo-wijev-headerbar '+i.wijCSS.header+" "+i.wijCSS.cornerTop+'">'+'<fieldset class="wijmo-wijev-tools">'+'<input id="'+this._uidPref+'_daybtn" name="viewselection"'+' type="radio" class="wijmo-wijev-day" />'+'<label for="'+this._uidPref+'_daybtn">'+this.localizeString("buttonDayView","Day")+"</label>"+'<input id="'+this._uidPref+'_weekbtn" name="viewselection"'+' type="radio" class="wijmo-wijev-week" />'+'<label for="'+this._uidPref+'_weekbtn">'+this.localizeString("buttonWeekView","Week")+"</label>"+'<input id="'+this._uidPref+'_monthbtn" name="viewselection"'+' type="radio" class="wijmo-wijev-month" />'+'<label for="'+this._uidPref+'_monthbtn">'+this.localizeString("buttonMonthView","Month")+"</label>"+'<input id="'+this._uidPref+'_listbtn" name="viewselection"'+' type="radio" class="wijmo-wijev-list" />'+'<label for="'+this._uidPref+'_listbtn">'+this.localizeString("buttonListView","List")+"</label>"+"</fieldset>"+"</div>").appendTo(this.element),n('<div class="wijmo-wijev-view-container"><div class="wijmo-wijev-leftpane wijmo-wijev-viewdetails '+i.wijCSS.content+' wijmo-wijev-day-details">'+'<div class="wijmo-wijev-leftpane-inner">'+'<div class="wijmo-wijev-daycalendar"></div>'+'<div class="wijmo-wijev-monthday-container">'+'<div class="wijmo-wijev-monthday-label">...</div>'+'<div class="wijmo-wijev-fulldate-label">'+this.localizeString("activityLoading","Loading...")+"</div>"+'<div class="wijmo-wijev-year-label">...</div>'+"</div>"+'<div class="wijmo-wijev-agenda-container '+i.wijCSS.content+" "+i.wijCSS.cornerAll+" "+i.wijCSS.helperClearFix+'"></div>'+"</div>"+"</div>"+'<div class="wijmo-wijev-leftpane wijmo-wijev-viewdetails '+i.wijCSS.content+' wijmo-wijev-list-details">'+'<div class="wijmo-wijev-leftpane-inner">'+'<div class="wijmo-wijev-agenda-container '+i.wijCSS.content+" "+i.wijCSS.cornerAll+" "+i.wijCSS.helperClearFix+'">&nbsp;'+"</div>"+"</div>"+"</div>"+'<div class="wijmo-wijev-rightpane">'+"&nbsp;</div>"+"</div>").appendTo(this.element),n('<div class="wijmo-wijev-loading-modal-frame"></div><div class="wijmo-wijev-loading"><div class="wijmo-wijev-loading-text">'+this.localizeString("activityLoading","Loading...")+"</div></div>").appendTo(this.element),n('<div class="wijmo-wijev-navigationbar '+i.wijCSS.header+" "+i.wijCSS.cornerBottom+" "+i.wijCSS.helperClearFix+'">'+'<a class="wijmo-wijev-today">'+this.localizeString("buttonToday","today")+"</a>"+'<div class="wijmo-wijev-datepager">'+"</div>"+"</div>").appendTo(this.element),n('<div class="wijmo-wijev-statusbar '+i.wijCSS.header+" "+i.wijCSS.cornerBottom+'">'+"</div>").appendTo(this.element),t=this.element.find(".wijmo-wijev-navigationbar"),r=this.element.find(".wijmo-wijev-headerbar .wijmo-wijev-tools"),n.mobile!=null?t.find(".wijmo-wijev-today").addClass("ui-btn ui-btn-corner-all").click(n.proxy(this._onTodayClick,this)):t.find(".wijmo-wijev-today").button({text:this.localizeString("buttonToday","today")}).click(n.proxy(this._onTodayClick,this)),this.element.find(".wijmo-wijev-datepager").wijdatepager({selectedDate:i.selectedDate,localization:i.datePagerLocalization,culture:i.culture,viewType:i.viewType,nextTooltip:this.localizeString("navigatorBarNextTooltip","right"),prevTooltip:this.localizeString("navigatorBarPrevTooltip","left"),firstDayOfWeek:i.firstDayOfWeek,selectedDateChanged:n.proxy(function(e,t){this.goToDate(t.selectedDate)},this)}),n.mobile==null?(r.find(".wijmo-wijev-day").button().button("widget").addClass(i.wijCSS.stateDefault),r.find(".wijmo-wijev-week").button().button("widget").addClass(i.wijCSS.stateDefault),r.find(".wijmo-wijev-month").button().button("widget").addClass(i.wijCSS.stateDefault),r.find(".wijmo-wijev-list").button().button("widget").addClass(i.wijCSS.stateDefault),r.buttonset()):(r.attr("data-role","controlgroup"),r.attr("data-type","horizontal"),r.parent().trigger("create"),r.controlgroup("refresh")),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver(),e._redrawActiveView()},"wijevcal"),r.find(".wijmo-wijev-day").click(n.proxy(this._onDayViewClick,this)),r.find(".wijmo-wijev-week").click(n.proxy(this._onWeekViewClick,this)),r.find(".wijmo-wijev-month").click(n.proxy(this._onMonthViewClick,this)),r.find(".wijmo-wijev-list").click(n.proxy(this._onListViewClick,this)),this.showLoadingLabel()},t.prototype.showLoadingLabel=function(e,t){e===!1?this.element.find(".wijmo-wijev-loading-text").hide():(this.element.find(".wijmo-wijev-loading-text").show(),e||(e=this.localizeString("activityLoading","Loading..."))),(t===undefined||t===!0)&&this.element.find(".wijmo-wijev-loading-modal-frame").show(),this.element.find(".wijmo-wijev-loading").show(),this.element.find(".wijmo-wijev-loading-text").html(e)},t.prototype.hideLoadingLabel=function(){this.element.find(".wijmo-wijev-loading-modal-frame").hide(),this.element.find(".wijmo-wijev-loading").hide()},t.prototype._init=function(){var e=this.options;e.selectedDates&&e.selectedDates.length>0?e.selectedDate=e.selectedDates[0]=i(e.selectedDates[0]):e.selectedDate?(e.selectedDate=i(e.selectedDate),e.selectedDates||(e.selectedDates=[]),e.selectedDates[0]=e.selectedDate):(e.selectedDate=i(new Date),e.selectedDates=[e.selectedDate]),e.disabled&&this.element.addClass(e.wijCSS.stateDisabled),this._initHeaderbar(),this._initNavigationbar(),this._initStatusbar(),this._initRightPane(),e.fullScreen&&this._onFullScreenModeChanged(e.fullScreen),this._initLogPanel(),this._initLocalDataStorage(),this.element.ajaxError(jQuery.proxy(this._onAjaxError,this)),n(window).bind("resize."+this.wijevcalnamespacekey,n.proxy(this._onWindowResize,this)),this._renderActiveView(),this._bindDataView()},t.prototype._onFullScreenModeChanged=function(e){},t.prototype._isDataViewLoaded=function(e){return e&&(e.isLoaded()||e.count()>0)},t.prototype._isDataview=function(e){if(e&&typeof e=="object"&&!n.isArray(e))return!0},t.prototype._getDataViewInst=function(){return this.element.data("wijdataview")},t.prototype._bindDataView=function(){var e=this.options,t=e.dataSource,t,n=this;!t&&this._getDataViewInst()&&(t=this._getDataViewInst(),t=e.dataSource=t),t&&this._isDataview(t)?this._isDataViewLoaded(t)?(this._dataView=t,this._setOption("eventsData",t.toArray())):t.element.bind("dataloaded",function(){n._dataView=t,n._setOption("eventsData",t.toArray())}):this._dataView=null},t.prototype._initLocalDataStorage=function(){try{f=!1;if(window.amplify&&window.amplify.store)try{l=amplify.store("wijevcal_tables1"),f=!0,this.log("Using amplify.store for the local data storage")}catch(e){this.log("amplify.store exception:"+e),this._loadData();return}else{if(!window.openDatabase){this.log(this.localizeString("logCouldntOpenLocalStorage","Couldn't open built-in local data storage. Please, add amplify.store references.")),this._loadData();return}try{o=window.openDatabase(u,a,"Wijmo Events Calendar Offline DB",2e5)}catch(t){this.log("web sql database error: "+t),this._loadData();return}if(!o){this.log("Failed to open the database on disk. This is probably because the version was bad or there is not enough space left in this domain's quota"),this._loadData();return}this.log("Using Web SQL Database for the local data storage.")}c("calendars","(id TEXT PRIMARY KEY, name TEXT, location TEXT, description TEXT, color TEXT, tag TEXT)");var r=n.Deferred(),i=this;this._defferObjs.push(r),c("events","(id TEXT PRIMARY KEY, calendar TEXT, subject TEXT, location TEXT, start TIMESTAMP, end TIMESTAMP, description TEXT, color TEXT, allday INTEGER, properties TEXT, tag TEXT)",function(){i._loadData(),r.resolve()})}catch(s){this.log("local datastorage initialization error:"+s)}},t.prototype._initStatusbar=function(){var e=this.element.find(".wijmo-wijev-statusbar");if(!this.options.statusBarVisible){e.hide();return}e.css("float","left"),e.show(),this.statusbarEventsAdded||(this.statusbarEventsAdded=!0)},t.prototype._initHeaderbar=function(){var e=this.element.find(".wijmo-wijev-headerbar");if(!this.options.headerBarVisible){e.hide();return}e.show()},t.prototype._initNavigationbar=function(){var e=this.element.find(".wijmo-wijev-navigationbar");if(!this.options.navigationBarVisible){e.hide();return}e.show()},t.prototype._initRightPane=function(){var e=this.element.find(".wijmo-wijev-rightpane");if(!this.options.rightPaneVisible){e.hide();return}e.show()},t.prototype._initLogPanel=function(){this.options.enableLogs?(this._createLogPanel(),this.log=this._log):(this.logDialog&&this.logDialog.wijdialog("close"),this.log=function(){})},t.prototype._handleServerError=function(e){return e&&e.toString().indexOf("error:")===0?(this.status(e.toString(),"error"),!0):!1},t.prototype._loadData=function(){var e=this.options,t=this,r,i,s,o,u,a,f,l,c,p,d,v,m;this.showLoadingLabel(),p=function(e){e==="Local data storage not found."&&(m=!0),t.hideLoadingLabel()},e.calendars=[],u=this._calendarsById={},l=function(n){e.calendars=[];if(!n)return;if(typeof n=="string"){if(t._handleServerError(n)){p(n);return}try{n=t._jsonParse(n)}catch(i){t.status("Unable to parse received calendars data. "+i,"error");return}}n.calendars&&n.calendars.length&&(n=n.calendars);for(r=0;r<n.length;r+=1)s=t._cloneObj(n[r]),s.prevData=t._cloneObj(s),e.calendars.push(s),u[s.id]=s;t._onCalendarsChanged()},e.dataStorage.loadCalendars?e.dataStorage.loadCalendars(l,p):e.webServiceUrl?n.getJSON(e.webServiceUrl+"?clientId="+this.element[0].id+"&command=loadCalendars"+"&calendars="+e.calendars,l):h("SELECT * FROM calendars",[],function(n){for(r=0,i=n.rows.length;r<i;r+=1)s=t._cloneObj(n.rows.item(r)),s.prevData=t._cloneObj(s),e.calendars.push(s),u[s.id]=s;t._onCalendarsChanged()},p),this._dataView&&(e.eventsData=this._dataView.toArray()),this._eventsDataById?a=this._eventsDataById:a=this._eventsDataById={},e.eventsData||(e.eventsData=[]),c=function(e){if(!e)return;if(typeof e=="string"){if(t._handleServerError(e)){p(e);return}try{e=t._jsonParse(e)}catch(n){t.log("Unable to parse received calendars data. "+n);return}}e.events&&e.events.length&&(e=e.events);for(r=0;r<e.length;r+=1)o=t._readEventData(e[r]),t._storeEventWithSort(o);t._onEventsDataChanged(),t._onInitialized()};if(e.dataStorage.loadEvents)e.dataStorage.loadEvents(e.visibleCalendars,c,p),t._chromeLoadDataDeffer.resolve();else if(e.webServiceUrl)n.ajax({url:e.webServiceUrl+"?clientId="+this.element[0].id+"&command=loadEvents&timestamp="+(new Date).getTime(),dataType:"text",cache:!1,contentType:"application/json; charset=utf-8",type:"POST",success:c,error:p}),t._chromeLoadDataDeffer.resolve();else{if(this._dataView){this._onInitialized();return}f="SELECT * FROM events where ";for(r=0;r<e.visibleCalendars.length;r+=1)r>0&&(f+=" OR "),f+="calendar='"+e.visibleCalendars[r]+"'";h(f,[],function(n){if(t._needLoadLocalStorage){e.eventsData=[];for(r=0,i=n.rows.length;r<i;r+=1)o=t._readEventData(n.rows.item(r)),t._storeEventWithSort(o)}t._onEventsDataChanged(),t._onInitialized(),t._chromeLoadDataDeffer.resolve()},function(){p.apply(this,arguments),m&&(t._onEventsDataChanged(),t._onInitialized()),t._chromeLoadDataDeffer.resolve()})}},t.prototype._onInitialized=function(){this._ensureDisabled(),this.hideLoadingLabel(),this._trigger("initialized")},t.prototype._readEventData=function(e){var t=this._cloneObj(e);return t.start=new Date(t.start),t.end=new Date(t.end),typeof t.allday=="string"&&(t.allday==="false"&&(t.allday=!1),t.allday==="true"&&(t.allday=!0)),t.start.getTime()>=t.end.getTime()&&(t.end=this._addMinutes(t.start,this.options.timeInterval)),this._deSerializeProperties(t.properties,t),t.prevData=this._cloneObj(t),t},t.prototype._prepareEventsForView=function(){this._eventsView=this.getOccurrences()},t.prototype._cloneObj=function(e){var t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},t.prototype._onDayViewClick=function(){var e=this.options;if(e.disabled)return;e.viewType!=="day"&&(e.viewType="day",this._onViewTypeChanged()),e.selectedDates=[e.selectedDate],this._onSelectedDatesChanged()},t.prototype._onWeekViewClick=function(){var e=this.options,t,n,r;if(e.disabled)return;e.viewType!=="week"&&(e.viewType="week",this._onViewTypeChanged()),t=e.selectedDate,r=e.firstDayOfWeek-t.getDay(),Math.abs(r)>6&&(r=t.getDay()-e.firstDayOfWeek),t=this._addDays(t,r),e.selectedDates=[];for(r=0;r<7;r+=1)n=this._addDays(t,r),e.selectedDates.push(n);this._onSelectedDatesChanged()},t.prototype._onMonthViewClick=function(){var e=this.options;if(e.disabled)return;e.viewType!=="month"&&(e.viewType="month",this._onViewTypeChanged())},t.prototype._onListViewClick=function(){var e=this.options;if(e.disabled)return;e.viewType!=="list"&&(e.viewType="list",this._onViewTypeChanged()),e.selectedDates=[e.selectedDate],this._onSelectedDatesChanged()},t.prototype._ensureEditCalendarDialogCreated=function(){var e=this.options,t,r={};this._editCalendarDialog||(t=e.editCalendarTemplate,t||(t="<p><label>"+this.localizeString("labelCalendarName","Calendar name")+"</label>"+'<input type="text" class="wijmo-wijev-name" value=""> '+'<div class="wijmo-wijev-color-button">'+'<div class="wijmo-wijev-color ui-wijmo-wijev-event-color-default">&nbsp;</div>'+"</div>"+"</p>"+"<p><label>"+this.localizeString("labelLocation","Location")+"</label>"+'<input type="text" class="wijmo-wijev-location" value=""></p>'+"<p><label>"+this.localizeString("labelDescription","Description")+'</label><textarea class="wijmo-wijev-description" /></p>'),this._editCalendarDialog=n('<div class="wijmo-wijev-editcalendar-dialog">'+t+"</div>"),this.element.append(this._editCalendarDialog),r[this.localizeString("buttonSave","Save")]=n.proxy(function(){try{var e=this._validateAndReadCalendarDialogFields(this._editCalendarDialog);e.prevData?this.updateCalendar(e):this.addCalendar(e),this._editCalendarDialog.wijdialog("close")}catch(t){alert(t)}},this),this._editCalendarDialog.wijdialog({autoOpen:!0,height:340,width:440,modal:!0,title:this.localizeString("titleEditCalendar","Edit calendar"),buttons:r,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}}),this._editCalendarDialog.find(".wijmo-wijev-name, .wijmo-wijev-location, .wijmo-wijev-description").wijtextbox(),this._editCalendarDialog.find(".wijmo-wijev-color-button").button({icons:{primary:e.wijCSS.iconArrowDown}}).click(n.proxy(this._onColorButtonClick,{dlg:this._editCalendarDialog,self:this})))},t.prototype._ensureEditEventDialogCreated=function(){var e=this.options,t,r=!1,i=!1;this._editEventDialog||(t=this.options.editEventDialogTemplate,t||(t='<div class="wijmo-wijev-event-dialog '+this.options.wijCSS.content+" "+e.wijCSS.cornerAll+'">'+'<ul class="wijmo-wijev-brief-content">'+"<li><label>"+this.localizeString("labelName","name")+"</label>"+'<input type="text" name="subject" class="wijmo-wijev-subject" value="">'+'<div class="wijmo-wijev-color-button">'+'<div class="wijmo-wijev-color ui-wijmo-wijev-event-color-default">&nbsp;</div>'+"</div>"+"</li>"+'<li><label for="'+this._uidPref+'_alldaybtn">'+this.localizeString("labelAllDay","all-day")+"</label>"+'<input type="checkbox" class="wijmo-wijev-allday" id="'+this._uidPref+'_alldaybtn" />'+"</li>"+"<li><label>"+this.localizeString("labelStarts","Starts")+"</label>"+'<input type="text" class="wijmo-wijev-start" value="">'+'<input type="text" class="wijmo-wijev-start-time" value="">'+"</li>"+"<li><label>"+this.localizeString("labelEnds","Ends")+"</label>"+'<input type="text" class="wijmo-wijev-end" value="">'+'<input type="text" class="wijmo-wijev-end-time" value="">'+"</li>"+"</ul>"+'<ul class="wijmo-wijev-detailed-content '+e.wijCSS.cornerAll+'">'+"<li><label>"+this.localizeString("labelLocation","Location")+"</label>"+'<input type="text" class="wijmo-wijev-location" value=""></li>'+"<li><label>"+this.localizeString("labelRepeat","Repeat")+"</label>"+'<select class="wijmo-wijev-repeat">'+'<option value="none">'+this.localizeString("repeatNone","None")+"</option>"+'<option value="daily">'+this.localizeString("repeatDaily","Every Day")+"</option>"+'<option value="workdays">'+this.localizeString("repeatWorkDays","Work days")+"</option>"+'<option value="weekly">'+this.localizeString("repeatWeekly","Every Week")+"</option>"+'<option value="monthly">'+this.localizeString("repeatMonthly","Every Month")+"</option>"+'<option value="yearly">'+this.localizeString("repeatYearly","Every Year")+"</option>"+"</select></li>"+"<li><label>"+this.localizeString("labelCalendar","Calendar")+"</label>"+'<select class="wijmo-wijev-calendar"></select></li>'+'<li class="wijmo-wijev-description-item"><label>'+this.localizeString("labelDescription","Description")+"</label>"+'<textarea class="wijmo-wijev-description" /></li>'+"</ul>"+'<div class="footer">'+'<a href="#" class="wijmo-wijev-delete">'+this.localizeString("buttonDelete","Delete")+"</a>"+'<a href="#" class="wijmo-wijev-save">'+this.localizeString("buttonOK","OK")+"</a>"+'<a href="#" class="wijmo-wijev-cancel">'+this.localizeString("buttonCancel","Cancel")+"</a>"+"</div>"+'<div class="wijmo-wijev-angle"></div>'+"</div>"),this._editEventDialog=n(t),e.ensureEventDialogOnBody?n("body").append(this._editEventDialog):this.element.append(this._editEventDialog),this._initEventDialogButton(this._editEventDialog.find(".wijmo-wijev-color-button"),n.proxy(this._onColorButtonClick,{dlg:this._editEventDialog,self:this}),{icons:{primary:e.wijCSS.iconArrowDown}}),this._initEventDialogButton(this._editEventDialog.find(".wijmo-wijev-delete"),n.proxy(function(){this.deleteEvent(this._editEventDialog.appt),this._editEventDialog.wijpopup("hide")},this)),this._initEventDialogButton(this._editEventDialog.find(".wijmo-wijev-cancel"),n.proxy(function(e){this._editEventDialog.wijpopup("hide"),e.preventDefault()},this)),this._editEventDialog.find(".wijmo-wijev-start").width(114).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!0,dateFormat:"d",dropDownOpen:function(e,t){r=!1},dropDownClose:function(e,t){r=!0,n(document).one("mouseup",function(){r=!1})},dateChanged:n.proxy(function(e,t){r&&(i=!0,n(document).one("mouseup",function(){i=!1}));var s=this._editEventDialog.find(".wijmo-wijev-end").wijinputdate("option","date");t.date>s&&this._editEventDialog.find(".wijmo-wijev-end").wijinputdate("option","date",t.date)},this)}),this._editEventDialog.find(".wijmo-wijev-start-time").width(80).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!1,dateFormat:"t",dateChanged:n.proxy(function(e,t){var n=this._editEventDialog.find(".wijmo-wijev-end-time").wijinputdate("option","date"),r=this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date");t.date.getDate()!==r.getDate()&&(t.date.setDate(r.getDate()),this._editEventDialog.find(".wijmo-wijev-start-time").wijinputdate("option","date",t.date)),t.date>n&&this._editEventDialog.find(".wijmo-wijev-end-time").wijinputdate("option","date",t.date)},this)}),this._editEventDialog.find(".wijmo-wijev-end").width(114).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!0,dateFormat:"d",dropDownOpen:function(e,t){r=!1},dropDownClose:function(e,t){r=!0,n(document).one("mouseup",function(){r=!1})},dateChanged:n.proxy(function(e,t){r&&(i=!0,n(document).one("mouseup",function(){i=!1}));var s=this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date");t.date<s&&this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date",t.date)},this)}),this._editEventDialog.find(".wijmo-wijev-end-time").width(80).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showDropDownButton:!1,dateFormat:"t"}),this._editEventDialog.find(".wijmo-wijev-allday").wijcheckbox().change(n.proxy(this._eventDialogEnsureTimePartState,this)),this._editEventDialog.find(".wijmo-wijev-subject,.wijmo-wijev-location,.wijmo-wijev-description").wijtextbox(),this._initEventDialogButton(this._editEventDialog.find(".wijmo-wijev-save"),n.proxy(function(e){try{var t=this._validateAndReadApptDialogFields(this._editEventDialog);t.prevData?this.updateEvent(t):this.addEvent(t),this._editEventDialog.wijpopup("hide")}catch(n){alert(n)}},this)),this._editEventDialog.wijpopup({autoHide:!0,hiding:n.proxy(function(e){if(i)return i=!1,!1;this._colorMenu&&this._colorMenu.wijpopup("hide"),this.element.find(".wijmo-wijev-dayview .ui-selected").removeClass("ui-selected")},this),shown:n.proxy(function(e){var t=this,r=n.browser.msie?!0:!1;this._dropDownInitialized?(this._editEventDialog.find(".wijmo-wijev-calendar").wijdropdown("refresh"),this._editEventDialog.find(".wijmo-wijev-repeat").wijdropdown("refresh")):(this._editEventDialog.find(".wijmo-wijev-calendar").wijdropdown({unfocus:r}).bind("change",function(e){var n=t._calendarsById[this.value];n&&n.color?t._addColorClass(t._editEventDialog.find(".wijmo-wijev-color"),n.color):t._editEventDialog.appt&&t._editEventDialog.appt.color&&t._addColorClass(t._editEventDialog.find(".wijmo-wijev-color"),t._editEventDialog.appt.color)}),this._editEventDialog.find(".wijmo-wijev-repeat").wijdropdown({unfocus:r}).bind("change",function(e){var n=this.value,r=t._editEventDialog.appt;switch(n){case"none":r.recurrenceState=null,r.recurrencePattern=null;break;case"daily":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"daily"};break;case"workdays":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"workdays"};break;case"weekly":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"weekly"};break;case"monthly":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"monthly"};break;case"yearly":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"yearly"};break;case"custom":alert("show custom recurrence pattern.")}}),this._dropDownInitialized=!0),this._onEditEventDialogShown(this._editEventDialog,this._editEventDialog.appt),this._editEventDialog.find(".wijmo-wijev-subject").focus(),this._updateEditEventPopupCallout()},this)}))},t.prototype._initEventDialogButton=function(e,t,r){n.mobile==null?e.button(r).click(t):e.addClass("ui-btn").click(t)},t.prototype._updateEditEventPopupCallout=function(){if(this._editEventDialog&&this._editEventDialog._arrowTarget){var e=this._editEventDialog,t=n(e._arrowTarget),r=t.offset(),i=e.offset(),s;r.left===i.left?e.removeClass("wijmo-wijev-rightangle").removeClass("wijmo-wijev-leftangle"):r.left<i.left?e.removeClass("wijmo-wijev-rightangle").addClass("wijmo-wijev-leftangle"):e.removeClass("wijmo-wijev-leftangle").addClass("wijmo-wijev-rightangle"),s=Math.round(r.top-i.top+t.outerHeight(!0)/2),this._editEventDialog.find(".wijmo-wijev-angle").css("top",s)}},t.prototype._onColorButtonClick=function(){var e=this.self,t=this.dlg,r,i=e.options,s=i.colors,o="";if(s&&s.length>0)for(r=0;r<s.length;r+=1)o+='<span class="wijmo-wijev-listcolor wijmo-wijev-event-color-'+s[r]+'">&nbsp;</span>';e._colorMenu||(e._colorMenu=n('<div class="wijmo-wijev-color-menu '+i.wijCSS.content+" "+i.wijCSS.cornerAll+'"></div>'),t.append(e._colorMenu),e._colorMenu.wijpopup({autoHide:!0})),e._colorMenu.html(o),e._colorMenu.find(".wijmo-wijev-listcolor").click(n.proxy(function(r){this._addColorClass(t.find(".wijmo-wijev-color"),this._readColorFromClass(n(r.target),"default")),e._colorMenu.wijpopup("hide")},e)),e._colorMenu.wijpopup("show",{of:t.find(".wijmo-wijev-color-button"),my:"left top",at:"left bottom"})},t.prototype._validateAndReadCalendarDialogFields=function(e){var t=e.cal||{};t.name=e.find(".wijmo-wijev-name").val(),t.location=e.find(".wijmo-wijev-location").val(),t.description=e.find(".wijmo-wijev-description").val(),t.color=this._readColorFromClass(e.find(".wijmo-wijev-color"),t.color||"default");if(!t.name)throw"Calendar name can not be empty";return t},t.prototype._validateAndReadApptDialogFields=function(e){var t=e.appt,n,r,s,o,u;n=i(e.find(".wijmo-wijev-start").wijinputdate("option","date")),r=i(e.find(".wijmo-wijev-end").wijinputdate("option","date")),s=e.find(".wijmo-wijev-start-time").wijinputdate("option","date"),o=e.find(".wijmo-wijev-end-time").wijinputdate("option","date");var a=(s.getHours()*60+s.getMinutes())*60+s.getSeconds(),f=(o.getHours()*60+o.getMinutes())*60+o.getSeconds();if(n.getTime()===r.getTime()&&a>f)throw this.localizeString("messageEndOccursBeforeStart","The end date you entered occurs before the start date.");return t.subject=e.find(".wijmo-wijev-subject").val(),t.location=e.find(".wijmo-wijev-location").val(),t.start=n,t.end=r,e.find(".wijmo-wijev-allday").length>0&&(t.allday=e.find(".wijmo-wijev-allday")[0].checked),t.allday?t.start.getTime()>=t.end.getTime()&&(t.end=this._addMinutes(t.start,this.options.timeInterval)):(t.start=new Date(t.start.getFullYear(),t.start.getMonth(),t.start.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()),t.end=new Date(t.end.getFullYear(),t.end.getMonth(),t.end.getDate(),o.getHours(),o.getMinutes(),o.getSeconds())),t.calendar=e.find(".wijmo-wijev-calendar").val(),t.description=e.find(".wijmo-wijev-description").val(),t.color=this._readColorFromClass(e.find(".wijmo-wijev-color"),t.color),u=t.recurrencePattern,u&&t.recurrenceState==="master"&&(u.startTime=t.start,u.endTime=t.end,u.patternStartDate=t.start),t},t.prototype._bindApptToDialog=function(e){if(!e)return;var t=this._editEventDialog,n,r;t.appt=e,t.find(".wijmo-wijev-subject").val(e.subject||""),t.find(".wijmo-wijev-location").val(e.location||"");try{t.find(".wijmo-wijev-start").wijinputdate("option","date",e.start),t.find(".wijmo-wijev-start-time").wijinputdate("option","date",e.start),t.find(".wijmo-wijev-end").wijinputdate("option","date",e.end),t.find(".wijmo-wijev-end-time").wijinputdate("option","date",e.end)}catch(i){alert("[e0001a] wijinputdate/wijtextselection firefox error\n"+i)}t.find(".wijmo-wijev-allday").length>0&&(t.find(".wijmo-wijev-allday")[0].checked=e.allday),t.find(".wijmo-wijev-allday").wijcheckbox("refresh"),this._fillCalendarsSelect(t.find(".wijmo-wijev-calendar"),e.calendar),this._loadRepeatValue(e,t.find(".wijmo-wijev-repeat")),t.find(".wijmo-wijev-description").val(e.description||""),e.prevData?t.find(".wijmo-wijev-delete").show():t.find(".wijmo-wijev-delete").hide(),t.find(".wijmo-wijev-calendar").length>0&&(n=this._calendarsById[t.find(".wijmo-wijev-calendar")[0].value]),r=e.color,!r&&n&&n.color&&(r=n.color),this._addColorClass(t.find(".wijmo-wijev-color"),r),this._eventDialogEnsureTimePartState()},t.prototype._onEditEventDialogShown=function(e,t){t.recurrenceState==="exception"?e.find(".wijmo-wijev-repeat").wijdropdown("option","disabled",!0):e.find(".wijmo-wijev-repeat").wijdropdown("option","disabled",!1)},t.prototype._eventDialogEnsureTimePartState=function(){var e=this._editEventDialog;e.find(".wijmo-wijev-allday").length>0&&(e.find(".wijmo-wijev-allday")[0].checked?(e.find(".wijmo-wijev-start-time").wijinputdate("option","disabled",!0),e.find(".wijmo-wijev-end-time").wijinputdate("option","disabled",!0)):(e.find(".wijmo-wijev-start-time").wijinputdate("option","disabled",!1),e.find(".wijmo-wijev-end-time").wijinputdate("option","disabled",!1)))},t.prototype._loadRepeatValue=function(e,t){var n="none";if(e.recurrencePattern)switch(e.recurrencePattern.recurrenceType){case"daily":n="daily";break;case"workdays":n="workdays";break;case"weekly":n="weekly";break;case"monthly":n="monthly";break;case"yearly":n="yearly";break;default:n="custom"}t.val(n)},t.prototype._addColorClass=function(e,t){var n,r=new RegExp("wijmo-wijev-event-color-(\\w+)\\s*");e.length>0&&(n=e[0].className,e[0].className=n.replace(r,""),e.addClass("wijmo-wijev-event-color-"+(t||"default")))},t.prototype._readColorFromClass=function(e,t){var n=new RegExp("wijmo-wijev-event-color-(\\w+)\\s*"),r;if(e.length>0){r=n.exec(e[0].className);if(r&&r.length>1)return r[1]}return t},t.prototype._fillCalendarsSelect=function(e,t){var n="",r=this.options,i,s,o,u=r.calendars.slice(0),a=r.visibleCalendars;if(a&&a.length>0)for(i=0;i<a.length;i+=1){o=!1;for(s=0;s<u.length;s+=1)u[s].name===a[i]&&(o=!0);o||u.push({id:a[i],name:a[i]})}if(u.length===0){e.html("");return}for(i=0;i<u.length;i+=1)n+='<option value="'+u[i].id+'">'+u[i].name+"</option>";e.html(n).val(t)},t.prototype._bindCalendarToDialog=function(e){if(!e)return;var t=this._editCalendarDialog;t.cal=e,t.find(".wijmo-wijev-name").val(e.name||""),t.find(".wijmo-wijev-location").val(e.location||""),t.find(".wijmo-wijev-description").val(e.description||""),this._addColorClass(t.find(".wijmo-wijev-color"),e.color)},t.prototype._onTodayClick=function(){if(this.options.disabled)return;return this.goToday(),!1},t.prototype._bindEvents=function(){this._eventsAttached||(n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-appointment",n.proxy(this._onAppointmentClick,this)),n(this.element).on("mousedown."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-appointment",n.proxy(this._onDayViewAppointmentMouseDown,this)),n(this.element).on("mousedown."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-appointment",n.proxy(this._onMonthViewAppointmentMouseDown,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-timeinterval",n.proxy(this._onDayViewTimeIntervalClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-allday-cell",n.proxy(this._onDayViewAllDayCellClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcellheader",n.proxy(this._onMonthViewDayLabelClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcell-showmore",n.proxy(this._onMonthViewDayLabelClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-weekview .wijmo-wijev-daylabel",n.proxy(this._onMonthViewDayLabelClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcell",n.proxy(this._onMonthViewCellClick,this)),this._eventsAttached=!0)},t.prototype._unbindEvents=function(){this._eventsAttached&&(n(this.element).off("mousedown."+this.wijevcalnamespacekey),n(this.element).off("click."+this.wijevcalnamespacekey),this._eventsAttached=!1)},t.prototype.destroy=function(){this._destroyInternal(),n.wijmo.widget.prototype.destroy.apply(this,arguments)},t.prototype._destroyInternal=function(){var e=this.options;this.element.removeClass("wijmo-wijev wijmo-wijevcal "+e.wijCSS.widget+" "+e.wijCSS.helperReset),n(window).unbind("resize."+this.wijevcalnamespacekey),this._unbindEvents(),this.element.empty(),this.wijevcalnamespacekey=null,this._uidPref=null,this._isUpdating=null,this._resolveDayApptConflictsTimeout=null,this._pendingRedrawActiveView=null,this._listViewDetailsInit=null,this._dayViewDetailsInit=null,this._eventsAttached=null,this.statusbarEventsAdded=null,this._dataView=null,this._eventsView=null,this._eventsDataById=null,this._calendarsById=null,this._dayViewCache=null,this._templateDayColumn=null,this._templateDayHeader=null,this._dayViewScrollToEvent=null,this._maxAllDayEventCount=null,this._dayColumnsToResolve=null,this._dayColumnResolveIdx=null,this.logDialog=null,this.logPanel=null,this._editCalendarDialog=null,this._editEventDialog=null,this._renderAgendaEventsTimeoutId=null,this.__targetAppt=null,this._isApptResize=null,this.__startApptH=null,this.__startApptY=null,this.__startClientY=null,this._apptDragResizeFlag=null,this._apptMovedFlag=null,this._movedFromTimeInervalApptElem=null,this.__targetApptChanged=null,this._defferObjs=null,this._setOptionCallbacks=null,this._chromeLoadDataDeffer=null,n.wijmo.wijevcal.prototype.options.eventsData=[]},t.prototype.deleteCalendar=function(e,t,r){var i,s=this.options.calendars,o=e.id||e,u=!1,a,f,l,c=this;for(i=0;i<s.length;i+=1)if(s[i].id===o){u=!0,e=s[i];if(!this._trigger("beforeDeleteCalendar",null,{data:e}))return!1;delete this._calendarsById[e.id],s.splice(i,1);break}if(!u)for(i=0;i<s.length;i+=1)if(s[i].name===o){u=!0,e=s[i];if(!this._trigger("beforeDeleteCalendar",null,{data:e}))return!1;delete this._calendarsById[e.id],s.splice(i,1);break}if(!u)return this.status("Calendar with id/name '"+o+"' not found."),!1;this.showLoadingLabel(this.localizeString("activityDeletingCalendar","Deleting calendar...")),a=function(n){c.status("Calendar '"+e.name+"' deleted."),c._onCalendarsChanged(),c.hideLoadingLabel(),t&&t(n)},f=function(t){c.status("Unable to delete calendar '"+e.name+"': "+t),c.hideLoadingLabel(),r&&r(t)};if(this.options.dataStorage.deleteCalendar)this.options.dataStorage.deleteCalendar(e,a,f);else if(this.options.webServiceUrl){try{l=this._jsonStringify(e)}catch(p){this.status("Unable to prepare calendar data for server. "+p,"error"),f("Unable to prepare calendar data for server. "+p);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=deleteCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+l,success:a,error:f})}else h("DELETE FROM calendars WHERE id='"+e.id+"'",[],a,f)},t.prototype.addCalendar=function(e,t,r){var i,s,o,u=this,a=!1;if(!this._trigger("beforeAddCalendar",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(s in e.prevData)e.prevData.hasOwnProperty(s)&&(e[s]=e.prevData[s]);return!1}e.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,e.id="dynid"+this._dynIdCounter+"ts"+(new Date).getTime()),n.each(u.options.calendars,function(t,n){if(e.name===n.name)return a=!0,!1});if(a)return;this.showLoadingLabel(this.localizeString("activityCreatingCalendar","Creating calendar...")),i=function(n){if(u._handleServerError(n)){o(n);return}u._readUpdatedServerDataIfAny(n,e),u._calendarsById[e.id]?u.status("Calendar '"+e.name+"' added."):(u.options.calendars.push(e),u._calendarsById[e.id]=e,u.status("Calendar '"+e.name+"' added.")),e.prevData=u._cloneObj(e),u._onCalendarsChanged(),u.hideLoadingLabel(),t&&t(n)},o=function(t){u.status("Unable to add calendar '"+e.name+"': "+t),u.hideLoadingLabel(),r&&r(t)};if(this.options.dataStorage.addCalendar)this.options.dataStorage.addCalendar(e,i,o);else if(this.options.webServiceUrl){try{s=this._jsonStringify(e)}catch(f){this.status("Unable prepare calendar data for server."+f,"error"),o("Unable to prepare calendar data for server."+f);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=addCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+s,success:i,error:o})}else h("INSERT OR REPLACE INTO calendars (id, name, location, description, color, tag) VALUES(?,?,?,?,?,?);",[e.id,e.name,e.location,e.description,e.color,e.tag],i,o)},t.prototype.updateCalendar=function(e,t,r){var i,s,o,u=this;if(!this._trigger("beforeUpdateCalendar",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(s in e.prevData)e.prevData.hasOwnProperty(s)&&(e[s]=e.prevData[s]);return!1}e.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,e.id="dynid"+this._dynIdCounter+"ts"+(new Date).getTime()),this.showLoadingLabel(this.localizeString("activityUpdatingCalendar","Updating calendar...")),i=function(r){var i=!1,s=u.options.visibleCalendars;if(u._handleServerError(r)){o(r);return}u._readUpdatedServerDataIfAny(r,e),u._calendarsById[e.id]?(n.each(s,function(t,n){if(n===e.prevData.name)return s[t]=e.name,!1}),u.status("Calendar '"+e.name+"' updated.")):(n.each(u.options.calendars,function(t,n){if(e.name===n.name)return i=!0,!1}),i||(u.options.calendars.push(e),u._calendarsById[e.id]=e,u.status("Calendar '"+e.name+"' added."))),e.prevData=u._cloneObj(e),u._onCalendarsChanged(),u.hideLoadingLabel(),t&&t(r)},o=function(t){u.status("Unable to update calendar '"+e.name+"': "+t),u.hideLoadingLabel(),r&&r(t)};if(this.options.dataStorage.updateCalendar)this.options.dataStorage.updateCalendar(e,i,o);else if(this.options.webServiceUrl){try{s=this._jsonStringify(e)}catch(a){this.status("Unable prepare calendar data for server. "+a,"error"),o("Unable to prepare calendar data for server. "+a);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=updateCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+s,success:i,error:o})}else h("INSERT OR REPLACE INTO calendars (id, name, location, description, color, tag) VALUES(?,?,?,?,?,?);",[e.id,e.name,e.location,e.description,e.color,e.tag],i,o)},t.prototype._initEventData=function(e){return n.extend({allday:!1,location:null,subject:null,description:null,color:null,tag:null},e)},t.prototype.addEvent=function(e,t,r){var i,o,u,a=this;if(!this._trigger("beforeAddEvent",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(u in e.prevData)e.prevData.hasOwnProperty(u)&&(e[u]=e.prevData[u]);return!1}e.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,e.id=s()),e.calendar||(e.calendar="Default"),this.showLoadingLabel(this.localizeString("activityCreatingEvent","Creating event...")),o=function(t){a.hideLoadingLabel(),a.status("Unable to add event '"+e.subject+"': "+t,"error");if(e.prevData)for(u in e.prevData)e.prevData.hasOwnProperty(u)&&(e[u]=e.prevData[u]);r&&r(t)},i=function(n){if(a._handleServerError(n)){o(n);return}a._readUpdatedServerDataIfAny(n,e),!a._eventsDataById[e.id]||e.recurrenceState==="exception"?(a._storeEventWithSort(e),a.status("Event '"+e.subject+"' added.")):a.status("Event '"+e.subject+"' added."),e.prevData=a._cloneObj(e),a._onEventsDataChanged(),a.hideLoadingLabel(),t&&t(n)};if(this.options.dataStorage.addEvent)this.options.dataStorage.addEvent(e,i,o);else if(this.options.webServiceUrl){try{u=this._jsonStringify(e)}catch(l){this.status("Unable prepare event data for server. "+l,"error"),o("Unable to prepare event data for server. "+l);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=addEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+u,success:i,error:o})}else{e=a._initEventData(e);if(!f&&!window.openDatabase){i.call(this,{rowsAffected:0,rows:[e]});return}h("INSERT OR REPLACE INTO events (id, calendar, subject, location, start, end, description, color, allday, properties, tag) VALUES(?,?,?,?,?,?,?,?,?,?,?);",[e.id,e.calendar,e.subject,e.location,e.start.getTime(),e.end.getTime(),e.description,e.color,e.allday,this._serializeProperties(e),e.tag],i,o)}},t.prototype._storeEventWithSort=function(e){var t=this.options.eventsData,n,r;this._eventsDataById[e.id]=e;if(!t)return;for(n=0,r=t.length;n<r;n+=1){if(t[n].start>e.start){t.splice(n,0,e);return}if(t[n].start.getTime()===e.start.getTime()&&t[n].subject>e.subject){t.splice(n,0,e);return}}t.push(e)},t.prototype._readUpdatedServerDataIfAny=function(e,t){var n=null,r;if(typeof e=="string"&&e.indexOf("update:")===0){e=e.toString().substr("update:".length);try{n=this._jsonParse(e)}catch(i){this.status("Unable to read updated server data. "+i,"warning")}if(n)for(r in n)n[r]&&(t[r]=n[r])}},t.prototype.updateEvent=function(e,t,r){var i,s,o,u=this;if(!this._trigger("beforeUpdateEvent",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(o in e.prevData)e.prevData.hasOwnProperty(o)&&(e[o]=e.prevData[o]);return this._updateAppointmentVisual(e),!1}e.calendar||(e.calendar="Default"),this.showLoadingLabel(this.localizeString("activityUpdatingEvent","Updating event...")),s=function(t){u.hideLoadingLabel(),u.status("Unable to update event '"+e.subject+"': "+t,"error");if(e.prevData)for(o in e.prevData)e.prevData.hasOwnProperty(o)&&(e[o]=e.prevData[o]);u._updateAppointmentVisual(e),r&&r(t)};if(!e.id){s("id is empty");return}if(e.recurrenceState==="exception"||e.recurrenceState==="occurrence"){if(!this._eventsDataById[e.parentRecurrenceId]){s("Unable to find master event for event with id:"+e.id);return}if(e.recurrenceState==="occurrence")return this.log(this._formatString("[updateEvent->addEvent] recurrenceState for event {0} changed to 'exception'.",e.id)),e.recurrenceState="exception",this.addEvent(e,t,r)}i=function(r){if(u._handleServerError(r)){s(r);return}u._readUpdatedServerDataIfAny(r,e),u._eventsDataById[e.id]?(n.extend(u._eventsDataById[e.id],e),u.status("Event '"+e.subject+"' updated.")):(u._storeEventWithSort(e),u.status("Event '"+e.subject+"' added.")),e.prevData=u._cloneObj(e),u._onEventsDataChanged(),u.hideLoadingLabel(),t&&t(r)};if(this.options.dataStorage.updateEvent)this.options.dataStorage.updateEvent(e,i,s);else if(this.options.webServiceUrl){try{o=this._jsonStringify(e)}catch(a){this.status("Unable prepare event data for server. "+a,"error"),s("Unable to prepare event data for server. "+a);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=updateEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+o,success:i,error:s})}else{e=u._initEventData(e);if(!f&&!window.openDatabase){i.call(this,{rowsAffected:0,rows:[e]});return}h("INSERT OR REPLACE INTO events (id, calendar, subject, location, start, end, description, color, allday, properties, tag) VALUES(?,?,?,?,?,?,?,?,?,?,?);",[e.id,e.calendar,e.subject,e.location,e.start.getTime(),e.end.getTime(),e.description,e.color,e.allday,this._serializeProperties(e),e.tag],i,s)}},t.prototype._serializeProperties=function(e){var t="",n={};n.parentRecurrenceId=e.parentRecurrenceId,n.recurrenceState=e.recurrenceState,n.recurrencePattern=e.recurrencePattern,n.color=e.color,n.allday=e.allday;try{t=this._jsonStringify(n)}catch(r){this.status("Unable save additional event properties. "+r,"error")}return t},t.prototype._deSerializeProperties=function(e,t){var n={},r;if(e){if(typeof e=="string")try{n=this._jsonParse(e)}catch(i){this.status("Unable to load additional event properties. "+i,"error");return}else n=e;n.parentRecurrenceId&&(t.parentRecurrenceId=n.parentRecurrenceId),n.recurrenceState&&(t.recurrenceState=n.recurrenceState),n.recurrencePattern&&(t.recurrencePattern=n.recurrencePattern),n.color&&(t.color=n.color),n.allday&&(t.allday=n.allday)}t&&t.recurrencePattern&&(r=t.recurrencePattern,r.patternStartDate=r.patternStartDate?new Date(r.patternStartDate):r.patternStartDate,r.startTime=r.startTime?new Date(r.startTime):r.startTime,r.endTime=r.endTime?new Date(r.endTime):r.endTime,r.startTime.getTime()>=r.endTime.getTime()&&(r.endTime=this._addMinutes(r.startTime,this.options.timeInterval)))},t.prototype._jsonStringify=function(e){var t;if(window.__JSONC1)t=window.__JSONC1.stringify(e);else{if(!window.JSON)throw"JSON not found.";t=JSON.stringify(e)}return t},t.prototype._jsonParse=function(e){var t,n,r;if(window.__JSONC1)t=window.__JSONC1.parse(e);else{if(!window.JSON)throw"JSON variable not found.";n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,r=/^\/Date\((d|-|.*)\)\/$/,t=window.JSON.parse(e,function(e,t){if(typeof t=="string"){var i=n.exec(t),s;if(i)return new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6]));i=r.exec(t);if(i)return s=i[1].split(/[-,.]/),new Date(+s[0])}return t})}return t},t.prototype.getOccurrences=function(e,t){var n=this.options,r=n.eventsData,i,s,o,u,a,f,l,c,h=100,p,d,v,m=[],g=[],y=[],b={};this._eventsDataById||(this._eventsDataById={});if(r)for(a=0,l=r.length;a<l;a+=1){i=r[a],this._eventsDataById[i.id]=i;if(i.recurrenceState==="master"){u=i.recurrencePattern,u.removedOccurrences&&(y=y.concat(u.removedOccurrences)),c=u.occurrences||h,p=u.patternStartDate||i.start,d=u.startTime||i.start,v=u.endTime||i.end;switch(u.recurrenceType){case"daily":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(this._addDays(p,f),d),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"workdays":for(f=0;f<c;f+=1){s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(this._addDays(p,f),d);if(s.start.getDay()===0||s.start.getDay()===6)continue;s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s)}break;case"weekly":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(this._addDays(p,f*7),d),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"monthly":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(new Date(p),d),s.start.setMonth(s.start.getMonth()+f),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"yearly":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(new Date(p),d),s.start.setYear(s.start.getFullYear()+f),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"monthlyNth":break;case"yearlyNth":}}else this._testIsEventInTimeInterval(i,e,t)&&(i.recurrenceState==="exception"?g.push(i):i.recurrenceState==="removed"?(y.push(i.id),this.log("[warning] Seems we found removed event inside events storage, id:"+i.id)):m.push(i))}for(a=0,l=g.length;a<l;a+=1)o=g[a],b[o.id]&&delete b[o.id],m.push(o),this._eventsDataById[o.id]=o;for(a=0,l=y.length;a<l;a+=1)b[y[a]]&&delete b[y[a]];for(a in b)s=b[a],m.push(s),this._eventsDataById[s.id]=s;return m},t.prototype._testIsEventInTimeInterval=function(e,t,n){return!t||!n?!0:e.start<n&&e.end>t?!0:!1},t.prototype.deleteEvent=function(e,t,r){e.id&&(e=e.id);var i=this._eventsDataById[e],s,o,u,a,l=this,c,p;if(!this._trigger("beforeDeleteEvent",null,{data:i}))return!1;this.showLoadingLabel(this.localizeString("activityDeletingEvent","Deleting event...")),a=function(e){l.status("Unable to delete event '"+(i?i.subject:"undefined")+"': "+e),l.hideLoadingLabel(),r&&r(e)};if(i.recurrenceState==="exception"||i.recurrenceState==="occurrence"){p=this._eventsDataById[i.parentRecurrenceId];if(p){this.log(this._formatString("[deleteEvent] removing {0} with id {1}. Updating master event with id {2}",i.recurrenceState,i.id,p.id)),p.recurrencePattern.removedOccurrences||(p.recurrencePattern.removedOccurrences=[]),p.recurrencePattern.removedOccurrences.push(i.id),this.updateEvent(p,t,r);if(i.recurrenceState==="occurrence"){this.log("No need to delete occurrence from store. Master event should be updated.");return}}else if(i.recurrenceState!=="exception")return a("Unable to find master event with id "+i.parentRecurrenceId),!1}i.recurrenceState==="master",u=function(n){if(l._handleServerError(n)){a(n);return}if(l._eventsDataById[i.id]){o=l.options.eventsData;if(o)for(s=0;s<o.length;s+=1)o[s].id===e&&o.splice(s,1);delete l._eventsDataById[i.id],l.status("Event '"+i.subject+"' deleted.")}else l.status("Event '"+i.subject+"' deleted.");i.prevData=l._cloneObj(i),l._onEventsDataChanged(),l.hideLoadingLabel(),t&&t(n)};if(this.options.dataStorage.deleteEvent)this.options.dataStorage.deleteEvent(i,u,a);else if(this.options.webServiceUrl){try{c=this._jsonStringify(i)}catch(d){this.status("Unable prepare event data for server. "+d,"error"),a("Unable prepare event data for server. "+d);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=deleteEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+c,success:u,error:a})}else{if(!f&&!window.openDatabase){u.call(this,{rowsAffected:0,rows:[i]});return}h("DELETE FROM events WHERE id='"+e+"'",[],u,a)}},t.prototype.beginUpdate=function(){this._isUpdating=!0,this.showLoadingLabel("Updating...")},t.prototype.endUpdate=function(){this._isUpdating=!1,this._pendingRedrawActiveView&&this._redrawActiveView(),this.hideLoadingLabel()},t.prototype.goToEvent=function(e){e.id&&(e=e.id);var t=this.options,n,r=this.findEventById(e);switch(t.viewType){case"day":case"week":case"list":n=this.element.find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn ."+this._eventIdToCssClass(e)),n.length>0?this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",n):(this._dayViewScrollToEvent=r,this.goToDate(r.start));break;case"month":this.goToDate(r.start)}},t.prototype.isAllDayEvent=function(e){var t=e;return e.id||(t=this.findEventById(e)),t.allday?(t.end.getTime()-t.start.getTime())/864e5>=1?!0:!0:!1},t.prototype.goToDate=function(e){e=i(e);var t=this.options,n=e.getDay(),r,s,o,u,a,f=t.selectedDates;if(f&&f.length>0){if(this._isContainsDayDate(f,e))return;a=f[0],o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),u=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),s=(o-u)/864e5;if(t.viewType==="week")for(r=0;r<f.length;r+=1)if(f[r].getDay()===n){s-=r;break}for(r=0;r<f.length;r+=1)f[r]=this._addDays(f[r],s);this._onSelectedDatesChanged()}else t.selectedDates=[e],this._onSelectedDatesChanged()},t.prototype.goToTime=function(e){var t=this.element.find(".wijmo-wijev-daycolumn .wijmo-wijev-timeinterval:first-child"),n=this.element.find(".wijmo-wijev-daycolumn .wijmo-wijev-timeinterval:last-child"),r=t.position().top,i=n.position().top+n.height(),s,o,u;u=86400,o=e.getHours()*60*60+e.getMinutes()*60,s=(i-r)*o/u+r,this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("vScrollTo",s)},t.prototype.goToday=function(){this.goToDate(new Date)},t.prototype.goLeft=function(){var e,t=this.options,n=t.viewType,r=t.selectedDates;n==="month"?this.goToDate(this._addMonths(r[0],-1)):(e=-7,r.length===1&&(e=-1),this.goToDate(this._addDays(r[0],e)))},t.prototype.goRight=function(){var e,t=this.options,n=t.viewType,r=t.selectedDates;n==="month"?this.goToDate(this._addMonths(r[0],1)):(e=7,r.length===1&&(e=1),this.goToDate(this._addDays(r[0],e)))},t.prototype.refresh=function(){this.invalidate()},t.prototype.invalidate=function(){var e=this.options;switch(e.viewType.toLowerCase()){case"list":case"day":case"week":this._invalidateDayView();break;case"month":this._invalidateMonthView();break;default:}},t.prototype.showEditCalendarDialog=function(e){var t=this.options,n=t.calendars,r;if(!e)e={name:"",description:"",location:"",color:""};else if(!e.name)for(r=0;r<n.length;r+=1)if(n[r].name===e){e=n[r];break}this._ensureEditCalendarDialogCreated(),this._bindCalendarToDialog(e),this._editCalendarDialog.wijdialog("open")},t.prototype.showEditEventDialog=function(e,t,r){var i=this.options,s,o,u,a=t?n(t):r?n(r.target):null;this._ensureEditEventDialogCreated(),this.element.find(".wijmo-wijev-dayview .ui-selected").removeClass("ui-selected"),a&&a.hasClass("wijmo-wijev-daylabel")&&(a=a.parent(".wijmo-wijev-allday-cell")),e?(this._editEventDialog._arrowTarget=a,e.prevData||(e.prevData=this._cloneObj(i)),e.recurrenceState==="occurrence"&&(s=this._eventsDataById[e.parentRecurrenceId],window.confirm(this._formatString(this.localizeString("promptOpenOccurrenceFormat","{2}  is recurring event. Do you want to open only this occurrence?"),e.start,e.end,e.subject,e.location))||(e=s))):(e={subject:this.localizeString("textNewEvent","New event")},e.isNewEvent=!0,a&&a.length>0?(this._editEventDialog._arrowTarget=a,a.addClass("ui-selected"),o=a.parent(".wijmo-wijev-daycolumn"),o.length<1&&(o=a.parent(".wijmo-wijev-dayheadercolumn")),o=o[0],a.hasClass("wijmo-wijev-allday-cell")?e.allday=!0:a.hasClass("wijmo-wijev-monthcellcontainer")?(o=a[0],e.allday=!0):e.allday=!1,o&&(u=this._parseDateFromClass(o.className,e.allday?null:a[0].className),e.start=u,e.allday?e.end=this._addMinutes(e.start,1440):e.end=this._addMinutes(e.start,i.timeInterval))):(e.start=new Date(i.selectedDates[0]),e.end=this._addMinutes(e.start,i.timeInterval))),this._trigger("beforeEditEventDialogShow",null,{data:e,targetCell:a})&&(this._bindApptToDialog(e),this._editEventDialog.wijpopup("show",{of:a,my:"left center",at:"right center",offset:(a&&r?Math.round(r.offsetX-a.width()):10)+" 0",collision:"fit"}))},t.prototype._renderActiveView=function(){var e=this.options,t=this.element.find(".wijmo-wijev-headerbar .wijmo-wijev-tools");this.element.find(".wijmo-wijev-view").hide(),this.element.find(".wijmo-wijev-viewdetails").hide(),this.element.find(".wijmo-wijev-"+e.viewType.toLowerCase()+"-details").show();switch(e.viewType.toLowerCase()){case"day":case"week":case"list":this.element.find(".wijmo-wijev-view.wijmo-wijev-dayview").show(),this._renderDayView();break;case"month":this.element.find(".wijmo-wijev-view.wijmo-wijev-monthview").show(),this._renderMonthView();break;default:}t.find(".wijmo-wijev-"+e.viewType.toLowerCase())[0].checked=!0,n().buttonset?t.buttonset("refresh"):n().checkboxradio&&t.find(":radio").checkboxradio("refresh")},t.prototype._redrawActiveView=function(){if(this._isUpdating){this._pendingRedrawActiveView=!0;return}switch(this.options.viewType.toLowerCase()){case"day":case"week":case"list":this._clearDayViewCache(),this._templateDayColumn=null}this._renderActiveView()},t.prototype._getDayColumnDates=function(e){var t=this.options,n=t.selectedDates,r,i,s;n||(n=[new Date]);if(t.viewType==="week"){r=t.selectedDate||n[0],s=t.firstDayOfWeek-r.getDay(),Math.abs(s)>6&&(s=r.getDay()-t.firstDayOfWeek),r=this._addDays(r,s),n=[];for(s=0;s<7;s+=1)i=this._addDays(r,s),n.push(i)}return e&&(t.selectedDates=n),n},t.prototype._renderDayView=function(){var e=this.options,t=0,r=1440,i,s,o,u=this._getDayColumnDates(!0),a,f,l,c,h=new Date,p,d=!1,v=this.element.find(".wijmo-wijev-dayview"),m,g,y,b=0,w;v.length===0&&(v=n('<div class="wijmo-wijev-view wijmo-wijev-dayview '+e.wijCSS.content+'">'+'<h3 class="wijmo-wijev-header-title">title'+"</h3>"+'<div class="wijmo-wijev-dayview-inner">'+'<div class="wijmo-wijev-headercontainer">'+'<div class="wijmo-wijev-sizer">'+'<div class="wijmo-wijev-gmtlabel">'+this.localizeString("labelAllDay","all-day")+"</div>"+"</div>"+"</div>"+'<div class="wijmo-wijev-scrollpanel">'+'<div class="wijmo-wijev-scrollcontent">'+'<div class="wijmo-wijev-timeruler">'+'<div class="wijmo-wijev-currenttime-indicator">'+'<div class="wijmo-wijev-currenttime-indicator-arrow '+e.wijCSS.stateError+'"></div>'+'<div class="wijmo-wijev-currenttime-indicator-line '+e.wijCSS.stateError+'"></div>'+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"),v.appendTo(this.element.find(".wijmo-wijev-view-container")),this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel({hScroller:{scrollBarVisibility:"hidden"},animationOptions:{disabled:!0}})),v.removeClass("wijmo-wijev-weekview wijmo-wijev-listview"),v.addClass("wijmo-wijev-"+e.viewType.toLowerCase()+"view"),m=this.element.find(".wijmo-wijev-headercontainer"),g=this.element.find(".wijmo-wijev-scrollcontent"),y=g.find(".wijmo-wijev-timeruler");if(!this._templateDayColumn){y.find(".wijmo-wijev-timerulerinterval").remove(),i='<div class="wijmo-wijev-daycolumn">',w=!0;while(t<r)s="wijmo-wijev-timeinterval "+e.wijCSS.content+" wijmo-wijev-minute-"+t,w&&(s+=" wijmo-wijev-oddrow"),w=!w,o="wijmo-wijev-timerulerinterval "+e.wijCSS.content+" wijmo-wijev-minute-"+t,i+='<div class="'+s+'" style="height: '+e.timeIntervalHeight+'px"></div>',t+=e.timeInterval,b+=e.timeInterval,b>=e.timeRulerInterval&&(s+=" wijmo-wijev-timeinterval-hourstart",o+=" wijmo-wijev-timerulerinterval-hourstart",y.append(n('<div class="'+o+'" style="height:'+b/e.timeInterval*e.timeIntervalHeight+'px">'+this._formatString(e.timeRulerFormat,new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,t-b))+"</div>")),b=0);i+="</div>",this._templateDayColumn=n(i),this._templateDayHeader=n('<div class="wijmo-wijev-dayheadercolumn '+e.wijCSS.content+'">'+'<div class="wijmo-wijev-allday-cell '+e.wijCSS.content+'">'+'<div class="wijmo-wijev-daylabel">3 Monday</div>'+"</div>"+"</div>")}m.find(".wijmo-wijev-dayheadercolumn").remove(),g.find(".wijmo-wijev-daycolumn").remove();for(a=0,p=u.length;a<p;a+=1)c=u[a],f=this._getCachedDayHeader(c),l=this._getCachedDayColumn(c),f?(f=n(f),f.find(".wijmo-wijev-daylabel").html(this._formatDayHeaderDate(c))):(f=this._templateDayHeader.clone(!0),l=this._templateDayColumn.clone(!0),f.addClass(this._dayDateToCssClass(c)),f.find(".wijmo-wijev-daylabel").html(this._formatDayHeaderDate(c)),l.addClass(this._dayDateToCssClass(c)),d?d=!1:(l.addClass("wijmo-wijev-leftborder"),f.addClass("wijmo-wijev-leftborder")),this._compareDayDates(c,h)===0&&(l.addClass("wijmo-wijev-today "+e.wijCSS.stateHighlight),l.addClass("wijmo-wijev-leftborder"),l.addClass("wijmo-wijev-rightborder"),f.addClass("wijmo-wijev-today").find(".wijmo-wijev-allday-cell").addClass(e.wijCSS.stateHighlight),f.addClass("wijmo-wijev-leftborder"),f.addClass("wijmo-wijev-rightborder"),d=!0),a===p-1&&(l.addClass("wijmo-wijev-rightborder"),f.addClass("wijmo-wijev-rightborder"))),m.append(f),g.append(l);this._invalidateDayView(),this._renderDayViewAppointments()},t.prototype._getCachedDayHeader=function(e){var t=null;return this._dayViewCache&&this._dayViewCache[e]&&(t=this._dayViewCache[e].h),t},t.prototype._getCachedDayColumn=function(e){var t=null;return this._dayViewCache&&this._dayViewCache[e]&&(t=this._dayViewCache[e].c),t},t.prototype._storeDayCache=function(e,t,n){this._dayViewCache||(this._dayViewCache={}),this._dayViewCache[e]={h:t,c:n}},t.prototype._clearViewsCache=function(){this._clearDayViewCache(),this._clearListViewCache()},t.prototype._clearDayViewCache=function(){this._dayViewCache={}},t.prototype._clearListViewCache=function(){var e=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container .wijmo-wijsuperpanel-templateouterwrapper");e[0]||(e=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container .wijmo-wijsuperpanel-contentwrapper-touch")),e.data("wijevcal_agenda_initialized",!1),e.data("wijevcal_agenda_loadedeventscount",0)},t.prototype._invalidateDayView=function(e){var t=this.element.find(".wijmo-wijev-headercontainer"),r=this.element.find(".wijmo-wijev-scrollcontent"),i=r.find(".wijmo-wijev-timeruler"),s=t.find(".wijmo-wijev-dayheadercolumn"),o=r.find(".wijmo-wijev-daycolumn"),u=this.options.viewType.toLowerCase(),a,f,l,c,h,p,d,v,m=i.outerWidth(),g,y,b,w,E;this._updateHeaderTitleText(),f=this.element.find(".wijmo-wijev-view.wijmo-wijev-"+u+"view .wijmo-wijev-header-title"),a=f.is(":visible")?f.outerHeight(!0):0,this._invalidateView(),this._maxAllDayEventCount||(this._maxAllDayEventCount=0),h=t.find(".wijmo-wijev-dayheadercolumn .wijmo-wijev-appointment").outerHeight(!0),h||(h=17),p=t.find(".wijmo-wijev-daylabel").outerHeight(!0),d=0;for(g=0;g<s.length;g+=1)v=n(s[g]).find(".wijmo-wijev-allday-cell .wijmo-wijev-appointment").length,v>d&&(d=v);c=h*d+p+h,t.outerHeight(c+Math.round(h/2)),t.find(".wijmo-wijev-allday-cell").outerHeight(c),l=this.element.find(".wijmo-wijev-view").width(),y=l-m,y-=18,b=this.element.find(".wijmo-wijev-view").innerHeight()-t.outerHeight(!0)-a,w=Math.floor(y/o.length),t.outerWidth(l),r.outerWidth(l),s.outerWidth(w),o.outerWidth(w),this._invalidateCurrentTimeIndicator(),E=this.element.find(".wijmo-wijev-scrollpanel"),E.outerWidth(l),E.outerHeight(b),this._refreshSuperPanel(E);switch(u){case"day":this._updateDayViewDetails();break;case"list":this._updateListViewDetails()}},t.prototype._refreshSuperPanel=function(e){(!n.support.isTouchEnabled||!n.support.isTouchEnabled())&&this._isIE8()?e.wijsuperpanel("paintPanel",!0):e.wijsuperpanel("refresh")},t.prototype._updateDayViewDetails=function(){var e=this.options,t=e.selectedDate,r=this.element.find(".wijmo-wijev-leftpane"),i=r.find(".wijmo-wijev-agenda-container");this._dayViewDetailsInit||(this._dayViewDetailsInit=!0,this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar({culture:e.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),showTitle:!1,showOtherMonthDays:!1,showWeekNumbers:!1,selectionMode:{day:!0,days:!1},selectedDatesChanged:n.proxy(function(t,n){n.dates&&!e.disabled&&this.goToDate(n.dates[0])},this),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous")}),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-agenda-container").wijsuperpanel()),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar("option","displayDate",t).wijcalendar("unSelectAll").wijcalendar("selectDate",t),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar("refresh"),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-monthday-label").html(t.getDate()),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-fulldate-label").html(this._formatString(this.localizeString("dayDetailsLabelFulldateFormat","{0:dddd, MMMM d}"),t)),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-year-label").html(this._formatString(this.localizeString("dayDetailsLabelYearFormat","{0:yyyy}"),t)),this._updateAgendaList(this.element.find(".wijmo-wijev-day-details  .wijmo-wijev-agenda-container"),t,t,!1)},t.prototype._listViewAgendaScrolled=function(e,t){var r=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container"),i=r.wijsuperpanel("option","vScroller"),s,o=i.scrollValue,u=i.scrollMax-i.scrollLargeChange*2,a=e.type,f=!1,l;a==="wijsuperpanelscroll"?(l=t.position,s=r.find(".wijmo-wijsuperpanel-contentwrapper-touch"),r.height()+l>=s.height()&&(f=!0)):s=r.find(".wijmo-wijsuperpanel-templateouterwrapper"),(o>=u||f)&&s.data("wijevcal_agenda_loadnextpage")&&(s.data("wijevcal_agenda_loadnextpage",!1),s.find(".wijmo-wijev-agenda-more-events").show().html(this.localizeString("agendaLoadingMoreEvents","Loading more events...")),this._renderAgendaEventsTimeoutId&&(clearTimeout(this._renderAgendaEventsTimeoutId),this._renderAgendaEventsTimeoutId=null),this._renderAgendaEventsTimeoutId=setTimeout(n.proxy(function(){this._renderAgendaEventsTimeoutId=null,this._renderAgendaEvents(s,null,null,!0,r),s.find(".wijmo-wijev-agenda-more-events").remove()},this),100))},t.prototype._updateListViewDetails=function(){this._listViewDetailsInit||(this._listViewDetailsInit=!0,n.support.isTouchEnabled&&n.support.isTouchEnabled()?this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container").wijsuperpanel({scroll:n.proxy(this._listViewAgendaScrolled,this)}):this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container").wijsuperpanel({scrolled:n.proxy(this._listViewAgendaScrolled,this)})),this._updateAgendaList(this.element.find(".wijmo-wijev-list-details  .wijmo-wijev-agenda-container"),null,null,!0)},t.prototype._updateAgendaList=function(e,t,r,i){var s=this.element.find(".wijmo-wijev-leftpane"),o=e;e.outerHeight(s.innerHeight()-e[0].offsetTop),o.find(".wijmo-wijsuperpanel-templateouterwrapper").length>0&&(o=o.find(".wijmo-wijsuperpanel-templateouterwrapper")),n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(o=o.find(".wijmo-wijsuperpanel-contentwrapper-touch"));if(i&&o.data("wijevcal_agenda_initialized")){e.data("wijmo-wijsuperpanel")&&this._refreshSuperPanel(e);return}o.data("wijevcal_agenda_initialized",!0),o.data("wijevcal_agenda_loadedeventscount",0),o.html(""),this._renderAgendaEvents(o,t,r,i,e)},t.prototype._isIE8=function(){return n.browser.msie&&n.browser.version&&parseFloat(n.browser.version)<=8},t.prototype._renderAgendaEvents=function(e,t,r,s,o){var u=this._eventsView,a,f,l,c,h=0,p,d="",v="",m=null,g=null,y=this.options,b,w,E=100,S=this,x=e.data("wijevcal_agenda_loadedeventscount");t&&(m=i(t),g=this._addDays(i(r),1),c=(g.getTime()-m.getTime())/864e5);if(u){l=u.length<E+x||!s?u.length:E+x,e.data("wijevcal_agenda_loadedeventscount",l);if(!m){v="";for(f=x;f<l;f+=1){a=u[f];if(f===x||b.getDate()!==a.start.getDate())b=a.start,f!==0&&(d+='<ul class="wijmo-wijev-agenda-list">'+v+"</ul>",d+="</div>"),d+='<div class="wijmo-wijev-agenda-day-container '+this._dayDateToCssClass(b)+'">',s&&(d+=this._renderAgendaDayHeader(b)),v="";v+=this._renderAgendaAppointmentVisual(a),p+=1,f===l-1&&(d+='<ul class="wijmo-wijev-agenda-list">'+v+"</ul>",d+="</div>",l<u.length?(d+='<div class="wijmo-wijev-agenda-more-events">',d+=this._formatString(this.localizeString("agendaMoreEventsFormat","More events ({0})..."),u.length-l),d+="<div>",e.data("wijevcal_agenda_loadnextpage",!0)):e.data("wijevcal_agenda_loadnextpage",!1))}}else while(h<c){b=this._addDays(m,h),b=new Date(b.getFullYear(),b.getMonth(),b.getDate()),w=new Date(b.getFullYear(),b.getMonth(),b.getDate(),23,59,59),p=0,v="";for(f=x;f<l;f+=1)a=u[f],a.start<g&&a.end>m&&a.start<w&&a.start>=b&&(v+=this._renderAgendaAppointmentVisual(a),p+=1);v!==""&&(d+='<div class="wijmo-wijev-agenda-day-container '+this._dayDateToCssClass(b)+'">',s&&(d+=this._renderAgendaDayHeader(b)),d+='<ul class="wijmo-wijev-agenda-list">'+v+"</ul>",d+="</div>"),h+=1}n(d).appendTo(e)}e.on("click",".wijmo-wijev-agenda-event",n.proxy(this._onAgendaEventClick,this)).on("mouseover",".wijmo-wijev-agenda-event",function(e){if(S.options.disabled)return;n(this).addClass(y.wijCSS.stateHover)}).on("mouseout",".wijmo-wijev-agenda-event",function(e){if(S.options.disabled)return;n(this).removeClass(y.wijCSS.stateHover).removeClass(y.wijCSS.stateActive)}).on("mousedown",".wijmo-wijev-agenda-event",function(){if(S.options.disabled)return;n(this).addClass(y.wijCSS.stateActive)}).on("mouseup",".wijmo-wijev-agenda-event",function(){if(S.options.disabled)return;n(this).removeClass(y.wijCSS.stateActive)}),o.data("wijmo-wijsuperpanel")&&this._refreshSuperPanel(o)},t.prototype._renderAgendaDayHeader=function(e){var t='<div class="wijmo-wijev-agenda-header '+this.options.header+'">'+'<div class="wijmo-wijev-weekday">'+this._formatString("{0:dddd}",e)+"</div>"+'<div class="wijmo-wijev-date">'+this._formatString(this.localizeString("agendaHeaderFullDateFormat","{0:MMMM d, yyyy}"),e)+"</div>"+"</div>";return t},t.prototype._onAgendaEventClick=function(e){if(this.options.disabled)return;var t=n(e.target);t.hasClass("wijmo-wijev-agenda-event")||(t=t.parent(".wijmo-wijev-agenda-event")),t.length>0&&this.goToEvent(this._parseEventIdFromClass(t[0].className))},t.prototype._renderAgendaAppointmentVisual=function(e){var t='<li class="wijmo-wijev-agenda-event '+this._dayDateToCssClass(e.start)+" "+this._eventIdToCssClass(e.id)+" "+this.options.wijCSS.stateDefault+" "+this.options.wijCSS.helperClearFix+'">'+'<div class="wijmo-wijev-agenda-event-color '+"wijmo-wijev-event-color-"+(e.color||"default")+'">'+"<div></div>"+"</div>"+'<div class="wijmo-wijev-agenda-event-title">'+e.subject+"</div>"+'<div class="wijmo-wijev-agenda-event-time">'+(this.isAllDayEvent(e)?this.localizeString("labelAllDay","all-day"):this._formatString(this.localizeString("agendaTimeFormat","{0:hh:mm tt} to {1:hh:mm tt}"),e.start,e.end))+"</div>"+"</li>";return t},t.prototype._invalidateCurrentTimeIndicator=function(){var e=this.element.find(".wijmo-wijev-timeruler .wijmo-wijev-currenttime-indicator"),t=new Date,n=this.options;t=t.getMinutes()+t.getHours()*60,e.css("top",t/n.timeInterval*n.timeIntervalHeight)},t.prototype._onEventsDataChanged=function(){this._clearViewsCache(),this._prepareEventsForView(),this._renderActiveView(),this._trigger("eventsDataChanged",null,{eventsData:this.options.eventsData})},t.prototype._onCalendarsChanged=function(){this._trigger("calendarsChanged",null,{calendars:this.options.calendars})},t.prototype._renderDayViewAppointments=function(){var e=this._eventsView,t,r,i,s,o,u=this.element.find(".wijmo-wijev-headercontainer"),a=this.element.find(".wijmo-wijev-scrollcontent"),f=u.find(".wijmo-wijev-dayheadercolumn"),l=a.find(".wijmo-wijev-daycolumn"),c,h,p=this.options,d=this._getDayColumnDates(),v=d[0],m,g,y,b,w,E,S,x,T,N=[];m=d[d.length-1],m=new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59,59);if(e)for(i=0,o=d.length;i<o;i+=1)if(!l[i]._cached){c=d[i],c=new Date(c.getFullYear(),c.getMonth(),c.getDate()),h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),23,59,59);for(r=0,s=e.length;r<s;r+=1)t=e[r],t.start<m&&t.end>v&&t.start<h&&t.end>c&&(this.isAllDayEvent(t)?(g=!0,y=n(this._getAllDayEventMarkup(t)),n(f[i]).find(".wijmo-wijev-allday-cell").append(y)):(b=t.start,w=t.end,b<c&&(b=c),w>h&&(w=h),E=(b-c)/1e3/60,S=(w-c)/1e3/60,x=Math.round(E*p.timeIntervalHeight/p.timeInterval),T=Math.round(S*p.timeIntervalHeight/p.timeInterval),y=n(this._getEventMarkup(t)),y.css("top",x),y.outerHeight(T-x),n(l[i]).append(y)));this._storeDayCache(d[i],f[i],l[i]),l[i]._cached=!0,N.push(l[i])}else N.push(l[i]);this._dayColumnsToResolve=N,this._dayColumnResolveIdx=0,this._resolveDayApptConflictsTimeout||(clearTimeout(this._resolveDayApptConflictsTimeout),this._resolveDayApptConflictsTimeout=null),this._resolveDayApptConflictsTimeout=setTimeout(n.proxy(this._resolveDayViewAppointmentConflictsCb1,this),1),g&&this._invalidateDayView(!0),this._dayViewScrollToEvent&&(y=this.element.find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn ."+this._eventIdToCssClass(this._dayViewScrollToEvent.id)),y.length>0&&this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",y))},t.prototype._getAllDayEventMarkup=function(e){return'<div class="wijmo-wijev-appointment '+this._eventIdToCssClass(e.id)+'">'+'<div class="'+" wijmo-wijev-colordot wijmo-wijev-event-color-"+(e.color||"default")+'"></div>'+'<div class="wijmo-wijev-event-title">'+e.subject+"</div>"+"</div>"},t.prototype._getEventMarkup=function(e){return'<div class="wijmo-wijev-appointment wijmo-wijev-event-color-'+(e.color||"default")+" "+this._eventIdToCssClass(e.id)+'">'+'<div class="wijmo-wijev-content"><div class="wijmo-wijev-title">'+this._formatString(this.options.eventTitleFormat,e.start,e.end,e.subject,e.location,"",e.description)+"</div></div>"+'<div class="wijmo-wijev-resizer">'+'<div class="'+this.options.wijCSS.icon+" "+this.options.wijCSS.iconHGripSolid+'">'+"&nbsp;</div></div>"+"</div>"},t.prototype._resolveDayViewAppointmentConflictsCb1=function(){this._resolveDayApptConflictsTimeout=null;if(!this._dayColumnsToResolve||this._dayColumnResolveIdx>=this._dayColumnsToResolve.length)return;this._resolveDayViewAppointmentConflicts(this._dayColumnsToResolve[this._dayColumnResolveIdx]),this._dayColumnResolveIdx=this._dayColumnResolveIdx+1,setTimeout(n.proxy(this._resolveDayViewAppointmentConflictsCb1,this),1)},t.prototype._resolveDayViewAppointmentConflicts=function(e){var t=n(e).find(".wijmo-wijev-appointment"),r,i=[],s,o,u,a,f,l,c,h,p=0;r=n(t).toArray().sort(this._sortOffsetTop);for(o=0,l=t.length;o<l;o+=1){if(o<p)continue;a=r[o];for(u=o;u<l;u+=1)if(u!==o){f=r[u];if(!(a.offsetTop<f.offsetTop+f.offsetHeight&&a.offsetTop+a.offsetHeight>f.offsetTop))break;i[o]||(i[o]=[a]),i[o].push(f),f.offsetTop+f.offsetHeight>a.offsetTop+a.offsetHeight&&(a=f)}p=u}for(o=0,l=i.length;o<l;o+=1){s=i[o];if(s){c=s.length,s.sort(this._sortOffsetTop);for(u=0;u<c;u+=1)a=s[u],a.style.width=Math.floor(100/c)+"%",h=Math.floor(100*u/c),a.style.marginLeft=h+"%",a.style.zIndex=h}}},t.prototype._sortOffsetTop=function(e,t){return e.offsetTop<t.offsetTop?-1:e.offsetTop>t.offsetTop?1:0},t.prototype._onDayViewTimeIntervalClick=function(e){if(this.options.disabled)return;if(this.options.readOnly)return;this.showEditEventDialog(null,e.target,e)},t.prototype._onDayViewAllDayCellClick=function(e){if(this.options.disabled)return;if(this.options.readOnly)return;var t=n(e.target);if(t.hasClass("wijmo-wijev-appointment")||t.parents(".wijmo-wijev-appointment").length>0)return;if(t.hasClass("wijmo-wijev-daylabel")||t.parents(".wijmo-wijev-daylabel").length>0)return;this.showEditEventDialog(null,e.target,e)},t.prototype._onMonthViewDayLabelClick=function(e){if(this.options.disabled)return;var t=n(e.target).parents(".wijmo-wijev-monthcellcontainer"),r=this.options,i;t.length<1&&(t=n(e.target).parents(".wijmo-wijev-dayheadercolumn")),t[0]&&(i=this._parseDateFromClass(t[0].className),r.viewType!=="day"&&(r.viewType="day",this._onViewTypeChanged()),r.selectedDates=[new Date(i)],this._onSelectedDatesChanged())},t.prototype._onMonthViewCellClick=function(e){if(this.options.disabled)return;var t=n(e.target).parent(".wijmo-wijev-monthcellcontainer");if(this.options.readOnly)return;if(t.length<1)return;this.showEditEventDialog(null,t,e)},t.prototype._onAppointmentClick=function(e){var t=n(e.target),r;if(this.options.disabled)return;if(this.options.readOnly)return;if(this._apptDragResizeFlag)return;t.hasClass("wijmo-wijev-appointment")||(t=t.parents(".wijmo-wijev-appointment")),t.length>0&&(r=this.findEventById(t[0].className),this.showEditEventDialog(r,t,e))},t.prototype.findEventById=function(e){var t;if(e){t=e.indexOf("apptid_"),t!==-1&&(e=this._parseEventIdFromClass(e));if(this._eventsDataById)return this._eventsDataById[e]}return null},t.prototype._onMonthViewAppointmentMouseDown=function(e){if(this.options.disabled)return;if(this.options.readOnly)return;var t=n(e.target),r=t.hasClass("wijmo-wijev-appointment")?t:t.parents(".wijmo-wijev-appointment");e.preventDefault(),this.__targetAppt=r,n(document).bind("mouseup.tmp_wijevcal",n.proxy(this._onMonthViewAppointmentMouseUp,this)),this.element.find(".wijmo-wijev-monthview .wijmo-wijev-monthcellcontainer").bind("mouseover.tmp_wijevcal",n.proxy(this._onMonthViewCellMouseOver,this))},t.prototype._onDayViewAppointmentMouseDown=function(e){if(this.options.disabled)return;if(this.options.readOnly)return;var t=n(e.target),r=t.hasClass("wijmo-wijev-appointment")?t:t.parents(".wijmo-wijev-appointment"),i=t.hasClass("wijmo-wijev-resizer")||t.parents(".wijmo-wijev-resizer").length>0;if(this.options.disabled)return;this._isApptResize=i,e.preventDefault(),this._isApptResize?(this.__startApptH=r[0].offsetHeight,this.__startApptY=r[0].offsetTop):this.__startApptY=r[0].offsetTop,this.__startClientY=e.clientY,this.__targetAppt=r,n(document).bind("mousemove.tmp_wijevcal",n.proxy(this._onDayViewAppointmentMouseMove,this)),n(document).bind("mouseup.tmp_wijevcal",n.proxy(this._onDayViewAppointmentMouseUp,this)),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn").bind("mouseover.tmp_wijevcal",n.proxy(this._onDayViewColumnMouseOver,this)),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-allday-cell").bind("mouseover.tmp_wijevcal",n.proxy(this._onDayViewAllDayMouseOver,this))},t.prototype._onDayViewAppointmentMouseMove=function(e){if(this.options.disabled)return;e.preventDefault();var t=e.clientY-this.__startClientY,n,r=this.options,i,s;e.ctrlKey||(t=Math.round(t/r.timeIntervalHeight)*r.timeIntervalHeight),t!==0&&!this._apptDragResizeFlag&&(this._apptDragResizeFlag=!0,this.__targetAppt.addClass("wijmo-wijev-dragging"),this.__targetAppt.css("width","100%").css("margin-left","0").css("z-index","1000")),this._apptDragResizeFlag&&(this._isApptResize?(i=this.__startApptH+t,i<0?(i=Math.abs(i),n=this.__startApptY-i,n>=0&&(this.__targetAppt.css("height",i),this.__targetAppt.css("top",n))):this.__targetAppt.css("height",i)):(n=this.__startApptY+t,n<0&&(n=0),this.__targetAppt.css("top",n),s=this.__targetAppt.offset().top,this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",this.__targetAppt),this.__startApptY=this.__startApptY-(this.__targetAppt.offset().top-s)),this._onApptVisualDargOrResize(this.__targetAppt,this.findEventById(this.__targetAppt[0].className)))},t.prototype._onDayViewAppointmentMouseUp=function(e){if(this.options.disabled)return;this.__targetAppt&&this.__targetAppt.removeClass("wijmo-wijev-dragging"),n(document).unbind(".tmp_wijevcal"),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn").unbind(".tmp_wijevcal"),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-allday-cell").unbind(".tmp_wijevcal");if(this._apptDragResizeFlag||this._apptMovedFlag){var t=this.findEventById(this.__targetAppt[0].className);this._onApptVisualDargOrResize(this.__targetAppt,t),this._apptMovedFlag=!1,this._movedFromTimeInervalApptElem=null,this.updateEvent(t),window.setTimeout(n.proxy(function(){this.__targetAppt&&!this.__targetAppt.hasClass("wijmo-wijev-dragging")&&(this._apptDragResizeFlag=!1,this._resolveDayViewAppointmentConflicts(this.__targetAppt.parents(".wijmo-wijev-daycolumn")))},this),1)}},t.prototype._updateAppointmentVisual=function(e){var t=this.element.find(".wijmo-wijev-dayview ."+this._eventIdToCssClass(e.id)),n=this.options,r,s,o,u,a,f,l,c;t.length===1&&(this._addColorClass(t,e.color),t.find(".wijmo-wijev-title").html(this._formatString(n.eventTitleFormat,e.start,e.end,e.subject,e.location,"",e.description)),a=i(e.start),r=(e.start-a)/1e3/60,s=(e.end-a)/1e3/60,o=Math.round(r*n.timeIntervalHeight/n.timeInterval),u=Math.round(s*n.timeIntervalHeight/n.timeInterval),t.css("top",o),t.css("height",u-o),f=this._dayDateToCssClass(a),t.parents(".wijmo-wijev-daycolumn."+f).length!==1&&(l=t[0].parentNode,c=this.element.find(".wijmo-wijev-daycolumn."+f),l.removeChild(t[0]),t.appendTo(c)))},t.prototype._onApptVisualDargOrResize=function(e,t){if(this.options.disabled)return;var n=this.options,r=e[0].offsetTop,s=r+e[0].offsetHeight,o,u,a,f,l,c,h,p;e.parents(".wijmo-wijev-dayheadercolumn").length>0?p=e.parents(".wijmo-wijev-dayheadercolumn")[0]:p=e.parents(".wijmo-wijev-daycolumn")[0],h=this._parseDateFromClass(p.className,null),o=Math.round(r*n.timeInterval/n.timeIntervalHeight),u=Math.round(s*n.timeInterval/n.timeIntervalHeight),a=new Date(o*60*1e3+h.getTime()),f=new Date(u*60*1e3+h.getTime()),t&&(this._isApptResize?l=f:(c=t.end.getTime()-t.start.getTime(),l=new Date(a.getTime()+c)),t.allday=e.parents(".wijmo-wijev-dayheadercolumn").length>0,t.start=a,t.end=l,e.find(".wijmo-wijev-title").html(this._formatString(n.eventTitleFormat,t.start,t.end,t.subject,t.location,"",t.description)),!this._isApptResize&&l.getTime()!==f.getTime()&&e.css("height",Math.round((t.end-i(t.start))/1e3/60*n.timeIntervalHeight/n.timeInterval)-Math.round((t.start-i(t.start))/1e3/60*n.timeIntervalHeight/n.timeInterval)))},t.prototype._onDayViewColumnMouseOver=function(e){if(this.options.disabled)return;var t=n(e.target).parents(".wijmo-wijev-daycolumn"),r=this.__targetAppt.parents(".wijmo-wijev-daycolumn");if(t.length<1)return;if(r.length<1){r=this.__targetAppt.parents(".wijmo-wijev-dayheadercolumn");if(r.length<1)return;this._movedFromTimeInervalApptElem?(this.__targetAppt.replaceWith(this._movedFromTimeInervalApptElem),this.__targetAppt=n(this._movedFromTimeInervalApptElem),this._movedFromTimeInervalApptElem=null):this.__targetAppt.html(this._getEventMarkup(this.findEventById(this.__targetAppt[0].className)))}t[0].className!==r[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this._resolveDayViewAppointmentConflicts(r),this.__targetAppt.appendTo(t),this._apptMovedFlag=!0)},t.prototype._onMonthViewCellMouseOver=function(e){if(this.options.disabled)return;var t=n(e.target),r=t.hasClass("wijmo-wijev-monthcellcontainer")?t:t.parents(".wijmo-wijev-monthcellcontainer"),i=this.__targetAppt.parents(".wijmo-wijev-monthcellcontainer");if(r.length<1||i.length<1)return;r[0].className!==i[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this.__targetAppt.appendTo(r.find(".wijmo-wijev-monthcell")),this.__targetApptChanged=!0)},t.prototype._onMonthViewAppointmentMouseUp=function(){if(this.options.disabled)return;var e,t=this.__targetAppt.parents(".wijmo-wijev-monthcellcontainer")[0],r=this._parseDateFromClass(t.className,null),s;n(document).unbind(".tmp_wijevcal"),this.element.find(".wijmo-wijev-monthview .wijmo-wijev-monthcellcontainer").unbind(".tmp_wijevcal"),this.__targetApptChanged&&(this.__targetApptChanged=!1,e=this.findEventById(this.__targetAppt[0].className),s=(r.getTime()-i(e.start).getTime())/864e5,e.start=this._addDays(e.start,s),e.end=this._addDays(e.end,s),this.updateEvent(e))},t.prototype._onDayViewAllDayMouseOver=function(e){if(this.options.disabled)return;var t=n(e.target).parents(".wijmo-wijev-dayheadercolumn"),r=this.__targetAppt.parents(".wijmo-wijev-daycolumn"),i;if(t.length<1)return;r.length>0?(i=n(this._getAllDayEventMarkup(this.findEventById(this.__targetAppt[0].className))),this._movedFromTimeInervalApptElem=this.__targetAppt[0].cloneNode(!0),this.__targetAppt.replaceWith(i),this.__targetAppt=i):r=this.__targetAppt.parents(".wijmo-wijev-dayheadercolumn");if(r.length<1)return;t[0].className!==r[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this._resolveDayViewAppointmentConflicts(r),this.__targetAppt.appendTo(n(t).find(".wijmo-wijev-allday-cell")),this._apptMovedFlag=!0)},t.prototype._renderMonthView=function(){var e=this.options,t=e.selectedDate,r=e.firstDayOfWeek,i=!1,s=!1,o,u,a,f=new Date,l,c,h=!1,p,d=["","","","","","",""],v,m,g=this.element.find(".wijmo-wijev-view.wijmo-wijev-monthview"),y,b=e.dayHeaderFormat,w=e.firstRowDayHeaderFormat;t||(t=new Date),u=new Date(t.getFullYear(),t.getMonth(),1);while(u.getDay()!==parseInt(r))u=this._addDays(u,-1);a=new Date(t.getFullYear(),t.getMonth(),this._daysInMonth(t.getMonth(),t.getFullYear())),o=u,l=0,c=0;while(o<a||l<7){o>a&&(a=o),v="",p="wijmo-wijev-monthcellcontainer "+e.wijCSS.content+" "+this._dayDateToCssClass(o),s=o.getMonth()!==t.getMonth(),s&&(p+=" wijmo-wijev-othermonth"),h?h=!1:(p+=" wijmo-wijev-leftborder",l===6&&(p+=" wijmo-wijev-rightborder")),i=this._compareDayDates(o,f)===0,i&&(p+=" wijmo-wijev-today",p+=" wijmo-wijev-rightborder",h=!0),v+='<div class="'+p+'">',v+='<div class="wijmo-wijev-monthcellheader',s&&(v+=" "+e.wijCSS.prioritySecondary),i&&(v+=" "+e.wijCSS.stateHighlight),v+='">',i&&(v+='<span class="wijmo-wijev-todaylabel">'+this.localizeString("labelToday","Today")+"</span>"),c===0?v+=this._formatString(w,o):v+=this._formatString(b,o),v+="</div>",v+='<div class="wijmo-wijev-monthcell',s&&(v+=" "+e.wijCSS.prioritySecondary),i&&(v+=" "+e.wijCSS.stateHighlight),v+='"></div>',v+="</div>",d[l]=d[l]+v,l+=1,o=this._addDays(o,1);if(l>6){if(o>a)break;l=0,c+=1}}g.length===0&&(g=n('<div class="wijmo-wijev-view wijmo-wijev-monthview '+e.wijCSS.content+'">'+'<h3 class="wijmo-wijev-header-title">title'+"</h3>"+'<div class="wijmo-wijev-monthview-inner">'+"</div>"+"</div>"),g.appendTo(this.element.find(".wijmo-wijev-view-container"))),y=g.find(".wijmo-wijev-monthview-inner"),y.find(".wijmo-wijev-monthcolumn").remove(),o=u;for(m=0;m<7;m+=1)y.append('<div class="wijmo-wijev-monthcolumn">'+d[m]+"</div>"),o=this._addDays(o,1);this._invalidateMonthView(),this._renderMonthViewAppointments()},t.prototype._invalidateMonthView=function(){var e=this.element.find(".wijmo-wijev-monthview"),t=e.find(".wijmo-wijev-monthview-inner"),r=e.find(".wijmo-wijev-monthcolumn"),i=e.find(".wijmo-wijev-monthcellcontainer"),s=this.element.find(".wijmo-wijev-monthview .wijmo-wijev-header-title"),o,u,a,f,l,c,h,p;this._invalidateView();if(r.length<1)return;o=e.innerWidth(),u=e.innerHeight()-s.outerHeight(!0),t.outerWidth(o),t.outerHeight(u),o-=t.outerWidth(!0)-t.innerWidth(),u-=t.outerHeight(!0)-t.innerHeight(),a=Math.floor(o/r.length),r.outerWidth(a),p=o-a*r.length,p>0&&n(r[r.length-1]).outerWidth(a+p),h=n(r[0]).find(".wijmo-wijev-weekdayname").outerHeight(!0),h||(h=0),f=Math.floor((u-h)/n(r[0]).find(".wijmo-wijev-monthcellcontainer").length),i.height(f),l=n(i[0]).find(".wijmo-wijev-monthcellheader").outerHeight(!0),c=f-l,i.find(".wijmo-wijev-monthcell").outerHeight(c)},t.prototype._renderMonthViewAppointments=function(){var e=this._eventsView,t,r,i,s,o,u=this.element.find(".wijmo-wijev-monthcellcontainer"),a,f,l,c;if(e)for(i=0,o=u.length;i<o;i+=1){a=u[i],f=this._parseDateFromClass(a.className),l=new Date(f.getFullYear(),f.getMonth(),f.getDate(),23,59,59);for(r=0,s=e.length;r<s;r+=1)t=e[r],t.start<l&&t.end>f&&(c=n('<div class="wijmo-wijev-appointment '+this._eventIdToCssClass(t.id)+'">'+'<div class="'+" wijmo-wijev-colordot wijmo-wijev-event-color-"+(t.color||"default")+'"></div>'+'<div class="wijmo-wijev-event-title">'+t.subject+"</div>"+"</div>"),n(a).find(".wijmo-wijev-monthcell").append(c))}u.find(".wijmo-wijev-monthcell").each(n.proxy(function(e,t){var r=n(t),i=r.find(".wijmo-wijev-appointment"),s=r.outerHeight(),o=i.outerHeight(),u=i.length*o,a=0;u>s&&(i.each(function(e,t){e*o+o>s&&(t.style.display="none",a+=1)}),a>0&&r.find(".wijmo-wijev-monthcell-showmore").length<1&&r.append(n('<div class="wijmo-wijev-monthcell-showmore">'+this._formatString(this.localizeString("monthCellMoreEventsFormat","{0}  more..."),a)+"</div>")))},this))},t.prototype.log=function(e,t){},t.prototype._log=function(e,t){var r;this.logPanel&&(r=new Date,this.logPanel.prepend(n('<span class="'+(t?t:"wijmo-wijev-information")+'">'+"["+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds()+"] "+e+"</span><br/>")))},t.prototype._createLogPanel=function(){if(!this.logPanel){this.logDialog=n('<div title="Log"><div class="wijmo-wijev-log"></div></div>'),this.logDialog.appendTo(this.element);var e={};e[this.localizeString("buttonClearAll","Clear All")]=function(){n(this).find(".wijmo-wijev-log").html("")},e[this.localizeString("buttonClose","Close")]=function(){n(this).wijdialog("close")},this.logPanel=this.logDialog.wijdialog({captionButtons:{},buttons:e,width:600,height:420,position:["right","top"]}).find(".wijmo-wijev-log")}this.logDialog.wijdialog("open")},t.prototype.status=function(e,t){this.element.find(".wijmo-wijev-statusbar").html("<span class='"+(t?t:"wijmo-wijev-status")+"'>"+e+"</span>"),this.log(e,t?t:"wijmo-wijev-status"),this.statusbarEventsAdded||(this.statusbarEventsAdded=!0,this._initStatusbar())},t.prototype._invalidateView=function(){var e=this.element.find(".wijmo-wijev-rightpane"),t=this.element.find(".wijmo-wijev-leftpane"),r=this.element.find(".wijmo-wijev-headerbar"),i=this.element.find(".wijmo-wijev-navigationbar"),s=this.element.find(".wijmo-wijev-statusbar"),o=this.element.find(".wijmo-wijev-view-container"),u=this.element.find(".wijmo-wijev-view"),a,f,l,c,h,p,d,v,m,g;a=this.element.innerWidth()-(o.outerWidth(!0)-o.innerWidth()),f=this.element.innerHeight()-(o.outerHeight(!0)-o.innerHeight()),l=r.is(":visible")?r.outerHeight(!0):0,c=i.is(":visible")?i.outerHeight(!0):0,h=s.is(":visible")?s.outerHeight(!0):0,o.outerWidth(a),o.outerHeight(f-l-c-h),v=0;for(g=0;g<t.length;g+=1)n(t[g]).is(":visible")&&(v+=n(t[g]).outerWidth());m=e.is(":visible")?e.outerWidth():0,p=f-l-c-h,d=a-m-v-1,u.outerHeight(p),u.outerWidth(d),r.outerWidth(d+v),i.outerWidth(this.element.innerWidth()),s.outerWidth(d+v+m),t.outerHeight(f-l-c-h),e.outerHeight(f+100),this.element.find(".wijmo-wijev-datepager").wijdatepager("refresh")},t.prototype._daysInMonth=function(e,t){var n=new Date(t,e+1,0);return n.getDate()},t.prototype._addMinutes=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()+t)},t.prototype._addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},t.prototype._setTime=function(e,t,n){var r;return e=new Date(e),e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),n&&(r=Math.floor((t.getTime()-n.getTime())/864e5),r>0&&(e=this._addDays(e,r))),e},t.prototype._addMonths=function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,e.getDate())},t.prototype._compareDayDates=function(e,t){return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e<t?-1:e>t?1:0},t.prototype._dayDateToCssClass=function(e){return"wijmo-wijev-date_"+e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()},t.prototype._parseDateFromClass=function(e,t,n){var r,i,s,o=new RegExp("wijmo-wijev-minute-(\\d+)\\s"),u=new RegExp("wijmo-wijev-date_(\\d+_\\d+_\\d+)\\s");return e?(s=u.exec(e+" ")[1].split("_"),r=new Date(parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)),t&&(i=o.exec(t+" "),i&&(i=parseInt(i[1],10),r.setMinutes(i))),r):n||null},t.prototype._eventIdToCssClass=function(e){return"apptid_"+e},t.prototype._parseEventIdFromClass=function(e){var t="",n,r;return n=new RegExp("apptid_(\\S+)"),r=n.exec(e),r&&r.length>1&&(t=r[1]),t},t.prototype._isContainsDayDate=function(e,t){var n;if(!e)return!1;for(n=0;n<e.length;n+=1)if(this._compareDayDates(e[n],t)===0)return!0},t.prototype._formatString=function(e,t,n,r,i,s,o,u){var a,f=arguments,l,c,h=this;if(f.length<=1)return Globalize.format(f);typeof e=="string"&&(e==="_formatWeekTitle"?e=this._formatWeekTitle:e==="_formatMonthTitle"?e=this._formatMonthTitle:typeof window[e]=="function"&&(e=window[e]));if(typeof e=="function"){c=[];for(l=1;l<f.length;l+=1)c[l-1]=f[l];return e.apply(this,c)}return a=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),e.replace(a,function(e,t,n,r,i){return e=f[Number(t)+1],r?Globalize.format(e,r,h._getCulture()):e})},t.prototype._formatMonthTitle=function(e){return this._formatString(this.localizeString("monthViewHeaderFormat","{0:MMMM yyyy}"),e)},t.prototype._formatWeekTitle=function(e,t){return e.getMonth()!==t.getMonth()?this._formatString(this.localizeString("weekViewHeaderFormat2Months","{0:MMMM} - {1:MMMM yyyy}"),e,t):this._formatString(this.localizeString("weekViewHeaderFormat","{0:MMMM yyyy}"),e)},t.prototype._formatDayHeaderDate=function(e){var t=this.options,n=t.viewType.toLowerCase(),r=this.options.dayViewHeaderFormat;if(r[n])r=r[n];else if(!r[n])return"";return this._formatString(r,e)},t.prototype._getCulture=function(e){return Globalize.findClosestCulture(e||this.options.culture)},t.prototype._isRTL=function(){return!!this._getCulture().isRTL},t.prototype._onAjaxError=function(e,t,n,r){t?(this.status("Ajax error "+t.status+" ("+t.statusText+")","error"),this.log("Error, requested url: "+n.url,"error"),t.responseText&&this.log("Error, response text: "+t.responseText,"error")):(this.status("Ajax error detected.","error"),this.log("Error, requested url: "+n.url,"error"))},t.prototype._onWindowResize=function(){this.invalidate()},t}(e.wijmoWidget);t.wijevcal=p;var d=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-b",stateDefault:"ui-btn ui-btn-b"},this.initSelector=":jqmData(role='wijevcal')",this.culture="",this.localization=null,this.datePagerLocalization=null,this.readOnly=!1,this.webServiceUrl="",this.colors=null,this.dataStorage={addEvent:null,updateEvent:null,deleteEvent:null,loadEvents:null,addCalendar:null,updateCalendar:null,deleteCalendar:null,loadCalendars:null},this.dataSource=null,this.eventsData=null,this.appointments=[],this.calendars=[],this.disabled=!1,this.editCalendarTemplate="",this.enableLogs=!1,this.eventTitleFormat="{2}",this.titleFormat={day:!1,week:"_formatWeekTitle",month:"_formatMonthTitle",list:!1},this.firstDayOfWeek=0,this.headerBarVisible=!0,this.navigationBarVisible=!0,this.rightPaneVisible=!1,this.selectedDate=null,this.selectedDates=null,this.statusBarVisible=!1,this.timeInterval=30,this.timeIntervalHeight=15,this.timeRulerInterval=60,this.timeRulerFormat="{0:h tt}",this.dayHeaderFormat="{0:d }",this.firstRowDayHeaderFormat="{0:ddd d}",this.dayViewHeaderFormat={day:"all-day events",week:"{0:d dddd}",list:"{0:d dddd}"},this.viewType="day",this.ensureEventDialogOnBody=!1,this.visibleCalendars=new Array("Default"),this.calendarsChanged=null,this.initialized=null,this.selectedDatesChanged=null,this.viewTypeChanged=null,this.beforeEditEventDialogShow=null,this.beforeAddEvent=null,this.beforeUpdateEvent=null,this.beforeDeleteEvent=null,this.beforeAddCalendar=null,this.beforeUpdateCalendar=null,this.beforeDeleteCalendar=null,this.eventsDataChanged=null}return e}();p.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new d),n.wijmo.registerWidget(r,p.prototype)})(e.evcal||(e.evcal={}));var t=e.evcal})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function h(){return document.location.hash.match(/^#\w+=/)}var n=jQuery,r="wijappview",i={menu:"menu",content:"content",header:"header",footer:"footer",page:"appviewpage"},s={adjusted:r+"-adjusted"},o="",u=!1;n.fn.findRole=function(e){return this.find(":jqmData(role='"+e+"')")};var a=function(e){function t(){e.apply(this,arguments),this._updatingUrl=!1}return __extends(t,e),t.prototype._appViewCSS=function(){return this.options.wijCSS.wijappview},t.prototype._initMenu=function(){this._menuDiv=this.element.findRole(i.menu);if(!this._menuDiv.length)throw"A DIV with data-role='"+i.menu+"' not found!";this._linkList=this._menuDiv.find("ul");if(!this._linkList.length)throw"Invalid markup. Link list not found";this._menuDiv.addClass(this._appViewCSS().menu)},t.prototype._initPages=function(e,t){var r=this._pageStore,i=this._appViewCSS();e.each(function(){var e=n(this).addClass(i.page),r=e.attr("id"),s=t;if(e.jqmData("url"))return;r&&(s+="#"+r),e.attr("data-url",s)})},t.prototype._initPageContainer=function(){var e=this._appViewCSS(),t=this._pageStore;this._pageContainer=n("<div/>").addClass(e.pageContainer).prependTo(this.element);var r=this.element.findRole(i.page);this._initPages(r,this._documentUrl),r.each(function(e){t.push(n(this).clone()),e>0&&n(this).remove()}),this._firstPage=r.first().addClass(e.pageActive).appendTo(this._pageContainer),this._initCurrentPage()},t.prototype._getUrl=function(e){var t=e.is("form")?"action":"href",r=e.attr(t);return!r||r==="#"?null:(n.mobile.path.isRelativeUrl(r)&&e.parents(":jqmData(url)").each(function(e,t){var i=n(t).jqmData("url");if(i&&n.mobile.path.isAbsoluteUrl(i))return r=n.mobile.path.makeUrlAbsolute(r,i),!1}),r)},t.prototype._hijackLinks=function(e){var t=this;e.on("click."+r,"a:not(.WijListviewNestedLink), .ui-btn:not(.WijListviewNestedLink)",function(e){if(e.isDefaultPrevented())return;var r=t._findClosestLink(e.target);if(!r||n(r).jqmData("appviewpage")===!1)return;var i=t._getUrl(n(r));i&&(e.preventDefault(),e.stopPropagation(),t.changePage(i))})},t.prototype._hijackForms=function(e){var t=this;e.on("submit."+r,"form",function(e){if(e.isDefaultPrevented())return;var r=n(e.currentTarget),i=r.closest("."+t._appViewCSS().page);if(!n.mobile.ajaxEnabled||r.is(":jqmData(ajax='false')")||!r.jqmHijackable().length)return;var s=r.attr("method"),o=r.attr("target"),u=t._getUrl(r);if(!u)return;e.preventDefault(),e.stopPropagation(),t.changePage(u,{type:s&&s.length&&s.toLowerCase()||"get",data:r.serialize(),reloadPage:!0})})},t.prototype._initNavigation=function(){var e=this;this._onPopStateScoped=this._onPopStateScoped||n.proxy(this._onPopState,this),n(window).bind("popstate."+r,this._onPopStateScoped),n(window).bind("appviewpagehashchange."+r,function(){return e._navigateToCurrentLocation()}),this._onNavigateScoped=this._onNavigateScoped||n.proxy(this._onNavigate,this),n(n.mobile.pageContainer).bind("navigate."+r,this._onNavigateScoped)},t.prototype._create=function(){this._pageStore=[],this._documentUrl=this._removePageUrlParam(location.href),this.element.attr("data-url",this._documentUrl),this._jqmPageEnclosingWidget=this._findJqmPage(),this.element.addClass(this._appViewCSS().outerDiv),this._initMenu(),this._initPageContainer(),this._hijackLinks(this.element),this._hijackForms(this.element),this._initNavigation(),this._navigateToCurrentLocation()},t.prototype.destroy=function(){e.prototype.destroy.call(this);var t="."+r;this.element.unbind(t),n(window).unbind(t),n(n.mobile.pageContainer).unbind(t)},t.prototype._findJqmPage=function(){for(var e=this.element;e.length;e=e.parent()){var t=e.jqmData("mobile-page");if(t)return t}return null},t.prototype._initCurrentPage=function(){var e=this._appViewCSS(),t=this.activePage();t.findRole(i.content).addClass(e.content);var n=t.findRole(i.header).addClass(e.header),r=n.jqmData("position"),s=!r||r==="fixed";s&&n.addClass("ui-header-fixed"),this.element.toggleClass(e.withFixedHeader,s)},t.prototype._findClosestLink=function(e){while(e&&(typeof e.nodeName!="string"||e.nodeName.toLowerCase()!=="a"))e=e.parentNode;return e},t.prototype._clickHandler=function(e){var t=n(e.currentTarget),r=t.is("li")?t.jqmData("url"):t.is("a")?t.attr("href"):null;if(!r)return;e.preventDefault(),e.stopPropagation(),this.changePage(r)},t.prototype._inheritAttribute=function(e,t,n){e.attr(n)&&!t.attr(n)&&t.attr(n,e.attr(n))},t.prototype._findInCache=function(e){return n(n.grep(this._pageStore,function(t){return t.jqmData("url")===e})[0]).clone()},t.prototype.loadPage=function(e,t){var r=this;e=e||"";var s=n.Deferred(),o=n.mobile.path,u=n.extend({},this.options.loadSettings,t),a=!e||e.charAt(0)==="#",f=null,l=null,c=this._makeAbsoluteUrl(e);if(u.data)switch(u.type){case"get":c=o.addSearchParams(c,u.data),u.data=undefined;break;case"post":u.reloadPage=!0}var h=n.Event("pagebeforeload"),p={url:e,absUrl:c,dataUrl:c,deferred:s,options:u};this._trigger(h.type,h,p);if(h.isDefaultPrevented())return s.promise();if(!n.mobile.allowCrossDomainPages&&!o.isSameDomain(o.parseLocation(),c))return s.reject(c,t),s.promise();var d=c&&o.getFilePath(c).replace(/#.+/,""),v=n.ajax({url:d,type:u.type,data:u.data,dataType:"html",success:function(u,a,h){function y(e){return o.isAbsoluteUrl(e)||/^(\w+:|#|\/)/.test(e)?null:o.makeUrlAbsolute(e,d)}var v=n("<div></div>"),m=new RegExp("(<[^>]+\\bdata-"+n.mobile.ns+"role=[\"']?"+i.page+"[\"']?[^>]*>)"),g=new RegExp("\\bdata-"+n.mobile.ns+"url=[\"']?([^\"'>]*)[\"']?");n.browser.msie&&parseFloat(n.browser.version)<=7&&(u=u.replace(/<a[^>]+href=['"][^'"]+['"]/g,function(e){return e.replace(/href=['"]([^'"]+)['"]/,function(e,t){return t=y(t)||t,"href='"+t+"'"})})),v.get(0).innerHTML=u;var b=r._getAllPages(v,e);b.length||(b=n("<div/>").attr("data-role",i.page).html(u.split(/<\/?body[^>]*>/gmi)[1]));var w=u.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;w&&~w.indexOf("&")&&(w=n("<div>"+w+"</div>").text()),b.each(function(e,t){t=n(t),t.attr("data-external-page",!0),!t.jqmData("title")&&w&&t.attr("data-title",w);var r=o.get(d);t.find("[src], [href]").each(function(){var e=n(this).is("[href]")?"href":n(this).is("[src]")?"src":"action",t=y(n(this).attr(e));t&&n(this).attr(e,t)})}),r._initPages(b,d),f=b.filter(function(){return n(this).jqmData("url")===c}),f.length||(f=b.first()),p.xhr=h,p.textStatus=a,p.page=f,p.allPages=b,r._trigger("pageload",null,p),b.each(function(e,t){r._pageStore.push(n(t).clone())}),s.resolve(c,t,f,l)},error:function(e,i,o){p.xhr=e,p.textStatus=i,p.errorThrown=o;var u=n.Event("pageloadfailed");r._trigger(u.type,u,p);if(u.isDefaultPrevented())return;s.reject(c,t)}});return s.fail(function(){v.abort()}),s},t.prototype._getAllPages=function(e,t){return e.findRole(i.page)},t.prototype.activePage=function(){return this._pageContainer.children("."+this._appViewCSS().pageActive).first()},t.prototype.isMenuUrl=function(e){var t=this;return e=e.toLowerCase(),this._menuDiv.find("a").is(function(){var r=t._getUrl(n(this));return r?r.toLowerCase()===e:!1})},t.prototype._showLoading=function(){n.mobile.loading("show")},t.prototype._hideLoading=function(){n.mobile.loading("hide")},t.prototype.changePage=function(e,t){var r=this;t=n.extend({updateUrl:!0},this.options.loadSettings,t);var o={toPage:e,options:t};this._curRequest&&this._curRequest.state()==="pending"&&this._curRequest.rejectWith&&this._curRequest.rejectWith(this,[e,t,!0]);var a,f;if(typeof e=="string"){a=this.activePage().data("url"),f=this._makeAbsoluteUrl(e);var l=f.indexOf("#");if(l>=0&&f.substr(0,l)===a.split("#")[0]){var c=this._findInCache(f);c.length&&(e=c)}}if(typeof e=="string"){this._updateUIBeforeChange(f),t.showLoadMsg&&this._showLoading(),this._curRequest=this.loadPage(e,t).always(function(){t.showLoadMsg&&r._hideLoading(),r._curRequest=null}).done(function(e,t,n,i){r._updateUIAfterChange(n.jqmData("url")),r.changePage(n,t)}).fail(function(e,t,n){n||r._updateUI(a),r._trigger("pagechangefailed",null,o)});return}var h=n.Event("pagebeforechange");this._trigger(h.type,h,o);if(h.isDefaultPrevented())return;var p=e.jqmData("url"),d=null;this._updateUI(p),p&&(d=this._makeRelative(p),d!=null&&(d=this._makeRelative(d)));var v=e.jqmData("title"),m=e.findRole("header"),g=this._appViewCSS();!m.length&&v&&(m=n("<div data-role='header'/>").append(n("<h2/>").text(v)).prependTo(e));if(m.length&&!m.jqmData(s.adjusted)){m.jqmData(s.adjusted,!0);var y=this._firstPage.findRole(i.header);y&&this._inheritAttribute(y,m,"data-position"),this.isMenuUrl(p)&&!m.find("a[data-icon=back]").length&&n("<a/>").attr({href:this._documentUrl,"data-icon":"back"}).text("Back").prependTo(m)}v&&(document.title=v),this._pageContainer.children().removeClass(g.pageActive),e.addClass(g.pageActive).appendTo(this._pageContainer.empty()),this._initCurrentPage();if(t.updateUrl||u)this._updateUrl(p,d,document.title),u=!1;e.jqmData("mobile-page",this._jqmPageEnclosingWidget).jqmData("page",this._jqmPageEnclosingWidget).enhanceWithin().trigger("pagecreate").trigger(this.widgetEventPrefix+"pageinit",o),this._trigger("pagechange",null,o)},t.prototype._updateUIBeforeChange=function(e){var t=this,r=e===this._documentUrl,i=this._linkList.find("li"),s=this._appViewCSS().menuItemActive;if(r)i.removeClass(s);else{var o=i.filter(function(){var r=t._getUrl(n(this).find("a"));return r&&r.toLowerCase()===e.toLowerCase()});o.length&&!o.hasClass(s)&&(i.removeClass(s),o.addClass(s))}},t.prototype._updateUIAfterChange=function(e){var t=this._appViewCSS(),n=e===this._documentUrl;this.element.toggleClass(t.inPage,!n)},t.prototype._updateUI=function(e){this._updateUIBeforeChange(e),this._updateUIAfterChange(e)},t.prototype._changePageIfDifferent=function(e,t){var n=typeof e=="string"?e:e.jqmData("url");this.activePage().jqmData("url")!==n&&this.changePage(e,t)},t.prototype._onNavigate=function(e){var t=new RegExp("^#?"+this.options.urlParamName+"=");(history.state&&history.state.wijappview||document.location.hash.match(t))&&e.preventDefault()},t.prototype._removePageUrlParam=function(e){return e.replace(/\#.*$/,"")},t.prototype._addUrl=function(e){var t=this.options.urlParamName,n=this._removePageUrlParam(location.href);return e&&(n+="#"+t+"="+e),n},t.prototype._makeRelative=function(e){var t=n.mobile.path.parseLocation(),r=e;if(e){var i=t.domain+t.directory;e.substr(0,t.hrefNoHash.length)===t.hrefNoHash?r=e.substr(t.hrefNoHash.length):e.substr(0,i.length)===i&&(r=e.substr(i.length))}return r},t.prototype._makeAbsoluteUrl=function(e){var t=n.mobile.path,r=this.activePage(),i=t.makeUrlAbsolute(r.jqmData("url")||this._documentUrl,this._documentUrl);return!i.match(/\/$/)&&!i.match(/\./)&&(i+="/"),e&&t.makeUrlAbsolute(e,i)},t.prototype._onPopState=function(e){if(this._updatingUrl)return;history.state&&history.state.wijappview?this._changePageIfDifferent(history.state.absUrl||this._firstPage,{updateUrl:!1}):this._navigateToCurrentLocation()},t.prototype._navigateToCurrentLocation=function(){var e=new RegExp("#"+this.options.urlParamName+"=(.+)"),t=e.exec(location.href)||o&&e.exec(o),r=t?n.mobile.path.makeUrlAbsolute(t[1],this._documentUrl):this._firstPage;o="",this._changePageIfDifferent(r,{updateUrl:!1})},t.prototype._updateUrl=function(e,t,r){this._updatingUrl=!0;try{n.mobile.navigate.navigator.preventHashAssignPopState=!0,document.location.hash=e===this._documentUrl?"":this.options.urlParamName+"="+t}finally{this._updatingUrl=!1}},t}(e.wijmoWidget);t.wijappview=a;var f="wijmo-wijappview",l=f+"-",c=function(){function e(){this.urlParamName="appviewpage",this.loadSettings={type:"GET",data:undefined,reloadPage:!1,showLoadMsg:!1},this.pagebeforeload=null,this.pageload=null,this.pageloadfailed=null,this.pagebeforechange=null,this.pagechange=null,this.pagechangefailed=null,this.wijCSS={wijappview:{outerDiv:f,inPage:l+"in-page",menu:l+"menu",menuItemActive:"ui-btn-down-b",page:l+"page",pageActive:l+"page-active",pageContainer:l+"page-container",content:l+"content",header:l+"header",withFixedHeader:l+"with-fixed-header"}}}return e}();t.wijappview_options=c,a.prototype.options=n.extend({},e.wijmoWidget.prototype.options,new c),n.mobile&&(n.wijmo.registerWidget(r,a.prototype),n(window).bind("hashchange",function(e){h()&&(e.stopImmediatePropagation(),n(window).trigger("appviewpagehashchange"))}),h()&&(o=document.location.hash,n(window).bind("pagecontainercreate",function(){document.location.hash="",u=!0})))})(e.appview||(e.appview={}));var t=e.appview})(wijmo||(wijmo={}));